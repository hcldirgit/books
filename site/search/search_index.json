{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u57fa\u4e8emkdocs-material\u642d\u5efa\u4e2a\u4eba\u9759\u6001\u535a\u5ba2(\u542b\u652f\u6301\u7684markdown\u8bed\u6cd5) \u00b6 \u672c\u6587\u4e3b\u9898 \u00b6 mkdocs-material\u5165\u95e8\uff0c\u5305\u62ec\u5b89\u88c5\u3001\u8fd0\u884c\u3001\u53d1\u5e03\u81f3github-pages\u53ca\u4e2a\u4eba\u7ad9\u70b9 markdown\u8bed\u6cd5\uff0c\u5305\u62ec\u4f20\u7edf\u8bed\u6cd5\u548cmkdocs-material\u652f\u6301\u7684\u6269\u5c55\u8bed\u6cd5 mkdocs-material\u662f\u4ec0\u4e48 \u00b6 \u7b26\u5408google material ui\u89c4\u8303\u7684\u9759\u6001\u6587\u6863\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u4f7f\u7528markdown\u8fdb\u884c\u6587\u6863\u4e66\u5199 mkdocs python\u7f16\u5199\u7684markdown\u89e3\u91ca\u5668\u3001\u7f16\u8bd1\u5668\uff0c\u5e26\u6709\u672c\u5730cli\u5de5\u5177 \u81ea\u5e26\u57fa\u4e8eTornado\u7684\u5c0f\u578bhttp\u670d\u52a1\uff0c\u7528\u4e8e\u672c\u5730\u8c03\u8bd5 \u5185\u7f6e\u4e00\u952e\u5f0f\u53d1\u5e03\u81f3GitHub Pages \u5185\u7f6emkdocs\u98ce\u683c\u3001readthedocs\u98ce\u683c\u7684\u4e3b\u9898\uff0c\u5e76\u652f\u6301\u81ea\u5b9a\u4e49\u4e3b\u9898 \u652f\u6301\u8c03\u7528python\u6a21\u5757\u5b9e\u73b0\u8bed\u6cd5\u53ca\u6e32\u67d3\u7684\u6269\u5c55 mkdocs-material python\u6a21\u5757\uff0c\u7b26\u5408google material ui\u89c4\u8303\u7684mkdocs\u81ea\u5b9a\u4e49\u4e3b\u9898 \u9488\u5bf9\u7279\u5b9a\u8bed\u6cd5\u3001\u529f\u80fd\u505a\u4e86\u6e32\u67d3\u4f18\u5316 \u6839\u636e\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u9875\u9762\u5c3a\u5bf8\u81ea\u52a8\u7f29\u653e\uff0c\u5bf9PC\u3001\u79fb\u52a8\u8bbe\u5907\u90fd\u53cb\u597d \u4e30\u5bcc\u7684\u9875\u9762\u914d\u8272\uff0c\u591a\u8fbe19\u79cd\u4e3b\u4f53\u914d\u8272\u548c16\u79cd\u60ac\u505c\u94fe\u63a5\u6587\u5b57\u914d\u8272 \u6700\u4f73\u5b9e\u8df5: \u5efa\u8bae\u4ec5\u4f7f\u7528 mkdocs-material \u5b98\u7f51\u652f\u6301\u7684\u8bed\u6cd5\u3001\u529f\u80fd\uff0c\u8fd9\u6837\u4e0d\u4f1a\u6709\u6e32\u67d3\u65b9\u9762\u7684\u5f02\u5e38\uff0c\u9664\u975e\u81ea\u5df1\u5bf9mkdocs\u3001mkdocs-material\u3001html\u3001js\u3001css\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\u3002 \u672c\u6587\u6240\u6709\u9610\u8ff0\u7684\u8bed\u6cd5\u5747\u662fmkdocs-material\u5b98\u7f51\u63a8\u8350\u7684\u3002 \u5199\u5728\u524d\u9762 \u00b6 \u672c\u6587\u5927\u90e8\u5206\u5185\u5bb9\u5747\u662f\u4e2a\u4eba\u7406\u89e3\uff0c\u4e0d\u4fdd\u8bc1\u51c6\u786e\u6027\u3002 \u672c\u6587\u4e3b\u8981\u662f\u9610\u8ff0markdown\u8bed\u6cd5\uff0c\u56e0\u6b64\u5173\u4e8emkdocs-material\u7684\u9ad8\u7ea7\u914d\u7f6e\u3001python markdown\u548cpymdowx\u6a21\u5757\u6240\u652f\u6301\u7684markdown\u8bed\u6cd5\u4e0d\u5728\u672c\u6587\u9610\u8ff0\u8303\u56f4\u3002\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u81ea\u5df1\u5230\u76f8\u5e94\u5b98\u7f51\u4e86\u89e3\uff0c\u5177\u4f53\u5982\u4e0b: mkdocs mkdocs-material python markdown pymdownx","title":"\u4e00. \u4ecb\u7ecd"},{"location":"#mkdocs-materialmarkdown","text":"","title":"\u57fa\u4e8emkdocs-material\u642d\u5efa\u4e2a\u4eba\u9759\u6001\u535a\u5ba2(\u542b\u652f\u6301\u7684markdown\u8bed\u6cd5)"},{"location":"#_1","text":"mkdocs-material\u5165\u95e8\uff0c\u5305\u62ec\u5b89\u88c5\u3001\u8fd0\u884c\u3001\u53d1\u5e03\u81f3github-pages\u53ca\u4e2a\u4eba\u7ad9\u70b9 markdown\u8bed\u6cd5\uff0c\u5305\u62ec\u4f20\u7edf\u8bed\u6cd5\u548cmkdocs-material\u652f\u6301\u7684\u6269\u5c55\u8bed\u6cd5","title":"\u672c\u6587\u4e3b\u9898"},{"location":"#mkdocs-material","text":"\u7b26\u5408google material ui\u89c4\u8303\u7684\u9759\u6001\u6587\u6863\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u4f7f\u7528markdown\u8fdb\u884c\u6587\u6863\u4e66\u5199 mkdocs python\u7f16\u5199\u7684markdown\u89e3\u91ca\u5668\u3001\u7f16\u8bd1\u5668\uff0c\u5e26\u6709\u672c\u5730cli\u5de5\u5177 \u81ea\u5e26\u57fa\u4e8eTornado\u7684\u5c0f\u578bhttp\u670d\u52a1\uff0c\u7528\u4e8e\u672c\u5730\u8c03\u8bd5 \u5185\u7f6e\u4e00\u952e\u5f0f\u53d1\u5e03\u81f3GitHub Pages \u5185\u7f6emkdocs\u98ce\u683c\u3001readthedocs\u98ce\u683c\u7684\u4e3b\u9898\uff0c\u5e76\u652f\u6301\u81ea\u5b9a\u4e49\u4e3b\u9898 \u652f\u6301\u8c03\u7528python\u6a21\u5757\u5b9e\u73b0\u8bed\u6cd5\u53ca\u6e32\u67d3\u7684\u6269\u5c55 mkdocs-material python\u6a21\u5757\uff0c\u7b26\u5408google material ui\u89c4\u8303\u7684mkdocs\u81ea\u5b9a\u4e49\u4e3b\u9898 \u9488\u5bf9\u7279\u5b9a\u8bed\u6cd5\u3001\u529f\u80fd\u505a\u4e86\u6e32\u67d3\u4f18\u5316 \u6839\u636e\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u9875\u9762\u5c3a\u5bf8\u81ea\u52a8\u7f29\u653e\uff0c\u5bf9PC\u3001\u79fb\u52a8\u8bbe\u5907\u90fd\u53cb\u597d \u4e30\u5bcc\u7684\u9875\u9762\u914d\u8272\uff0c\u591a\u8fbe19\u79cd\u4e3b\u4f53\u914d\u8272\u548c16\u79cd\u60ac\u505c\u94fe\u63a5\u6587\u5b57\u914d\u8272 \u6700\u4f73\u5b9e\u8df5: \u5efa\u8bae\u4ec5\u4f7f\u7528 mkdocs-material \u5b98\u7f51\u652f\u6301\u7684\u8bed\u6cd5\u3001\u529f\u80fd\uff0c\u8fd9\u6837\u4e0d\u4f1a\u6709\u6e32\u67d3\u65b9\u9762\u7684\u5f02\u5e38\uff0c\u9664\u975e\u81ea\u5df1\u5bf9mkdocs\u3001mkdocs-material\u3001html\u3001js\u3001css\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\u3002 \u672c\u6587\u6240\u6709\u9610\u8ff0\u7684\u8bed\u6cd5\u5747\u662fmkdocs-material\u5b98\u7f51\u63a8\u8350\u7684\u3002","title":"mkdocs-material\u662f\u4ec0\u4e48"},{"location":"#_2","text":"\u672c\u6587\u5927\u90e8\u5206\u5185\u5bb9\u5747\u662f\u4e2a\u4eba\u7406\u89e3\uff0c\u4e0d\u4fdd\u8bc1\u51c6\u786e\u6027\u3002 \u672c\u6587\u4e3b\u8981\u662f\u9610\u8ff0markdown\u8bed\u6cd5\uff0c\u56e0\u6b64\u5173\u4e8emkdocs-material\u7684\u9ad8\u7ea7\u914d\u7f6e\u3001python markdown\u548cpymdowx\u6a21\u5757\u6240\u652f\u6301\u7684markdown\u8bed\u6cd5\u4e0d\u5728\u672c\u6587\u9610\u8ff0\u8303\u56f4\u3002\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u81ea\u5df1\u5230\u76f8\u5e94\u5b98\u7f51\u4e86\u89e3\uff0c\u5177\u4f53\u5982\u4e0b: mkdocs mkdocs-material python markdown pymdownx","title":"\u5199\u5728\u524d\u9762"},{"location":"contact/","text":"E-mail\u5730\u5740: 610658552@qq.com caimengzhi","title":"\u516d. \u8054\u7cfb\u65b9\u5f0f"},{"location":"recommend/","text":"\u5982\u679c\u5e0c\u671b\u81ea\u5df1\u6240\u5199\u7684markdown\u53ef\u4ee5\u517c\u5bb9\u5404\u4e2amarkdown\u7f16\u8f91\u5668\uff0c\u90a3\u4e48\u53ea\u9700\u4e86\u89e3markdown\u7684\u4f20\u7edf\u8bed\u6cd5\u5373\u53ef\uff0c\u8fd9\u91cc\u63a8\u8350\u4e00\u7bc7\u6587\u7ae0 Markdown\u57fa\u672c\u8bed\u6cd5 \u3002 \u5982\u679c\u60f3\u8ba9\u81ea\u5df1\u6240\u5199\u7684markdown\u53d1\u5e03\u5230web\u670d\u52a1\u5668\uff0c\u4f8b\u5982GitHub Pages\u3001\u81ea\u5df1\u642d\u5efa\u7684HTTP Server\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u672c\u6587\u6240\u4ecb\u7ecd\u7684\u8bed\u6cd5\uff0c\u4ee5\u5b9e\u73b0\u4e30\u5bcc\u591a\u6837\u7684\u6e32\u67d3\u6548\u679c\u3002 \u7b14\u8005\u5efa\u8bae\uff1a\u5c3d\u91cf\u4f7f\u7528\u4f20\u7edf\u8bed\u6cd5\uff0c\u53ea\u5728\u5fc5\u8981\u65f6\u5019\u624d\u4f7f\u7528\u672c\u6587\u4ecb\u7ecd\u7684\u8bed\u6cd5\u3002\u56e0\u4e3a\u6392\u7248\u7b80\u6d01\u3001\u6761\u7406\u6e05\u6670\u624d\u80fd\u5e26\u6765\u6700\u8212\u670d\u7684\u9605\u8bfb\u611f\u53d7\u3002","title":"\u4e94. \u4f7f\u7528\u5efa\u8bae"},{"location":"appendix/baidu_tongji/","text":"\u5148\u5728\u767e\u5ea6\u7edf\u8ba1\u91cc\u521b\u5efa\u6dfb\u52a0\u7ad9\u70b9\uff0c\u4ee5\u672c\u7ad9\u4e3a\u4f8b: \u786e\u5b9a\u540e\u4f1a\u770b\u5230javascript\u4ee3\u7801\uff0c\u590d\u5236\u4ee3\u7801 \u5728docs\u76ee\u5f55\u4e0b\u65b0\u5efajs\u76ee\u5f55\uff0c\u5e76\u5728docs/js\u76ee\u5f55\u91cc\u653e\u7f6ebaidu-tongji.js\uff0c\u5c06\u590d\u5236\u7684\u4ee3\u7801\u7c98\u8d34\u8fdb\u6765\uff0c\u4ee5\u672c\u7ad9\u4e3a\u4f8b: var _hmt = _hmt || []; ( function () { var hm = document . createElement ( \"script\" ); hm . src = \"https://hm.baidu.com/hm.js?51fafb2ac8f80ecf43b05bb4cc281020\" ; var s = document . getElementsByTagName ( \"script\" )[ 0 ]; s . parentNode . insertBefore ( hm , s ); })(); \u6700\u540e\u5728mkdocs.yml\u91cc\u65b0\u589e\u5982\u4e0b\u914d\u7f6e: extra_javascript : - 'js/baidu-tongji.js' \u6548\u679c: js\u4f1a\u81ea\u52a8\u52a0\u5728 \u524d\uff0c\u4ee5\u672c\u7ad9\u4e3a\u4f8b:","title":"3. \u6dfb\u52a0\u767e\u5ea6\u7edf\u8ba1"},{"location":"appendix/color/","text":"\u4ecb\u7ecd \u00b6 mkdocs-material\u652f\u6301google material ui\u89c4\u8303\u5b9a\u4e49\u768419\u79cd\u4e3b\u4f53\u914d\u8272\u548c16\u79cd\u9f20\u6807\u60ac\u505c\u8d85\u94fe\u63a5\u6587\u5b57\u914d\u8272 \u4f7f\u7528 \u00b6 \u5728mkdocs.yml\u91cc\u6dfb\u52a0\u914d\u7f6e\uff0c\u4ee5\u672c\u7ad9\u4e3a\u4f8b: extra : palette : primary : 'Blue Grey' accent : 'Pink' primary\u548caccent\u7684\u9ed8\u8ba4\u503c\u5747\u662f\"Indigo\" 19\u79cd\u4e3b\u4f53\u914d\u8272 \u00b6 \u9f20\u6807\u70b9\u51fb\u5373\u53ef\u4e34\u65f6\u6539\u53d8\u5f53\u524d\u9875\u4e3b\u4f53\u989c\u8272 Red Pink Purple Deep Purple Indigo Blue Light Blue Cyan Teal Green Light Green Lime Yellow Amber Orange Deep Orange Brown Grey Blue Grey var buttons = document.querySelectorAll(\"button[data-md-color-primary]\"); Array.prototype.forEach.call(buttons, function(button) { button.addEventListener(\"click\", function() { document.body.dataset.mdColorPrimary = this.dataset.mdColorPrimary; }) }) 16\u79cd\u9f20\u6807\u60ac\u505c\u8d85\u94fe\u63a5\u6587\u5b57\u914d\u8272 \u00b6 \u9f20\u6807\u70b9\u51fb\u5373\u53ef\u4e34\u65f6\u6539\u53d8\u5f53\u524d\u9875\u9f20\u6807\u60ac\u505c\u8d85\u94fe\u63a5\u6587\u5b57\u989c\u8272 Red Pink Purple Deep Purple Indigo Blue Light Blue Cyan Teal Green Light Green Lime Yellow Amber Orange Deep Orange var buttons = document.querySelectorAll(\"button[data-md-color-accent]\"); Array.prototype.forEach.call(buttons, function(button) { button.addEventListener(\"click\", function() { document.body.dataset.mdColorAccent = this.dataset.mdColorAccent; }) })","title":"4. \u914d\u8272"},{"location":"appendix/color/#_1","text":"mkdocs-material\u652f\u6301google material ui\u89c4\u8303\u5b9a\u4e49\u768419\u79cd\u4e3b\u4f53\u914d\u8272\u548c16\u79cd\u9f20\u6807\u60ac\u505c\u8d85\u94fe\u63a5\u6587\u5b57\u914d\u8272","title":"\u4ecb\u7ecd"},{"location":"appendix/color/#_2","text":"\u5728mkdocs.yml\u91cc\u6dfb\u52a0\u914d\u7f6e\uff0c\u4ee5\u672c\u7ad9\u4e3a\u4f8b: extra : palette : primary : 'Blue Grey' accent : 'Pink' primary\u548caccent\u7684\u9ed8\u8ba4\u503c\u5747\u662f\"Indigo\"","title":"\u4f7f\u7528"},{"location":"appendix/color/#19","text":"\u9f20\u6807\u70b9\u51fb\u5373\u53ef\u4e34\u65f6\u6539\u53d8\u5f53\u524d\u9875\u4e3b\u4f53\u989c\u8272 Red Pink Purple Deep Purple Indigo Blue Light Blue Cyan Teal Green Light Green Lime Yellow Amber Orange Deep Orange Brown Grey Blue Grey var buttons = document.querySelectorAll(\"button[data-md-color-primary]\"); Array.prototype.forEach.call(buttons, function(button) { button.addEventListener(\"click\", function() { document.body.dataset.mdColorPrimary = this.dataset.mdColorPrimary; }) })","title":"19\u79cd\u4e3b\u4f53\u914d\u8272"},{"location":"appendix/color/#16","text":"\u9f20\u6807\u70b9\u51fb\u5373\u53ef\u4e34\u65f6\u6539\u53d8\u5f53\u524d\u9875\u9f20\u6807\u60ac\u505c\u8d85\u94fe\u63a5\u6587\u5b57\u989c\u8272 Red Pink Purple Deep Purple Indigo Blue Light Blue Cyan Teal Green Light Green Lime Yellow Amber Orange Deep Orange var buttons = document.querySelectorAll(\"button[data-md-color-accent]\"); Array.prototype.forEach.call(buttons, function(button) { button.addEventListener(\"click\", function() { document.body.dataset.mdColorAccent = this.dataset.mdColorAccent; }) })","title":"16\u79cd\u9f20\u6807\u60ac\u505c\u8d85\u94fe\u63a5\u6587\u5b57\u914d\u8272"},{"location":"appendix/emoji_shortname/","text":"\u8be5\u8868\u683c\u4e3aemojione-3.1.2(pymdownx-4.0\u96c6\u6210)\u7684\u5168\u540d\u548c\u77ed\u540d\u6620\u5c04\u8868\uff0c\u51712666\u4e2a \u5168\u540d \u77ed\u540d hundred points :100: input numbers :1234: pool 8 ball :8ball: A button (blood type) :a: AB button (blood type) :ab: input latin letters :abc: input latin lowercase :abcd: Japanese \\u201cacceptable\\u201d button :accept: adult :adult: adult: light skin tone :adult_tone1: adult: medium-light skin tone :adult_tone2: adult: medium skin tone :adult_tone3: adult: medium-dark skin tone :adult_tone4: adult: dark skin tone :adult_tone5: aerial tramway :aerial_tramway: airplane :airplane: airplane arrival :airplane_arriving: airplane departure :airplane_departure: small airplane :airplane_small: alarm clock :alarm_clock: alembic :alembic: alien :alien: ambulance :ambulance: amphora :amphora: anchor :anchor: baby angel :angel: baby angel: light skin tone :angel_tone1: baby angel: medium-light skin tone :angel_tone2: baby angel: medium skin tone :angel_tone3: baby angel: medium-dark skin tone :angel_tone4: baby angel: dark skin tone :angel_tone5: anger symbol :anger: right anger bubble :anger_right: angry face :angry: anguished face :anguished: ant :ant: red apple :apple: Aquarius :aquarius: Aries :aries: reverse button :arrow_backward: fast down button :arrow_double_down: fast up button :arrow_double_up: down arrow :arrow_down: down button :arrow_down_small: play button :arrow_forward: right arrow curving down :arrow_heading_down: right arrow curving up :arrow_heading_up: left arrow :arrow_left: down-left arrow :arrow_lower_left: down-right arrow :arrow_lower_right: right arrow :arrow_right: left arrow curving right :arrow_right_hook: up arrow :arrow_up: up-down arrow :arrow_up_down: up button :arrow_up_small: up-left arrow :arrow_upper_left: up-right arrow :arrow_upper_right: clockwise vertical arrows :arrows_clockwise: anticlockwise arrows button :arrows_counterclockwise: artist palette :art: articulated lorry :articulated_lorry: keycap: * :asterisk: asterisk :asterisk_symbol: astonished face :astonished: running shoe :athletic_shoe: ATM sign :atm: atom symbol :atom: avocado :avocado: B button (blood type) :b: baby :baby: baby bottle :baby_bottle: baby chick :baby_chick: baby symbol :baby_symbol: baby: light skin tone :baby_tone1: baby: medium-light skin tone :baby_tone2: baby: medium skin tone :baby_tone3: baby: medium-dark skin tone :baby_tone4: baby: dark skin tone :baby_tone5: BACK arrow :back: bacon :bacon: badminton :badminton: baggage claim :baggage_claim: balloon :balloon: ballot box with ballot :ballot_box: ballot box with check :ballot_box_with_check: pine decoration :bamboo: banana :banana: double exclamation mark :bangbang: bank :bank: bar chart :bar_chart: barber pole :barber: baseball :baseball: basketball :basketball: bat :bat: person taking bath :bath: person taking bath: light skin tone :bath_tone1: person taking bath: medium-light skin tone :bath_tone2: person taking bath: medium skin tone :bath_tone3: person taking bath: medium-dark skin tone :bath_tone4: person taking bath: dark skin tone :bath_tone5: bathtub :bathtub: battery :battery: beach with umbrella :beach: umbrella on ground :beach_umbrella: bear face :bear: bearded person :bearded_person: bearded person: light skin tone :bearded_person_tone1: bearded person: medium-light skin tone :bearded_person_tone2: bearded person: medium skin tone :bearded_person_tone3: bearded person: medium-dark skin tone :bearded_person_tone4: bearded person: dark skin tone :bearded_person_tone5: bed :bed: honeybee :bee: beer mug :beer: clinking beer mugs :beers: lady beetle :beetle: Japanese symbol for beginner :beginner: bell :bell: bellhop bell :bellhop: bento box :bento: bicycle :bike: bikini :bikini: billed cap :billed_cap: biohazard :biohazard: bird :bird: birthday cake :birthday: black circle :black_circle: black heart :black_heart: joker :black_joker: black large square :black_large_square: black medium-small square :black_medium_small_square: black medium square :black_medium_square: black nib :black_nib: black small square :black_small_square: black square button :black_square_button: blond-haired man :blond-haired_man: blond-haired man: light skin tone :blond-haired_man_tone1: blond-haired man: medium-light skin tone :blond-haired_man_tone2: blond-haired man: medium skin tone :blond-haired_man_tone3: blond-haired man: medium-dark skin tone :blond-haired_man_tone4: blond-haired man: dark skin tone :blond-haired_man_tone5: blond-haired woman :blond-haired_woman: blond-haired woman: light skin tone :blond-haired_woman_tone1: blond-haired woman: medium-light skin tone :blond-haired_woman_tone2: blond-haired woman: medium skin tone :blond-haired_woman_tone3: blond-haired woman: medium-dark skin tone :blond-haired_woman_tone4: blond-haired woman: dark skin tone :blond-haired_woman_tone5: blond-haired person :blond_haired_person: blond-haired person: light skin tone :blond_haired_person_tone1: blond-haired person: medium-light skin tone :blond_haired_person_tone2: blond-haired person: medium skin tone :blond_haired_person_tone3: blond-haired person: medium-dark skin tone :blond_haired_person_tone4: blond-haired person: dark skin tone :blond_haired_person_tone5: blossom :blossom: blowfish :blowfish: blue book :blue_book: sport utility vehicle :blue_car: blue circle :blue_circle: blue heart :blue_heart: smiling face with smiling eyes :blush: boar :boar: bomb :bomb: open book :book: bookmark :bookmark: bookmark tabs :bookmark_tabs: books :books: collision :boom: woman\\u2019s boot :boot: bouquet :bouquet: bow and arrow :bow_and_arrow: bowl with spoon :bowl_with_spoon: bowling :bowling: boxing glove :boxing_glove: boy :boy: boy: light skin tone :boy_tone1: boy: medium-light skin tone :boy_tone2: boy: medium skin tone :boy_tone3: boy: medium-dark skin tone :boy_tone4: boy: dark skin tone :boy_tone5: brain :brain: bread :bread: breast-feeding :breast_feeding: breast-feeding: light skin tone :breast_feeding_tone1: breast-feeding: medium-light skin tone :breast_feeding_tone2: breast-feeding: medium skin tone :breast_feeding_tone3: breast-feeding: medium-dark skin tone :breast_feeding_tone4: breast-feeding: dark skin tone :breast_feeding_tone5: bride with veil :bride_with_veil: bride with veil: light skin tone :bride_with_veil_tone1: bride with veil: medium-light skin tone :bride_with_veil_tone2: bride with veil: medium skin tone :bride_with_veil_tone3: bride with veil: medium-dark skin tone :bride_with_veil_tone4: bride with veil: dark skin tone :bride_with_veil_tone5: bridge at night :bridge_at_night: briefcase :briefcase: broccoli :broccoli: broken heart :broken_heart: bug :bug: light bulb :bulb: high-speed train with bullet nose :bullettrain_front: high-speed train :bullettrain_side: burrito :burrito: bus :bus: bus stop :busstop: bust in silhouette :bust_in_silhouette: busts in silhouette :busts_in_silhouette: butterfly :butterfly: cactus :cactus: shortcake :cake: tear-off calendar :calendar: spiral calendar :calendar_spiral: call me hand :call_me: call me hand: light skin tone :call_me_tone1: call me hand: medium-light skin tone :call_me_tone2: call me hand: medium skin tone :call_me_tone3: call me hand: medium-dark skin tone :call_me_tone4: call me hand: dark skin tone :call_me_tone5: mobile phone with arrow :calling: two-hump camel :camel: camera :camera: camera with flash :camera_with_flash: camping :camping: Cancer :cancer: candle :candle: candy :candy: canned food :canned_food: canoe :canoe: input latin uppercase :capital_abcd: Capricorn :capricorn: card file box :card_box: card index :card_index: carousel horse :carousel_horse: carrot :carrot: cat :cat2: cat face :cat: optical disk :cd: chains :chains: bottle with popping cork :champagne: clinking glasses :champagne_glass: chart increasing with yen :chart: chart decreasing :chart_with_downwards_trend: chart increasing :chart_with_upwards_trend: chequered flag :checkered_flag: cheese wedge :cheese: cherries :cherries: cherry blossom :cherry_blossom: chestnut :chestnut: chicken :chicken: child :child: child: light skin tone :child_tone1: child: medium-light skin tone :child_tone2: child: medium skin tone :child_tone3: child: medium-dark skin tone :child_tone4: child: dark skin tone :child_tone5: children crossing :children_crossing: chipmunk :chipmunk: chocolate bar :chocolate_bar: chopsticks :chopsticks: Christmas tree :christmas_tree: church :church: cinema :cinema: circus tent :circus_tent: cityscape at dusk :city_dusk: sunset :city_sunset: cityscape :cityscape: CL button :cl: clapping hands :clap: clapping hands: light skin tone :clap_tone1: clapping hands: medium-light skin tone :clap_tone2: clapping hands: medium skin tone :clap_tone3: clapping hands: medium-dark skin tone :clap_tone4: clapping hands: dark skin tone :clap_tone5: clapper board :clapper: classical building :classical_building: clipboard :clipboard: ten-thirty :clock1030: ten o\\u2019clock :clock10: eleven-thirty :clock1130: eleven o\\u2019clock :clock11: twelve-thirty :clock1230: twelve o\\u2019clock :clock12: one-thirty :clock130: one o\\u2019clock :clock1: two-thirty :clock230: two o\\u2019clock :clock2: three-thirty :clock330: three o\\u2019clock :clock3: four-thirty :clock430: four o\\u2019clock :clock4: five-thirty :clock530: five o\\u2019clock :clock5: six-thirty :clock630: six o\\u2019clock :clock6: seven-thirty :clock730: seven o\\u2019clock :clock7: eight-thirty :clock830: eight o\\u2019clock :clock8: nine-thirty :clock930: nine o\\u2019clock :clock9: mantelpiece clock :clock: closed book :closed_book: locked with key :closed_lock_with_key: closed umbrella :closed_umbrella: cloud :cloud: cloud with lightning :cloud_lightning: cloud with rain :cloud_rain: cloud with snow :cloud_snow: tornado :cloud_tornado: clown face :clown: club suit :clubs: coat :coat: cocktail glass :cocktail: coconut :coconut: hot beverage :coffee: coffin :coffin: face with open mouth & cold sweat :cold_sweat: comet :comet: clamp :compression: laptop computer :computer: confetti ball :confetti_ball: confounded face :confounded: confused face :confused: Japanese \\u201ccongratulations\\u201d button :congratulations: construction :construction: building construction :construction_site: construction worker :construction_worker: construction worker: light skin tone :construction_worker_tone1: construction worker: medium-light skin tone :construction_worker_tone2: construction worker: medium skin tone :construction_worker_tone3: construction worker: medium-dark skin tone :construction_worker_tone4: construction worker: dark skin tone :construction_worker_tone5: control knobs :control_knobs: convenience store :convenience_store: cookie :cookie: cooking :cooking: COOL button :cool: copyright :copyright: ear of corn :corn: couch and lamp :couch: man and woman holding hands :couple: couple with heart: man, man :couple_mm: couple with heart :couple_with_heart: couple with heart: woman, man :couple_with_heart_woman_man: couple with heart: woman, woman :couple_ww: kiss :couplekiss: cow :cow2: cow face :cow: cowboy hat face :cowboy: crab :crab: crayon :crayon: crazy face :crazy_face: credit card :credit_card: crescent moon :crescent_moon: cricket :cricket: cricket game :cricket_game: crocodile :crocodile: croissant :croissant: latin cross :cross: crossed flags :crossed_flags: crossed swords :crossed_swords: crown :crown: passenger ship :cruise_ship: crying face :cry: crying cat face :crying_cat_face: crystal ball :crystal_ball: cucumber :cucumber: cup with straw :cup_with_straw: heart with arrow :cupid: curling stone :curling_stone: curly loop :curly_loop: currency exchange :currency_exchange: curry rice :curry: custard :custard: customs :customs: cut of meat :cut_of_meat: cyclone :cyclone: dagger :dagger: woman dancing :dancer: woman dancing: light skin tone :dancer_tone1: woman dancing: medium-light skin tone :dancer_tone2: woman dancing: medium skin tone :dancer_tone3: woman dancing: medium-dark skin tone :dancer_tone4: woman dancing: dark skin tone :dancer_tone5: dango :dango: sunglasses :dark_sunglasses: direct hit :dart: dashing away :dash: calendar :date: deciduous tree :deciduous_tree: deer :deer: department store :department_store: desert :desert: desktop computer :desktop: detective :detective: detective: light skin tone :detective_tone1: detective: medium-light skin tone :detective_tone2: detective: medium skin tone :detective_tone3: detective: medium-dark skin tone :detective_tone4: detective: dark skin tone :detective_tone5: diamond with a dot :diamond_shape_with_a_dot_inside: diamond suit :diamonds: digit eight :digit_eight: digit five :digit_five: digit four :digit_four: digit nine :digit_nine: digit one :digit_one: digit seven :digit_seven: digit six :digit_six: digit three :digit_three: digit two :digit_two: digit zero :digit_zero: disappointed face :disappointed: disappointed but relieved face :disappointed_relieved: card index dividers :dividers: dizzy :dizzy: dizzy face :dizzy_face: no littering :do_not_litter: dog :dog2: dog face :dog: dollar banknote :dollar: Japanese dolls :dolls: dolphin :dolphin: door :door: doughnut :doughnut: dove :dove: dragon :dragon: dragon face :dragon_face: dress :dress: camel :dromedary_camel: drooling face :drooling_face: droplet :droplet: drum :drum: duck :duck: dumpling :dumpling: dvd :dvd: e-mail :e-mail: eagle :eagle: ear :ear: sheaf of rice :ear_of_rice: ear: light skin tone :ear_tone1: ear: medium-light skin tone :ear_tone2: ear: medium skin tone :ear_tone3: ear: medium-dark skin tone :ear_tone4: ear: dark skin tone :ear_tone5: globe showing Europe-Africa :earth_africa: globe showing Americas :earth_americas: globe showing Asia-Australia :earth_asia: egg :egg: eggplant :eggplant: keycap: 8 :eight: eight-pointed star :eight_pointed_black_star: eight-spoked asterisk :eight_spoked_asterisk: eject button :eject: electric plug :electric_plug: elephant :elephant: elf :elf: elf: light skin tone :elf_tone1: elf: medium-light skin tone :elf_tone2: elf: medium skin tone :elf_tone3: elf: medium-dark skin tone :elf_tone4: elf: dark skin tone :elf_tone5: END arrow :end: England :england: envelope :envelope: envelope with arrow :envelope_with_arrow: euro banknote :euro: castle :european_castle: post office :european_post_office: evergreen tree :evergreen_tree: exclamation mark :exclamation: exploding head :exploding_head: expressionless face :expressionless: eye :eye: eye in speech bubble :eye_in_speech_bubble: glasses :eyeglasses: eyes :eyes: face vomiting :face_vomiting: face with hand over mouth :face_with_hand_over_mouth: face with monocle :face_with_monocle: face with raised eyebrow :face_with_raised_eyebrow: face with symbols over mouth :face_with_symbols_over_mouth: factory :factory: fairy :fairy: fairy: light skin tone :fairy_tone1: fairy: medium-light skin tone :fairy_tone2: fairy: medium skin tone :fairy_tone3: fairy: medium-dark skin tone :fairy_tone4: fairy: dark skin tone :fairy_tone5: fallen leaf :fallen_leaf: family :family: family: man, boy :family_man_boy: family: man, boy, boy :family_man_boy_boy: family: man, girl :family_man_girl: family: man, girl, boy :family_man_girl_boy: family: man, girl, girl :family_man_girl_girl: family: man, woman, boy :family_man_woman_boy: family: man, man, boy :family_mmb: family: man, man, boy, boy :family_mmbb: family: man, man, girl :family_mmg: family: man, man, girl, boy :family_mmgb: family: man, man, girl, girl :family_mmgg: family: man, woman, boy, boy :family_mwbb: family: man, woman, girl :family_mwg: family: man, woman, girl, boy :family_mwgb: family: man, woman, girl, girl :family_mwgg: family: woman, boy :family_woman_boy: family: woman, boy, boy :family_woman_boy_boy: family: woman, girl :family_woman_girl: family: woman, girl, boy :family_woman_girl_boy: family: woman, girl, girl :family_woman_girl_girl: family: woman, woman, boy :family_wwb: family: woman, woman, boy, boy :family_wwbb: family: woman, woman, girl :family_wwg: family: woman, woman, girl, boy :family_wwgb: family: woman, woman, girl, girl :family_wwgg: fast-forward button :fast_forward: fax machine :fax: fearful face :fearful: paw prints :feet: female sign :female_sign: ferris wheel :ferris_wheel: ferry :ferry: field hockey :field_hockey: file cabinet :file_cabinet: file folder :file_folder: film frames :film_frames: crossed fingers :fingers_crossed: crossed fingers: light skin tone :fingers_crossed_tone1: crossed fingers: medium-light skin tone :fingers_crossed_tone2: crossed fingers: medium skin tone :fingers_crossed_tone3: crossed fingers: medium-dark skin tone :fingers_crossed_tone4: crossed fingers: dark skin tone :fingers_crossed_tone5: fire :fire: fire engine :fire_engine: fireworks :fireworks: 1 st place medal :first_place: first quarter moon :first_quarter_moon: first quarter moon with face :first_quarter_moon_with_face: fish :fish: fish cake with swirl :fish_cake: fishing pole :fishing_pole_and_fish: raised fist :fist: raised fist: light skin tone :fist_tone1: raised fist: medium-light skin tone :fist_tone2: raised fist: medium skin tone :fist_tone3: raised fist: medium-dark skin tone :fist_tone4: raised fist: dark skin tone :fist_tone5: keycap: 5 :five: Ascension Island :flag_ac: Andorra :flag_ad: United Arab Emirates :flag_ae: Afghanistan :flag_af: Antigua & Barbuda :flag_ag: Anguilla :flag_ai: Albania :flag_al: Armenia :flag_am: Angola :flag_ao: Antarctica :flag_aq: Argentina :flag_ar: American Samoa :flag_as: Austria :flag_at: Australia :flag_au: Aruba :flag_aw: \\u00c5land Islands :flag_ax: Azerbaijan :flag_az: Bosnia & Herzegovina :flag_ba: Barbados :flag_bb: Bangladesh :flag_bd: Belgium :flag_be: Burkina Faso :flag_bf: Bulgaria :flag_bg: Bahrain :flag_bh: Burundi :flag_bi: Benin :flag_bj: St. Barth\\u00e9lemy :flag_bl: black flag :flag_black: Bermuda :flag_bm: Brunei :flag_bn: Bolivia :flag_bo: Caribbean Netherlands :flag_bq: Brazil :flag_br: Bahamas :flag_bs: Bhutan :flag_bt: Bouvet Island :flag_bv: Botswana :flag_bw: Belarus :flag_by: Belize :flag_bz: Canada :flag_ca: Cocos (Keeling) Islands :flag_cc: Congo - Kinshasa :flag_cd: Central African Republic :flag_cf: Congo - Brazzaville :flag_cg: Switzerland :flag_ch: C\\u00f4te d\\u2019Ivoire :flag_ci: Cook Islands :flag_ck: Chile :flag_cl: Cameroon :flag_cm: China :flag_cn: Colombia :flag_co: Clipperton Island :flag_cp: Costa Rica :flag_cr: Cuba :flag_cu: Cape Verde :flag_cv: Cura\\u00e7ao :flag_cw: Christmas Island :flag_cx: Cyprus :flag_cy: Czechia :flag_cz: Germany :flag_de: Diego Garcia :flag_dg: Djibouti :flag_dj: Denmark :flag_dk: Dominica :flag_dm: Dominican Republic :flag_do: Algeria :flag_dz: Ceuta & Melilla :flag_ea: Ecuador :flag_ec: Estonia :flag_ee: Egypt :flag_eg: Western Sahara :flag_eh: Eritrea :flag_er: Spain :flag_es: Ethiopia :flag_et: European Union :flag_eu: Finland :flag_fi: Fiji :flag_fj: Falkland Islands :flag_fk: Micronesia :flag_fm: Faroe Islands :flag_fo: France :flag_fr: Gabon :flag_ga: United Kingdom :flag_gb: Grenada :flag_gd: Georgia :flag_ge: French Guiana :flag_gf: Guernsey :flag_gg: Ghana :flag_gh: Gibraltar :flag_gi: Greenland :flag_gl: Gambia :flag_gm: Guinea :flag_gn: Guadeloupe :flag_gp: Equatorial Guinea :flag_gq: Greece :flag_gr: South Georgia & South Sandwich Islands :flag_gs: Guatemala :flag_gt: Guam :flag_gu: Guinea-Bissau :flag_gw: Guyana :flag_gy: Hong Kong SAR China :flag_hk: Heard & McDonald Islands :flag_hm: Honduras :flag_hn: Croatia :flag_hr: Haiti :flag_ht: Hungary :flag_hu: Canary Islands :flag_ic: Indonesia :flag_id: Ireland :flag_ie: Israel :flag_il: Isle of Man :flag_im: India :flag_in: British Indian Ocean Territory :flag_io: Iraq :flag_iq: Iran :flag_ir: Iceland :flag_is: Italy :flag_it: Jersey :flag_je: Jamaica :flag_jm: Jordan :flag_jo: Japan :flag_jp: Kenya :flag_ke: Kyrgyzstan :flag_kg: Cambodia :flag_kh: Kiribati :flag_ki: Comoros :flag_km: St. Kitts & Nevis :flag_kn: North Korea :flag_kp: South Korea :flag_kr: Kuwait :flag_kw: Cayman Islands :flag_ky: Kazakhstan :flag_kz: Laos :flag_la: Lebanon :flag_lb: St. Lucia :flag_lc: Liechtenstein :flag_li: Sri Lanka :flag_lk: Liberia :flag_lr: Lesotho :flag_ls: Lithuania :flag_lt: Luxembourg :flag_lu: Latvia :flag_lv: Libya :flag_ly: Morocco :flag_ma: Monaco :flag_mc: Moldova :flag_md: Montenegro :flag_me: St. Martin :flag_mf: Madagascar :flag_mg: Marshall Islands :flag_mh: Macedonia :flag_mk: Mali :flag_ml: Myanmar (Burma) :flag_mm: Mongolia :flag_mn: Macau SAR China :flag_mo: Northern Mariana Islands :flag_mp: Martinique :flag_mq: Mauritania :flag_mr: Montserrat :flag_ms: Malta :flag_mt: Mauritius :flag_mu: Maldives :flag_mv: Malawi :flag_mw: Mexico :flag_mx: Malaysia :flag_my: Mozambique :flag_mz: Namibia :flag_na: New Caledonia :flag_nc: Niger :flag_ne: Norfolk Island :flag_nf: Nigeria :flag_ng: Nicaragua :flag_ni: Netherlands :flag_nl: Norway :flag_no: Nepal :flag_np: Nauru :flag_nr: Niue :flag_nu: New Zealand :flag_nz: Oman :flag_om: Panama :flag_pa: Peru :flag_pe: French Polynesia :flag_pf: Papua New Guinea :flag_pg: Philippines :flag_ph: Pakistan :flag_pk: Poland :flag_pl: St. Pierre & Miquelon :flag_pm: Pitcairn Islands :flag_pn: Puerto Rico :flag_pr: Palestinian Territories :flag_ps: Portugal :flag_pt: Palau :flag_pw: Paraguay :flag_py: Qatar :flag_qa: R\\u00e9union :flag_re: Romania :flag_ro: Serbia :flag_rs: Russia :flag_ru: Rwanda :flag_rw: Saudi Arabia :flag_sa: Solomon Islands :flag_sb: Seychelles :flag_sc: Sudan :flag_sd: Sweden :flag_se: Singapore :flag_sg: St. Helena :flag_sh: Slovenia :flag_si: Svalbard & Jan Mayen :flag_sj: Slovakia :flag_sk: Sierra Leone :flag_sl: San Marino :flag_sm: Senegal :flag_sn: Somalia :flag_so: Suriname :flag_sr: South Sudan :flag_ss: S\\u00e3o Tom\\u00e9 & Pr\\u00edncipe :flag_st: El Salvador :flag_sv: Sint Maarten :flag_sx: Syria :flag_sy: Swaziland :flag_sz: Tristan da Cunha :flag_ta: Turks & Caicos Islands :flag_tc: Chad :flag_td: French Southern Territories :flag_tf: Togo :flag_tg: Thailand :flag_th: Tajikistan :flag_tj: Tokelau :flag_tk: Timor-Leste :flag_tl: Turkmenistan :flag_tm: Tunisia :flag_tn: Tonga :flag_to: Turkey :flag_tr: Trinidad & Tobago :flag_tt: Tuvalu :flag_tv: Taiwan :flag_tw: Tanzania :flag_tz: Ukraine :flag_ua: Uganda :flag_ug: U.S. Outlying Islands :flag_um: United States :flag_us: Uruguay :flag_uy: Uzbekistan :flag_uz: Vatican City :flag_va: St. Vincent & Grenadines :flag_vc: Venezuela :flag_ve: British Virgin Islands :flag_vg: U.S. Virgin Islands :flag_vi: Vietnam :flag_vn: Vanuatu :flag_vu: Wallis & Futuna :flag_wf: white flag :flag_white: Samoa :flag_ws: Kosovo :flag_xk: Yemen :flag_ye: Mayotte :flag_yt: South Africa :flag_za: Zambia :flag_zm: Zimbabwe :flag_zw: carp streamer :flags: flashlight :flashlight: fleur-de-lis :fleur-de-lis: floppy disk :floppy_disk: flower playing cards :flower_playing_cards: flushed face :flushed: flying saucer :flying_saucer: fog :fog: foggy :foggy: american football :football: footprints :footprints: fork and knife :fork_and_knife: fork and knife with plate :fork_knife_plate: fortune cookie :fortune_cookie: fountain :fountain: keycap: 4 :four: four leaf clover :four_leaf_clover: fox face :fox: framed picture :frame_photo: FREE button :free: baguette bread :french_bread: fried shrimp :fried_shrimp: french fries :fries: frog face :frog: frowning face :frowning2: frowning face with open mouth :frowning: fuel pump :fuelpump: full moon :full_moon: full moon with face :full_moon_with_face: game die :game_die: gear :gear: gem stone :gem: Gemini :gemini: genie :genie: ghost :ghost: wrapped gift :gift: heart with ribbon :gift_heart: giraffe :giraffe: girl :girl: girl: light skin tone :girl_tone1: girl: medium-light skin tone :girl_tone2: girl: medium skin tone :girl_tone3: girl: medium-dark skin tone :girl_tone4: girl: dark skin tone :girl_tone5: globe with meridians :globe_with_meridians: gloves :gloves: goal net :goal: goat :goat: flag in hole :golf: gorilla :gorilla: grapes :grapes: green apple :green_apple: green book :green_book: green heart :green_heart: white exclamation mark :grey_exclamation: white question mark :grey_question: grimacing face :grimacing: grinning face with smiling eyes :grin: grinning face :grinning: guard :guard: guard: light skin tone :guard_tone1: guard: medium-light skin tone :guard_tone2: guard: medium skin tone :guard_tone3: guard: medium-dark skin tone :guard_tone4: guard: dark skin tone :guard_tone5: guitar :guitar: pistol :gun: hamburger :hamburger: hammer :hammer: hammer and pick :hammer_pick: hamster face :hamster: raised hand with fingers splayed :hand_splayed: raised hand with fingers splayed: light skin tone :hand_splayed_tone1: raised hand with fingers splayed: medium-light skin tone :hand_splayed_tone2: raised hand with fingers splayed: medium skin tone :hand_splayed_tone3: raised hand with fingers splayed: medium-dark skin tone :hand_splayed_tone4: raised hand with fingers splayed: dark skin tone :hand_splayed_tone5: handbag :handbag: handshake :handshake: keycap: # :hash: front-facing baby chick :hatched_chick: hatching chick :hatching_chick: face with head-bandage :head_bandage: headphone :headphones: hear-no-evil monkey :hear_no_evil: red heart :heart: heart decoration :heart_decoration: heavy heart exclamation :heart_exclamation: smiling face with heart-eyes :heart_eyes: smiling cat face with heart-eyes :heart_eyes_cat: beating heart :heartbeat: growing heart :heartpulse: heart suit :hearts: heavy check mark :heavy_check_mark: heavy division sign :heavy_division_sign: heavy dollar sign :heavy_dollar_sign: heavy minus sign :heavy_minus_sign: heavy multiplication x :heavy_multiplication_x: heavy plus sign :heavy_plus_sign: hedgehog :hedgehog: helicopter :helicopter: rescue worker\\u2019s helmet :helmet_with_cross: herb :herb: hibiscus :hibiscus: bright button :high_brightness: high-heeled shoe :high_heel: ice hockey :hockey: hole :hole: houses :homes: honey pot :honey_pot: horse face :horse: horse racing :horse_racing: horse racing: light skin tone :horse_racing_tone1: horse racing: medium-light skin tone :horse_racing_tone2: horse racing: medium skin tone :horse_racing_tone3: horse racing: medium-dark skin tone :horse_racing_tone4: horse racing: dark skin tone :horse_racing_tone5: hospital :hospital: hot pepper :hot_pepper: hot dog :hotdog: hotel :hotel: hot springs :hotsprings: hourglass :hourglass: hourglass with flowing sand :hourglass_flowing_sand: house :house: derelict house :house_abandoned: house with garden :house_with_garden: hugging face :hugging: hushed face :hushed: ice cream :ice_cream: ice skate :ice_skate: soft ice cream :icecream: ID button :id: Japanese \\u201cbargain\\u201d button :ideograph_advantage: angry face with horns :imp: inbox tray :inbox_tray: incoming envelope :incoming_envelope: information :information_source: smiling face with halo :innocent: exclamation question mark :interrobang: mobile phone :iphone: desert island :island: red paper lantern :izakaya_lantern: jack-o-lantern :jack_o_lantern: map of Japan :japan: Japanese castle :japanese_castle: goblin :japanese_goblin: ogre :japanese_ogre: jeans :jeans: face with tears of joy :joy: cat face with tears of joy :joy_cat: joystick :joystick: kaaba :kaaba: old key :key2: key :key: keyboard :keyboard: keycap 10 :keycap_ten: kimono :kimono: kiss mark :kiss: kiss: man, man :kiss_mm: kiss: woman, man :kiss_woman_man: kiss: woman, woman :kiss_ww: kissing face :kissing: kissing cat face with closed eyes :kissing_cat: kissing face with closed eyes :kissing_closed_eyes: face blowing a kiss :kissing_heart: kissing face with smiling eyes :kissing_smiling_eyes: kiwi fruit :kiwi: kitchen knife :knife: koala :koala: Japanese \\u201chere\\u201d button :koko: label :label: large blue diamond :large_blue_diamond: large orange diamond :large_orange_diamond: last quarter moon :last_quarter_moon: last quarter moon with face :last_quarter_moon_with_face: smiling face with open mouth & closed eyes :laughing: leaf fluttering in wind :leaves: ledger :ledger: left-facing fist :left_facing_fist: left-facing fist: light skin tone :left_facing_fist_tone1: left-facing fist: medium-light skin tone :left_facing_fist_tone2: left-facing fist: medium skin tone :left_facing_fist_tone3: left-facing fist: medium-dark skin tone :left_facing_fist_tone4: left-facing fist: dark skin tone :left_facing_fist_tone5: left luggage :left_luggage: left-right arrow :left_right_arrow: right arrow curving left :leftwards_arrow_with_hook: lemon :lemon: Leo :leo: leopard :leopard: level slider :level_slider: man in business suit levitating :levitate: Libra :libra: light rail :light_rail: link :link: lion face :lion_face: mouth :lips: lipstick :lipstick: lizard :lizard: locked :lock: locked with pen :lock_with_ink_pen: lollipop :lollipop: double curly loop :loop: speaker high volume :loud_sound: loudspeaker :loudspeaker: love hotel :love_hotel: love letter :love_letter: love-you gesture :love_you_gesture: love-you gesture: light skin tone :love_you_gesture_tone1: love-you gesture: medium-light skin tone :love_you_gesture_tone2: love-you gesture: medium skin tone :love_you_gesture_tone3: love-you gesture: medium-dark skin tone :love_you_gesture_tone4: love-you gesture: dark skin tone :love_you_gesture_tone5: dim button :low_brightness: lying face :lying_face: circled M :m: left-pointing magnifying glass :mag: right-pointing magnifying glass :mag_right: mage :mage: mage: light skin tone :mage_tone1: mage: medium-light skin tone :mage_tone2: mage: medium skin tone :mage_tone3: mage: medium-dark skin tone :mage_tone4: mage: dark skin tone :mage_tone5: mahjong red dragon :mahjong: closed mailbox with raised flag :mailbox: closed mailbox with lowered flag :mailbox_closed: open mailbox with raised flag :mailbox_with_mail: open mailbox with lowered flag :mailbox_with_no_mail: male sign :male_sign: man :man: man artist :man_artist: man artist: light skin tone :man_artist_tone1: man artist: medium-light skin tone :man_artist_tone2: man artist: medium skin tone :man_artist_tone3: man artist: medium-dark skin tone :man_artist_tone4: man artist: dark skin tone :man_artist_tone5: man astronaut :man_astronaut: man astronaut: light skin tone :man_astronaut_tone1: man astronaut: medium-light skin tone :man_astronaut_tone2: man astronaut: medium skin tone :man_astronaut_tone3: man astronaut: medium-dark skin tone :man_astronaut_tone4: man astronaut: dark skin tone :man_astronaut_tone5: man biking :man_biking: man biking: light skin tone :man_biking_tone1: man biking: medium-light skin tone :man_biking_tone2: man biking: medium skin tone :man_biking_tone3: man biking: medium-dark skin tone :man_biking_tone4: man biking: dark skin tone :man_biking_tone5: man bouncing ball :man_bouncing_ball: man bouncing ball: light skin tone :man_bouncing_ball_tone1: man bouncing ball: medium-light skin tone :man_bouncing_ball_tone2: man bouncing ball: medium skin tone :man_bouncing_ball_tone3: man bouncing ball: medium-dark skin tone :man_bouncing_ball_tone4: man bouncing ball: dark skin tone :man_bouncing_ball_tone5: man bowing :man_bowing: man bowing: light skin tone :man_bowing_tone1: man bowing: medium-light skin tone :man_bowing_tone2: man bowing: medium skin tone :man_bowing_tone3: man bowing: medium-dark skin tone :man_bowing_tone4: man bowing: dark skin tone :man_bowing_tone5: man cartwheeling :man_cartwheeling: man cartwheeling: light skin tone :man_cartwheeling_tone1: man cartwheeling: medium-light skin tone :man_cartwheeling_tone2: man cartwheeling: medium skin tone :man_cartwheeling_tone3: man cartwheeling: medium-dark skin tone :man_cartwheeling_tone4: man cartwheeling: dark skin tone :man_cartwheeling_tone5: man climbing :man_climbing: man climbing: light skin tone :man_climbing_tone1: man climbing: medium-light skin tone :man_climbing_tone2: man climbing: medium skin tone :man_climbing_tone3: man climbing: medium-dark skin tone :man_climbing_tone4: man climbing: dark skin tone :man_climbing_tone5: man construction worker :man_construction_worker: man construction worker: light skin tone :man_construction_worker_tone1: man construction worker: medium-light skin tone :man_construction_worker_tone2: man construction worker: medium skin tone :man_construction_worker_tone3: man construction worker: medium-dark skin tone :man_construction_worker_tone4: man construction worker: dark skin tone :man_construction_worker_tone5: man cook :man_cook: man cook: light skin tone :man_cook_tone1: man cook: medium-light skin tone :man_cook_tone2: man cook: medium skin tone :man_cook_tone3: man cook: medium-dark skin tone :man_cook_tone4: man cook: dark skin tone :man_cook_tone5: man dancing :man_dancing: man dancing: light skin tone :man_dancing_tone1: man dancing: medium-light skin tone :man_dancing_tone2: man dancing: medium skin tone :man_dancing_tone3: man dancing: medium-dark skin tone :man_dancing_tone4: man dancing: dark skin tone :man_dancing_tone5: man detective :man_detective: man detective: light skin tone :man_detective_tone1: man detective: medium-light skin tone :man_detective_tone2: man detective: medium skin tone :man_detective_tone3: man detective: medium-dark skin tone :man_detective_tone4: man detective: dark skin tone :man_detective_tone5: man elf :man_elf: man elf: light skin tone :man_elf_tone1: man elf: medium-light skin tone :man_elf_tone2: man elf: medium skin tone :man_elf_tone3: man elf: medium-dark skin tone :man_elf_tone4: man elf: dark skin tone :man_elf_tone5: man facepalming :man_facepalming: man facepalming: light skin tone :man_facepalming_tone1: man facepalming: medium-light skin tone :man_facepalming_tone2: man facepalming: medium skin tone :man_facepalming_tone3: man facepalming: medium-dark skin tone :man_facepalming_tone4: man facepalming: dark skin tone :man_facepalming_tone5: man factory worker :man_factory_worker: man factory worker: light skin tone :man_factory_worker_tone1: man factory worker: medium-light skin tone :man_factory_worker_tone2: man factory worker: medium skin tone :man_factory_worker_tone3: man factory worker: medium-dark skin tone :man_factory_worker_tone4: man factory worker: dark skin tone :man_factory_worker_tone5: man fairy :man_fairy: man fairy: light skin tone :man_fairy_tone1: man fairy: medium-light skin tone :man_fairy_tone2: man fairy: medium skin tone :man_fairy_tone3: man fairy: medium-dark skin tone :man_fairy_tone4: man fairy: dark skin tone :man_fairy_tone5: man farmer :man_farmer: man farmer: light skin tone :man_farmer_tone1: man farmer: medium-light skin tone :man_farmer_tone2: man farmer: medium skin tone :man_farmer_tone3: man farmer: medium-dark skin tone :man_farmer_tone4: man farmer: dark skin tone :man_farmer_tone5: man firefighter :man_firefighter: man firefighter: light skin tone :man_firefighter_tone1: man firefighter: medium-light skin tone :man_firefighter_tone2: man firefighter: medium skin tone :man_firefighter_tone3: man firefighter: medium-dark skin tone :man_firefighter_tone4: man firefighter: dark skin tone :man_firefighter_tone5: man frowning :man_frowning: man frowning: light skin tone :man_frowning_tone1: man frowning: medium-light skin tone :man_frowning_tone2: man frowning: medium skin tone :man_frowning_tone3: man frowning: medium-dark skin tone :man_frowning_tone4: man frowning: dark skin tone :man_frowning_tone5: man genie :man_genie: man gesturing NO :man_gesturing_no: man gesturing NO: light skin tone :man_gesturing_no_tone1: man gesturing NO: medium-light skin tone :man_gesturing_no_tone2: man gesturing NO: medium skin tone :man_gesturing_no_tone3: man gesturing NO: medium-dark skin tone :man_gesturing_no_tone4: man gesturing NO: dark skin tone :man_gesturing_no_tone5: man gesturing OK :man_gesturing_ok: man gesturing OK: light skin tone :man_gesturing_ok_tone1: man gesturing OK: medium-light skin tone :man_gesturing_ok_tone2: man gesturing OK: medium skin tone :man_gesturing_ok_tone3: man gesturing OK: medium-dark skin tone :man_gesturing_ok_tone4: man gesturing OK: dark skin tone :man_gesturing_ok_tone5: man getting massage :man_getting_face_massage: man getting massage: light skin tone :man_getting_face_massage_tone1: man getting massage: medium-light skin tone :man_getting_face_massage_tone2: man getting massage: medium skin tone :man_getting_face_massage_tone3: man getting massage: medium-dark skin tone :man_getting_face_massage_tone4: man getting massage: dark skin tone :man_getting_face_massage_tone5: man getting haircut :man_getting_haircut: man getting haircut: light skin tone :man_getting_haircut_tone1: man getting haircut: medium-light skin tone :man_getting_haircut_tone2: man getting haircut: medium skin tone :man_getting_haircut_tone3: man getting haircut: medium-dark skin tone :man_getting_haircut_tone4: man getting haircut: dark skin tone :man_getting_haircut_tone5: man golfing :man_golfing: man golfing: light skin tone :man_golfing_tone1: man golfing: medium-light skin tone :man_golfing_tone2: man golfing: medium skin tone :man_golfing_tone3: man golfing: medium-dark skin tone :man_golfing_tone4: man golfing: dark skin tone :man_golfing_tone5: man guard :man_guard: man guard: light skin tone :man_guard_tone1: man guard: medium-light skin tone :man_guard_tone2: man guard: medium skin tone :man_guard_tone3: man guard: medium-dark skin tone :man_guard_tone4: man guard: dark skin tone :man_guard_tone5: man health worker :man_health_worker: man health worker: light skin tone :man_health_worker_tone1: man health worker: medium-light skin tone :man_health_worker_tone2: man health worker: medium skin tone :man_health_worker_tone3: man health worker: medium-dark skin tone :man_health_worker_tone4: man health worker: dark skin tone :man_health_worker_tone5: man in business suit levitating: light skin tone :man_in_business_suit_levitating_tone1: man in business suit levitating: medium-light skin tone :man_in_business_suit_levitating_tone2: man in business suit levitating: medium skin tone :man_in_business_suit_levitating_tone3: man in business suit levitating: medium-dark skin tone :man_in_business_suit_levitating_tone4: man in business suit levitating: dark skin tone :man_in_business_suit_levitating_tone5: man in lotus position :man_in_lotus_position: man in lotus position: light skin tone :man_in_lotus_position_tone1: man in lotus position: medium-light skin tone :man_in_lotus_position_tone2: man in lotus position: medium skin tone :man_in_lotus_position_tone3: man in lotus position: medium-dark skin tone :man_in_lotus_position_tone4: man in lotus position: dark skin tone :man_in_lotus_position_tone5: man in steamy room :man_in_steamy_room: man in steamy room: light skin tone :man_in_steamy_room_tone1: man in steamy room: medium-light skin tone :man_in_steamy_room_tone2: man in steamy room: medium skin tone :man_in_steamy_room_tone3: man in steamy room: medium-dark skin tone :man_in_steamy_room_tone4: man in steamy room: dark skin tone :man_in_steamy_room_tone5: man in tuxedo :man_in_tuxedo: man in tuxedo: light skin tone :man_in_tuxedo_tone1: man in tuxedo: medium-light skin tone :man_in_tuxedo_tone2: man in tuxedo: medium skin tone :man_in_tuxedo_tone3: man in tuxedo: medium-dark skin tone :man_in_tuxedo_tone4: man in tuxedo: dark skin tone :man_in_tuxedo_tone5: man judge :man_judge: man judge: light skin tone :man_judge_tone1: man judge: medium-light skin tone :man_judge_tone2: man judge: medium skin tone :man_judge_tone3: man judge: medium-dark skin tone :man_judge_tone4: man judge: dark skin tone :man_judge_tone5: man juggling :man_juggling: man juggling: light skin tone :man_juggling_tone1: man juggling: medium-light skin tone :man_juggling_tone2: man juggling: medium skin tone :man_juggling_tone3: man juggling: medium-dark skin tone :man_juggling_tone4: man juggling: dark skin tone :man_juggling_tone5: man lifting weights :man_lifting_weights: man lifting weights: light skin tone :man_lifting_weights_tone1: man lifting weights: medium-light skin tone :man_lifting_weights_tone2: man lifting weights: medium skin tone :man_lifting_weights_tone3: man lifting weights: medium-dark skin tone :man_lifting_weights_tone4: man lifting weights: dark skin tone :man_lifting_weights_tone5: man mage :man_mage: man mage: light skin tone :man_mage_tone1: man mage: medium-light skin tone :man_mage_tone2: man mage: medium skin tone :man_mage_tone3: man mage: medium-dark skin tone :man_mage_tone4: man mage: dark skin tone :man_mage_tone5: man mechanic :man_mechanic: man mechanic: light skin tone :man_mechanic_tone1: man mechanic: medium-light skin tone :man_mechanic_tone2: man mechanic: medium skin tone :man_mechanic_tone3: man mechanic: medium-dark skin tone :man_mechanic_tone4: man mechanic: dark skin tone :man_mechanic_tone5: man mountain biking :man_mountain_biking: man mountain biking: light skin tone :man_mountain_biking_tone1: man mountain biking: medium-light skin tone :man_mountain_biking_tone2: man mountain biking: medium skin tone :man_mountain_biking_tone3: man mountain biking: medium-dark skin tone :man_mountain_biking_tone4: man mountain biking: dark skin tone :man_mountain_biking_tone5: man office worker :man_office_worker: man office worker: light skin tone :man_office_worker_tone1: man office worker: medium-light skin tone :man_office_worker_tone2: man office worker: medium skin tone :man_office_worker_tone3: man office worker: medium-dark skin tone :man_office_worker_tone4: man office worker: dark skin tone :man_office_worker_tone5: man pilot :man_pilot: man pilot: light skin tone :man_pilot_tone1: man pilot: medium-light skin tone :man_pilot_tone2: man pilot: medium skin tone :man_pilot_tone3: man pilot: medium-dark skin tone :man_pilot_tone4: man pilot: dark skin tone :man_pilot_tone5: man playing handball :man_playing_handball: man playing handball: light skin tone :man_playing_handball_tone1: man playing handball: medium-light skin tone :man_playing_handball_tone2: man playing handball: medium skin tone :man_playing_handball_tone3: man playing handball: medium-dark skin tone :man_playing_handball_tone4: man playing handball: dark skin tone :man_playing_handball_tone5: man playing water polo :man_playing_water_polo: man playing water polo: light skin tone :man_playing_water_polo_tone1: man playing water polo: medium-light skin tone :man_playing_water_polo_tone2: man playing water polo: medium skin tone :man_playing_water_polo_tone3: man playing water polo: medium-dark skin tone :man_playing_water_polo_tone4: man playing water polo: dark skin tone :man_playing_water_polo_tone5: man police officer :man_police_officer: man police officer: light skin tone :man_police_officer_tone1: man police officer: medium-light skin tone :man_police_officer_tone2: man police officer: medium skin tone :man_police_officer_tone3: man police officer: medium-dark skin tone :man_police_officer_tone4: man police officer: dark skin tone :man_police_officer_tone5: man pouting :man_pouting: man pouting: light skin tone :man_pouting_tone1: man pouting: medium-light skin tone :man_pouting_tone2: man pouting: medium skin tone :man_pouting_tone3: man pouting: medium-dark skin tone :man_pouting_tone4: man pouting: dark skin tone :man_pouting_tone5: man raising hand :man_raising_hand: man raising hand: light skin tone :man_raising_hand_tone1: man raising hand: medium-light skin tone :man_raising_hand_tone2: man raising hand: medium skin tone :man_raising_hand_tone3: man raising hand: medium-dark skin tone :man_raising_hand_tone4: man raising hand: dark skin tone :man_raising_hand_tone5: man rowing boat :man_rowing_boat: man rowing boat: light skin tone :man_rowing_boat_tone1: man rowing boat: medium-light skin tone :man_rowing_boat_tone2: man rowing boat: medium skin tone :man_rowing_boat_tone3: man rowing boat: medium-dark skin tone :man_rowing_boat_tone4: man rowing boat: dark skin tone :man_rowing_boat_tone5: man running :man_running: man running: light skin tone :man_running_tone1: man running: medium-light skin tone :man_running_tone2: man running: medium skin tone :man_running_tone3: man running: medium-dark skin tone :man_running_tone4: man running: dark skin tone :man_running_tone5: man scientist :man_scientist: man scientist: light skin tone :man_scientist_tone1: man scientist: medium-light skin tone :man_scientist_tone2: man scientist: medium skin tone :man_scientist_tone3: man scientist: medium-dark skin tone :man_scientist_tone4: man scientist: dark skin tone :man_scientist_tone5: man shrugging :man_shrugging: man shrugging: light skin tone :man_shrugging_tone1: man shrugging: medium-light skin tone :man_shrugging_tone2: man shrugging: medium skin tone :man_shrugging_tone3: man shrugging: medium-dark skin tone :man_shrugging_tone4: man shrugging: dark skin tone :man_shrugging_tone5: man singer :man_singer: man singer: light skin tone :man_singer_tone1: man singer: medium-light skin tone :man_singer_tone2: man singer: medium skin tone :man_singer_tone3: man singer: medium-dark skin tone :man_singer_tone4: man singer: dark skin tone :man_singer_tone5: man student :man_student: man student: light skin tone :man_student_tone1: man student: medium-light skin tone :man_student_tone2: man student: medium skin tone :man_student_tone3: man student: medium-dark skin tone :man_student_tone4: man student: dark skin tone :man_student_tone5: man surfing :man_surfing: man surfing: light skin tone :man_surfing_tone1: man surfing: medium-light skin tone :man_surfing_tone2: man surfing: medium skin tone :man_surfing_tone3: man surfing: medium-dark skin tone :man_surfing_tone4: man surfing: dark skin tone :man_surfing_tone5: man swimming :man_swimming: man swimming: light skin tone :man_swimming_tone1: man swimming: medium-light skin tone :man_swimming_tone2: man swimming: medium skin tone :man_swimming_tone3: man swimming: medium-dark skin tone :man_swimming_tone4: man swimming: dark skin tone :man_swimming_tone5: man teacher :man_teacher: man teacher: light skin tone :man_teacher_tone1: man teacher: medium-light skin tone :man_teacher_tone2: man teacher: medium skin tone :man_teacher_tone3: man teacher: medium-dark skin tone :man_teacher_tone4: man teacher: dark skin tone :man_teacher_tone5: man technologist :man_technologist: man technologist: light skin tone :man_technologist_tone1: man technologist: medium-light skin tone :man_technologist_tone2: man technologist: medium skin tone :man_technologist_tone3: man technologist: medium-dark skin tone :man_technologist_tone4: man technologist: dark skin tone :man_technologist_tone5: man tipping hand :man_tipping_hand: man tipping hand: light skin tone :man_tipping_hand_tone1: man tipping hand: medium-light skin tone :man_tipping_hand_tone2: man tipping hand: medium skin tone :man_tipping_hand_tone3: man tipping hand: medium-dark skin tone :man_tipping_hand_tone4: man tipping hand: dark skin tone :man_tipping_hand_tone5: man: light skin tone :man_tone1: man: medium-light skin tone :man_tone2: man: medium skin tone :man_tone3: man: medium-dark skin tone :man_tone4: man: dark skin tone :man_tone5: man vampire :man_vampire: man vampire: light skin tone :man_vampire_tone1: man vampire: medium-light skin tone :man_vampire_tone2: man vampire: medium skin tone :man_vampire_tone3: man vampire: medium-dark skin tone :man_vampire_tone4: man vampire: dark skin tone :man_vampire_tone5: man walking :man_walking: man walking: light skin tone :man_walking_tone1: man walking: medium-light skin tone :man_walking_tone2: man walking: medium skin tone :man_walking_tone3: man walking: medium-dark skin tone :man_walking_tone4: man walking: dark skin tone :man_walking_tone5: man wearing turban :man_wearing_turban: man wearing turban: light skin tone :man_wearing_turban_tone1: man wearing turban: medium-light skin tone :man_wearing_turban_tone2: man wearing turban: medium skin tone :man_wearing_turban_tone3: man wearing turban: medium-dark skin tone :man_wearing_turban_tone4: man wearing turban: dark skin tone :man_wearing_turban_tone5: man with Chinese cap :man_with_chinese_cap: man with Chinese cap: light skin tone :man_with_chinese_cap_tone1: man with Chinese cap: medium-light skin tone :man_with_chinese_cap_tone2: man with Chinese cap: medium skin tone :man_with_chinese_cap_tone3: man with Chinese cap: medium-dark skin tone :man_with_chinese_cap_tone4: man with Chinese cap: dark skin tone :man_with_chinese_cap_tone5: man zombie :man_zombie: man\\u2019s shoe :mans_shoe: world map :map: maple leaf :maple_leaf: martial arts uniform :martial_arts_uniform: face with medical mask :mask: meat on bone :meat_on_bone: sports medal :medal: medical symbol :medical_symbol: megaphone :mega: melon :melon: men with bunny ears partying :men_with_bunny_ears_partying: men wrestling :men_wrestling: menorah :menorah: men\\u2019s room :mens: mermaid :mermaid: mermaid: light skin tone :mermaid_tone1: mermaid: medium-light skin tone :mermaid_tone2: mermaid: medium skin tone :mermaid_tone3: mermaid: medium-dark skin tone :mermaid_tone4: mermaid: dark skin tone :mermaid_tone5: merman :merman: merman: light skin tone :merman_tone1: merman: medium-light skin tone :merman_tone2: merman: medium skin tone :merman_tone3: merman: medium-dark skin tone :merman_tone4: merman: dark skin tone :merman_tone5: merperson :merperson: merperson: light skin tone :merperson_tone1: merperson: medium-light skin tone :merperson_tone2: merperson: medium skin tone :merperson_tone3: merperson: medium-dark skin tone :merperson_tone4: merperson: dark skin tone :merperson_tone5: sign of the horns :metal: sign of the horns: light skin tone :metal_tone1: sign of the horns: medium-light skin tone :metal_tone2: sign of the horns: medium skin tone :metal_tone3: sign of the horns: medium-dark skin tone :metal_tone4: sign of the horns: dark skin tone :metal_tone5: metro :metro: studio microphone :microphone2: microphone :microphone: microscope :microscope: middle finger :middle_finger: middle finger: light skin tone :middle_finger_tone1: middle finger: medium-light skin tone :middle_finger_tone2: middle finger: medium skin tone :middle_finger_tone3: middle finger: medium-dark skin tone :middle_finger_tone4: middle finger: dark skin tone :middle_finger_tone5: military medal :military_medal: glass of milk :milk: milky way :milky_way: minibus :minibus: computer disk :minidisc: mobile phone off :mobile_phone_off: money-mouth face :money_mouth: money with wings :money_with_wings: money bag :moneybag: monkey :monkey: monkey face :monkey_face: monorail :monorail: graduation cap :mortar_board: mosque :mosque: motor scooter :motor_scooter: motor boat :motorboat: motorcycle :motorcycle: motorway :motorway: mount fuji :mount_fuji: mountain :mountain: mountain cableway :mountain_cableway: mountain railway :mountain_railway: snow-capped mountain :mountain_snow: mouse :mouse2: mouse face :mouse: computer mouse :mouse_three_button: movie camera :movie_camera: moai :moyai: Mrs. Claus :mrs_claus: Mrs. Claus: light skin tone :mrs_claus_tone1: Mrs. Claus: medium-light skin tone :mrs_claus_tone2: Mrs. Claus: medium skin tone :mrs_claus_tone3: Mrs. Claus: medium-dark skin tone :mrs_claus_tone4: Mrs. Claus: dark skin tone :mrs_claus_tone5: flexed biceps :muscle: flexed biceps: light skin tone :muscle_tone1: flexed biceps: medium-light skin tone :muscle_tone2: flexed biceps: medium skin tone :muscle_tone3: flexed biceps: medium-dark skin tone :muscle_tone4: flexed biceps: dark skin tone :muscle_tone5: mushroom :mushroom: musical keyboard :musical_keyboard: musical note :musical_note: musical score :musical_score: muted speaker :mute: nail polish :nail_care: nail polish: light skin tone :nail_care_tone1: nail polish: medium-light skin tone :nail_care_tone2: nail polish: medium skin tone :nail_care_tone3: nail polish: medium-dark skin tone :nail_care_tone4: nail polish: dark skin tone :nail_care_tone5: name badge :name_badge: nauseated face :nauseated_face: necktie :necktie: cross mark button :negative_squared_cross_mark: nerd face :nerd: neutral face :neutral_face: NEW button :new: new moon :new_moon: new moon face :new_moon_with_face: rolled-up newspaper :newspaper2: newspaper :newspaper: NG button :ng: night with stars :night_with_stars: keycap: 9 :nine: bell with slash :no_bell: no bicycles :no_bicycles: no entry :no_entry: prohibited :no_entry_sign: no mobile phones :no_mobile_phones: face without mouth :no_mouth: no pedestrians :no_pedestrians: no smoking :no_smoking: non-potable water :non-potable_water: nose :nose: nose: light skin tone :nose_tone1: nose: medium-light skin tone :nose_tone2: nose: medium skin tone :nose_tone3: nose: medium-dark skin tone :nose_tone4: nose: dark skin tone :nose_tone5: notebook :notebook: notebook with decorative cover :notebook_with_decorative_cover: spiral notepad :notepad_spiral: musical notes :notes: nut and bolt :nut_and_bolt: O button (blood type) :o2: heavy large circle :o: water wave :ocean: stop sign :octagonal_sign: octopus :octopus: oden :oden: office building :office: oil drum :oil: OK button :ok: OK hand :ok_hand: OK hand: light skin tone :ok_hand_tone1: OK hand: medium-light skin tone :ok_hand_tone2: OK hand: medium skin tone :ok_hand_tone3: OK hand: medium-dark skin tone :ok_hand_tone4: OK hand: dark skin tone :ok_hand_tone5: older adult :older_adult: older adult: light skin tone :older_adult_tone1: older adult: medium-light skin tone :older_adult_tone2: older adult: medium skin tone :older_adult_tone3: older adult: medium-dark skin tone :older_adult_tone4: older adult: dark skin tone :older_adult_tone5: old man :older_man: old man: light skin tone :older_man_tone1: old man: medium-light skin tone :older_man_tone2: old man: medium skin tone :older_man_tone3: old man: medium-dark skin tone :older_man_tone4: old man: dark skin tone :older_man_tone5: old woman :older_woman: old woman: light skin tone :older_woman_tone1: old woman: medium-light skin tone :older_woman_tone2: old woman: medium skin tone :older_woman_tone3: old woman: medium-dark skin tone :older_woman_tone4: old woman: dark skin tone :older_woman_tone5: om :om_symbol: ON! arrow :on: oncoming automobile :oncoming_automobile: oncoming bus :oncoming_bus: oncoming police car :oncoming_police_car: oncoming taxi :oncoming_taxi: keycap: 1 :one: open file folder :open_file_folder: open hands :open_hands: open hands: light skin tone :open_hands_tone1: open hands: medium-light skin tone :open_hands_tone2: open hands: medium skin tone :open_hands_tone3: open hands: medium-dark skin tone :open_hands_tone4: open hands: dark skin tone :open_hands_tone5: face with open mouth :open_mouth: Ophiuchus :ophiuchus: orange book :orange_book: orange heart :orange_heart: orthodox cross :orthodox_cross: outbox tray :outbox_tray: owl :owl: ox :ox: package :package: page facing up :page_facing_up: page with curl :page_with_curl: pager :pager: paintbrush :paintbrush: palm tree :palm_tree: palms up together :palms_up_together: palms up together: light skin tone :palms_up_together_tone1: palms up together: medium-light skin tone :palms_up_together_tone2: palms up together: medium skin tone :palms_up_together_tone3: palms up together: medium-dark skin tone :palms_up_together_tone4: palms up together: dark skin tone :palms_up_together_tone5: pancakes :pancakes: panda face :panda_face: paperclip :paperclip: linked paperclips :paperclips: national park :park: P button :parking: part alternation mark :part_alternation_mark: sun behind cloud :partly_sunny: passport control :passport_control: pause button :pause_button: peace symbol :peace: peach :peach: peanuts :peanuts: pear :pear: pen :pen_ballpoint: fountain pen :pen_fountain: pencil :pencil2: memo :pencil: penguin :penguin: pensive face :pensive: people with bunny ears partying :people_with_bunny_ears_partying: people wrestling :people_wrestling: performing arts :performing_arts: persevering face :persevere: person biking :person_biking: person biking: light skin tone :person_biking_tone1: person biking: medium-light skin tone :person_biking_tone2: person biking: medium skin tone :person_biking_tone3: person biking: medium-dark skin tone :person_biking_tone4: person biking: dark skin tone :person_biking_tone5: person bouncing ball :person_bouncing_ball: person bouncing ball: light skin tone :person_bouncing_ball_tone1: person bouncing ball: medium-light skin tone :person_bouncing_ball_tone2: person bouncing ball: medium skin tone :person_bouncing_ball_tone3: person bouncing ball: medium-dark skin tone :person_bouncing_ball_tone4: person bouncing ball: dark skin tone :person_bouncing_ball_tone5: person bowing :person_bowing: person bowing: light skin tone :person_bowing_tone1: person bowing: medium-light skin tone :person_bowing_tone2: person bowing: medium skin tone :person_bowing_tone3: person bowing: medium-dark skin tone :person_bowing_tone4: person bowing: dark skin tone :person_bowing_tone5: person climbing :person_climbing: person climbing: light skin tone :person_climbing_tone1: person climbing: medium-light skin tone :person_climbing_tone2: person climbing: medium skin tone :person_climbing_tone3: person climbing: medium-dark skin tone :person_climbing_tone4: person climbing: dark skin tone :person_climbing_tone5: person cartwheeling :person_doing_cartwheel: person cartwheeling: light skin tone :person_doing_cartwheel_tone1: person cartwheeling: medium-light skin tone :person_doing_cartwheel_tone2: person cartwheeling: medium skin tone :person_doing_cartwheel_tone3: person cartwheeling: medium-dark skin tone :person_doing_cartwheel_tone4: person cartwheeling: dark skin tone :person_doing_cartwheel_tone5: person facepalming :person_facepalming: person facepalming: light skin tone :person_facepalming_tone1: person facepalming: medium-light skin tone :person_facepalming_tone2: person facepalming: medium skin tone :person_facepalming_tone3: person facepalming: medium-dark skin tone :person_facepalming_tone4: person facepalming: dark skin tone :person_facepalming_tone5: person fencing :person_fencing: person frowning :person_frowning: person frowning: light skin tone :person_frowning_tone1: person frowning: medium-light skin tone :person_frowning_tone2: person frowning: medium skin tone :person_frowning_tone3: person frowning: medium-dark skin tone :person_frowning_tone4: person frowning: dark skin tone :person_frowning_tone5: person gesturing NO :person_gesturing_no: person gesturing NO: light skin tone :person_gesturing_no_tone1: person gesturing NO: medium-light skin tone :person_gesturing_no_tone2: person gesturing NO: medium skin tone :person_gesturing_no_tone3: person gesturing NO: medium-dark skin tone :person_gesturing_no_tone4: person gesturing NO: dark skin tone :person_gesturing_no_tone5: person gesturing OK :person_gesturing_ok: person gesturing OK: light skin tone :person_gesturing_ok_tone1: person gesturing OK: medium-light skin tone :person_gesturing_ok_tone2: person gesturing OK: medium skin tone :person_gesturing_ok_tone3: person gesturing OK: medium-dark skin tone :person_gesturing_ok_tone4: person gesturing OK: dark skin tone :person_gesturing_ok_tone5: person getting haircut :person_getting_haircut: person getting haircut: light skin tone :person_getting_haircut_tone1: person getting haircut: medium-light skin tone :person_getting_haircut_tone2: person getting haircut: medium skin tone :person_getting_haircut_tone3: person getting haircut: medium-dark skin tone :person_getting_haircut_tone4: person getting haircut: dark skin tone :person_getting_haircut_tone5: person getting massage :person_getting_massage: person getting massage: light skin tone :person_getting_massage_tone1: person getting massage: medium-light skin tone :person_getting_massage_tone2: person getting massage: medium skin tone :person_getting_massage_tone3: person getting massage: medium-dark skin tone :person_getting_massage_tone4: person getting massage: dark skin tone :person_getting_massage_tone5: person golfing :person_golfing: person golfing: light skin tone :person_golfing_tone1: person golfing: medium-light skin tone :person_golfing_tone2: person golfing: medium skin tone :person_golfing_tone3: person golfing: medium-dark skin tone :person_golfing_tone4: person golfing: dark skin tone :person_golfing_tone5: person in bed: light skin tone :person_in_bed_tone1: person in bed: medium-light skin tone :person_in_bed_tone2: person in bed: medium skin tone :person_in_bed_tone3: person in bed: medium-dark skin tone :person_in_bed_tone4: person in bed: dark skin tone :person_in_bed_tone5: person in lotus position :person_in_lotus_position: person in lotus position: light skin tone :person_in_lotus_position_tone1: person in lotus position: medium-light skin tone :person_in_lotus_position_tone2: person in lotus position: medium skin tone :person_in_lotus_position_tone3: person in lotus position: medium-dark skin tone :person_in_lotus_position_tone4: person in lotus position: dark skin tone :person_in_lotus_position_tone5: person in steamy room :person_in_steamy_room: person in steamy room: light skin tone :person_in_steamy_room_tone1: person in steamy room: medium-light skin tone :person_in_steamy_room_tone2: person in steamy room: medium skin tone :person_in_steamy_room_tone3: person in steamy room: medium-dark skin tone :person_in_steamy_room_tone4: person in steamy room: dark skin tone :person_in_steamy_room_tone5: person juggling :person_juggling: person juggling: light skin tone :person_juggling_tone1: person juggling: medium-light skin tone :person_juggling_tone2: person juggling: medium skin tone :person_juggling_tone3: person juggling: medium-dark skin tone :person_juggling_tone4: person juggling: dark skin tone :person_juggling_tone5: person lifting weights :person_lifting_weights: person lifting weights: light skin tone :person_lifting_weights_tone1: person lifting weights: medium-light skin tone :person_lifting_weights_tone2: person lifting weights: medium skin tone :person_lifting_weights_tone3: person lifting weights: medium-dark skin tone :person_lifting_weights_tone4: person lifting weights: dark skin tone :person_lifting_weights_tone5: person mountain biking :person_mountain_biking: person mountain biking: light skin tone :person_mountain_biking_tone1: person mountain biking: medium-light skin tone :person_mountain_biking_tone2: person mountain biking: medium skin tone :person_mountain_biking_tone3: person mountain biking: medium-dark skin tone :person_mountain_biking_tone4: person mountain biking: dark skin tone :person_mountain_biking_tone5: person playing handball :person_playing_handball: person playing handball: light skin tone :person_playing_handball_tone1: person playing handball: medium-light skin tone :person_playing_handball_tone2: person playing handball: medium skin tone :person_playing_handball_tone3: person playing handball: medium-dark skin tone :person_playing_handball_tone4: person playing handball: dark skin tone :person_playing_handball_tone5: person playing water polo :person_playing_water_polo: person playing water polo: light skin tone :person_playing_water_polo_tone1: person playing water polo: medium-light skin tone :person_playing_water_polo_tone2: person playing water polo: medium skin tone :person_playing_water_polo_tone3: person playing water polo: medium-dark skin tone :person_playing_water_polo_tone4: person playing water polo: dark skin tone :person_playing_water_polo_tone5: person pouting :person_pouting: person pouting: light skin tone :person_pouting_tone1: person pouting: medium-light skin tone :person_pouting_tone2: person pouting: medium skin tone :person_pouting_tone3: person pouting: medium-dark skin tone :person_pouting_tone4: person pouting: dark skin tone :person_pouting_tone5: person raising hand :person_raising_hand: person raising hand: light skin tone :person_raising_hand_tone1: person raising hand: medium-light skin tone :person_raising_hand_tone2: person raising hand: medium skin tone :person_raising_hand_tone3: person raising hand: medium-dark skin tone :person_raising_hand_tone4: person raising hand: dark skin tone :person_raising_hand_tone5: person rowing boat :person_rowing_boat: person rowing boat: light skin tone :person_rowing_boat_tone1: person rowing boat: medium-light skin tone :person_rowing_boat_tone2: person rowing boat: medium skin tone :person_rowing_boat_tone3: person rowing boat: medium-dark skin tone :person_rowing_boat_tone4: person rowing boat: dark skin tone :person_rowing_boat_tone5: person running :person_running: person running: light skin tone :person_running_tone1: person running: medium-light skin tone :person_running_tone2: person running: medium skin tone :person_running_tone3: person running: medium-dark skin tone :person_running_tone4: person running: dark skin tone :person_running_tone5: person shrugging :person_shrugging: person shrugging: light skin tone :person_shrugging_tone1: person shrugging: medium-light skin tone :person_shrugging_tone2: person shrugging: medium skin tone :person_shrugging_tone3: person shrugging: medium-dark skin tone :person_shrugging_tone4: person shrugging: dark skin tone :person_shrugging_tone5: person surfing :person_surfing: person surfing: light skin tone :person_surfing_tone1: person surfing: medium-light skin tone :person_surfing_tone2: person surfing: medium skin tone :person_surfing_tone3: person surfing: medium-dark skin tone :person_surfing_tone4: person surfing: dark skin tone :person_surfing_tone5: person swimming :person_swimming: person swimming: light skin tone :person_swimming_tone1: person swimming: medium-light skin tone :person_swimming_tone2: person swimming: medium skin tone :person_swimming_tone3: person swimming: medium-dark skin tone :person_swimming_tone4: person swimming: dark skin tone :person_swimming_tone5: person tipping hand :person_tipping_hand: person tipping hand: light skin tone :person_tipping_hand_tone1: person tipping hand: medium-light skin tone :person_tipping_hand_tone2: person tipping hand: medium skin tone :person_tipping_hand_tone3: person tipping hand: medium-dark skin tone :person_tipping_hand_tone4: person tipping hand: dark skin tone :person_tipping_hand_tone5: person walking :person_walking: person walking: light skin tone :person_walking_tone1: person walking: medium-light skin tone :person_walking_tone2: person walking: medium skin tone :person_walking_tone3: person walking: medium-dark skin tone :person_walking_tone4: person walking: dark skin tone :person_walking_tone5: person wearing turban :person_wearing_turban: person wearing turban: light skin tone :person_wearing_turban_tone1: person wearing turban: medium-light skin tone :person_wearing_turban_tone2: person wearing turban: medium skin tone :person_wearing_turban_tone3: person wearing turban: medium-dark skin tone :person_wearing_turban_tone4: person wearing turban: dark skin tone :person_wearing_turban_tone5: pick :pick: pie :pie: pig :pig2: pig face :pig: pig nose :pig_nose: pill :pill: pineapple :pineapple: ping pong :ping_pong: Pisces :pisces: pizza :pizza: place of worship :place_of_worship: play or pause button :play_pause: backhand index pointing down :point_down: backhand index pointing down: light skin tone :point_down_tone1: backhand index pointing down: medium-light skin tone :point_down_tone2: backhand index pointing down: medium skin tone :point_down_tone3: backhand index pointing down: medium-dark skin tone :point_down_tone4: backhand index pointing down: dark skin tone :point_down_tone5: backhand index pointing left :point_left: backhand index pointing left: light skin tone :point_left_tone1: backhand index pointing left: medium-light skin tone :point_left_tone2: backhand index pointing left: medium skin tone :point_left_tone3: backhand index pointing left: medium-dark skin tone :point_left_tone4: backhand index pointing left: dark skin tone :point_left_tone5: backhand index pointing right :point_right: backhand index pointing right: light skin tone :point_right_tone1: backhand index pointing right: medium-light skin tone :point_right_tone2: backhand index pointing right: medium skin tone :point_right_tone3: backhand index pointing right: medium-dark skin tone :point_right_tone4: backhand index pointing right: dark skin tone :point_right_tone5: index pointing up :point_up: backhand index pointing up :point_up_2: backhand index pointing up: light skin tone :point_up_2_tone1: backhand index pointing up: medium-light skin tone :point_up_2_tone2: backhand index pointing up: medium skin tone :point_up_2_tone3: backhand index pointing up: medium-dark skin tone :point_up_2_tone4: backhand index pointing up: dark skin tone :point_up_2_tone5: index pointing up: light skin tone :point_up_tone1: index pointing up: medium-light skin tone :point_up_tone2: index pointing up: medium skin tone :point_up_tone3: index pointing up: medium-dark skin tone :point_up_tone4: index pointing up: dark skin tone :point_up_tone5: police car :police_car: police officer :police_officer: police officer: light skin tone :police_officer_tone1: police officer: medium-light skin tone :police_officer_tone2: police officer: medium skin tone :police_officer_tone3: police officer: medium-dark skin tone :police_officer_tone4: police officer: dark skin tone :police_officer_tone5: poodle :poodle: pile of poo :poop: popcorn :popcorn: Japanese post office :post_office: postal horn :postal_horn: postbox :postbox: potable water :potable_water: potato :potato: clutch bag :pouch: poultry leg :poultry_leg: pound banknote :pound: pound symbol :pound_symbol: pouting cat face :pouting_cat: folded hands :pray: folded hands: light skin tone :pray_tone1: folded hands: medium-light skin tone :pray_tone2: folded hands: medium skin tone :pray_tone3: folded hands: medium-dark skin tone :pray_tone4: folded hands: dark skin tone :pray_tone5: prayer beads :prayer_beads: pregnant woman :pregnant_woman: pregnant woman: light skin tone :pregnant_woman_tone1: pregnant woman: medium-light skin tone :pregnant_woman_tone2: pregnant woman: medium skin tone :pregnant_woman_tone3: pregnant woman: medium-dark skin tone :pregnant_woman_tone4: pregnant woman: dark skin tone :pregnant_woman_tone5: pretzel :pretzel: prince :prince: prince: light skin tone :prince_tone1: prince: medium-light skin tone :prince_tone2: prince: medium skin tone :prince_tone3: prince: medium-dark skin tone :prince_tone4: prince: dark skin tone :prince_tone5: princess :princess: princess: light skin tone :princess_tone1: princess: medium-light skin tone :princess_tone2: princess: medium skin tone :princess_tone3: princess: medium-dark skin tone :princess_tone4: princess: dark skin tone :princess_tone5: printer :printer: film projector :projector: oncoming fist :punch: oncoming fist: light skin tone :punch_tone1: oncoming fist: medium-light skin tone :punch_tone2: oncoming fist: medium skin tone :punch_tone3: oncoming fist: medium-dark skin tone :punch_tone4: oncoming fist: dark skin tone :punch_tone5: purple heart :purple_heart: purse :purse: pushpin :pushpin: litter in bin sign :put_litter_in_its_place: question mark :question: rabbit :rabbit2: rabbit face :rabbit: racing car :race_car: horse :racehorse: radio :radio: radio button :radio_button: radioactive :radioactive: pouting face :rage: railway car :railway_car: railway track :railway_track: rainbow :rainbow: rainbow flag :rainbow_flag: raised back of hand :raised_back_of_hand: raised back of hand: light skin tone :raised_back_of_hand_tone1: raised back of hand: medium-light skin tone :raised_back_of_hand_tone2: raised back of hand: medium skin tone :raised_back_of_hand_tone3: raised back of hand: medium-dark skin tone :raised_back_of_hand_tone4: raised back of hand: dark skin tone :raised_back_of_hand_tone5: raised hand :raised_hand: raised hand: light skin tone :raised_hand_tone1: raised hand: medium-light skin tone :raised_hand_tone2: raised hand: medium skin tone :raised_hand_tone3: raised hand: medium-dark skin tone :raised_hand_tone4: raised hand: dark skin tone :raised_hand_tone5: raising hands :raised_hands: raising hands: light skin tone :raised_hands_tone1: raising hands: medium-light skin tone :raised_hands_tone2: raising hands: medium skin tone :raised_hands_tone3: raising hands: medium-dark skin tone :raised_hands_tone4: raising hands: dark skin tone :raised_hands_tone5: ram :ram: steaming bowl :ramen: rat :rat: record button :record_button: recycling symbol :recycle: automobile :red_car: red circle :red_circle: regional indicator symbol letter a :regional_indicator_a: regional indicator symbol letter b :regional_indicator_b: regional indicator symbol letter c :regional_indicator_c: regional indicator symbol letter d :regional_indicator_d: regional indicator symbol letter e :regional_indicator_e: regional indicator symbol letter f :regional_indicator_f: regional indicator symbol letter g :regional_indicator_g: regional indicator symbol letter h :regional_indicator_h: regional indicator symbol letter i :regional_indicator_i: regional indicator symbol letter j :regional_indicator_j: regional indicator symbol letter k :regional_indicator_k: regional indicator symbol letter l :regional_indicator_l: regional indicator symbol letter m :regional_indicator_m: regional indicator symbol letter n :regional_indicator_n: regional indicator symbol letter o :regional_indicator_o: regional indicator symbol letter p :regional_indicator_p: regional indicator symbol letter q :regional_indicator_q: regional indicator symbol letter r :regional_indicator_r: regional indicator symbol letter s :regional_indicator_s: regional indicator symbol letter t :regional_indicator_t: regional indicator symbol letter u :regional_indicator_u: regional indicator symbol letter v :regional_indicator_v: regional indicator symbol letter w :regional_indicator_w: regional indicator symbol letter x :regional_indicator_x: regional indicator symbol letter y :regional_indicator_y: regional indicator symbol letter z :regional_indicator_z: registered :registered: smiling face :relaxed: relieved face :relieved: reminder ribbon :reminder_ribbon: repeat button :repeat: repeat single button :repeat_one: restroom :restroom: revolving hearts :revolving_hearts: fast reverse button :rewind: rhinoceros :rhino: ribbon :ribbon: cooked rice :rice: rice ball :rice_ball: rice cracker :rice_cracker: moon viewing ceremony :rice_scene: right-facing fist :right_facing_fist: right-facing fist: light skin tone :right_facing_fist_tone1: right-facing fist: medium-light skin tone :right_facing_fist_tone2: right-facing fist: medium skin tone :right_facing_fist_tone3: right-facing fist: medium-dark skin tone :right_facing_fist_tone4: right-facing fist: dark skin tone :right_facing_fist_tone5: ring :ring: robot face :robot: rocket :rocket: rolling on the floor laughing :rofl: roller coaster :roller_coaster: face with rolling eyes :rolling_eyes: rooster :rooster: rose :rose: rosette :rosette: police car light :rotating_light: round pushpin :round_pushpin: rugby football :rugby_football: running shirt :running_shirt_with_sash: Japanese \\u201cservice charge\\u201d button :sa: Sagittarius :sagittarius: sailboat :sailboat: sake :sake: green salad :salad: woman\\u2019s sandal :sandal: sandwich :sandwich: Santa Claus :santa: Santa Claus: light skin tone :santa_tone1: Santa Claus: medium-light skin tone :santa_tone2: Santa Claus: medium skin tone :santa_tone3: Santa Claus: medium-dark skin tone :santa_tone4: Santa Claus: dark skin tone :santa_tone5: satellite antenna :satellite: satellite :satellite_orbital: sauropod :sauropod: saxophone :saxophone: balance scale :scales: scarf :scarf: school :school: school backpack :school_satchel: scissors :scissors: kick scooter :scooter: scorpion :scorpion: Scorpius :scorpius: Scotland :scotland: face screaming in fear :scream: weary cat face :scream_cat: scroll :scroll: seat :seat: 2 nd place medal :second_place: Japanese \\u201csecret\\u201d button :secret: see-no-evil monkey :see_no_evil: seedling :seedling: selfie :selfie: selfie: light skin tone :selfie_tone1: selfie: medium-light skin tone :selfie_tone2: selfie: medium skin tone :selfie_tone3: selfie: medium-dark skin tone :selfie_tone4: selfie: dark skin tone :selfie_tone5: keycap: 7 :seven: shallow pan of food :shallow_pan_of_food: shamrock :shamrock: shark :shark: shaved ice :shaved_ice: ewe :sheep: spiral shell :shell: shield :shield: shinto shrine :shinto_shrine: ship :ship: t-shirt :shirt: shopping bags :shopping_bags: shopping cart :shopping_cart: shower :shower: shrimp :shrimp: shushing face :shushing_face: antenna bars :signal_strength: keycap: 6 :six: dotted six-pointed star :six_pointed_star: skis :ski: skier :skier: skull :skull: skull and crossbones :skull_crossbones: sled :sled: sleeping face :sleeping: person in bed :sleeping_accommodation: sleepy face :sleepy: slightly frowning face :slight_frown: slightly smiling face :slight_smile: slot machine :slot_machine: small blue diamond :small_blue_diamond: small orange diamond :small_orange_diamond: red triangle pointed up :small_red_triangle: red triangle pointed down :small_red_triangle_down: smiling face with open mouth & smiling eyes :smile: grinning cat face with smiling eyes :smile_cat: smiling face with open mouth :smiley: smiling cat face with open mouth :smiley_cat: smiling face with horns :smiling_imp: smirking face :smirk: cat face with wry smile :smirk_cat: cigarette :smoking: snail :snail: snake :snake: sneezing face :sneezing_face: snowboarder :snowboarder: snowboarder: light skin tone :snowboarder_tone1: snowboarder: medium-light skin tone :snowboarder_tone2: snowboarder: medium skin tone :snowboarder_tone3: snowboarder: medium-dark skin tone :snowboarder_tone4: snowboarder: dark skin tone :snowboarder_tone5: snowflake :snowflake: snowman :snowman2: snowman without snow :snowman: loudly crying face :sob: soccer ball :soccer: socks :socks: SOON arrow :soon: SOS button :sos: speaker medium volume :sound: alien monster :space_invader: spade suit :spades: spaghetti :spaghetti: sparkle :sparkle: sparkler :sparkler: sparkles :sparkles: sparkling heart :sparkling_heart: speak-no-evil monkey :speak_no_evil: speaker low volume :speaker: speaking head :speaking_head: speech balloon :speech_balloon: left speech bubble :speech_left: speedboat :speedboat: spider :spider: spider web :spider_web: spoon :spoon: squid :squid: stadium :stadium: glowing star :star2: white medium star :star: star and crescent :star_and_crescent: star of David :star_of_david: star-struck :star_struck: shooting star :stars: station :station: Statue of Liberty :statue_of_liberty: locomotive :steam_locomotive: pot of food :stew: stop button :stop_button: stopwatch :stopwatch: straight ruler :straight_ruler: strawberry :strawberry: face with stuck-out tongue :stuck_out_tongue: face with stuck-out tongue & closed eyes :stuck_out_tongue_closed_eyes: face with stuck-out tongue & winking eye :stuck_out_tongue_winking_eye: stuffed flatbread :stuffed_flatbread: sun with face :sun_with_face: sunflower :sunflower: smiling face with sunglasses :sunglasses: sun :sunny: sunrise :sunrise: sunrise over mountains :sunrise_over_mountains: sushi :sushi: suspension railway :suspension_railway: face with cold sweat :sweat: sweat droplets :sweat_drops: smiling face with open mouth & cold sweat :sweat_smile: roasted sweet potato :sweet_potato: input symbols :symbols: synagogue :synagogue: syringe :syringe: T-Rex :t_rex: taco :taco: party popper :tada: takeout box :takeout_box: tanabata tree :tanabata_tree: tangerine :tangerine: Taurus :taurus: taxi :taxi: teacup without handle :tea: telephone :telephone: telephone receiver :telephone_receiver: telescope :telescope: tennis :tennis: tent :tent: thermometer :thermometer: face with thermometer :thermometer_face: thinking face :thinking: 3 rd place medal :third_place: thought balloon :thought_balloon: keycap: 3 :three: thumbs down :thumbsdown: thumbs down: light skin tone :thumbsdown_tone1: thumbs down: medium-light skin tone :thumbsdown_tone2: thumbs down: medium skin tone :thumbsdown_tone3: thumbs down: medium-dark skin tone :thumbsdown_tone4: thumbs down: dark skin tone :thumbsdown_tone5: thumbs up :thumbsup: thumbs up: light skin tone :thumbsup_tone1: thumbs up: medium-light skin tone :thumbsup_tone2: thumbs up: medium skin tone :thumbsup_tone3: thumbs up: medium-dark skin tone :thumbsup_tone4: thumbs up: dark skin tone :thumbsup_tone5: cloud with lightning and rain :thunder_cloud_rain: ticket :ticket: admission tickets :tickets: tiger :tiger2: tiger face :tiger: timer clock :timer: tired face :tired_face: trade mark :tm: toilet :toilet: Tokyo tower :tokyo_tower: tomato :tomato: light skin tone :tone1: medium-light skin tone :tone2: medium skin tone :tone3: medium-dark skin tone :tone4: dark skin tone :tone5: tongue :tongue: hammer and wrench :tools: TOP arrow :top: top hat :tophat: next track button :track_next: last track button :track_previous: trackball :trackball: tractor :tractor: horizontal traffic light :traffic_light: train :train2: tram car :train: tram :tram: triangular flag :triangular_flag_on_post: triangular ruler :triangular_ruler: trident emblem :trident: face with steam from nose :triumph: trolleybus :trolleybus: trophy :trophy: tropical drink :tropical_drink: tropical fish :tropical_fish: delivery truck :truck: trumpet :trumpet: tulip :tulip: tumbler glass :tumbler_glass: turkey :turkey: turtle :turtle: television :tv: shuffle tracks button :twisted_rightwards_arrows: keycap: 2 :two: two hearts :two_hearts: two men holding hands :two_men_holding_hands: two women holding hands :two_women_holding_hands: Japanese \\u201cdiscount\\u201d button :u5272: Japanese \\u201cpassing grade\\u201d button :u5408: Japanese \\u201copen for business\\u201d button :u55b6: Japanese \\u201creserved\\u201d button :u6307: Japanese \\u201cmonthly amount\\u201d button :u6708: Japanese \\u201cnot free of charge\\u201d button :u6709: Japanese \\u201cno vacancy\\u201d button :u6e80: Japanese \\u201cfree of charge\\u201d button :u7121: Japanese \\u201capplication\\u201d button :u7533: Japanese \\u201cprohibited\\u201d button :u7981: Japanese \\u201cvacancy\\u201d button :u7a7a: umbrella :umbrella2: umbrella with rain drops :umbrella: unamused face :unamused: no one under eighteen :underage: unicorn face :unicorn: United Nations :united_nations: unlocked :unlock: UP! button :up: upside-down face :upside_down: funeral urn :urn: victory hand :v: victory hand: light skin tone :v_tone1: victory hand: medium-light skin tone :v_tone2: victory hand: medium skin tone :v_tone3: victory hand: medium-dark skin tone :v_tone4: victory hand: dark skin tone :v_tone5: vampire :vampire: vampire: light skin tone :vampire_tone1: vampire: medium-light skin tone :vampire_tone2: vampire: medium skin tone :vampire_tone3: vampire: medium-dark skin tone :vampire_tone4: vampire: dark skin tone :vampire_tone5: vertical traffic light :vertical_traffic_light: videocassette :vhs: vibration mode :vibration_mode: video camera :video_camera: video game :video_game: violin :violin: Virgo :virgo: volcano :volcano: volleyball :volleyball: VS button :vs: vulcan salute :vulcan: vulcan salute: light skin tone :vulcan_tone1: vulcan salute: medium-light skin tone :vulcan_tone2: vulcan salute: medium skin tone :vulcan_tone3: vulcan salute: medium-dark skin tone :vulcan_tone4: vulcan salute: dark skin tone :vulcan_tone5: Wales :wales: waning crescent moon :waning_crescent_moon: waning gibbous moon :waning_gibbous_moon: warning :warning: wastebasket :wastebasket: watch :watch: water buffalo :water_buffalo: watermelon :watermelon: waving hand :wave: waving hand: light skin tone :wave_tone1: waving hand: medium-light skin tone :wave_tone2: waving hand: medium skin tone :wave_tone3: waving hand: medium-dark skin tone :wave_tone4: waving hand: dark skin tone :wave_tone5: wavy dash :wavy_dash: waxing crescent moon :waxing_crescent_moon: waxing gibbous moon :waxing_gibbous_moon: water closet :wc: weary face :weary: wedding :wedding: whale :whale2: spouting whale :whale: wheel of dharma :wheel_of_dharma: wheelchair symbol :wheelchair: white heavy check mark :white_check_mark: white circle :white_circle: white flower :white_flower: white large square :white_large_square: white medium-small square :white_medium_small_square: white medium square :white_medium_square: white small square :white_small_square: white square button :white_square_button: sun behind large cloud :white_sun_cloud: sun behind rain cloud :white_sun_rain_cloud: sun behind small cloud :white_sun_small_cloud: wilted flower :wilted_rose: wind face :wind_blowing_face: wind chime :wind_chime: wine glass :wine_glass: winking face :wink: wolf face :wolf: woman :woman: woman artist :woman_artist: woman artist: light skin tone :woman_artist_tone1: woman artist: medium-light skin tone :woman_artist_tone2: woman artist: medium skin tone :woman_artist_tone3: woman artist: medium-dark skin tone :woman_artist_tone4: woman artist: dark skin tone :woman_artist_tone5: woman astronaut :woman_astronaut: woman astronaut: light skin tone :woman_astronaut_tone1: woman astronaut: medium-light skin tone :woman_astronaut_tone2: woman astronaut: medium skin tone :woman_astronaut_tone3: woman astronaut: medium-dark skin tone :woman_astronaut_tone4: woman astronaut: dark skin tone :woman_astronaut_tone5: woman biking :woman_biking: woman biking: light skin tone :woman_biking_tone1: woman biking: medium-light skin tone :woman_biking_tone2: woman biking: medium skin tone :woman_biking_tone3: woman biking: medium-dark skin tone :woman_biking_tone4: woman biking: dark skin tone :woman_biking_tone5: woman bouncing ball :woman_bouncing_ball: woman bouncing ball: light skin tone :woman_bouncing_ball_tone1: woman bouncing ball: medium-light skin tone :woman_bouncing_ball_tone2: woman bouncing ball: medium skin tone :woman_bouncing_ball_tone3: woman bouncing ball: medium-dark skin tone :woman_bouncing_ball_tone4: woman bouncing ball: dark skin tone :woman_bouncing_ball_tone5: woman bowing :woman_bowing: woman bowing: light skin tone :woman_bowing_tone1: woman bowing: medium-light skin tone :woman_bowing_tone2: woman bowing: medium skin tone :woman_bowing_tone3: woman bowing: medium-dark skin tone :woman_bowing_tone4: woman bowing: dark skin tone :woman_bowing_tone5: woman cartwheeling :woman_cartwheeling: woman cartwheeling: light skin tone :woman_cartwheeling_tone1: woman cartwheeling: medium-light skin tone :woman_cartwheeling_tone2: woman cartwheeling: medium skin tone :woman_cartwheeling_tone3: woman cartwheeling: medium-dark skin tone :woman_cartwheeling_tone4: woman cartwheeling: dark skin tone :woman_cartwheeling_tone5: woman climbing :woman_climbing: woman climbing: light skin tone :woman_climbing_tone1: woman climbing: medium-light skin tone :woman_climbing_tone2: woman climbing: medium skin tone :woman_climbing_tone3: woman climbing: medium-dark skin tone :woman_climbing_tone4: woman climbing: dark skin tone :woman_climbing_tone5: woman construction worker :woman_construction_worker: woman construction worker: light skin tone :woman_construction_worker_tone1: woman construction worker: medium-light skin tone :woman_construction_worker_tone2: woman construction worker: medium skin tone :woman_construction_worker_tone3: woman construction worker: medium-dark skin tone :woman_construction_worker_tone4: woman construction worker: dark skin tone :woman_construction_worker_tone5: woman cook :woman_cook: woman cook: light skin tone :woman_cook_tone1: woman cook: medium-light skin tone :woman_cook_tone2: woman cook: medium skin tone :woman_cook_tone3: woman cook: medium-dark skin tone :woman_cook_tone4: woman cook: dark skin tone :woman_cook_tone5: woman detective :woman_detective: woman detective: light skin tone :woman_detective_tone1: woman detective: medium-light skin tone :woman_detective_tone2: woman detective: medium skin tone :woman_detective_tone3: woman detective: medium-dark skin tone :woman_detective_tone4: woman detective: dark skin tone :woman_detective_tone5: woman elf :woman_elf: woman elf: light skin tone :woman_elf_tone1: woman elf: medium-light skin tone :woman_elf_tone2: woman elf: medium skin tone :woman_elf_tone3: woman elf: medium-dark skin tone :woman_elf_tone4: woman elf: dark skin tone :woman_elf_tone5: woman facepalming :woman_facepalming: woman facepalming: light skin tone :woman_facepalming_tone1: woman facepalming: medium-light skin tone :woman_facepalming_tone2: woman facepalming: medium skin tone :woman_facepalming_tone3: woman facepalming: medium-dark skin tone :woman_facepalming_tone4: woman facepalming: dark skin tone :woman_facepalming_tone5: woman factory worker :woman_factory_worker: woman factory worker: light skin tone :woman_factory_worker_tone1: woman factory worker: medium-light skin tone :woman_factory_worker_tone2: woman factory worker: medium skin tone :woman_factory_worker_tone3: woman factory worker: medium-dark skin tone :woman_factory_worker_tone4: woman factory worker: dark skin tone :woman_factory_worker_tone5: woman fairy :woman_fairy: woman fairy: light skin tone :woman_fairy_tone1: woman fairy: medium-light skin tone :woman_fairy_tone2: woman fairy: medium skin tone :woman_fairy_tone3: woman fairy: medium-dark skin tone :woman_fairy_tone4: woman fairy: dark skin tone :woman_fairy_tone5: woman farmer :woman_farmer: woman farmer: light skin tone :woman_farmer_tone1: woman farmer: medium-light skin tone :woman_farmer_tone2: woman farmer: medium skin tone :woman_farmer_tone3: woman farmer: medium-dark skin tone :woman_farmer_tone4: woman farmer: dark skin tone :woman_farmer_tone5: woman firefighter :woman_firefighter: woman firefighter: light skin tone :woman_firefighter_tone1: woman firefighter: medium-light skin tone :woman_firefighter_tone2: woman firefighter: medium skin tone :woman_firefighter_tone3: woman firefighter: medium-dark skin tone :woman_firefighter_tone4: woman firefighter: dark skin tone :woman_firefighter_tone5: woman frowning :woman_frowning: woman frowning: light skin tone :woman_frowning_tone1: woman frowning: medium-light skin tone :woman_frowning_tone2: woman frowning: medium skin tone :woman_frowning_tone3: woman frowning: medium-dark skin tone :woman_frowning_tone4: woman frowning: dark skin tone :woman_frowning_tone5: woman genie :woman_genie: woman gesturing NO :woman_gesturing_no: woman gesturing NO: light skin tone :woman_gesturing_no_tone1: woman gesturing NO: medium-light skin tone :woman_gesturing_no_tone2: woman gesturing NO: medium skin tone :woman_gesturing_no_tone3: woman gesturing NO: medium-dark skin tone :woman_gesturing_no_tone4: woman gesturing NO: dark skin tone :woman_gesturing_no_tone5: woman gesturing OK :woman_gesturing_ok: woman gesturing OK: light skin tone :woman_gesturing_ok_tone1: woman gesturing OK: medium-light skin tone :woman_gesturing_ok_tone2: woman gesturing OK: medium skin tone :woman_gesturing_ok_tone3: woman gesturing OK: medium-dark skin tone :woman_gesturing_ok_tone4: woman gesturing OK: dark skin tone :woman_gesturing_ok_tone5: woman getting massage :woman_getting_face_massage: woman getting massage: light skin tone :woman_getting_face_massage_tone1: woman getting massage: medium-light skin tone :woman_getting_face_massage_tone2: woman getting massage: medium skin tone :woman_getting_face_massage_tone3: woman getting massage: medium-dark skin tone :woman_getting_face_massage_tone4: woman getting massage: dark skin tone :woman_getting_face_massage_tone5: woman getting haircut :woman_getting_haircut: woman getting haircut: light skin tone :woman_getting_haircut_tone1: woman getting haircut: medium-light skin tone :woman_getting_haircut_tone2: woman getting haircut: medium skin tone :woman_getting_haircut_tone3: woman getting haircut: medium-dark skin tone :woman_getting_haircut_tone4: woman getting haircut: dark skin tone :woman_getting_haircut_tone5: woman golfing :woman_golfing: woman golfing: light skin tone :woman_golfing_tone1: woman golfing: medium-light skin tone :woman_golfing_tone2: woman golfing: medium skin tone :woman_golfing_tone3: woman golfing: medium-dark skin tone :woman_golfing_tone4: woman golfing: dark skin tone :woman_golfing_tone5: woman guard :woman_guard: woman guard: light skin tone :woman_guard_tone1: woman guard: medium-light skin tone :woman_guard_tone2: woman guard: medium skin tone :woman_guard_tone3: woman guard: medium-dark skin tone :woman_guard_tone4: woman guard: dark skin tone :woman_guard_tone5: woman health worker :woman_health_worker: woman health worker: light skin tone :woman_health_worker_tone1: woman health worker: medium-light skin tone :woman_health_worker_tone2: woman health worker: medium skin tone :woman_health_worker_tone3: woman health worker: medium-dark skin tone :woman_health_worker_tone4: woman health worker: dark skin tone :woman_health_worker_tone5: woman in lotus position :woman_in_lotus_position: woman in lotus position: light skin tone :woman_in_lotus_position_tone1: woman in lotus position: medium-light skin tone :woman_in_lotus_position_tone2: woman in lotus position: medium skin tone :woman_in_lotus_position_tone3: woman in lotus position: medium-dark skin tone :woman_in_lotus_position_tone4: woman in lotus position: dark skin tone :woman_in_lotus_position_tone5: woman in steamy room :woman_in_steamy_room: woman in steamy room: light skin tone :woman_in_steamy_room_tone1: woman in steamy room: medium-light skin tone :woman_in_steamy_room_tone2: woman in steamy room: medium skin tone :woman_in_steamy_room_tone3: woman in steamy room: medium-dark skin tone :woman_in_steamy_room_tone4: woman in steamy room: dark skin tone :woman_in_steamy_room_tone5: woman judge :woman_judge: woman judge: light skin tone :woman_judge_tone1: woman judge: medium-light skin tone :woman_judge_tone2: woman judge: medium skin tone :woman_judge_tone3: woman judge: medium-dark skin tone :woman_judge_tone4: woman judge: dark skin tone :woman_judge_tone5: woman juggling :woman_juggling: woman juggling: light skin tone :woman_juggling_tone1: woman juggling: medium-light skin tone :woman_juggling_tone2: woman juggling: medium skin tone :woman_juggling_tone3: woman juggling: medium-dark skin tone :woman_juggling_tone4: woman juggling: dark skin tone :woman_juggling_tone5: woman lifting weights :woman_lifting_weights: woman lifting weights: light skin tone :woman_lifting_weights_tone1: woman lifting weights: medium-light skin tone :woman_lifting_weights_tone2: woman lifting weights: medium skin tone :woman_lifting_weights_tone3: woman lifting weights: medium-dark skin tone :woman_lifting_weights_tone4: woman lifting weights: dark skin tone :woman_lifting_weights_tone5: woman mage :woman_mage: woman mage: light skin tone :woman_mage_tone1: woman mage: medium-light skin tone :woman_mage_tone2: woman mage: medium skin tone :woman_mage_tone3: woman mage: medium-dark skin tone :woman_mage_tone4: woman mage: dark skin tone :woman_mage_tone5: woman mechanic :woman_mechanic: woman mechanic: light skin tone :woman_mechanic_tone1: woman mechanic: medium-light skin tone :woman_mechanic_tone2: woman mechanic: medium skin tone :woman_mechanic_tone3: woman mechanic: medium-dark skin tone :woman_mechanic_tone4: woman mechanic: dark skin tone :woman_mechanic_tone5: woman mountain biking :woman_mountain_biking: woman mountain biking: light skin tone :woman_mountain_biking_tone1: woman mountain biking: medium-light skin tone :woman_mountain_biking_tone2: woman mountain biking: medium skin tone :woman_mountain_biking_tone3: woman mountain biking: medium-dark skin tone :woman_mountain_biking_tone4: woman mountain biking: dark skin tone :woman_mountain_biking_tone5: woman office worker :woman_office_worker: woman office worker: light skin tone :woman_office_worker_tone1: woman office worker: medium-light skin tone :woman_office_worker_tone2: woman office worker: medium skin tone :woman_office_worker_tone3: woman office worker: medium-dark skin tone :woman_office_worker_tone4: woman office worker: dark skin tone :woman_office_worker_tone5: woman pilot :woman_pilot: woman pilot: light skin tone :woman_pilot_tone1: woman pilot: medium-light skin tone :woman_pilot_tone2: woman pilot: medium skin tone :woman_pilot_tone3: woman pilot: medium-dark skin tone :woman_pilot_tone4: woman pilot: dark skin tone :woman_pilot_tone5: woman playing handball :woman_playing_handball: woman playing handball: light skin tone :woman_playing_handball_tone1: woman playing handball: medium-light skin tone :woman_playing_handball_tone2: woman playing handball: medium skin tone :woman_playing_handball_tone3: woman playing handball: medium-dark skin tone :woman_playing_handball_tone4: woman playing handball: dark skin tone :woman_playing_handball_tone5: woman playing water polo :woman_playing_water_polo: woman playing water polo: light skin tone :woman_playing_water_polo_tone1: woman playing water polo: medium-light skin tone :woman_playing_water_polo_tone2: woman playing water polo: medium skin tone :woman_playing_water_polo_tone3: woman playing water polo: medium-dark skin tone :woman_playing_water_polo_tone4: woman playing water polo: dark skin tone :woman_playing_water_polo_tone5: woman police officer :woman_police_officer: woman police officer: light skin tone :woman_police_officer_tone1: woman police officer: medium-light skin tone :woman_police_officer_tone2: woman police officer: medium skin tone :woman_police_officer_tone3: woman police officer: medium-dark skin tone :woman_police_officer_tone4: woman police officer: dark skin tone :woman_police_officer_tone5: woman pouting :woman_pouting: woman pouting: light skin tone :woman_pouting_tone1: woman pouting: medium-light skin tone :woman_pouting_tone2: woman pouting: medium skin tone :woman_pouting_tone3: woman pouting: medium-dark skin tone :woman_pouting_tone4: woman pouting: dark skin tone :woman_pouting_tone5: woman raising hand :woman_raising_hand: woman raising hand: light skin tone :woman_raising_hand_tone1: woman raising hand: medium-light skin tone :woman_raising_hand_tone2: woman raising hand: medium skin tone :woman_raising_hand_tone3: woman raising hand: medium-dark skin tone :woman_raising_hand_tone4: woman raising hand: dark skin tone :woman_raising_hand_tone5: woman rowing boat :woman_rowing_boat: woman rowing boat: light skin tone :woman_rowing_boat_tone1: woman rowing boat: medium-light skin tone :woman_rowing_boat_tone2: woman rowing boat: medium skin tone :woman_rowing_boat_tone3: woman rowing boat: medium-dark skin tone :woman_rowing_boat_tone4: woman rowing boat: dark skin tone :woman_rowing_boat_tone5: woman running :woman_running: woman running: light skin tone :woman_running_tone1: woman running: medium-light skin tone :woman_running_tone2: woman running: medium skin tone :woman_running_tone3: woman running: medium-dark skin tone :woman_running_tone4: woman running: dark skin tone :woman_running_tone5: woman scientist :woman_scientist: woman scientist: light skin tone :woman_scientist_tone1: woman scientist: medium-light skin tone :woman_scientist_tone2: woman scientist: medium skin tone :woman_scientist_tone3: woman scientist: medium-dark skin tone :woman_scientist_tone4: woman scientist: dark skin tone :woman_scientist_tone5: woman shrugging :woman_shrugging: woman shrugging: light skin tone :woman_shrugging_tone1: woman shrugging: medium-light skin tone :woman_shrugging_tone2: woman shrugging: medium skin tone :woman_shrugging_tone3: woman shrugging: medium-dark skin tone :woman_shrugging_tone4: woman shrugging: dark skin tone :woman_shrugging_tone5: woman singer :woman_singer: woman singer: light skin tone :woman_singer_tone1: woman singer: medium-light skin tone :woman_singer_tone2: woman singer: medium skin tone :woman_singer_tone3: woman singer: medium-dark skin tone :woman_singer_tone4: woman singer: dark skin tone :woman_singer_tone5: woman student :woman_student: woman student: light skin tone :woman_student_tone1: woman student: medium-light skin tone :woman_student_tone2: woman student: medium skin tone :woman_student_tone3: woman student: medium-dark skin tone :woman_student_tone4: woman student: dark skin tone :woman_student_tone5: woman surfing :woman_surfing: woman surfing: light skin tone :woman_surfing_tone1: woman surfing: medium-light skin tone :woman_surfing_tone2: woman surfing: medium skin tone :woman_surfing_tone3: woman surfing: medium-dark skin tone :woman_surfing_tone4: woman surfing: dark skin tone :woman_surfing_tone5: woman swimming :woman_swimming: woman swimming: light skin tone :woman_swimming_tone1: woman swimming: medium-light skin tone :woman_swimming_tone2: woman swimming: medium skin tone :woman_swimming_tone3: woman swimming: medium-dark skin tone :woman_swimming_tone4: woman swimming: dark skin tone :woman_swimming_tone5: woman teacher :woman_teacher: woman teacher: light skin tone :woman_teacher_tone1: woman teacher: medium-light skin tone :woman_teacher_tone2: woman teacher: medium skin tone :woman_teacher_tone3: woman teacher: medium-dark skin tone :woman_teacher_tone4: woman teacher: dark skin tone :woman_teacher_tone5: woman technologist :woman_technologist: woman technologist: light skin tone :woman_technologist_tone1: woman technologist: medium-light skin tone :woman_technologist_tone2: woman technologist: medium skin tone :woman_technologist_tone3: woman technologist: medium-dark skin tone :woman_technologist_tone4: woman technologist: dark skin tone :woman_technologist_tone5: woman tipping hand :woman_tipping_hand: woman tipping hand: light skin tone :woman_tipping_hand_tone1: woman tipping hand: medium-light skin tone :woman_tipping_hand_tone2: woman tipping hand: medium skin tone :woman_tipping_hand_tone3: woman tipping hand: medium-dark skin tone :woman_tipping_hand_tone4: woman tipping hand: dark skin tone :woman_tipping_hand_tone5: woman: light skin tone :woman_tone1: woman: medium-light skin tone :woman_tone2: woman: medium skin tone :woman_tone3: woman: medium-dark skin tone :woman_tone4: woman: dark skin tone :woman_tone5: woman vampire :woman_vampire: woman vampire: light skin tone :woman_vampire_tone1: woman vampire: medium-light skin tone :woman_vampire_tone2: woman vampire: medium skin tone :woman_vampire_tone3: woman vampire: medium-dark skin tone :woman_vampire_tone4: woman vampire: dark skin tone :woman_vampire_tone5: woman walking :woman_walking: woman walking: light skin tone :woman_walking_tone1: woman walking: medium-light skin tone :woman_walking_tone2: woman walking: medium skin tone :woman_walking_tone3: woman walking: medium-dark skin tone :woman_walking_tone4: woman walking: dark skin tone :woman_walking_tone5: woman wearing turban :woman_wearing_turban: woman wearing turban: light skin tone :woman_wearing_turban_tone1: woman wearing turban: medium-light skin tone :woman_wearing_turban_tone2: woman wearing turban: medium skin tone :woman_wearing_turban_tone3: woman wearing turban: medium-dark skin tone :woman_wearing_turban_tone4: woman wearing turban: dark skin tone :woman_wearing_turban_tone5: woman with headscarf :woman_with_headscarf: woman with headscarf: light skin tone :woman_with_headscarf_tone1: woman with headscarf: medium-light skin tone :woman_with_headscarf_tone2: woman with headscarf: medium skin tone :woman_with_headscarf_tone3: woman with headscarf: medium-dark skin tone :woman_with_headscarf_tone4: woman with headscarf: dark skin tone :woman_with_headscarf_tone5: woman zombie :woman_zombie: woman\\u2019s clothes :womans_clothes: woman\\u2019s hat :womans_hat: women with bunny ears partying :women_with_bunny_ears_partying: women wrestling :women_wrestling: women\\u2019s room :womens: worried face :worried: wrench :wrench: writing hand :writing_hand: writing hand: light skin tone :writing_hand_tone1: writing hand: medium-light skin tone :writing_hand_tone2: writing hand: medium skin tone :writing_hand_tone3: writing hand: medium-dark skin tone :writing_hand_tone4: writing hand: dark skin tone :writing_hand_tone5: cross mark :x: yellow heart :yellow_heart: yen banknote :yen: yin yang :yin_yang: face savouring delicious food :yum: high voltage :zap: zebra :zebra: keycap: 0 :zero: zipper-mouth face :zipper_mouth: zombie :zombie: zzz :zzz:","title":"2. emojione\u5168\u540d\u77ed\u540d\u6620\u5c04\u8868"},{"location":"appendix/level/","text":"\u4e00\u4e2a.md\u91cc\u53ea\u80fd\u6709\u4e00\u4e2a#\uff08h1\uff09\uff0c\u4e0b\u9762\u662f\u591a\u4e2a## \u5982\u679c\u6709\u591a\u4e2a#\uff08h1\uff09\uff0c\u5219\u662f\u4e0d\u6807\u51c6\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u4e0d\u4f1a\u81ea\u52a8\u751f\u4ea7\u76ee\u5f55 \u5982\u679c.md\u6ca1\u6709\u7528#\uff08h1\uff09\uff0c\u5219mkdocs\u4f1a\u81ea\u52a8\u5c06\u8be5\u6587\u4ef6\u5728mkdocs.yml\u91cc\u5bf9\u5e94\u7684page\u540d\u7528h1\u6548\u679c\u5c55\u793a\u5728\u7b2c\u4e00\u884c","title":"6. mkdocs\u5c42\u7ea7\u5173\u7cfb"},{"location":"appendix/module/","text":"\u4e0b\u8ff0\u5747\u4e3a\u4e2a\u4eba\u7406\u89e3\uff0c\u4e0d\u4fdd\u8bc1\u51c6\u786e\u6027 python markdown \u00b6 \u662f\u7528python\u5199\u7684markdown\u6a21\u5757\uff0c\u7528\u8fd9\u6a21\u5757\u53ef\u4ee5\u5c06markdown\u6587\u672c\u6e32\u67d3\u6210html\uff0c\u6bd4\u5982\uff1a >>> import markdown >>> text = ''' ... # abc ... ```go ... import \"fmt\" ... ``` ... ... ## sss ... ... - xxx ... - yyy ... ''' >>> html = markdown.markdown(text) >>> print html <h1>abc</h1> <p><code>go import \"fmt\"</code></p> <h2>sss</h2> <ul> <li>xxx</li> <li>yyy</li> </ul> \u540c\u65f6markdown\u6a21\u5757\u5185\u7f6e\u4e00\u4e9b\u6269\u5c55\uff0c\u6709\uff1a abbr.py admonition.py attr_list.py codehilite.py def_list.py extra.py fenced_code.py footnotes.py headerid.py meta.py nl2br.py sane_lists.py smart_strong.py smarty.py tables.py toc.py wikilinks.py pymdownx \u00b6 \u662fpython\u7684\u4e00\u4e2a\u6a21\u5757\uff0c\u6269\u5c55\u4e86markdown\u7684\u529f\u80fd\uff0c\u6bd4\u5982emoji\u56fe\u6807\u3001\u53ef\u6298\u53e0\u7684\u6587\u672c\u6846\u7b49\uff0cpymdownx\u4e5f\u662f\u8c03\u7528markdown\u6a21\u5757\u505a\u4e8b\uff0cpymdownx\u5305\u542b\u4ee5\u4e0b\u529f\u80fd\uff1a arithmatex.py b64.py betterem.py caret.py critic.py details.py emoji.py emoji1_db.py escapeall.py extra.py extrarawhtml.py gemoji_db.py github.py highlight.py inlinehilite.py keymap_db.py keys.py magiclink.py mark.py pathconverter.py plainhtml.py progressbar.py slugs.py smartsymbols.py snippets.py superfences.py tasklist.py tilde.py twemoji_db.py util.py mkdocs \u00b6 \u662f\u7528python\u7f16\u5199\u7684\uff0c\u5305\u62ecmkdocs\u4e3b\u9898\u53ca\u547d\u4ee4\u884c\u5de5\u5177\uff0cmkdocs\u8c03\u7528python markdown\u6765\u6e32\u67d3html\uff0c\u5176\u4e2d\u91cd\u5199\u4e86\u5c11\u90e8\u5206\u57fa\u7840\u529f\u80fd\uff0c\u6bd4\u5982toc\uff0c\u4ee5\u8fbe\u5230\u7b26\u5408mkdocs\u4e3b\u9898\u6548\u679c\uff1bmkdocs\u4e5f\u5185\u7f6e\u4e00\u79cd\u4e3b\u9898\uff0c\u5c31\u53ebmkdocs\uff0c\u540c\u65f6\u4e5f\u5185\u7f6e\u652f\u6301readthedocs\uff0c\u5e76\u4e14mkdocs\u4e5f\u652f\u6301\u81ea\u5b9a\u4e49\u4e3b\u9898\u3002mkdocs\u4e3b\u8981\u5c31\u662f\u4e00\u4e2a\u96c6\u6210\u5668\uff0c\u901a\u8fc7\u8fd9\u4e2a\u5de5\u5177\u6765\u7b80\u5316\u6e32\u67d3\u3001\u90e8\u7f72\u3001\u4f7f\u7528\u3001\u6a21\u5757\u8c03\u7528\u3001\u4e3b\u9898\u8c03\u7528 material \u00b6 \u662fpython\u7684\u4e00\u4e2a\u6a21\u5757\uff0c\u662f\u7b26\u5408mkdocs\u89c4\u8303\u7684\u81ea\u5b9a\u4e49\u4e3b\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7pip install mkdocs-material\u6765\u4e0b\u8f7d\uff0c\u8fd9\u4e2a\u6a21\u5757\u91cc\u9762\u90fd\u662f\u4e00\u4e9bjs\u3001css\u3001html\u6587\u4ef6 material\u8fd9\u4e2a\u6a21\u5757\u540d\u548c\u4e3b\u9898\u98ce\u683c\uff0c\u662f\u6765\u81ea\u4e8egoogle material\uff0c\u5373google\u5b9a\u4e49\u7684\u4e00\u79cd\u901a\u7528\u98ce\u683c\uff0c\u7528\u4e8e\u517c\u5bb9\u4e0d\u540c\u5206\u8fa8\u7387\u4e0b\u7684\u9875\u9762\u5c55\u793a\uff0c\u5373\u53ea\u8981\u7b26\u5408\u8fd9\u79cd\u8c37\u6b4c\u98ce\u683c\u7684\uff0c\u4e00\u5904\u7f16\u5199\uff0c\u5904\u5904\u4f7f\u7528\uff08\u5728pc\u3001\u624b\u673a\u4e0a\u90fd\u53ef\u4ee5\u7528\uff0c\u5373\u4f1a\u6839\u636e\u5206\u8fa8\u7387\u81ea\u52a8\u8c03\u6574\u9875\u9762\u5c55\u793a\uff09 material\u4e3b\u9898\u5bf9python markdown\u7684\u4e00\u4e9b\u5185\u7f6e\u6269\u5c55\u548cpymdownx\u7684\u529f\u80fd\u505a\u4e86\u4e3b\u9898\u6548\u679c\u4f18\u5316\uff0c\u4ee5\u4fbf\u66f4\u4f18\u7f8e\uff0c\u5185\u7f6e\u7684\u6709\uff1a \u652f\u6301\u7684python markdown\u6269\u5c55\u6709\uff1aAdmonition\u3001CodeHilite\u3001Footnotes\u3001Metadata\u3001Permalinks pymdownx\u6709\uff1aArithmatex\u3001BetterEM\u3001Caret\u3001Critic\u3001Details\u3001Emoji\u3001InlineHilite\u3001MagicLink\u3001Mark\u3001SmartSymbols\u3001SuperFences\u3001Tasklist\u3001Tilde","title":"5. \u6a21\u5757\u4ecb\u7ecd"},{"location":"appendix/module/#python-markdown","text":"\u662f\u7528python\u5199\u7684markdown\u6a21\u5757\uff0c\u7528\u8fd9\u6a21\u5757\u53ef\u4ee5\u5c06markdown\u6587\u672c\u6e32\u67d3\u6210html\uff0c\u6bd4\u5982\uff1a >>> import markdown >>> text = ''' ... # abc ... ```go ... import \"fmt\" ... ``` ... ... ## sss ... ... - xxx ... - yyy ... ''' >>> html = markdown.markdown(text) >>> print html <h1>abc</h1> <p><code>go import \"fmt\"</code></p> <h2>sss</h2> <ul> <li>xxx</li> <li>yyy</li> </ul> \u540c\u65f6markdown\u6a21\u5757\u5185\u7f6e\u4e00\u4e9b\u6269\u5c55\uff0c\u6709\uff1a abbr.py admonition.py attr_list.py codehilite.py def_list.py extra.py fenced_code.py footnotes.py headerid.py meta.py nl2br.py sane_lists.py smart_strong.py smarty.py tables.py toc.py wikilinks.py","title":"python markdown"},{"location":"appendix/module/#pymdownx","text":"\u662fpython\u7684\u4e00\u4e2a\u6a21\u5757\uff0c\u6269\u5c55\u4e86markdown\u7684\u529f\u80fd\uff0c\u6bd4\u5982emoji\u56fe\u6807\u3001\u53ef\u6298\u53e0\u7684\u6587\u672c\u6846\u7b49\uff0cpymdownx\u4e5f\u662f\u8c03\u7528markdown\u6a21\u5757\u505a\u4e8b\uff0cpymdownx\u5305\u542b\u4ee5\u4e0b\u529f\u80fd\uff1a arithmatex.py b64.py betterem.py caret.py critic.py details.py emoji.py emoji1_db.py escapeall.py extra.py extrarawhtml.py gemoji_db.py github.py highlight.py inlinehilite.py keymap_db.py keys.py magiclink.py mark.py pathconverter.py plainhtml.py progressbar.py slugs.py smartsymbols.py snippets.py superfences.py tasklist.py tilde.py twemoji_db.py util.py","title":"pymdownx"},{"location":"appendix/module/#mkdocs","text":"\u662f\u7528python\u7f16\u5199\u7684\uff0c\u5305\u62ecmkdocs\u4e3b\u9898\u53ca\u547d\u4ee4\u884c\u5de5\u5177\uff0cmkdocs\u8c03\u7528python markdown\u6765\u6e32\u67d3html\uff0c\u5176\u4e2d\u91cd\u5199\u4e86\u5c11\u90e8\u5206\u57fa\u7840\u529f\u80fd\uff0c\u6bd4\u5982toc\uff0c\u4ee5\u8fbe\u5230\u7b26\u5408mkdocs\u4e3b\u9898\u6548\u679c\uff1bmkdocs\u4e5f\u5185\u7f6e\u4e00\u79cd\u4e3b\u9898\uff0c\u5c31\u53ebmkdocs\uff0c\u540c\u65f6\u4e5f\u5185\u7f6e\u652f\u6301readthedocs\uff0c\u5e76\u4e14mkdocs\u4e5f\u652f\u6301\u81ea\u5b9a\u4e49\u4e3b\u9898\u3002mkdocs\u4e3b\u8981\u5c31\u662f\u4e00\u4e2a\u96c6\u6210\u5668\uff0c\u901a\u8fc7\u8fd9\u4e2a\u5de5\u5177\u6765\u7b80\u5316\u6e32\u67d3\u3001\u90e8\u7f72\u3001\u4f7f\u7528\u3001\u6a21\u5757\u8c03\u7528\u3001\u4e3b\u9898\u8c03\u7528","title":"mkdocs"},{"location":"appendix/module/#material","text":"\u662fpython\u7684\u4e00\u4e2a\u6a21\u5757\uff0c\u662f\u7b26\u5408mkdocs\u89c4\u8303\u7684\u81ea\u5b9a\u4e49\u4e3b\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7pip install mkdocs-material\u6765\u4e0b\u8f7d\uff0c\u8fd9\u4e2a\u6a21\u5757\u91cc\u9762\u90fd\u662f\u4e00\u4e9bjs\u3001css\u3001html\u6587\u4ef6 material\u8fd9\u4e2a\u6a21\u5757\u540d\u548c\u4e3b\u9898\u98ce\u683c\uff0c\u662f\u6765\u81ea\u4e8egoogle material\uff0c\u5373google\u5b9a\u4e49\u7684\u4e00\u79cd\u901a\u7528\u98ce\u683c\uff0c\u7528\u4e8e\u517c\u5bb9\u4e0d\u540c\u5206\u8fa8\u7387\u4e0b\u7684\u9875\u9762\u5c55\u793a\uff0c\u5373\u53ea\u8981\u7b26\u5408\u8fd9\u79cd\u8c37\u6b4c\u98ce\u683c\u7684\uff0c\u4e00\u5904\u7f16\u5199\uff0c\u5904\u5904\u4f7f\u7528\uff08\u5728pc\u3001\u624b\u673a\u4e0a\u90fd\u53ef\u4ee5\u7528\uff0c\u5373\u4f1a\u6839\u636e\u5206\u8fa8\u7387\u81ea\u52a8\u8c03\u6574\u9875\u9762\u5c55\u793a\uff09 material\u4e3b\u9898\u5bf9python markdown\u7684\u4e00\u4e9b\u5185\u7f6e\u6269\u5c55\u548cpymdownx\u7684\u529f\u80fd\u505a\u4e86\u4e3b\u9898\u6548\u679c\u4f18\u5316\uff0c\u4ee5\u4fbf\u66f4\u4f18\u7f8e\uff0c\u5185\u7f6e\u7684\u6709\uff1a \u652f\u6301\u7684python markdown\u6269\u5c55\u6709\uff1aAdmonition\u3001CodeHilite\u3001Footnotes\u3001Metadata\u3001Permalinks pymdownx\u6709\uff1aArithmatex\u3001BetterEM\u3001Caret\u3001Critic\u3001Details\u3001Emoji\u3001InlineHilite\u3001MagicLink\u3001Mark\u3001SmartSymbols\u3001SuperFences\u3001Tasklist\u3001Tilde","title":"material"},{"location":"appendix/pygments/","text":"\u5305\u62ec\u9ad8\u7ea7\u8bed\u8a00\u3001\u6a21\u7248\u8bed\u8a00\u3001\u6807\u8bb0\u8bed\u8a00\uff0c\u5171434\u4e2a \u683c\u5f0f \u77ed\u540d ABAP abap ABNF abnf ActionScript 3 as3, actionscript3 ActionScript as, actionscript Ada ada, ada95, ada2005 ADL adl Agda agda Aheui aheui Alloy alloy AmbientTalk at, ambienttalk, ambienttalk/2 Ampl ampl Angular2 ng2 ANTLR With ActionScript Target antlr-as, antlr-actionscript ANTLR With C# Target antlr-csharp, antlr-c# ANTLR With CPP Target antlr-cpp ANTLR With Java Target antlr-java ANTLR With ObjectiveC Target antlr-objc ANTLR With Perl Target antlr-perl ANTLR With Python Target antlr-python ANTLR With Ruby Target antlr-ruby, antlr-rb ANTLR antlr ApacheConf apacheconf, aconf, apache APL apl AppleScript applescript Arduino arduino AspectJ aspectj aspx-cs aspx-cs aspx-vb aspx-vb Asymptote asy, asymptote autohotkey ahk, autohotkey AutoIt autoit Awk awk, gawk, mawk, nawk Base Makefile basemake Bash Session console, shell-session Bash bash, sh, ksh, zsh, shell Batchfile bat, batch, dosbatch, winbatch BBCode bbcode BC bc Befunge befunge BibTeX bib, bibtex BlitzBasic blitzbasic, b3d, bplus BlitzMax blitzmax, bmax BNF bnf Boo boo Boogie boogie Brainfuck brainfuck, bf Bro bro BST bst, bst-pybtex BUGS bugs, winbugs, openbugs C c C# csharp, c# C++ cpp, c++ c-objdump c-objdump ca65 assembler ca65 cADL cadl CAmkES camkes, idl4 Cap'n Proto capnp CapDL capdl CBM BASIC V2 cbmbas Ceylon ceylon CFEngine3 cfengine3, cf3 cfstatement cfs ChaiScript chai, chaiscript Chapel chapel, chpl Cheetah cheetah, spitfire Cirru cirru Clay clay Clean clean Clojure clojure, clj ClojureScript clojurescript, cljs CMake cmake COBOL cobol COBOLFree cobolfree CoffeeScript coffee-script, coffeescript, coffee Coldfusion CFC cfc Coldfusion HTML cfm Common Lisp common-lisp, cl, lisp Component Pascal componentpascal, cp Coq coq cpp-objdump cpp-objdump, c++-objdumb, cxx-objdump CPSA cpsa Crmsh crmsh, pcmk Croc croc Cryptol cryptol, cry Crystal cr, crystal Csound Document csound-document, csound-csd Csound Orchestra csound, csound-orc Csound Score csound-score, csound-sco CSS css CSS+Django/Jinja css+django, css+jinja CSS+Genshi Text css+genshitext, css+genshi CSS+Lasso css+lasso CSS+Mako css+mako CSS+mozpreproc css+mozpreproc CSS+Myghty css+myghty CSS+PHP css+php CSS+Ruby css+erb, css+ruby CSS+Smarty css+smarty CUDA cuda, cu Cypher cypher Cython cython, pyx, pyrex D d d-objdump d-objdump Darcs Patch dpatch Dart dart Debian Control file control, debcontrol Debian Sourcelist sourceslist, sources.list, debsources Delphi delphi, pas, pascal, objectpascal dg dg Diff diff, udiff Django/Jinja django, jinja Docker docker, dockerfile DTD dtd Duel duel, jbst, jsonml+bst Dylan session dylan-console, dylan-repl Dylan dylan DylanLID dylan-lid, lid Earl Grey earl-grey, earlgrey, eg Easytrieve easytrieve EBNF ebnf eC ec ECL ecl Eiffel eiffel Elixir iex session iex Elixir elixir, ex, exs Elm elm EmacsLisp emacs, elisp, emacs-lisp Embedded Ragel ragel-em ERB erb Erlang erl session erl Erlang erlang Evoque evoque Ezhil ezhil Factor factor Fancy fancy, fy Fantom fan Felix felix, flx Fish fish, fishshell Flatline flatline Forth forth Fortran fortran FortranFixed fortranfixed FoxPro foxpro, vfp, clipper, xbase FSharp fsharp GAP gap GAS gas, asm Genshi Text genshitext Genshi genshi, kid, xml+genshi, xml+kid Gettext Catalog pot, po Gherkin cucumber, gherkin GLSL glsl Gnuplot gnuplot Go go Golo golo GoodData-CL gooddata-cl Gosu Template gst Gosu gosu Groff groff, nroff, man Groovy groovy Haml haml Handlebars handlebars Haskell haskell, hs Haxe hx, haxe, hxsl Hexdump hexdump HSAIL hsail, hsa HTML + Angular2 html+ng2 HTML html HTML+Cheetah html+cheetah, html+spitfire, htmlcheetah HTML+Django/Jinja html+django, html+jinja, htmldjango HTML+Evoque html+evoque HTML+Genshi html+genshi, html+kid HTML+Handlebars html+handlebars HTML+Lasso html+lasso HTML+Mako html+mako HTML+Myghty html+myghty HTML+PHP html+php HTML+Smarty html+smarty HTML+Twig html+twig HTML+Velocity html+velocity HTTP http Hxml haxeml, hxml Hy hylang Hybris hybris, hy IDL idl Idris idris, idr Igor igor, igorpro Inform 6 template i6t Inform 6 inform6, i6 Inform 7 inform7, i7 INI ini, cfg, dosini Io io Ioke ioke, ik IRC logs irc Isabelle isabelle J j JAGS jags Jasmin jasmin, jasminxt Java Server Page jsp Java java JavaScript js, javascript JavaScript+Cheetah js+cheetah, javascript+cheetah, js+spitfire, javascript+spitfire JavaScript+Django/Jinja js+django, javascript+django, js+jinja, javascript+jinja JavaScript+Genshi Text js+genshitext, js+genshi, javascript+genshitext, javascript+genshi JavaScript+Lasso js+lasso, javascript+lasso JavaScript+Mako js+mako, javascript+mako Javascript+mozpreproc javascript+mozpreproc JavaScript+Myghty js+myghty, javascript+myghty JavaScript+PHP js+php, javascript+php JavaScript+Ruby js+erb, javascript+erb, js+ruby, javascript+ruby JavaScript+Smarty js+smarty, javascript+smarty JCL jcl JSGF jsgf JSON json JSON-LD jsonld, json-ld JSONBareObject json-object Julia console jlcon Julia julia, jl Juttle juttle, juttle Kal kal Kconfig kconfig, menuconfig, linux-config, kernel-config Koka koka Kotlin kotlin Lasso lasso, lassoscript Lean lean LessCss less Lighttpd configuration file lighty, lighttpd Limbo limbo liquid liquid Literate Agda lagda, literate-agda Literate Cryptol lcry, literate-cryptol, lcryptol Literate Haskell lhs, literate-haskell, lhaskell Literate Idris lidr, literate-idris, lidris LiveScript live-script, livescript LLVM llvm Logos logos Logtalk logtalk LSL lsl Lua lua Makefile make, makefile, mf, bsdmake Mako mako MAQL maql markdown md Mask mask Mason mason Mathematica mathematica, mma, nb Matlab session matlabsession Matlab matlab MiniD minid Modelica modelica Modula-2 modula2, m2 MoinMoin/Trac Wiki markup trac-wiki, moin Monkey monkey Monte monte MOOCode moocode, moo MoonScript moon, moonscript mozhashpreproc mozhashpreproc mozpercentpreproc mozpercentpreproc MQL mql, mq4, mq5, mql4, mql5 Mscgen mscgen, msc MSDOS Session doscon MuPAD mupad MXML mxml Myghty myghty MySQL mysql NASM nasm NCL ncl Nemerle nemerle nesC nesc NewLisp newlisp Newspeak newspeak Nginx configuration file nginx Nimrod nim, nimrod Nit nit Nix nixos, nix NSIS nsis, nsi, nsh NumPy numpy NuSMV nusmv objdump objdump objdump-nasm objdump-nasm Objective-C objective-c, objectivec, obj-c, objc Objective-C++ objective-c++, objectivec++, obj-c++, objc++ Objective-J objective-j, objectivej, obj-j, objj OCaml ocaml Octave octave ODIN odin Ooc ooc Opa opa OpenEdge ABL openedge, abl, progress PacmanConf pacmanconf Pan pan ParaSail parasail Pawn pawn Perl perl, pl Perl6 perl6, pl6 PHP php, php3, php4, php5 Pig pig Pike pike PkgConfig pkgconfig PL/pgSQL plpgsql PostgreSQL console (psql) psql, postgresql-console, postgres-console PostgreSQL SQL dialect postgresql, postgres PostScript postscript, postscr POVRay pov PowerShell Session ps1con PowerShell powershell, posh, ps1, psm1 Praat praat Prolog prolog Properties properties, jproperties Protocol Buffer protobuf, proto Pug pug, jade Puppet puppet PyPy Log pypylog, pypy Python 3 python3, py3 Python 3.0 Traceback py3tb Python console session pycon Python Traceback pytb Python python, py, sage QBasic qbasic, basic QML qml, qbs QVTO qvto, qvt Racket racket, rkt Ragel in C Host ragel-c Ragel in CPP Host ragel-cpp Ragel in D Host ragel-d Ragel in Java Host ragel-java Ragel in Objective C Host ragel-objc Ragel in Ruby Host ragel-ruby, ragel-rb Ragel ragel Raw token data raw RConsole rconsole, rout Rd rd REBOL rebol Red red, red/system Redcode redcode reg registry Relax-NG Compact rnc, rng-compact ResourceBundle resource, resourcebundle reStructuredText rst, rest, restructuredtext Rexx rexx, arexx RHTML rhtml, html+erb, html+ruby Roboconf Graph roboconf-graph Roboconf Instances roboconf-instances RobotFramework robotframework RPMSpec spec RQL rql RSL rsl Ruby irb session rbcon, irb Ruby rb, ruby, duby Rust rust S splus, s, r SAS sas Sass sass Scala scala Scalate Server Page ssp Scaml scaml Scheme scheme, scm Scilab scilab SCSS scss Shen shen Silver silver Slim slim Smali smali Smalltalk smalltalk, squeak, st Smarty smarty Snobol snobol Snowball snowball SourcePawn sp SPARQL sparql SQL sql sqlite3con sqlite3 SquidConf squidconf, squid.conf, squid Stan stan Standard ML sml Stata stata, do SuperCollider sc, supercollider Swift swift SWIG swig systemverilog systemverilog, sv TADS 3 tads3 TAP tap TASM tasm Tcl tcl Tcsh Session tcshcon Tcsh tcsh, csh Tea tea Termcap termcap Terminfo terminfo Terraform terraform, tf TeX tex, latex Text only text Thrift thrift Todotxt todotxt TrafficScript rts, trafficscript Transact-SQL tsql, t-sql Treetop treetop Turtle turtle Twig twig TypeScript ts, typescript TypoScript typoscript TypoScriptCssData typoscriptcssdata TypoScriptHtmlData typoscripthtmldata UrbiScript urbiscript Vala vala, vapi VB.net vb.net, vbnet VCL vcl VCLSnippets vclsnippets, vclsnippet VCTreeStatus vctreestatus Velocity velocity verilog verilog, v VGL vgl vhdl vhdl VimL vim WDiff wdiff Whiley whiley X10 x10, xten XML xml XML+Cheetah xml+cheetah, xml+spitfire XML+Django/Jinja xml+django, xml+jinja XML+Evoque xml+evoque XML+Lasso xml+lasso XML+Mako xml+mako XML+Myghty xml+myghty XML+PHP xml+php XML+Ruby xml+erb, xml+ruby XML+Smarty xml+smarty XML+Velocity xml+velocity XQuery xquery, xqy, xq, xql, xqm XSLT xslt Xtend xtend xtlang extempore XUL+mozpreproc xul+mozpreproc YAML yaml YAML+Jinja yaml+jinja, salt, sls Zephir zephir \u8bf4\u660e \u9017\u53f7\u5206\u9694\u8868\u793a\u4efb\u9009\u4e00\u79cd\u5747\u53ef \u5e95\u5c42\u5b9e\u9645\u662f\u7531Pygments\u7684lexers\u6240\u5b9e\u73b0\uff0c\u4e0a\u8ff0\u8868\u683c\u4e2d\u7684Pygments\u7248\u672c\u662f2.2.0\uff0c\u652f\u6301\u5171434\u79cd\u8bed\u8a00\u3001\u6a21\u7248\u3001\u6807\u8bb0\u8bed\u8a00\u3002 \u53ea\u8981\u662f\u4f9d\u8d56Pygments\u5b9e\u73b0\u7684\u8bed\u6cd5\u9ad8\u4eae\uff0c\u4e0a\u8ff0\u8868\u683c\u91cc\u7684\u5747\u53ef\u4ee5\u4f7f\u7528 \u4e0a\u8ff0\u8868\u683c\u4e0d\u662f\u4ecepygments\u7684\u5b98\u7f51\u4e0a\u627e\u5230\u7684\uff0c\u56e0\u4e3a\u5b98\u7f51\u5df2\u7ecf\u5f88\u4e45\u6ca1\u66f4\u65b0\u8fd9\u4e2a\u8868\u683c\u4e86\uff08 http://pygments.org/languages/ \uff0c\u8fdego\u8bed\u8a00\u90fd\u6ca1\u5199\u51fa\u6765\uff09\uff0c\u6240\u4ee5\u6211\u662f\u76f4\u63a5\u4ecepygments\u6e90\u4ee3\u7801\uff08pygments/lexers/_mapping.py\uff09\u91cc\u641c\u96c6\u7684\u3002 \u9644: \u83b7\u5f97\u4e0a\u8ff0434\u79cd\u8bed\u8a00\u7684\u65b9\u6cd5 #!/usr/bin/python from pygments.lexers import get_all_lexers lexers = get_all_lexers () for lexer in lexers : print lexer","title":"1. \u652f\u6301\u4ee3\u7801\u9ad8\u4eae\u7684\u8bed\u8a00"},{"location":"appendix/search/","text":"\u867d\u7136search\u529f\u80fd(lunr.js)\u6682\u4e0d\u76f4\u63a5\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u6d4b\u8bd5\u53d1\u73b0\u8bbe\u7f6e\u4e3a\u65e5\u8bed\u540e\uff0c\u4e2d\u6587\u548c\u82f1\u6587\u641c\u7d22\u90fd\u53ef\u4ee5\u4f7f\u7528 extra: search: language: 'jp' Note \u6d4b\u8bd5\u53d1\u73b0\uff0c\u5f53\u7ad9\u70b9\u6587\u5b57\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u6709\u7684\u65f6\u5019\u7b2c\u4e00\u6b21\u641c\u7d22\u52a0\u8f7d\u67e5\u8be2\u7684\u65f6\u95f4\u6bd4\u8f83\u4e45\uff0c\u4f1a\u5f15\u8d77\u6d4f\u89c8\u5668\u5047\u6b7b\uff0c\u591a\u7b49\u4e00\u4f1a\u5c31\u884c\u4e86\u3002\u6bd4\u5982\u672c\u7ad9\u70b9\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u641c\u7d22\u5c31\u6bd4\u8f83\u5361 \u4e3a\u4ec0\u4e48\u4e0a\u9762\u8bf4\u7684\u662f\u6709\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u6211\u7684\u53e6\u4e00\u4e2a\u7ad9\u70b9\u6587\u5b57\u6570\u91cf\u6bd4\u672c\u7ad9\u8fd8\u8981\u591a\uff0c\u4f46\u641c\u7d22\u786e\u5f88\u5feb\uff0c\u7b49\u4ee5\u540e\u719f\u6089\u4e86lunr.js\u540e\u518d\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898 \u53e6\u5916\uff0c\u641c\u7d22\u5bf9\u8bdd\u6846\u7684\u663e\u793a\u6587\u5b57\uff0c\u9ed8\u8ba4\u4e3a\u82f1\u6587\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4e2d\u6587\u3002\u4f8b\u5982\"search\"\u6539\u4e3a\u4e2d\u6587\u540e\u5c31\u53eb\"\u641c\u7d22\" theme: language: 'zh'","title":"7. \u652f\u6301\u4e2d\u6587\u641c\u7d22"},{"location":"appendix/yml/","text":"site_name : markdown\u8bed\u6cd5\u8be6\u89e3(\u57fa\u4e8emkdocs-material) - cyent\u7b14\u8bb0 site_description : \u5173\u4e8emkdocs-material\u652f\u6301\u7684markdown\u8bed\u6cd5\uff0c\u5305\u62ec\u4f20\u7edf\u8bed\u6cd5\u548c\u6269\u5c55\u8bed\u6cd5 site_author : cyent site_url : https://cyent.github.io/markdown-with-mkdocs-material/ repo_name : 'cyent/markdown-with-mkdocs-material' repo_url : 'https://github.com/cyent/markdown-with-mkdocs-material' theme : name : material palette : primary : 'Blue Grey' accent : 'Pink' feature : tabs : false #font: #text: 'Ubuntu' #code: 'Ubuntu Mono' language : 'zh' extra : social : - type : github link : https://github.com/cyent search : language : 'jp' markdown_extensions : - admonition - codehilite : guess_lang : false linenums : false - toc : permalink : true - footnotes - meta - def_list - pymdownx.arithmatex - pymdownx.betterem : smart_enable : all - pymdownx.caret - pymdownx.critic - pymdownx.details - pymdownx.emoji : emoji_generator : !!python/name:pymdownx.emoji.to_png #emoji_generator: !!python/name:pymdownx.emoji.to_svg #emoji_generator: !!python/name:pymdownx.emoji.to_png_sprite #emoji_generator: !!python/name:pymdownx.emoji.to_svg_sprite #emoji_generator: !!python/name:pymdownx.emoji.to_awesome #emoji_generator: !!python/name:pymdownx.emoji.to_alt - pymdownx.inlinehilite - pymdownx.magiclink - pymdownx.mark - pymdownx.smartsymbols - pymdownx.superfences - pymdownx.tasklist - pymdownx.tilde extra_javascript : - 'js/extra.js' - 'js/baidu-tongji.js' - 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML' nav : - \u4e00. \u4ecb\u7ecd : index.md - \u4e8c. \u5b89\u88c5 : - 1. \u672c\u5730\u73af\u5883\u642d\u5efa : install/local.md - 2. \u53d1\u5e03\u81f3GitHub Pages : install/github-pages.md - 3. \u53d1\u5e03\u81f3\u81ea\u5df1\u7684HTTP Server : install/http-server.md - \u4e09. \u8bed\u6cd5 : - 1. \u8bed\u6cd5\u603b\u89c8 : syntax/main.md - 2. \u6807\u9898 : syntax/headline.md - 3. \u6bb5\u843d : syntax/paragraph.md","title":"8. mkdocs.yml\u8303\u4f8b"},{"location":"course/","text":"1. \u514b\u9686\u9879\u76ee \u00b6 root@leco:/tmp/leco# git clone https://github.com/caimengzhi/books.git \u6b63\u514b\u9686\u5230 'books'... remote: Enumerating objects: 1879, done. remote: Counting objects: 100% (1879/1879), done. remote: Compressing objects: 100% (237/237), done. remote: Total 6365 (delta 835), reused 1800 (delta 782), pack-reused 4486 \u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (6365/6365), 5.58 MiB | 24.00 KiB/s, \u5b8c\u6210. \u5904\u7406 delta \u4e2d: 100% (2938/2938), \u5b8c\u6210. \u68c0\u67e5\u8fde\u63a5... \u5b8c\u6210\u3002 root@leco:/tmp/leco# cd books/ root@leco:/tmp/leco/books# ls docs mkdocs.yml README.md site root@leco:/tmp/leco/books# cd .. root@leco:/tmp/leco# tree . -L 3 . \u2514\u2500\u2500 books \u251c\u2500\u2500 docs \u2502 \u251c\u2500\u2500 appendix \u2502 \u251c\u2500\u2500 contact.md \u2502 \u251c\u2500\u2500 frontend \u2502 \u251c\u2500\u2500 img \u2502 \u251c\u2500\u2500 index.md \u2502 \u251c\u2500\u2500 install \u2502 \u251c\u2500\u2500 js \u2502 \u251c\u2500\u2500 linux \u2502 \u251c\u2500\u2500 pictures \u2502 \u251c\u2500\u2500 python \u2502 \u251c\u2500\u2500 recommend.md \u2502 \u2514\u2500\u2500 syntax \u251c\u2500\u2500 mkdocs.yml \u251c\u2500\u2500 README.md \u2514\u2500\u2500 site \u251c\u2500\u2500 404.html \u251c\u2500\u2500 appendix \u251c\u2500\u2500 assets \u251c\u2500\u2500 contact \u251c\u2500\u2500 frontend \u251c\u2500\u2500 img \u251c\u2500\u2500 index.html \u251c\u2500\u2500 install \u251c\u2500\u2500 js \u251c\u2500\u2500 linux \u251c\u2500\u2500 pictures \u251c\u2500\u2500 python \u251c\u2500\u2500 recommend \u251c\u2500\u2500 search \u251c\u2500\u2500 sitemap.xml \u251c\u2500\u2500 sitemap.xml.gz \u2514\u2500\u2500 syntax 25 directories, 9 files \u89e3\u91ca \u751f\u6210\u9759\u6001\u6587\u4ef6 mkdocs build \u7136\u540e\u5c31\u5728\u9879\u76ee\u7684\u6587\u4ef6\u5939\u4e0b\u751f\u6210site\u9759\u6001\u6587\u4ef6\uff0c\u4ee5\u540enginx\u7684\u5bb6\u76ee\u5f55\u6307\u5b9a\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5373\u53ef 2. \u521b\u5efa\u9879\u76ee \u00b6 2.1 \u521b\u5efamarkdown\u6587\u4ef6 \u00b6 root@leco:~/book/books/docs# cd course/ root@leco:~/book/books/docs/course# ls index.md root@leco:~/book/books/docs/course# cat index.md ### 1. \u514b\u9686\u9879\u76ee root@leco:/tmp/leco# git clone git@github.com:caimengzhi/books.git \u6b63\u514b\u9686\u5230 'books'... remote: Enumerating objects: 1879, done. remote: Counting objects: 100% (1879/1879), done. remote: Compressing objects: 100% (237/237), done. remote: Total 6365 (delta 835), reused 1800 (delta 782), pack-reused 4486 \u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (6365/6365), 5.58 MiB | 24.00 KiB/s, \u5b8c\u6210. \u5904\u7406 delta \u4e2d: 100% (2938/2938), \u5b8c\u6210. \u68c0\u67e5\u8fde\u63a5... \u5b8c\u6210\u3002 root@leco:/tmp/leco# cd books/ root@leco:/tmp/leco/books# ls docs mkdocs.yml README.md site root@leco:/tmp/leco/books# cd .. root@leco:/tmp/leco# tree . -L 3 . \u2514\u2500\u2500 books 2.2 \u4fee\u6539\u76ee\u5f55\u6587\u4ef6 \u00b6 \u6587\u4ef6\u5185\u5bb9\u5176\u4ed6\u7701\u7565 root@leco:~/book/books# egrep -irn course mkdocs.yml 107: - \u6559\u7a0b: course/index.md 2.3 \u914d\u7f6e\u76ee\u5f55 \u00b6 \u914d\u7f6e\u76f8\u5173\u4fe1\u606f\uff0c\u63d0\u4ea4\u4ee3\u7801 root@leco:~/book/books/docs/course# cd .. root@leco:~/book/books/docs# ls appendix contact.md course frontend img index.md install js linux mysql pictures python recommend.md syntax root@leco:~/book/books/docs# cd .. root@leco:~/book/books# ls docs mkdocs.yml README.md site root@leco:~/book/books# ls docs mkdocs.yml README.md site root@leco:~/book/books# git add . root@leco:~/book/books# git commit -m 'add course how to use mkdocs' [master 205de67] add course how to use mkdocs 98 files changed, 10137 insertions(+), 4377 deletions(-) create mode 100644 docs/course/index.md create mode 100644 site/course/index.html rewrite site/search/search_index.json (64%) root@leco:~/book/books# git tag v1.0 root@leco:~/book/books# git push \u5bf9\u8c61\u8ba1\u6570\u4e2d: 215, \u5b8c\u6210. Delta compression using up to 4 threads. \u538b\u7f29\u5bf9\u8c61\u4e2d: 100% (28/28), \u5b8c\u6210. \u5199\u5165\u5bf9\u8c61\u4e2d: 100% (215/215), 152.75 KiB | 173.00 KiB/s, \u5b8c\u6210. Total 215 (delta 97), reused 195 (delta 83) remote: Resolving deltas: 100% (97/97), completed with 13 local objects. To git@github.com:caimengzhi/books.git 0de48fc..205de67 master -> master 2.4 \u90e8\u7f72 \u00b6 2.4.1 \u751f\u6210\u9759\u6001\u6587\u4ef6 \u00b6 root@leco:~/book/books# mkdocs build \u6267\u884c mkdocs build\u7684\u65f6\u5019\u5fc5\u987b\u5728\u8fd9\u76ee\u5f55\u4e0b\u56e0\u4e3a\u4f1a\u53bb\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u6267\u884c\u540e\u6b64\u65f6\u4f1a\u751f\u6210\u9759\u6001\u6587\u4ef6site 2.4.2 site\u7ed3\u548cnginx \u00b6 root@leco:~/book/books# ll site \u603b\u7528\u91cf 176 drwxr-xr-x 16 root root 4096 2\u6708 14 15:17 ./ drwxr-xr-x 5 root root 4096 2\u6708 13 16:36 ../ -rw-r--r-- 1 root root 43718 2\u6708 14 15:17 404.html drwxr-xr-x 10 root root 4096 2\u6708 14 15:17 appendix/ drwxr-xr-x 6 root root 4096 2\u6708 14 15:17 assets/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 contact/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 course/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 frontend/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 img/ -rw-r--r-- 1 root root 49983 2\u6708 14 15:17 index.html drwxr-xr-x 5 root root 4096 2\u6708 14 15:17 install/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 js/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 linux/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 pictures/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 python/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 recommend/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 search/ -rw-r--r-- 1 root root 10505 2\u6708 14 15:17 sitemap.xml -rw-r--r-- 1 root root 245 2\u6708 14 15:17 sitemap.xml.gz drwxr-xr-x 58 root root 4096 2\u6708 14 15:17 syntax/ root@leco:~/book/books# cat /etc/nginx/sites-enabled/book.conf server { listen 5000; charset utf-8; client_max_body_size 75M; location / { root /root/book/books/site; index index.html; } } root@leco:~/book/books# /etc/init.d/nginx restart [ ok ] Restarting nginx (via systemctl): nginx.service. \u5c55\u793a\u6548\u679c 2.4.3 \u90e8\u7f72\u5230github page \u00b6 root@leco:~/book/books# mkdocs gh-deploy INFO - Cleaning site directory INFO - Building documentation to directory: /root/book/books/site INFO - Copying '/root/book/books/site' to 'gh-pages' branch and pushing to GitHub. INFO - Your documentation should shortly be available at: https://caimengzhi.github.io/books/ 2.5 \u914d\u7f6e\u5feb\u6377\u547d\u4ee4 \u00b6 2.5.1 \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6 \u00b6 root@leco:~/book/books/docs/course# egrep -irn 'cmz' /root/.bashrc 84:alias cmzb='cd /root/book/books;mkdocs build;cd -' 85:alias cmzd='cd /root/book/books;mkdocs gh-deploy;cd -' 2.5.2 \u751f\u6548\u73af\u5883\u53d8\u91cf \u00b6 root@leco:~/book/books/docs/course# source /root/.bashrc \u4e0b\u6b21\u767b\u5f55root\u7528\u6237\u7684\u65f6\u5019\uff0c\u5728\u4efb\u4f55\u76ee\u5f55\u4e0b\u90fd\u53ef\u4ee5\u6267\u884ccmzb\u3002 root@leco:~/book/books/docs/course# cmzd INFO - Cleaning site directory INFO - Building documentation to directory: /root/book/books/site INFO - Copying '/root/book/books/site' to 'gh-pages' branch and pushing to GitHub. INFO - Your documentation should shortly be available at: https://caimengzhi.github.io/books/ 2.6 \u914d\u7f6e\u6587\u4ef6 \u00b6 \u628a\u622a\u53d6\u7684\u56fe\u7247\u4e0a\u4f20\u5230\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b root@leco:~/book/books/docs/course# ls ~/book/books/docs/pictures/course/1.png /root/book/books/docs//course/1.png \u5c55\u793a\u6548\u679c \u6ce8\u610f\u56fe\u7247\u76f8\u5bf9\u4f4d\u7f6e 1. ![](../pictures/course/1.png) \u671f\u4e2d\u56fe\u7247\u7684\u4f4d\u7f6e\u662f../pictures/course/1.png\u662f\u6839\u636emarkdown\u6587\u4ef6\u6240\u5728\u4f4d\u7f6e\u53bb\u627e\u56fe\u7247\u7684\u76f8\u5bf9\u4f4d\u7f6e root@leco:~/book/books/docs/course# ls index.md root@leco:~/book/books/docs/course# ls ../pictures/course/1.png ../pictures/course/1.png 2. \u6211\u8bd5\u8fc7\u7edd\u5bf9\u8def\u5f84\u4e0d\u884c\uff0c\u4f60\u4eec\u8bd5\u8bd5\u770b","title":"\u6559\u7a0b"},{"location":"course/#1","text":"root@leco:/tmp/leco# git clone https://github.com/caimengzhi/books.git \u6b63\u514b\u9686\u5230 'books'... remote: Enumerating objects: 1879, done. remote: Counting objects: 100% (1879/1879), done. remote: Compressing objects: 100% (237/237), done. remote: Total 6365 (delta 835), reused 1800 (delta 782), pack-reused 4486 \u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (6365/6365), 5.58 MiB | 24.00 KiB/s, \u5b8c\u6210. \u5904\u7406 delta \u4e2d: 100% (2938/2938), \u5b8c\u6210. \u68c0\u67e5\u8fde\u63a5... \u5b8c\u6210\u3002 root@leco:/tmp/leco# cd books/ root@leco:/tmp/leco/books# ls docs mkdocs.yml README.md site root@leco:/tmp/leco/books# cd .. root@leco:/tmp/leco# tree . -L 3 . \u2514\u2500\u2500 books \u251c\u2500\u2500 docs \u2502 \u251c\u2500\u2500 appendix \u2502 \u251c\u2500\u2500 contact.md \u2502 \u251c\u2500\u2500 frontend \u2502 \u251c\u2500\u2500 img \u2502 \u251c\u2500\u2500 index.md \u2502 \u251c\u2500\u2500 install \u2502 \u251c\u2500\u2500 js \u2502 \u251c\u2500\u2500 linux \u2502 \u251c\u2500\u2500 pictures \u2502 \u251c\u2500\u2500 python \u2502 \u251c\u2500\u2500 recommend.md \u2502 \u2514\u2500\u2500 syntax \u251c\u2500\u2500 mkdocs.yml \u251c\u2500\u2500 README.md \u2514\u2500\u2500 site \u251c\u2500\u2500 404.html \u251c\u2500\u2500 appendix \u251c\u2500\u2500 assets \u251c\u2500\u2500 contact \u251c\u2500\u2500 frontend \u251c\u2500\u2500 img \u251c\u2500\u2500 index.html \u251c\u2500\u2500 install \u251c\u2500\u2500 js \u251c\u2500\u2500 linux \u251c\u2500\u2500 pictures \u251c\u2500\u2500 python \u251c\u2500\u2500 recommend \u251c\u2500\u2500 search \u251c\u2500\u2500 sitemap.xml \u251c\u2500\u2500 sitemap.xml.gz \u2514\u2500\u2500 syntax 25 directories, 9 files \u89e3\u91ca \u751f\u6210\u9759\u6001\u6587\u4ef6 mkdocs build \u7136\u540e\u5c31\u5728\u9879\u76ee\u7684\u6587\u4ef6\u5939\u4e0b\u751f\u6210site\u9759\u6001\u6587\u4ef6\uff0c\u4ee5\u540enginx\u7684\u5bb6\u76ee\u5f55\u6307\u5b9a\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5373\u53ef","title":"1. \u514b\u9686\u9879\u76ee"},{"location":"course/#2","text":"","title":"2. \u521b\u5efa\u9879\u76ee"},{"location":"course/#21-markdown","text":"root@leco:~/book/books/docs# cd course/ root@leco:~/book/books/docs/course# ls index.md root@leco:~/book/books/docs/course# cat index.md ### 1. \u514b\u9686\u9879\u76ee root@leco:/tmp/leco# git clone git@github.com:caimengzhi/books.git \u6b63\u514b\u9686\u5230 'books'... remote: Enumerating objects: 1879, done. remote: Counting objects: 100% (1879/1879), done. remote: Compressing objects: 100% (237/237), done. remote: Total 6365 (delta 835), reused 1800 (delta 782), pack-reused 4486 \u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (6365/6365), 5.58 MiB | 24.00 KiB/s, \u5b8c\u6210. \u5904\u7406 delta \u4e2d: 100% (2938/2938), \u5b8c\u6210. \u68c0\u67e5\u8fde\u63a5... \u5b8c\u6210\u3002 root@leco:/tmp/leco# cd books/ root@leco:/tmp/leco/books# ls docs mkdocs.yml README.md site root@leco:/tmp/leco/books# cd .. root@leco:/tmp/leco# tree . -L 3 . \u2514\u2500\u2500 books","title":"2.1 \u521b\u5efamarkdown\u6587\u4ef6"},{"location":"course/#22","text":"\u6587\u4ef6\u5185\u5bb9\u5176\u4ed6\u7701\u7565 root@leco:~/book/books# egrep -irn course mkdocs.yml 107: - \u6559\u7a0b: course/index.md","title":"2.2 \u4fee\u6539\u76ee\u5f55\u6587\u4ef6"},{"location":"course/#23","text":"\u914d\u7f6e\u76f8\u5173\u4fe1\u606f\uff0c\u63d0\u4ea4\u4ee3\u7801 root@leco:~/book/books/docs/course# cd .. root@leco:~/book/books/docs# ls appendix contact.md course frontend img index.md install js linux mysql pictures python recommend.md syntax root@leco:~/book/books/docs# cd .. root@leco:~/book/books# ls docs mkdocs.yml README.md site root@leco:~/book/books# ls docs mkdocs.yml README.md site root@leco:~/book/books# git add . root@leco:~/book/books# git commit -m 'add course how to use mkdocs' [master 205de67] add course how to use mkdocs 98 files changed, 10137 insertions(+), 4377 deletions(-) create mode 100644 docs/course/index.md create mode 100644 site/course/index.html rewrite site/search/search_index.json (64%) root@leco:~/book/books# git tag v1.0 root@leco:~/book/books# git push \u5bf9\u8c61\u8ba1\u6570\u4e2d: 215, \u5b8c\u6210. Delta compression using up to 4 threads. \u538b\u7f29\u5bf9\u8c61\u4e2d: 100% (28/28), \u5b8c\u6210. \u5199\u5165\u5bf9\u8c61\u4e2d: 100% (215/215), 152.75 KiB | 173.00 KiB/s, \u5b8c\u6210. Total 215 (delta 97), reused 195 (delta 83) remote: Resolving deltas: 100% (97/97), completed with 13 local objects. To git@github.com:caimengzhi/books.git 0de48fc..205de67 master -> master","title":"2.3 \u914d\u7f6e\u76ee\u5f55"},{"location":"course/#24","text":"","title":"2.4 \u90e8\u7f72"},{"location":"course/#241","text":"root@leco:~/book/books# mkdocs build \u6267\u884c mkdocs build\u7684\u65f6\u5019\u5fc5\u987b\u5728\u8fd9\u76ee\u5f55\u4e0b\u56e0\u4e3a\u4f1a\u53bb\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u6267\u884c\u540e\u6b64\u65f6\u4f1a\u751f\u6210\u9759\u6001\u6587\u4ef6site","title":"2.4.1 \u751f\u6210\u9759\u6001\u6587\u4ef6"},{"location":"course/#242-sitenginx","text":"root@leco:~/book/books# ll site \u603b\u7528\u91cf 176 drwxr-xr-x 16 root root 4096 2\u6708 14 15:17 ./ drwxr-xr-x 5 root root 4096 2\u6708 13 16:36 ../ -rw-r--r-- 1 root root 43718 2\u6708 14 15:17 404.html drwxr-xr-x 10 root root 4096 2\u6708 14 15:17 appendix/ drwxr-xr-x 6 root root 4096 2\u6708 14 15:17 assets/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 contact/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 course/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 frontend/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 img/ -rw-r--r-- 1 root root 49983 2\u6708 14 15:17 index.html drwxr-xr-x 5 root root 4096 2\u6708 14 15:17 install/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 js/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 linux/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 pictures/ drwxr-xr-x 3 root root 4096 2\u6708 14 15:17 python/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 recommend/ drwxr-xr-x 2 root root 4096 2\u6708 14 15:17 search/ -rw-r--r-- 1 root root 10505 2\u6708 14 15:17 sitemap.xml -rw-r--r-- 1 root root 245 2\u6708 14 15:17 sitemap.xml.gz drwxr-xr-x 58 root root 4096 2\u6708 14 15:17 syntax/ root@leco:~/book/books# cat /etc/nginx/sites-enabled/book.conf server { listen 5000; charset utf-8; client_max_body_size 75M; location / { root /root/book/books/site; index index.html; } } root@leco:~/book/books# /etc/init.d/nginx restart [ ok ] Restarting nginx (via systemctl): nginx.service. \u5c55\u793a\u6548\u679c","title":"2.4.2 site\u7ed3\u548cnginx"},{"location":"course/#243-github-page","text":"root@leco:~/book/books# mkdocs gh-deploy INFO - Cleaning site directory INFO - Building documentation to directory: /root/book/books/site INFO - Copying '/root/book/books/site' to 'gh-pages' branch and pushing to GitHub. INFO - Your documentation should shortly be available at: https://caimengzhi.github.io/books/","title":"2.4.3 \u90e8\u7f72\u5230github page"},{"location":"course/#25","text":"","title":"2.5 \u914d\u7f6e\u5feb\u6377\u547d\u4ee4"},{"location":"course/#251","text":"root@leco:~/book/books/docs/course# egrep -irn 'cmz' /root/.bashrc 84:alias cmzb='cd /root/book/books;mkdocs build;cd -' 85:alias cmzd='cd /root/book/books;mkdocs gh-deploy;cd -'","title":"2.5.1 \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6"},{"location":"course/#252","text":"root@leco:~/book/books/docs/course# source /root/.bashrc \u4e0b\u6b21\u767b\u5f55root\u7528\u6237\u7684\u65f6\u5019\uff0c\u5728\u4efb\u4f55\u76ee\u5f55\u4e0b\u90fd\u53ef\u4ee5\u6267\u884ccmzb\u3002 root@leco:~/book/books/docs/course# cmzd INFO - Cleaning site directory INFO - Building documentation to directory: /root/book/books/site INFO - Copying '/root/book/books/site' to 'gh-pages' branch and pushing to GitHub. INFO - Your documentation should shortly be available at: https://caimengzhi.github.io/books/","title":"2.5.2 \u751f\u6548\u73af\u5883\u53d8\u91cf"},{"location":"course/#26","text":"\u628a\u622a\u53d6\u7684\u56fe\u7247\u4e0a\u4f20\u5230\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b root@leco:~/book/books/docs/course# ls ~/book/books/docs/pictures/course/1.png /root/book/books/docs//course/1.png \u5c55\u793a\u6548\u679c \u6ce8\u610f\u56fe\u7247\u76f8\u5bf9\u4f4d\u7f6e 1. ![](../pictures/course/1.png) \u671f\u4e2d\u56fe\u7247\u7684\u4f4d\u7f6e\u662f../pictures/course/1.png\u662f\u6839\u636emarkdown\u6587\u4ef6\u6240\u5728\u4f4d\u7f6e\u53bb\u627e\u56fe\u7247\u7684\u76f8\u5bf9\u4f4d\u7f6e root@leco:~/book/books/docs/course# ls index.md root@leco:~/book/books/docs/course# ls ../pictures/course/1.png ../pictures/course/1.png 2. \u6211\u8bd5\u8fc7\u7edd\u5bf9\u8def\u5f84\u4e0d\u884c\uff0c\u4f60\u4eec\u8bd5\u8bd5\u770b","title":"2.6 \u914d\u7f6e\u6587\u4ef6"},{"location":"frontend/vue/","text":"1. method \u00b6 \u4f60\u597d","title":"Vue"},{"location":"frontend/vue/#1-method","text":"\u4f60\u597d","title":"1. method"},{"location":"install/github-pages/","text":"\u901a\u8fc7mkdocs gh-deploy\u81ea\u52a8\u7f16\u8bd1\u51fahtml\u5e76\u53d1\u5e03\u81f3GitHub pages \u521d\u59cb\u5316repo \u00b6 \u5728github\u4e0a\u521b\u5efa\u4e00\u4e2arepo\uff0c\u540d\u5b57\u53ebmy-project \u5c06repo\u540c\u6b65\u5230\u672c\u5730 \u5bfc\u5165\u9879\u76ee \u00b6 \u5c06mkdocs\u6839\u76ee\u5f55(my-project)\u4e0b\u7684\u6240\u6709\u4e1c\u897f\u79fb\u5230\u672c\u5730git\u76ee\u5f55\u4e0b (\u7136\u540e\u53ef\u4ee5\u5c06mkdocs\u6839\u76ee\u5f55\u5220\u9664\u4e86) \u53d1\u5e03 \u00b6 \u5728\u672c\u5730git\u76ee\u5f55\u4e0b\u6267\u884c mkdocs gh-deploy","title":"2. \u53d1\u5e03\u81f3GitHub Pages"},{"location":"install/github-pages/#repo","text":"\u5728github\u4e0a\u521b\u5efa\u4e00\u4e2arepo\uff0c\u540d\u5b57\u53ebmy-project \u5c06repo\u540c\u6b65\u5230\u672c\u5730","title":"\u521d\u59cb\u5316repo"},{"location":"install/github-pages/#_1","text":"\u5c06mkdocs\u6839\u76ee\u5f55(my-project)\u4e0b\u7684\u6240\u6709\u4e1c\u897f\u79fb\u5230\u672c\u5730git\u76ee\u5f55\u4e0b (\u7136\u540e\u53ef\u4ee5\u5c06mkdocs\u6839\u76ee\u5f55\u5220\u9664\u4e86)","title":"\u5bfc\u5165\u9879\u76ee"},{"location":"install/github-pages/#_2","text":"\u5728\u672c\u5730git\u76ee\u5f55\u4e0b\u6267\u884c mkdocs gh-deploy","title":"\u53d1\u5e03"},{"location":"install/http-server/","text":"\u901a\u8fc7mkdocs build\u7f16\u8bd1\u51fahtml\u5e76\u624b\u52a8\u540c\u6b65\u81f3http server\u7684\u6839\u76ee\u5f55 \u751f\u6210\u7ad9\u70b9\u6587\u4ef6 \u00b6 \u5728git\u6839\u76ee\u5f55\u4e0b\u6267\u884c\u547d\u4ee4 mkdocs build \u547d\u4ee4\u6267\u884c\u5b8c\u6bd5\u540e\u53ef\u4ee5\u770b\u5230site\u76ee\u5f55 \u53d1\u5e03\u81f3http server \u00b6 \u5c06site\u76ee\u5f55\u91cc\u7684\u6240\u6709\u4e1c\u897f\u540c\u6b65\u81f3\u81ea\u5df1\u7684http server\u7684\u6839\u76ee\u5f55","title":"3. \u53d1\u5e03\u81f3\u81ea\u5df1\u7684HTTP Server"},{"location":"install/http-server/#_1","text":"\u5728git\u6839\u76ee\u5f55\u4e0b\u6267\u884c\u547d\u4ee4 mkdocs build \u547d\u4ee4\u6267\u884c\u5b8c\u6bd5\u540e\u53ef\u4ee5\u770b\u5230site\u76ee\u5f55","title":"\u751f\u6210\u7ad9\u70b9\u6587\u4ef6"},{"location":"install/http-server/#http-server","text":"\u5c06site\u76ee\u5f55\u91cc\u7684\u6240\u6709\u4e1c\u897f\u540c\u6b65\u81f3\u81ea\u5df1\u7684http server\u7684\u6839\u76ee\u5f55","title":"\u53d1\u5e03\u81f3http server"},{"location":"install/local/","text":"\u73af\u5883\u8bf4\u660e \u00b6 python: 2.7.13 \u4f9d\u8d56\u7684python\u5305: \u5305\u540d \u6a21\u5757\u540d \u7248\u672c mkdocs mkdocs 1.0.4 mkdocs-material material 3.0.6 Markdown markdown 3.0.1 pymdown-extensions pymdownx 6.0 mkdocs-material\u90e8\u7f72 \u00b6 \u5b89\u88c5 \u00b6 pip install mkdocs mkdocs-material \u82e5\u4e0b\u8f7d\u6162\uff0c\u53ef\u66f4\u6362\u5b89\u88c5\u6e90\u4e3a\u8c46\u74e3 sudo pip install --trusted-host pypi.douban.com -i http://pypi.douban.com/simple/ mkdocs mkdocs-material \u521d\u59cb\u5316\u9879\u76ee \u00b6 mkdocs new my-project \u4f1a\u751f\u6210my-project\u76ee\u5f55\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u91cc\uff0c\u53ef\u4ee5\u770b\u5230\u9ed8\u8ba4\u653e\u7f6e\u4e86\u4e00\u4e9b\u6587\u4ef6\uff0c\u5305\u62ecmkdocs.yaml\uff0c\u8fd9\u662f\u4e3b\u914d\u7f6e\u6587\u4ef6 \u4fee\u6539\u4e3b\u9898 \u00b6 mkdocs.yml\u91cc\u6dfb\u52a0: theme: name: material \u6dfb\u52a0\u6269\u5c55 \u00b6 mkdocs.yml\u91cc\u6dfb\u52a0: markdown_extensions: - admonition - codehilite: guess_lang: false linenums: false - toc: permalink: true - footnotes - meta - def_list - pymdownx.arithmatex - pymdownx.betterem: smart_enable: all - pymdownx.caret - pymdownx.critic - pymdownx.details - pymdownx.emoji: emoji_generator: !!python/name:pymdownx.emoji.to_png - pymdownx.inlinehilite - pymdownx.magiclink - pymdownx.mark - pymdownx.smartsymbols - pymdownx.superfences - pymdownx.tasklist - pymdownx.tilde [\u53ef\u9009] \u6dfb\u52a0\u767e\u5ea6\u7edf\u8ba1 [\u53ef\u9009] \u6539\u53d8\u9875\u9762\u914d\u8272 [\u63a8\u8350] \u652f\u6301\u4e2d\u6587\u641c\u7d22 \u53ef\u4ee5\u67e5\u770b\u6211\u7684mkdocs.yml\u8303\u4f8b\uff0c\u8be6\u89c1 mkdocs.yml\u8303\u4f8b mkdocs\u670d\u52a1\u542f\u52a8 \u00b6 # \u5728my-project\u76ee\u5f55\u91cc\u6267\u884c mkdocs serve \u901a\u8fc7\u6d4f\u89c8\u5668\u6253\u5f00 http://127.0.0.1:8000/ \u67e5\u770b\u6548\u679c","title":"1. \u672c\u5730\u73af\u5883\u642d\u5efa"},{"location":"install/local/#_1","text":"python: 2.7.13 \u4f9d\u8d56\u7684python\u5305: \u5305\u540d \u6a21\u5757\u540d \u7248\u672c mkdocs mkdocs 1.0.4 mkdocs-material material 3.0.6 Markdown markdown 3.0.1 pymdown-extensions pymdownx 6.0","title":"\u73af\u5883\u8bf4\u660e"},{"location":"install/local/#mkdocs-material","text":"","title":"mkdocs-material\u90e8\u7f72"},{"location":"install/local/#_2","text":"pip install mkdocs mkdocs-material \u82e5\u4e0b\u8f7d\u6162\uff0c\u53ef\u66f4\u6362\u5b89\u88c5\u6e90\u4e3a\u8c46\u74e3 sudo pip install --trusted-host pypi.douban.com -i http://pypi.douban.com/simple/ mkdocs mkdocs-material","title":"\u5b89\u88c5"},{"location":"install/local/#_3","text":"mkdocs new my-project \u4f1a\u751f\u6210my-project\u76ee\u5f55\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u91cc\uff0c\u53ef\u4ee5\u770b\u5230\u9ed8\u8ba4\u653e\u7f6e\u4e86\u4e00\u4e9b\u6587\u4ef6\uff0c\u5305\u62ecmkdocs.yaml\uff0c\u8fd9\u662f\u4e3b\u914d\u7f6e\u6587\u4ef6","title":"\u521d\u59cb\u5316\u9879\u76ee"},{"location":"install/local/#_4","text":"mkdocs.yml\u91cc\u6dfb\u52a0: theme: name: material","title":"\u4fee\u6539\u4e3b\u9898"},{"location":"install/local/#_5","text":"mkdocs.yml\u91cc\u6dfb\u52a0: markdown_extensions: - admonition - codehilite: guess_lang: false linenums: false - toc: permalink: true - footnotes - meta - def_list - pymdownx.arithmatex - pymdownx.betterem: smart_enable: all - pymdownx.caret - pymdownx.critic - pymdownx.details - pymdownx.emoji: emoji_generator: !!python/name:pymdownx.emoji.to_png - pymdownx.inlinehilite - pymdownx.magiclink - pymdownx.mark - pymdownx.smartsymbols - pymdownx.superfences - pymdownx.tasklist - pymdownx.tilde [\u53ef\u9009] \u6dfb\u52a0\u767e\u5ea6\u7edf\u8ba1 [\u53ef\u9009] \u6539\u53d8\u9875\u9762\u914d\u8272 [\u63a8\u8350] \u652f\u6301\u4e2d\u6587\u641c\u7d22 \u53ef\u4ee5\u67e5\u770b\u6211\u7684mkdocs.yml\u8303\u4f8b\uff0c\u8be6\u89c1 mkdocs.yml\u8303\u4f8b","title":"\u6dfb\u52a0\u6269\u5c55"},{"location":"install/local/#mkdocs","text":"# \u5728my-project\u76ee\u5f55\u91cc\u6267\u884c mkdocs serve \u901a\u8fc7\u6d4f\u89c8\u5668\u6253\u5f00 http://127.0.0.1:8000/ \u67e5\u770b\u6548\u679c","title":"mkdocs\u670d\u52a1\u542f\u52a8"},{"location":"linux/server/certificate/tomcat.index/","text":"Tomcat\u751f\u6210https+ssl\u53cc\u5411\u8bc1\u4e66\u8ba4\u8bc1 1. \u4ecb\u7ecd \u00b6 Q: \u4ec0\u4e48\u662fhttps? A: \u767e\u5ea6\u767e\u79d1\u8db3\u591f\u89e3\u91ca\u5b83\uff1a http://baike.baidu.com/view/14121.htm 2. \u73af\u5883\u51c6\u5907 \u00b6 \u5de5\u5177\uff1akeytool \uff08java\u81ea\u5e26\u7684\u5de5\u5177\uff09 \u73af\u5883\uff1aCentOS release 6.9 jdk1.8 3. \u4e3a\u670d\u52a1\u5668\u751f\u6210\u8bc1\u4e66 \u00b6 root@lt4:/ssl# keytool -genkey -v -alias tomcat -keyalg RSA -keystore /ssl/tomcat.keystore -validity 36500 Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Re-enter new password: #\u8f93\u5165\u5bc6\u7801111111 What is your first and last name? [Unknown]: loocha What is the name of your organizational unit? [Unknown]: loocha What is the name of your organization? [Unknown]: loocha What is the name of your City or Locality? [Unknown]: js What is the name of your State or Province? [Unknown]: js What is the two-letter country code for this unit? [Unknown]: cn Is CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn correct? [no]: y Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 36,500 days for: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn Enter key password for <tomcat> (RETURN if same as keystore password): #\u8f93\u5165\u5bc6\u7801111111 [Storing /ssl/tomcat.keystore] #\u8f93\u5165\u5bc6\u7801111111 \u6ce8\u610f\u8bc1\u4e66\u6709\u6548\u671f /ssl/tomcat.keystore\u542b\u4e49\u662f\u5c06\u8bc1\u4e66\u6587\u4ef6\u7684\u4fdd\u5b58\u8def\u5f84\uff0c\u8bc1\u4e66\u6587\u4ef6\u540d\u79f0\u662ftomcat.keystore(\u53ef\u81ea\u5b9a\u4e49\u540d\u79f0)\uff1b -validity 36500 \u542b\u4e49\u662f\u8bc1\u4e66\u6709\u6548\u671f\uff0c36500\u8868\u793a100\u5e74\uff0c\u9ed8\u8ba4\u503c\u662f90\u5929\uff1b 4. \u4e3a\u5ba2\u6237\u7aef\u751f\u6210\u8bc1\u4e66 \u00b6 root@lt4:/ssl# keytool -genkey -v -alias mykey -keyalg RSA -storetype PKCS12 -keystore /ssl/client.key.p12 -validity 36500 Enter keystore password: Re-enter new password: What is your first and last name? [Unknown]: loocha What is the name of your organizational unit? [Unknown]: loocha What is the name of your organization? [Unknown]: loocha What is the name of your City or Locality? [Unknown]: js What is the name of your State or Province? [Unknown]: js What is the two-letter country code for this unit? [Unknown]: cn Is CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn correct? [no]: y Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days for: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn [Storing /ssl/client.key.p12] root@lt4:/ssl# ll total 16 drwxr-xr-x 2 root root 4096 Oct 25 13:24 ./ drwxr-xr-x 25 999 root 4096 Oct 25 13:23 ../ -rw-r--r-- 1 root root 2546 Oct 25 13:24 client.key.p12 -rw-r--r-- 1 root root 2209 Oct 25 13:24 tomcat.keystore 5. \u5ba2\u6237\u7aef\u5b89\u88c5 \u00b6 \u627e\u4e00\u4e2a\u673a\u5668\u5b89\u88c5\uff0c\u6d4f\u89c8\u5668\u8bc1\u4e66 \u67e5\u770b\u5b89\u88c5\u7684\u8bc1\u4e66,\u5f00\u59cb\uff08win+R \u5feb\u6377\u6309\u952e\uff09\u8fd0\u884c\u4e2d\u8f93\u5165certmgr.msc 6. \u8ba9\u670d\u52a1\u5668\u4fe1\u4efb\u5ba2\u6237\u7aef\u8bc1\u4e66 \u00b6 6.1 \u5ba2\u6237\u7aef\u8bc1\u4e66\u5bfc\u51fa\u4e3aCER\u6587\u4ef6 \u00b6 \u7531\u4e8e\u662f\u53cc\u5411SSL\u8ba4\u8bc1\uff0c\u670d\u52a1\u5668\u5fc5\u987b\u8981\u4fe1\u4efb\u5ba2\u6237\u7aef\u8bc1\u4e66\uff0c\u56e0\u6b64\uff0c\u5fc5\u987b\u628a\u5ba2\u6237\u7aef\u8bc1\u4e66\u6dfb\u52a0\u4e3a\u670d\u52a1\u5668\u7684\u4fe1\u4efb\u8ba4\u8bc1\u3002\u56e0\u4e0d\u80fd\u76f4\u63a5\u5c06PKCS12\u683c\u5f0f\u7684\u8bc1\u4e66\u5e93\u5bfc\u5165\u670d\u52a1\u5668\u8bc1\u4e66\u5e93\uff0c\u5c06\u5ba2\u6237\u7aef\u8bc1\u4e66\u5bfc\u51fa\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684CER\u6587\u4ef6 root@lt4:/ssl# keytool -export -alias mykey -keystore /ssl/client.key.p12 -storetype PKCS12 -storepass 111111 -rfc -file /ssl/client.key.cer Certificate stored in file </ssl/client.key.cer> \u8bc1\u4e66\u5bc6\u7801 password\u4e3a\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684\u5bc6\u7801 6.2 CER\u6587\u4ef6\u5bfc\u5165\u670d\u52a1\u5668\u8bc1\u4e66\u5e93 \u00b6 root@lt4:/ssl# keytool -import -v -file /ssl/client.key.cer -keystore /ssl/tomcat.keystore Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Owner: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn Issuer: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn Serial number: 22ec582e Valid from: Wed Oct 25 13:24:37 CST 2017 until: Tue Jan 23 13:24:37 CST 2018 Certificate fingerprints: MD5: 1C:BC:C9:7E:BA:06:1C:4F:37:78:96:3D:7B:76:5B:F8 SHA1: E9:A0:65:DB:60:B6:87:0F:60:85:47:8D:41:57:0F:FC:99:E2:6C:4E SHA256: CC:2D:B9:41:C1:70:60:F2:E6:11:B8:E5:6A:E9:1D:D9:EB:52:38:69:30:F9:8D:B2:A0:E1:9D:10:09:42:F9:EF Signature algorithm name: SHA256withRSA Version: 3 Extensions: #1: ObjectId: 2.5.29.14 Criticality=false SubjectKeyIdentifier [ KeyIdentifier [ 0000: 30 3C 89 80 90 44 88 DD 33 29 A5 3C EF 52 6C 79 0<...D..3).<.Rly 0010: 20 C4 F0 A4 ... ] ] Trust this certificate? [no]: y Certificate was added to keystore [Storing /ssl/tomcat.keystore] 7. \u68c0\u67e5 \u00b6 \u901a\u8fc7list\u547d\u4ee4\u67e5\u770b\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u5e93\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66 keytool -list -keystore /ssl/tomcat.keystore (tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d)\u3002 8. \u670d\u52a1\u5668\u7aef\u4fe1\u4efb\u5ba2\u6237\u7aef\u8bc1\u4e66 \u00b6 root@lt4:/ssl# keytool -list -keystore /ssl/tomcat.keystore Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Keystore type: JKS Keystore provider: SUN Your keystore contains 2 entries tomcat, Oct 25, 2017, PrivateKeyEntry, Certificate fingerprint (SHA1): 2E:3B:52:F3:6C:B8:E7:4E:67:F5:15:55:80:70:24:58:57:F6:79:29 mykey, Oct 25, 2017, trustedCertEntry, Certificate fingerprint (SHA1): E9:A0:65:DB:60:B6:87:0F:60:85:47:8D:41:57:0F:FC:99:E2:6C:4E 8.1 \u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3aCER\u6587\u4ef6 \u00b6 \u7531\u4e8e\u662f\u53cc\u5411SSL\u8ba4\u8bc1\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u56e0\u6b64\uff0c\u5fc5\u987b\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u6dfb\u52a0\u5230\u6d4f\u89c8\u7684\u201c\u53d7\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u201d\u3002\u7531\u4e8e\u4e0d\u80fd\u76f4\u63a5\u5c06keystore\u683c\u5f0f\u7684\u8bc1\u4e66\u5e93\u5bfc\u5165\uff0c\u5fc5\u987b\u5148\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684CER\u6587\u4ef6\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer \u8bc1\u4e66\u540d tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d root@lt4:/ssl# keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Certificate stored in file </ssl/tomcat.cer> root@lt4:/ssl# ls client.key.cer client.key.p12 tomcat.cer tomcat.keystore root@lt4:/ssl# vim README.d root@lt4:/ssl# cat README.d password=111111 8.2 \u68c0\u67e5\u7ed3\u679c \u00b6 \u901a\u8fc7list\u547d\u4ee4\u67e5\u770b\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u5e93\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66 root@lt4:/ssl# keytool -list -keystore /ssl/tomcat.keystore (tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d)\u3002 root@lt4:/ssl# keytool -list -keystore /ssl/tomcat.keystore Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Keystore type: JKS Keystore provider: SUN Your keystore contains 2 entries tomcat, Oct 25, 2017, PrivateKeyEntry, Certificate fingerprint (SHA1): 2E:3B:52:F3:6C:B8:E7:4E:67:F5:15:55:80:70:24:58:57:F6:79:29 mykey, Oct 25, 2017, trustedCertEntry, Certificate fingerprint (SHA1): E9:A0:65:DB:60:B6:87:0F:60:85:47:8D:41:57:0F:FC:99:E2:6C:4E 9. \u5ba2\u6237\u7aef\u4fe1\u4efb\u670d\u52a1\u5668\u8bc1\u4e66 \u00b6 9.1 \u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3aCER\u6587\u4ef6 \u00b6 \u7531\u4e8e\u662f\u53cc\u5411SSL\u8ba4\u8bc1\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u56e0\u6b64\uff0c\u5fc5\u987b\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u6dfb\u52a0\u5230\u6d4f\u89c8\u7684\u201c\u53d7\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u201d\u3002\u7531\u4e8e\u4e0d\u80fd\u76f4\u63a5\u5c06keystore\u683c\u5f0f\u7684\u8bc1\u4e66\u5e93\u5bfc\u5165\uff0c\u5fc5\u987b\u5148\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684CER\u6587\u4ef6\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer !!! info '\u8bc1\u4e66\u540d' tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d root@lt4:/ssl# keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Certificate stored in file </ssl/tomcat.cer> root@lt4:/ssl# ls client.key.cer client.key.p12 tomcat.cer tomcat.keystore root@lt4:/ssl# vim README.d root@lt4:/ssl# cat README.d password=111111 10. \u5728\u5ba2\u6237\u7aef\u5b89\u88c5\u670d\u52a1\u5668\u8bc1\u4e66 \u00b6 \u53cc\u51fbtomcat.cer\uff0c\u6309\u7167\u63d0\u793a\u5b89\u88c5\u8bc1\u4e66\uff0c\u5c06\u8bc1\u4e66\u586b\u5165\u5230 '\u53d7\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u9881\u53d1\u673a\u6784'\u3002 11. \u6d4f\u89c8\u5668\u68c0\u67e5 \u00b6 IE -> Internet\u9009\u9879 -> \u5185\u5bb9 -> \u8bc1\u4e66 12. tomcat\u670d\u52a1\u914d\u7f6e \u00b6 server.xml \u914d\u7f6e <?xml version='1.0' encoding='utf-8'?> <!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. --> <!-- Note: A \"Server\" is not itself a \"Container\", so you may not define subcomponents such as \"Valves\" at this level. Documentation at /docs/config/server.html --> <Server port=\"8005\" shutdown=\"SHUTDOWN\"> <Listener className=\"org.apache.catalina.startup.VersionLoggerListener\" /> <!-- Security listener. Documentation at /docs/config/listeners.html <Listener className=\"org.apache.catalina.security.SecurityListener\" /> --> <!--APR library loader. Documentation at /docs/apr.html --> <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" SSLEngine=\"on\" /> <!--Initialize Jasper prior to webapps are loaded. Documentation at /docs/jasper-howto.html --> <Listener className=\"org.apache.catalina.core.JasperListener\" /> <!-- Prevent memory leaks due to use of particular java/javax APIs--> <Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" /> <Listener className=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" /> <Listener className=\"org.apache.catalina.core.ThreadLocalLeakPreventionListener\" /> <!-- Global JNDI resources Documentation at /docs/jndi-resources-howto.html --> <GlobalNamingResources> <!-- Editable user database that can also be used by UserDatabaseRealm to authenticate users --> <Resource name=\"UserDatabase\" auth=\"Container\" type=\"org.apache.catalina.UserDatabase\" description=\"User database that can be updated and saved\" factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\" pathname=\"conf/tomcat-users.xml\" /> </GlobalNamingResources> <!-- A \"Service\" is a collection of one or more \"Connectors\" that share a single \"Container\" Note: A \"Service\" is not itself a \"Container\", so you may not define subcomponents such as \"Valves\" at this level. Documentation at /docs/config/service.html --> <Service name=\"Catalina\"> <!--The connectors can use a shared executor, you can define one or more named thread pools--> <!-- <Executor name=\"tomcatThreadPool\" namePrefix=\"catalina-exec-\" maxThreads=\"150\" minSpareThreads=\"4\"/> --> <!-- A \"Connector\" represents an endpoint by which requests are received and responses are returned. Documentation at : Java HTTP Connector: /docs/config/http.html (blocking & non-blocking) Java AJP Connector: /docs/config/ajp.html APR (HTTP/AJP) Connector: /docs/apr.html Define a non-SSL HTTP/1.1 Connector on port 8080 --> <!-- <Connector port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"20000\" redirectPort=\"8443\" /> --> <!-- A \"Connector\" using the shared thread pool--> <!-- <Connector executor=\"tomcatThreadPool\" port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"20000\" redirectPort=\"8443\" /> --> <!-- Define a SSL HTTP/1.1 Connector on port 8443 This connector uses the BIO implementation that requires the JSSE style configuration. When using the APR/native implementation, the OpenSSL style configuration is required as described in the APR/native documentation --> <Connector port=\"8443\" protocol=\"HTTP/1.1\" maxThreads=\"150\" SSLEnabled=\"true\" scheme=\"https\" secure=\"true\" clientAuth=\"true\" sslProtocol=\"TLS\" keystoreFile=\"/ssl/tomcat.keystore\" keystorePass=\"111111\" truststoreFile=\"/ssl/tomcat.keystore\" truststorePass=\"111111\" /> <!-- Define an AJP 1.3 Connector on port 8009 --> <Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" /> <!-- An Engine represents the entry point (within Catalina) that processes every request. The Engine implementation for Tomcat stand alone analyzes the HTTP headers included with the request, and passes them on to the appropriate Host (virtual host). Documentation at /docs/config/engine.html --> <!-- You should set jvmRoute to support load-balancing via AJP ie : <Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"jvm1\"> --> <Engine name=\"Catalina\" defaultHost=\"localhost\"> <!--For clustering, please take a look at documentation at: /docs/cluster-howto.html (simple how to) /docs/config/cluster.html (reference documentation) --> <!-- <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"/> --> <!-- Use the LockOutRealm to prevent attempts to guess user passwords via a brute-force attack --> <Realm className=\"org.apache.catalina.realm.LockOutRealm\"> <!-- This Realm uses the UserDatabase configured in the global JNDI resources under the key \"UserDatabase\". Any edits that are performed against this UserDatabase are immediately available for use by the Realm. --> <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\" resourceName=\"UserDatabase\"/> </Realm> <Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"true\"> <!-- SingleSignOn valve, share authentication between web applications Documentation at: /docs/config/valve.html --> <!-- <Valve className=\"org.apache.catalina.authenticator.SingleSignOn\" /> --> <!-- Access log processes all example. Documentation at: /docs/config/valve.html Note: The pattern used is equivalent to using pattern=\"common\" --> <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\" prefix=\"localhost_access_log.\" suffix=\".txt\" pattern=\"%h %l %u %t &quot;%r&quot; %s %b\" /> </Host> </Engine> </Service> </Server> \u8fd9\u91cc\uff0c\u5bc6\u7801\u548c\u8bc1\u4e66\u7684\u4f4d\u7f6e\u6839\u636e\u4e2a\u4eba\u7684\u5177\u4f53\u73af\u5883\u800c\u8bbe\u7f6e\uff0c\u5c5e\u6027\u53c2\u6570\u5982\u4e0b\u6240\u8ff0\uff1a \u53c2\u6570 \u89e3\u91ca clientAuth \u5982\u679c\u8bbe\u4e3atrue\uff0c\u8868\u793aTomcat\u8981\u6c42\u6240\u6709\u7684SSL\u5ba2\u6237\u51fa\u793a\u5b89\u5168\u8bc1\u4e66\uff0c\u5bf9SSL\u5ba2\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1 keystoreFile \u6307\u5b9akeystore\u6587\u4ef6\u7684\u5b58\u653e\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u76f8\u5bf9\u4e8e \uff08Tomcat\u5b89\u88c5\u76ee\u5f55\uff09\u73af\u5883\u53d8\u91cf \u7684\u76f8\u5bf9\u8def\u5f84\u3002\u5982\u679c\u6b64\u9879\u6ca1\u6709\u8bbe\u5b9a\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cTomcat\u5c06\u4ece\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u7684\u7528\u6237\u76ee\u5f55\u4e0b\u8bfb\u53d6\u540d\u4e3a\u201c.keystore\u201d\u7684\u6587\u4ef6\u3002 keystorePass \u6307\u5b9akeystore\u7684\u5bc6\u7801\uff0c\u5982\u679c\u6b64\u9879\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cTomcat\u5c06\u4f7f\u7528\u201cchangeit\u201d\u4f5c\u4e3a\u9ed8\u8ba4\u5bc6\u7801\u3002 sslProtocol \u6307\u5b9a\u5957\u63a5\u5b57\uff08Socket\uff09\u4f7f\u7528\u7684\u52a0\u5bc6/\u89e3\u5bc6\u534f\u8bae\uff0c\u9ed8\u8ba4\u503c\u4e3aTLS\uff0c\u7528\u6237\u4e0d\u5e94\u8be5\u4fee\u6539\u8fd9\u4e2a\u9ed8\u8ba4\u503c\u3002 ciphers \u6307\u5b9a\u5957\u63a5\u5b57\u53ef\u7528\u7684\u7528\u4e8e\u52a0\u5bc6\u7684\u5bc6\u7801\u6e05\u5355\uff0c\u591a\u4e2a\u5bc6\u7801\u95f4\u4ee5\u9017\u53f7\uff08,\uff09\u5206\u9694\u3002\u5982\u679c\u6b64\u9879\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5957\u63a5\u5b57\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u4e00\u4e2a\u53ef\u7528\u7684\u5bc6\u7801\u3002 13. \u5ba2\u670d\u7aef\u6d4b\u8bd5 \u00b6","title":"1. Tomcat"},{"location":"linux/server/certificate/tomcat.index/#1","text":"Q: \u4ec0\u4e48\u662fhttps? A: \u767e\u5ea6\u767e\u79d1\u8db3\u591f\u89e3\u91ca\u5b83\uff1a http://baike.baidu.com/view/14121.htm","title":"1. \u4ecb\u7ecd"},{"location":"linux/server/certificate/tomcat.index/#2","text":"\u5de5\u5177\uff1akeytool \uff08java\u81ea\u5e26\u7684\u5de5\u5177\uff09 \u73af\u5883\uff1aCentOS release 6.9 jdk1.8","title":"2. \u73af\u5883\u51c6\u5907"},{"location":"linux/server/certificate/tomcat.index/#3","text":"root@lt4:/ssl# keytool -genkey -v -alias tomcat -keyalg RSA -keystore /ssl/tomcat.keystore -validity 36500 Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Re-enter new password: #\u8f93\u5165\u5bc6\u7801111111 What is your first and last name? [Unknown]: loocha What is the name of your organizational unit? [Unknown]: loocha What is the name of your organization? [Unknown]: loocha What is the name of your City or Locality? [Unknown]: js What is the name of your State or Province? [Unknown]: js What is the two-letter country code for this unit? [Unknown]: cn Is CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn correct? [no]: y Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 36,500 days for: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn Enter key password for <tomcat> (RETURN if same as keystore password): #\u8f93\u5165\u5bc6\u7801111111 [Storing /ssl/tomcat.keystore] #\u8f93\u5165\u5bc6\u7801111111 \u6ce8\u610f\u8bc1\u4e66\u6709\u6548\u671f /ssl/tomcat.keystore\u542b\u4e49\u662f\u5c06\u8bc1\u4e66\u6587\u4ef6\u7684\u4fdd\u5b58\u8def\u5f84\uff0c\u8bc1\u4e66\u6587\u4ef6\u540d\u79f0\u662ftomcat.keystore(\u53ef\u81ea\u5b9a\u4e49\u540d\u79f0)\uff1b -validity 36500 \u542b\u4e49\u662f\u8bc1\u4e66\u6709\u6548\u671f\uff0c36500\u8868\u793a100\u5e74\uff0c\u9ed8\u8ba4\u503c\u662f90\u5929\uff1b","title":"3. \u4e3a\u670d\u52a1\u5668\u751f\u6210\u8bc1\u4e66"},{"location":"linux/server/certificate/tomcat.index/#4","text":"root@lt4:/ssl# keytool -genkey -v -alias mykey -keyalg RSA -storetype PKCS12 -keystore /ssl/client.key.p12 -validity 36500 Enter keystore password: Re-enter new password: What is your first and last name? [Unknown]: loocha What is the name of your organizational unit? [Unknown]: loocha What is the name of your organization? [Unknown]: loocha What is the name of your City or Locality? [Unknown]: js What is the name of your State or Province? [Unknown]: js What is the two-letter country code for this unit? [Unknown]: cn Is CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn correct? [no]: y Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days for: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn [Storing /ssl/client.key.p12] root@lt4:/ssl# ll total 16 drwxr-xr-x 2 root root 4096 Oct 25 13:24 ./ drwxr-xr-x 25 999 root 4096 Oct 25 13:23 ../ -rw-r--r-- 1 root root 2546 Oct 25 13:24 client.key.p12 -rw-r--r-- 1 root root 2209 Oct 25 13:24 tomcat.keystore","title":"4. \u4e3a\u5ba2\u6237\u7aef\u751f\u6210\u8bc1\u4e66"},{"location":"linux/server/certificate/tomcat.index/#5","text":"\u627e\u4e00\u4e2a\u673a\u5668\u5b89\u88c5\uff0c\u6d4f\u89c8\u5668\u8bc1\u4e66 \u67e5\u770b\u5b89\u88c5\u7684\u8bc1\u4e66,\u5f00\u59cb\uff08win+R \u5feb\u6377\u6309\u952e\uff09\u8fd0\u884c\u4e2d\u8f93\u5165certmgr.msc","title":"5. \u5ba2\u6237\u7aef\u5b89\u88c5"},{"location":"linux/server/certificate/tomcat.index/#6","text":"","title":"6. \u8ba9\u670d\u52a1\u5668\u4fe1\u4efb\u5ba2\u6237\u7aef\u8bc1\u4e66"},{"location":"linux/server/certificate/tomcat.index/#61-cer","text":"\u7531\u4e8e\u662f\u53cc\u5411SSL\u8ba4\u8bc1\uff0c\u670d\u52a1\u5668\u5fc5\u987b\u8981\u4fe1\u4efb\u5ba2\u6237\u7aef\u8bc1\u4e66\uff0c\u56e0\u6b64\uff0c\u5fc5\u987b\u628a\u5ba2\u6237\u7aef\u8bc1\u4e66\u6dfb\u52a0\u4e3a\u670d\u52a1\u5668\u7684\u4fe1\u4efb\u8ba4\u8bc1\u3002\u56e0\u4e0d\u80fd\u76f4\u63a5\u5c06PKCS12\u683c\u5f0f\u7684\u8bc1\u4e66\u5e93\u5bfc\u5165\u670d\u52a1\u5668\u8bc1\u4e66\u5e93\uff0c\u5c06\u5ba2\u6237\u7aef\u8bc1\u4e66\u5bfc\u51fa\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684CER\u6587\u4ef6 root@lt4:/ssl# keytool -export -alias mykey -keystore /ssl/client.key.p12 -storetype PKCS12 -storepass 111111 -rfc -file /ssl/client.key.cer Certificate stored in file </ssl/client.key.cer> \u8bc1\u4e66\u5bc6\u7801 password\u4e3a\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684\u5bc6\u7801","title":"6.1 \u5ba2\u6237\u7aef\u8bc1\u4e66\u5bfc\u51fa\u4e3aCER\u6587\u4ef6"},{"location":"linux/server/certificate/tomcat.index/#62-cer","text":"root@lt4:/ssl# keytool -import -v -file /ssl/client.key.cer -keystore /ssl/tomcat.keystore Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Owner: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn Issuer: CN=loocha, OU=loocha, O=loocha, L=js, ST=js, C=cn Serial number: 22ec582e Valid from: Wed Oct 25 13:24:37 CST 2017 until: Tue Jan 23 13:24:37 CST 2018 Certificate fingerprints: MD5: 1C:BC:C9:7E:BA:06:1C:4F:37:78:96:3D:7B:76:5B:F8 SHA1: E9:A0:65:DB:60:B6:87:0F:60:85:47:8D:41:57:0F:FC:99:E2:6C:4E SHA256: CC:2D:B9:41:C1:70:60:F2:E6:11:B8:E5:6A:E9:1D:D9:EB:52:38:69:30:F9:8D:B2:A0:E1:9D:10:09:42:F9:EF Signature algorithm name: SHA256withRSA Version: 3 Extensions: #1: ObjectId: 2.5.29.14 Criticality=false SubjectKeyIdentifier [ KeyIdentifier [ 0000: 30 3C 89 80 90 44 88 DD 33 29 A5 3C EF 52 6C 79 0<...D..3).<.Rly 0010: 20 C4 F0 A4 ... ] ] Trust this certificate? [no]: y Certificate was added to keystore [Storing /ssl/tomcat.keystore]","title":"6.2 CER\u6587\u4ef6\u5bfc\u5165\u670d\u52a1\u5668\u8bc1\u4e66\u5e93"},{"location":"linux/server/certificate/tomcat.index/#7","text":"\u901a\u8fc7list\u547d\u4ee4\u67e5\u770b\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u5e93\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66 keytool -list -keystore /ssl/tomcat.keystore (tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d)\u3002","title":"7. \u68c0\u67e5"},{"location":"linux/server/certificate/tomcat.index/#8","text":"root@lt4:/ssl# keytool -list -keystore /ssl/tomcat.keystore Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Keystore type: JKS Keystore provider: SUN Your keystore contains 2 entries tomcat, Oct 25, 2017, PrivateKeyEntry, Certificate fingerprint (SHA1): 2E:3B:52:F3:6C:B8:E7:4E:67:F5:15:55:80:70:24:58:57:F6:79:29 mykey, Oct 25, 2017, trustedCertEntry, Certificate fingerprint (SHA1): E9:A0:65:DB:60:B6:87:0F:60:85:47:8D:41:57:0F:FC:99:E2:6C:4E","title":"8. \u670d\u52a1\u5668\u7aef\u4fe1\u4efb\u5ba2\u6237\u7aef\u8bc1\u4e66"},{"location":"linux/server/certificate/tomcat.index/#81-cer","text":"\u7531\u4e8e\u662f\u53cc\u5411SSL\u8ba4\u8bc1\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u56e0\u6b64\uff0c\u5fc5\u987b\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u6dfb\u52a0\u5230\u6d4f\u89c8\u7684\u201c\u53d7\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u201d\u3002\u7531\u4e8e\u4e0d\u80fd\u76f4\u63a5\u5c06keystore\u683c\u5f0f\u7684\u8bc1\u4e66\u5e93\u5bfc\u5165\uff0c\u5fc5\u987b\u5148\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684CER\u6587\u4ef6\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer \u8bc1\u4e66\u540d tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d root@lt4:/ssl# keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Certificate stored in file </ssl/tomcat.cer> root@lt4:/ssl# ls client.key.cer client.key.p12 tomcat.cer tomcat.keystore root@lt4:/ssl# vim README.d root@lt4:/ssl# cat README.d password=111111","title":"8.1 \u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3aCER\u6587\u4ef6"},{"location":"linux/server/certificate/tomcat.index/#82","text":"\u901a\u8fc7list\u547d\u4ee4\u67e5\u770b\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u5e93\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u4e00\u4e2a\u662f\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66 root@lt4:/ssl# keytool -list -keystore /ssl/tomcat.keystore (tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d)\u3002 root@lt4:/ssl# keytool -list -keystore /ssl/tomcat.keystore Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Keystore type: JKS Keystore provider: SUN Your keystore contains 2 entries tomcat, Oct 25, 2017, PrivateKeyEntry, Certificate fingerprint (SHA1): 2E:3B:52:F3:6C:B8:E7:4E:67:F5:15:55:80:70:24:58:57:F6:79:29 mykey, Oct 25, 2017, trustedCertEntry, Certificate fingerprint (SHA1): E9:A0:65:DB:60:B6:87:0F:60:85:47:8D:41:57:0F:FC:99:E2:6C:4E","title":"8.2 \u68c0\u67e5\u7ed3\u679c"},{"location":"linux/server/certificate/tomcat.index/#9","text":"","title":"9. \u5ba2\u6237\u7aef\u4fe1\u4efb\u670d\u52a1\u5668\u8bc1\u4e66"},{"location":"linux/server/certificate/tomcat.index/#91-cer","text":"\u7531\u4e8e\u662f\u53cc\u5411SSL\u8ba4\u8bc1\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u56e0\u6b64\uff0c\u5fc5\u987b\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u6dfb\u52a0\u5230\u6d4f\u89c8\u7684\u201c\u53d7\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u201d\u3002\u7531\u4e8e\u4e0d\u80fd\u76f4\u63a5\u5c06keystore\u683c\u5f0f\u7684\u8bc1\u4e66\u5e93\u5bfc\u5165\uff0c\u5fc5\u987b\u5148\u628a\u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684CER\u6587\u4ef6\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer !!! info '\u8bc1\u4e66\u540d' tomcat\u4e3a\u4f60\u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u7684\u8bc1\u4e66\u540d root@lt4:/ssl# keytool -keystore /ssl/tomcat.keystore -export -alias tomcat -file /ssl/tomcat.cer Enter keystore password: #\u8f93\u5165\u5bc6\u7801111111 Certificate stored in file </ssl/tomcat.cer> root@lt4:/ssl# ls client.key.cer client.key.p12 tomcat.cer tomcat.keystore root@lt4:/ssl# vim README.d root@lt4:/ssl# cat README.d password=111111","title":"9.1 \u670d\u52a1\u5668\u8bc1\u4e66\u5bfc\u51fa\u4e3aCER\u6587\u4ef6"},{"location":"linux/server/certificate/tomcat.index/#10","text":"\u53cc\u51fbtomcat.cer\uff0c\u6309\u7167\u63d0\u793a\u5b89\u88c5\u8bc1\u4e66\uff0c\u5c06\u8bc1\u4e66\u586b\u5165\u5230 '\u53d7\u4fe1\u4efb\u7684\u6839\u8bc1\u4e66\u9881\u53d1\u673a\u6784'\u3002","title":"10. \u5728\u5ba2\u6237\u7aef\u5b89\u88c5\u670d\u52a1\u5668\u8bc1\u4e66"},{"location":"linux/server/certificate/tomcat.index/#11","text":"IE -> Internet\u9009\u9879 -> \u5185\u5bb9 -> \u8bc1\u4e66","title":"11. \u6d4f\u89c8\u5668\u68c0\u67e5"},{"location":"linux/server/certificate/tomcat.index/#12-tomcat","text":"server.xml \u914d\u7f6e <?xml version='1.0' encoding='utf-8'?> <!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. --> <!-- Note: A \"Server\" is not itself a \"Container\", so you may not define subcomponents such as \"Valves\" at this level. Documentation at /docs/config/server.html --> <Server port=\"8005\" shutdown=\"SHUTDOWN\"> <Listener className=\"org.apache.catalina.startup.VersionLoggerListener\" /> <!-- Security listener. Documentation at /docs/config/listeners.html <Listener className=\"org.apache.catalina.security.SecurityListener\" /> --> <!--APR library loader. Documentation at /docs/apr.html --> <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" SSLEngine=\"on\" /> <!--Initialize Jasper prior to webapps are loaded. Documentation at /docs/jasper-howto.html --> <Listener className=\"org.apache.catalina.core.JasperListener\" /> <!-- Prevent memory leaks due to use of particular java/javax APIs--> <Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" /> <Listener className=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" /> <Listener className=\"org.apache.catalina.core.ThreadLocalLeakPreventionListener\" /> <!-- Global JNDI resources Documentation at /docs/jndi-resources-howto.html --> <GlobalNamingResources> <!-- Editable user database that can also be used by UserDatabaseRealm to authenticate users --> <Resource name=\"UserDatabase\" auth=\"Container\" type=\"org.apache.catalina.UserDatabase\" description=\"User database that can be updated and saved\" factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\" pathname=\"conf/tomcat-users.xml\" /> </GlobalNamingResources> <!-- A \"Service\" is a collection of one or more \"Connectors\" that share a single \"Container\" Note: A \"Service\" is not itself a \"Container\", so you may not define subcomponents such as \"Valves\" at this level. Documentation at /docs/config/service.html --> <Service name=\"Catalina\"> <!--The connectors can use a shared executor, you can define one or more named thread pools--> <!-- <Executor name=\"tomcatThreadPool\" namePrefix=\"catalina-exec-\" maxThreads=\"150\" minSpareThreads=\"4\"/> --> <!-- A \"Connector\" represents an endpoint by which requests are received and responses are returned. Documentation at : Java HTTP Connector: /docs/config/http.html (blocking & non-blocking) Java AJP Connector: /docs/config/ajp.html APR (HTTP/AJP) Connector: /docs/apr.html Define a non-SSL HTTP/1.1 Connector on port 8080 --> <!-- <Connector port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"20000\" redirectPort=\"8443\" /> --> <!-- A \"Connector\" using the shared thread pool--> <!-- <Connector executor=\"tomcatThreadPool\" port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"20000\" redirectPort=\"8443\" /> --> <!-- Define a SSL HTTP/1.1 Connector on port 8443 This connector uses the BIO implementation that requires the JSSE style configuration. When using the APR/native implementation, the OpenSSL style configuration is required as described in the APR/native documentation --> <Connector port=\"8443\" protocol=\"HTTP/1.1\" maxThreads=\"150\" SSLEnabled=\"true\" scheme=\"https\" secure=\"true\" clientAuth=\"true\" sslProtocol=\"TLS\" keystoreFile=\"/ssl/tomcat.keystore\" keystorePass=\"111111\" truststoreFile=\"/ssl/tomcat.keystore\" truststorePass=\"111111\" /> <!-- Define an AJP 1.3 Connector on port 8009 --> <Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" /> <!-- An Engine represents the entry point (within Catalina) that processes every request. The Engine implementation for Tomcat stand alone analyzes the HTTP headers included with the request, and passes them on to the appropriate Host (virtual host). Documentation at /docs/config/engine.html --> <!-- You should set jvmRoute to support load-balancing via AJP ie : <Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"jvm1\"> --> <Engine name=\"Catalina\" defaultHost=\"localhost\"> <!--For clustering, please take a look at documentation at: /docs/cluster-howto.html (simple how to) /docs/config/cluster.html (reference documentation) --> <!-- <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"/> --> <!-- Use the LockOutRealm to prevent attempts to guess user passwords via a brute-force attack --> <Realm className=\"org.apache.catalina.realm.LockOutRealm\"> <!-- This Realm uses the UserDatabase configured in the global JNDI resources under the key \"UserDatabase\". Any edits that are performed against this UserDatabase are immediately available for use by the Realm. --> <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\" resourceName=\"UserDatabase\"/> </Realm> <Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"true\"> <!-- SingleSignOn valve, share authentication between web applications Documentation at: /docs/config/valve.html --> <!-- <Valve className=\"org.apache.catalina.authenticator.SingleSignOn\" /> --> <!-- Access log processes all example. Documentation at: /docs/config/valve.html Note: The pattern used is equivalent to using pattern=\"common\" --> <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\" prefix=\"localhost_access_log.\" suffix=\".txt\" pattern=\"%h %l %u %t &quot;%r&quot; %s %b\" /> </Host> </Engine> </Service> </Server> \u8fd9\u91cc\uff0c\u5bc6\u7801\u548c\u8bc1\u4e66\u7684\u4f4d\u7f6e\u6839\u636e\u4e2a\u4eba\u7684\u5177\u4f53\u73af\u5883\u800c\u8bbe\u7f6e\uff0c\u5c5e\u6027\u53c2\u6570\u5982\u4e0b\u6240\u8ff0\uff1a \u53c2\u6570 \u89e3\u91ca clientAuth \u5982\u679c\u8bbe\u4e3atrue\uff0c\u8868\u793aTomcat\u8981\u6c42\u6240\u6709\u7684SSL\u5ba2\u6237\u51fa\u793a\u5b89\u5168\u8bc1\u4e66\uff0c\u5bf9SSL\u5ba2\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1 keystoreFile \u6307\u5b9akeystore\u6587\u4ef6\u7684\u5b58\u653e\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u76f8\u5bf9\u4e8e \uff08Tomcat\u5b89\u88c5\u76ee\u5f55\uff09\u73af\u5883\u53d8\u91cf \u7684\u76f8\u5bf9\u8def\u5f84\u3002\u5982\u679c\u6b64\u9879\u6ca1\u6709\u8bbe\u5b9a\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cTomcat\u5c06\u4ece\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u7684\u7528\u6237\u76ee\u5f55\u4e0b\u8bfb\u53d6\u540d\u4e3a\u201c.keystore\u201d\u7684\u6587\u4ef6\u3002 keystorePass \u6307\u5b9akeystore\u7684\u5bc6\u7801\uff0c\u5982\u679c\u6b64\u9879\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cTomcat\u5c06\u4f7f\u7528\u201cchangeit\u201d\u4f5c\u4e3a\u9ed8\u8ba4\u5bc6\u7801\u3002 sslProtocol \u6307\u5b9a\u5957\u63a5\u5b57\uff08Socket\uff09\u4f7f\u7528\u7684\u52a0\u5bc6/\u89e3\u5bc6\u534f\u8bae\uff0c\u9ed8\u8ba4\u503c\u4e3aTLS\uff0c\u7528\u6237\u4e0d\u5e94\u8be5\u4fee\u6539\u8fd9\u4e2a\u9ed8\u8ba4\u503c\u3002 ciphers \u6307\u5b9a\u5957\u63a5\u5b57\u53ef\u7528\u7684\u7528\u4e8e\u52a0\u5bc6\u7684\u5bc6\u7801\u6e05\u5355\uff0c\u591a\u4e2a\u5bc6\u7801\u95f4\u4ee5\u9017\u53f7\uff08,\uff09\u5206\u9694\u3002\u5982\u679c\u6b64\u9879\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5957\u63a5\u5b57\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u4e00\u4e2a\u53ef\u7528\u7684\u5bc6\u7801\u3002","title":"12. tomcat\u670d\u52a1\u914d\u7f6e"},{"location":"linux/server/certificate/tomcat.index/#13","text":"","title":"13. \u5ba2\u670d\u7aef\u6d4b\u8bd5"},{"location":"linux/server/deploy_django/deploy_django.index/","text":"Django\u9879\u76ee\u90e8\u7f72 1. \u4ecb\u7ecd \u00b6 uWSGI\u662f\u4e00\u4e2aWeb\u670d\u52a1\u5668\uff0c\u5b83\u5b9e\u73b0\u4e86WSGI\u534f\u8bae\u3001uwsgi\u3001http\u7b49\u534f\u8bae\u3002Nginx\u4e2dHttpUwsgiModule\u7684\u4f5c\u7528\u662f\u4e0euWSGI\u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u6362\u3002 \u8981\u6ce8\u610f WSGI / uwsgi / uWSGI \u8fd9\u4e09\u4e2a\u6982\u5ff5\u7684\u533a\u5206\u3002 WSGI\u662f\u4e00\u79cdWeb\u670d\u52a1\u5668\u7f51\u5173\u63a5\u53e3\u3002\u5b83\u662f\u4e00\u4e2aWeb\u670d\u52a1\u5668\uff08\u5982nginx\uff0cuWSGI\u7b49\u670d\u52a1\u5668\uff09\u4e0eweb\u5e94\u7528\uff08\u5982\u7528Flask\u6846\u67b6\u5199\u7684\u7a0b\u5e8f\uff09\u901a\u4fe1\u7684\u4e00\u79cd\u89c4\u8303\u3002 uwsgi\u662f\u4e00\u79cd\u7ebf\u8def\u534f\u8bae\u800c\u4e0d\u662f\u901a\u4fe1\u534f\u8bae\uff0c\u5728\u6b64\u5e38\u7528\u4e8e\u5728uWSGI\u670d\u52a1\u5668\u4e0e\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u5668\u7684\u6570\u636e\u901a\u4fe1\u3002\u800cuWSGI\u662f\u5b9e\u73b0\u4e86uwsgi\u548cWSGI\u4e24\u79cd\u534f\u8bae\u7684Web\u670d\u52a1\u5668\u3002 uwsgi\u534f\u8bae\u662f\u4e00\u4e2auWSGI\u670d\u52a1\u5668\u81ea\u6709\u7684\u534f\u8bae\uff0c\u5b83\u7528\u4e8e\u5b9a\u4e49\u4f20\u8f93\u4fe1\u606f\u7684\u7c7b\u578b\uff08type of information\uff09\uff0c\u6bcf\u4e00\u4e2auwsgi packet\u524d4byte\u4e3a\u4f20\u8f93\u4fe1\u606f\u7c7b\u578b\u63cf\u8ff0\uff0c\u5b83\u4e0eWSGI\u76f8\u6bd4\u662f\u4e24\u6837\u4e1c\u897f\u3002 2. \u539f\u7406 \u00b6 \u9996\u5148\u5ba2\u6237\u7aef\u8bf7\u6c42\u670d\u52a1\u8d44\u6e90\uff0c nginx\u4f5c\u4e3a\u76f4\u63a5\u5bf9\u5916\u7684\u670d\u52a1\u63a5\u53e3,\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u9001\u8fc7\u6765\u7684http\u8bf7\u6c42,\u4f1a\u89e3\u5305\u3001\u5206\u6790\uff0c \u5982\u679c\u662f\u9759\u6001\u6587\u4ef6\u8bf7\u6c42\u5c31\u6839\u636enginx\u914d\u7f6e\u7684\u9759\u6001\u6587\u4ef6\u76ee\u5f55\uff0c\u8fd4\u56de\u8bf7\u6c42\u7684\u8d44\u6e90\uff0c \u5982\u679c\u662f\u52a8\u6001\u7684\u8bf7\u6c42,nginx\u5c31\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6,\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9uWSGI\uff1buWSGI \u5c06\u63a5\u6536\u5230\u7684\u5305\u8fdb\u884c\u5904\u7406\uff0c\u5e76\u8f6c\u53d1\u7ed9wsgi\uff0c wsgi\u6839\u636e\u8bf7\u6c42\u8c03\u7528django\u5de5\u7a0b\u7684\u67d0\u4e2a\u6587\u4ef6\u6216\u51fd\u6570\uff0c\u5904\u7406\u5b8c\u540edjango\u5c06\u8fd4\u56de\u503c\u4ea4\u7ed9wsgi\uff0c wsgi\u5c06\u8fd4\u56de\u503c\u8fdb\u884c\u6253\u5305\uff0c\u8f6c\u53d1\u7ed9uWSGI\uff0c uWSGI\u63a5\u6536\u540e\u8f6c\u53d1\u7ed9nginx,nginx\u6700\u7ec8\u5c06\u8fd4\u56de\u503c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef(\u5982\u6d4f\u89c8\u5668)\u3002 3. windows\u7aef\u64cd\u4f5c \u00b6 3.1 \u9879\u76ee\u6253\u5305 \u00b6 3.2 \u5bfc\u51fa\u4f9d\u8d56 \u00b6 pip freeze > requirements.txt \uff08windows\u6211\u6d4b\u8bd5\u5931\u8d25\u3002\u6211\u76f4\u63a5pip list \u7136\u540e\u7f16\u8f91\u6587\u4ef6\u5230 requirements.txt\uff09 \u683c\u5f0f\u5982\u4e0b\uff1a (venv) [root@leco bookms]# cat requirements.txt asn1crypto==0.24.0 cffi==1.11.5 cryptography==2.4.2 Django==2.1.4 idna==2.8 pycparser==2.19 PyMySQL==0.9.2 pytz==2018.7 setuptools==39.1.0 six==1.12.0 3.3 \u4e0a\u4f20\u5230\u670d\u52a1\u5668 \u00b6 \u6700\u597d\u662f\u653e\u5728nginx\u7684\u6307\u5b9a\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u6211\u653e\u5728\u4e86\u5982\u4e0b\u8def\u5f84\u3002 (venv) [root@leco bookms]# pwd /usr/share/nginx/html/bookms 4. Linux\u7aef\u64cd\u4f5c \u00b6 4.1 \u5b89\u88c5nginx \u00b6 ubuntu \u7cfb\u7edf [root@leco etc]# apt-get install nginx centos\u7cfb\u7edf [root@leco etc]# yum install nginx 4.2 \u5b89\u88c5python \u00b6 4.2.1 \u4e0b\u8f7d \u00b6 [root@leco ~]# wget https://www.python.org/ftp/python/3.7.1/Python-3.7.1.tgz 4.2.2 \u89e3\u538b \u00b6 [root@leco ~]# tar xf Python-3.7.1.tgz 4.2.2 \u7f16\u8bd1\u5b89\u88c5 \u00b6 [root@leco ~]# cd Python-3.7.1 [root@leco Python-3.7.1]# ./configure && make && make install 4.2.3 \u6d4b\u8bd5 \u00b6 [root@leco Python-3.7.1]# python3 -V Python 3.7.1 [root@leco Python-3.7.1]# pip3 -V pip 10.0.1 from /usr/local/lib/python3.7/site-packages/pip (python 3.7) 4.3 \u5b89\u88c5\u865a\u62df\u73af\u5883 \u00b6 [root@leco Python-3.7.1]# pip3 install virtualenv 4.4 \u865a\u62df\u73af\u5883 \u00b6 \u627e\u5230\u9879\u76ee\u7684\u6839\u76ee\u5f55\uff0c\u5220\u9664windows\u81ea\u5e26\u7684\u865a\u62df\u73af\u5883\uff0c\u91cd\u65b0\u521b\u5efa\u548c\u5b89\u88c5\u5305 [root@leco bookms]# ls book bookms_02 db.sqlite3 manage.py requirements.txt static templates venv \u5220\u9664windows\u7684\u865a\u62df\u73af\u5883\uff0c\u82e5\u662f\u672c\u8eab\u5728linux\u4e0a\u7684\u5c31\u4e0d\u7528\u5220\u9664\u3002Windows\u7684\u6709\u70b9\u95ee\u9898 [root@leco bookms]# rm -rf venv [root@leco bookms]# virtualenv venv \u8fdb\u5165\u865a\u62df\u73af\u5883\uff0c\u6b64\u65f6\u5b89\u88c5\u7684\u5305\u90fd\u662f\u5728\u672c\u9879\u76ee\u7684\u865a\u62df\u73af\u5883\u4e2d\u3002 [root@cairui bookms]# source venv/bin/activate (venv) [root@cairui bookms]# \u8fdb\u5165\u865a\u62df\u73af\u5883\u540e\u524d\u9762\u4f1a\u591a(venv),(venv)\u662f\u865a\u62df\u73af\u5883\u7684\u540d\u5b57\u3002 (venv) [root@leco bookms]# pip install -r requirements.txt (venv) [root@leco bookms]# pip list Package Version ------------ ------- asn1crypto 0.24.0 cffi 1.11.5 cryptography 2.4.2 Django 2.1.4 idna 2.8 pip 18.1 pycparser 2.19 PyMySQL 0.9.2 pytz 2018.7 setuptools 39.1.0 six 1.12.0 wheel 0.32.3 5. \u914d\u7f6e \u00b6 5.1 \u8bbf\u95ee\u8bbe\u7f6e \u00b6 (venv) [root@leco bookms]# vim bookms_02/settings.py ALLOWED_HOSTS = ['*'] \u5730\u5740\u9650\u5236 \u661f\u53f7\u8868\u793a\u4e0d\u9650\u5236\u8bbf\u95ee\u7684IP\u5730\u5740 5.2 \u6570\u636e\u914d\u7f6e \u00b6 (venv) [root@leco bookms]# vim bookms_02/settings.py DATABASES = { 'default': { 'ENGINE': 'django.db.backends.mysql', 'NAME': 'book_orm', 'USER':'root', 'PASSWORD':'root', 'HOST':'127.0.0.1', 'PORT':'3306', } } \u914d\u7f6e\u53c2\u6570\u8be6\u89e3 'ENGINE' : 'django.db.backends.mysql' , \u4f7f\u7528 mysql\u6570\u636e\u5e93 'NAME' : 'book_orm' , \u6307\u5b9a\u6570\u636e\u5e93\u540d\uff0c\u9700\u8981\u624b\u52a8\u5148\u521b\u5efa 'USER' : 'root' , \u6570\u636e\u5e93\u767b\u5f55\u7528\u6237\u540d 'PASSWORD' : 'root' , \u6570\u636e\u5e93\u767b\u5f55\u7528\u6237\u540d\u5bf9\u5e94\u7684\u5bc6\u7801 'HOST' : '127.0.0.1' , mysql\u6570\u636e\u5e93\u7684IP\u5730\u5740 \u3002 'PORT' : '3306' , mysql\u7aef\u53e3 6.\u521b\u5efa\u6570\u636e\u5e93 \u00b6 6.1 \u521b\u5efa\u6570\u636e\u5e93 \u00b6 [root@leco Python-3.7.1]# mysql -uroot -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 4 Server version: 5.6.42 MySQL Community Server (GPL) Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> create database book_orm DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; 6.2 \u6570\u636e\u8fc1\u79fb \u00b6 \u6570\u636e\u8868\u521b\u5efa (venv) [root@leco bookms]# ls book bookms_02 db.sqlite3 manage.py requirements.txt static templates venv (venv) [root@leco bookms]# python3 manage.py makemigrations (venv) [root@leco bookms]# python3 manage.py migrate \u533a\u522b python manage . py makemigrations makemigrations\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2amigrations\u6587\u4ef6\u5939 \uff0c\u8be5\u6587\u4ef6\u5939\u7684\u5185\u5bb9\u5c31\u662f\u6570\u636e\u5e93\u8981\u6267\u884c\u7684\u5185\u5bb9 python manage . py migrate migrate\u5c31\u662f\u6267\u884c\u4e4b\u524d\u751f\u6210\u7684migrations\u6587\u4ef6 \uff0c\u8fd9\u4e00\u6b65\u624d\u662f\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u4e00\u6b65 6.3 \u6d4b\u8bd5 \u00b6 (venv) [root@leco bookms]# python3 manage.py runserver 0.0.0.0:7000 Performing system checks... System check identified no issues (0 silenced). (0.000) SELECT @@SQL_AUTO_IS_NULL; args=None (0.000) SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED; args=None (0.001) SHOW FULL TABLES; args=None (0.003) SELECT `django_migrations`.`app`, `django_migrations`.`name` FROM `django_migrations`; args=() December 24, 2018 - 07:16:02 Django version 2.1.4, using settings 'bookms_02.settings' Starting development server at http://0.0.0.0:7000/ Quit the server with CONTROL-C. \u65b0\u5f00\u4e00\u4e2a\u7ec8\u7aef\u6d4b\u8bd5 [root@leco Python-3.7.1]# curl 127.0.0.1:7000 <!DOCTYPE html> <html lang=\"en\"> <head> <meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\"> <title>Page not found at /</title> <meta name=\"robots\" content=\"NONE,NOARCHIVE\"> <style type=\"text/css\"> html * { padding:0; margin:0; } body * { padding:10px 20px; } body * * { padding:0; } body { font:small sans-serif; background:#eee; color:#000; } body>div { border-bottom:1px solid #ddd; } h1 { font-weight:normal; margin-bottom:.4em; } h1 span { font-size:60%; color:#666; font-weight:normal; } table { border:none; border-collapse: collapse; width:100%; } td, th { vertical-align:top; padding:2px 3px; } th { width:12em; text-align:right; color:#666; padding-right:.5em; } #info { background:#f6f6f6; } #info ol { margin: 0.5em 4em; } #info ol li { font-family: monospace; } #summary { background: #ffc; } #explanation { background:#eee; border-bottom: 0px none; } </style> </head> <body> <div id=\"summary\"> <h1>Page not found <span>(404)</span></h1> <table class=\"meta\"> <tr> <th>Request Method:</th> <td>GET</td> </tr> <tr> <th>Request URL:</th> <td>http://127.0.0.1:7000/</td> </tr> </table> </div> <div id=\"info\"> <p> Using the URLconf defined in <code>bookms_02.urls</code>, Django tried these URL patterns, in this order: </p> <ol> <li> admin/ </li> <li> books/add/$ </li> <li> books/$ </li> <li> books/(\\d+)/change </li> <li> books/(\\d+)/delete </li> </ol> <p> The empty path didn't match any of these. </p> </div> <div id=\"explanation\"> <p> You're seeing this error because you have <code>DEBUG = True</code> in your Django settings file. Change that to <code>False</code>, and Django will display a standard 404 page. </p> </div> </body> </html> \u4ee5\u4e0a\u6d4b\u8bd5OK\u3002 6.4 \u521b\u5efa\u914d\u7f6e\u6587\u4ef6 \u00b6 (venv) [root@leco bookms]# mkdir conf (venv) [root@leco bookms]# mv bookms.conf socket.xml uwsgi.ini uwsgi_params conf/ (venv) [root@leco conf]# cat bookms.conf upstream django { # server unix:///path/to/your/mysite/mysite.sock; # for a file socket # \u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u7684\u7aef\u53e3 server 127.0.0.1:8000; # for a web port socket (we'll use this first) } server{ listen 80; server_name localhost; charset utf-8; access_log off; location /static { alias /usr/share/nginx/html/bookms/static; # \u8981\u4e0e\u4e4b\u524ddjango\u7684setting.py\u4e2d\u6dfb\u52a0\u7684static\u9759\u6001\u6587\u4ef6\u8f6c\u79fb\u76ee\u5f55\u4e00\u81f4 } location / { uwsgi_pass django; include /usr/share/nginx/html/bookms/conf/uwsgi_params; } } (venv) [root@leco conf]# cat socket.xml <uwsgi> <socket>:8000</socket> <chdir>/usr/share/nginx/html/HelloWorld</chdir> <module>hello.wsgi</module> <processes>4</processes> <!-- \u8fdb\u7a0b\u6570 --> <daemonize>uwsgi.log</daemonize> </uwsgi> (venv) [root@leco conf]# cat uwsgi.ini [uwsgi] # Django-related settings # Django\u9879\u76ee\u672c\u5730\u7aef\u53e3 socket = :8000 # \u9879\u76ee\u6839\u76ee\u5f55\u4f4d\u7f6e chdir = /usr/share/nginx/html/bookms # wsgi.py\u6587\u4ef6\u5728\u9879\u76ee\u7684\u4e2d\u7684\u76f8\u5bf9\u4f4d\u7f6e wsgi-file = /usr/share/nginx/html/bookms/bookms_02/wsgi.py module =bookms.wsgi # \u8fdb\u7a0b\u8bbe\u7f6e\uff0c\u65e0\u9700\u53d8\u52a8 # master master = true # maximum number of worker processes # \u542f\u52a84\u4e2auwsgi\u8fdb\u7a0b processes = 4 # ... with appropriate permissions - may be needed # chmod-socket = 664 # clear environment on exit vacuum = true pidfile=uwsgi.pid daemonize=uwsgi.log (venv) [root@leco conf]# cat uwsgi_params # \u8fd9\u4e2a\u662f\u56fa\u5b9a\u7684\u6587\u4ef6\uff0c uwsgi_param QUERY_STRING $query_string; uwsgi_param REQUEST_METHOD $request_method; uwsgi_param CONTENT_TYPE $content_type; uwsgi_param CONTENT_LENGTH $content_length; uwsgi_param REQUEST_URI $request_uri; uwsgi_param PATH_INFO $document_uri; uwsgi_param DOCUMENT_ROOT $document_root; uwsgi_param SERVER_PROTOCOL $server_protocol; uwsgi_param REQUEST_SCHEME $scheme; uwsgi_param HTTPS $https if_not_empty; uwsgi_param REMOTE_ADDR $remote_addr; uwsgi_param REMOTE_PORT $remote_port; uwsgi_param SERVER_PORT $server_port; uwsgi_param SERVER_NAME $server_name (venv) [root@leco conf]# ls bookms.conf socket.xml uwsgi.ini uwsgi_params (venv) [root@leco conf]# pwd /usr/share/nginx/html/bookms/conf 7. \u5b89\u88c5\u8c03\u8bd5uwsgi \u00b6 (venv) [root@leco conf]# pip3 install uwsgi Looking in indexes: http://mirrors.cloud.aliyuncs.com/pypi/simple/ Collecting uwsgi Installing collected packages: uwsgi Successfully installed uwsgi-2.0.17.1 (venv) [root@leco conf]# uwsgi --ini uwsgi.ini [uWSGI] getting INI configuration from uwsgi.ini (venv) [root@leco conf]# ls bookms.conf socket.xml uwsgi.ini uwsgi.log uwsgi_params uwsgi.pid (venv) [root@leco conf]# ps axf|grep uwsgi 2589 pts/0 S+ 0:00 | \\_ grep uwsgi 31935 ? S 0:00 uwsgi --ini uwsgi.ini 31936 ? S 0:00 \\_ uwsgi --ini uwsgi.ini 31937 ? S 0:00 \\_ uwsgi --ini uwsgi.ini 31938 ? S 0:00 \\_ uwsgi --ini uwsgi.ini 31939 ? S 0:00 \\_ uwsgi --ini uwsgi.ini \u6ce8\u610f uwsgi\u5728\u54ea\u4e2a\u76ee\u5f55\u542f\u52a8 \uff0c\u5c31\u4f1a\u5728\u54ea\u4e2a\u76ee\u5f55\u751f\u6210 uwsgi . pid\u548cuswgi . log\u6587\u4ef6 \u3002 \u542f\u52a8\uff1a uwsgi -- ini uwsgi . ini \u505c\u6b62\uff1a uwsgi -- stop uwsgi . pid \u91cd\u542f\uff1a uwsgi -- reload uwsgi . pid \u5f3a\u5236\u505c\u6b62\uff1a killall - 9 uwsgi \u8fd9\u91cc\u6211\u4eec\u542f\u52a8 uwsgi\u670d\u52a1 \uff0c\u53ef\u4ee5\u901a\u8fc7 ps - ef | grep uwsgi\u770b\u5230\u5df2\u7ecf\u6709\u56db\u4e2auwsgi\u670d\u52a1\u542f\u52a8 \u3002 /usr/share/nginx/html/bookms/conf (venv) [root@leco conf]# pwd /usr/share/nginx/html/bookms/conf (venv) [root@leco conf]# ln -sf /usr/share/nginx/html/bookms/conf/bookms.conf /etc/nginx/conf.d/ (venv) [root@leco conf]# ll /etc/nginx/conf.d/ total 8 lrwxrwxrwx 1 root root 45 Dec 24 15:27 bookms.conf -> /usr/share/nginx/html/bookms/conf/bookms.conf (venv) [root@leco conf]# /etc/init.d/nginx configtest nginx: the configuration file /etc/nginx/nginx.conf syntax is ok nginx: configuration file /etc/nginx/nginx.conf test is successful (venv) [root@leco conf]# /etc/init.d/nginx restart Stopping nginx: [ OK ] Starting nginx: [ OK ] (venv) [root@leco conf]# 8. \u6d4f\u89c8\u5668\u6d4b\u8bd5 \u00b6 9. \u6c47\u603b\u914d\u7f6e\u6587\u4ef6 \u00b6 9.1 books.conf \u00b6 upstream django { # server unix:///path/to/your/mysite/mysite.sock; # for a file socket # \u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u7684\u7aef\u53e3 server 127.0.0.1:8000; # for a web port socket (we'll use this first) } server{ listen 80; server_name localhost; charset utf-8; access_log off; location /static { alias /usr/share/nginx/html/bookms/static; #\u8981\u4e0e\u4e4b\u524ddjango\u7684setting.py\u4e2d\u6dfb\u52a0\u7684static\u9759\u6001\u6587\u4ef6\u8f6c\u79fb\u76ee\u5f55\u4e00\u81f4 } location / { uwsgi_pass django; include /usr/share/nginx/html/bookms/conf/uwsgi_params; } } 9.2 socket.xml \u00b6 <uwsgi> <socket>:8000</socket> <chdir>/usr/share/nginx/html/HelloWorld</chdir> <module>hello.wsgi</module> <processes>4</processes> <!-- \u8fdb\u7a0b\u6570 --> <daemonize>uwsgi.log</daemonize> </uwsgi> 9.3 uwsgi.ini \u00b6 [uwsgi] # Django-related settings # Django\u9879\u76ee\u672c\u5730\u7aef\u53e3 socket = :8000 # \u9879\u76ee\u6839\u76ee\u5f55\u4f4d\u7f6e chdir = /usr/share/nginx/html/bookms # wsgi.py\u6587\u4ef6\u5728\u9879\u76ee\u7684\u4e2d\u7684\u76f8\u5bf9\u4f4d\u7f6e wsgi-file = /usr/share/nginx/html/bookms/bookms_02/wsgi.py module =booksms.wsgi # \u8fdb\u7a0b\u8bbe\u7f6e\uff0c\u65e0\u9700\u53d8\u52a8 # master master = true # maximum number of worker processes # \u542f\u52a84\u4e2auwsgi\u8fdb\u7a0b processes = 4 # ... with appropriate permissions - may be needed # chmod-socket = 664 # clear environment on exit vacuum = true pidfile=uwsgi.pid daemonize=uwsgi.log 9.4 uwsgi_params \u00b6 uwsgi_param QUERY_STRING $query_string; uwsgi_param REQUEST_METHOD $request_method; uwsgi_param CONTENT_TYPE $content_type; uwsgi_param CONTENT_LENGTH $content_length; uwsgi_param REQUEST_URI $request_uri; uwsgi_param PATH_INFO $document_uri; uwsgi_param DOCUMENT_ROOT $document_root; uwsgi_param SERVER_PROTOCOL $server_protocol; uwsgi_param REQUEST_SCHEME $scheme; uwsgi_param HTTPS $https if_not_empty; uwsgi_param REMOTE_ADDR $remote_addr; uwsgi_param REMOTE_PORT $remote_port; uwsgi_param SERVER_PORT $server_port; uwsgi_param SERVER_NAME $server_name;","title":"3. django\u9879\u76ee\u90e8\u7f72"},{"location":"linux/server/deploy_django/deploy_django.index/#1","text":"uWSGI\u662f\u4e00\u4e2aWeb\u670d\u52a1\u5668\uff0c\u5b83\u5b9e\u73b0\u4e86WSGI\u534f\u8bae\u3001uwsgi\u3001http\u7b49\u534f\u8bae\u3002Nginx\u4e2dHttpUwsgiModule\u7684\u4f5c\u7528\u662f\u4e0euWSGI\u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u6362\u3002 \u8981\u6ce8\u610f WSGI / uwsgi / uWSGI \u8fd9\u4e09\u4e2a\u6982\u5ff5\u7684\u533a\u5206\u3002 WSGI\u662f\u4e00\u79cdWeb\u670d\u52a1\u5668\u7f51\u5173\u63a5\u53e3\u3002\u5b83\u662f\u4e00\u4e2aWeb\u670d\u52a1\u5668\uff08\u5982nginx\uff0cuWSGI\u7b49\u670d\u52a1\u5668\uff09\u4e0eweb\u5e94\u7528\uff08\u5982\u7528Flask\u6846\u67b6\u5199\u7684\u7a0b\u5e8f\uff09\u901a\u4fe1\u7684\u4e00\u79cd\u89c4\u8303\u3002 uwsgi\u662f\u4e00\u79cd\u7ebf\u8def\u534f\u8bae\u800c\u4e0d\u662f\u901a\u4fe1\u534f\u8bae\uff0c\u5728\u6b64\u5e38\u7528\u4e8e\u5728uWSGI\u670d\u52a1\u5668\u4e0e\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u5668\u7684\u6570\u636e\u901a\u4fe1\u3002\u800cuWSGI\u662f\u5b9e\u73b0\u4e86uwsgi\u548cWSGI\u4e24\u79cd\u534f\u8bae\u7684Web\u670d\u52a1\u5668\u3002 uwsgi\u534f\u8bae\u662f\u4e00\u4e2auWSGI\u670d\u52a1\u5668\u81ea\u6709\u7684\u534f\u8bae\uff0c\u5b83\u7528\u4e8e\u5b9a\u4e49\u4f20\u8f93\u4fe1\u606f\u7684\u7c7b\u578b\uff08type of information\uff09\uff0c\u6bcf\u4e00\u4e2auwsgi packet\u524d4byte\u4e3a\u4f20\u8f93\u4fe1\u606f\u7c7b\u578b\u63cf\u8ff0\uff0c\u5b83\u4e0eWSGI\u76f8\u6bd4\u662f\u4e24\u6837\u4e1c\u897f\u3002","title":"1. \u4ecb\u7ecd"},{"location":"linux/server/deploy_django/deploy_django.index/#2","text":"\u9996\u5148\u5ba2\u6237\u7aef\u8bf7\u6c42\u670d\u52a1\u8d44\u6e90\uff0c nginx\u4f5c\u4e3a\u76f4\u63a5\u5bf9\u5916\u7684\u670d\u52a1\u63a5\u53e3,\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u9001\u8fc7\u6765\u7684http\u8bf7\u6c42,\u4f1a\u89e3\u5305\u3001\u5206\u6790\uff0c \u5982\u679c\u662f\u9759\u6001\u6587\u4ef6\u8bf7\u6c42\u5c31\u6839\u636enginx\u914d\u7f6e\u7684\u9759\u6001\u6587\u4ef6\u76ee\u5f55\uff0c\u8fd4\u56de\u8bf7\u6c42\u7684\u8d44\u6e90\uff0c \u5982\u679c\u662f\u52a8\u6001\u7684\u8bf7\u6c42,nginx\u5c31\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6,\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9uWSGI\uff1buWSGI \u5c06\u63a5\u6536\u5230\u7684\u5305\u8fdb\u884c\u5904\u7406\uff0c\u5e76\u8f6c\u53d1\u7ed9wsgi\uff0c wsgi\u6839\u636e\u8bf7\u6c42\u8c03\u7528django\u5de5\u7a0b\u7684\u67d0\u4e2a\u6587\u4ef6\u6216\u51fd\u6570\uff0c\u5904\u7406\u5b8c\u540edjango\u5c06\u8fd4\u56de\u503c\u4ea4\u7ed9wsgi\uff0c wsgi\u5c06\u8fd4\u56de\u503c\u8fdb\u884c\u6253\u5305\uff0c\u8f6c\u53d1\u7ed9uWSGI\uff0c uWSGI\u63a5\u6536\u540e\u8f6c\u53d1\u7ed9nginx,nginx\u6700\u7ec8\u5c06\u8fd4\u56de\u503c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef(\u5982\u6d4f\u89c8\u5668)\u3002","title":"2. \u539f\u7406"},{"location":"linux/server/deploy_django/deploy_django.index/#3-windows","text":"","title":"3. windows\u7aef\u64cd\u4f5c"},{"location":"linux/server/deploy_django/deploy_django.index/#31","text":"","title":"3.1 \u9879\u76ee\u6253\u5305"},{"location":"linux/server/deploy_django/deploy_django.index/#32","text":"pip freeze > requirements.txt \uff08windows\u6211\u6d4b\u8bd5\u5931\u8d25\u3002\u6211\u76f4\u63a5pip list \u7136\u540e\u7f16\u8f91\u6587\u4ef6\u5230 requirements.txt\uff09 \u683c\u5f0f\u5982\u4e0b\uff1a (venv) [root@leco bookms]# cat requirements.txt asn1crypto==0.24.0 cffi==1.11.5 cryptography==2.4.2 Django==2.1.4 idna==2.8 pycparser==2.19 PyMySQL==0.9.2 pytz==2018.7 setuptools==39.1.0 six==1.12.0","title":"3.2 \u5bfc\u51fa\u4f9d\u8d56"},{"location":"linux/server/deploy_django/deploy_django.index/#33","text":"\u6700\u597d\u662f\u653e\u5728nginx\u7684\u6307\u5b9a\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u6211\u653e\u5728\u4e86\u5982\u4e0b\u8def\u5f84\u3002 (venv) [root@leco bookms]# pwd /usr/share/nginx/html/bookms","title":"3.3 \u4e0a\u4f20\u5230\u670d\u52a1\u5668"},{"location":"linux/server/deploy_django/deploy_django.index/#4-linux","text":"","title":"4. Linux\u7aef\u64cd\u4f5c"},{"location":"linux/server/deploy_django/deploy_django.index/#41-nginx","text":"ubuntu \u7cfb\u7edf [root@leco etc]# apt-get install nginx centos\u7cfb\u7edf [root@leco etc]# yum install nginx","title":"4.1 \u5b89\u88c5nginx"},{"location":"linux/server/deploy_django/deploy_django.index/#42-python","text":"","title":"4.2 \u5b89\u88c5python"},{"location":"linux/server/deploy_django/deploy_django.index/#421","text":"[root@leco ~]# wget https://www.python.org/ftp/python/3.7.1/Python-3.7.1.tgz","title":"4.2.1 \u4e0b\u8f7d"},{"location":"linux/server/deploy_django/deploy_django.index/#422","text":"[root@leco ~]# tar xf Python-3.7.1.tgz","title":"4.2.2 \u89e3\u538b"},{"location":"linux/server/deploy_django/deploy_django.index/#422_1","text":"[root@leco ~]# cd Python-3.7.1 [root@leco Python-3.7.1]# ./configure && make && make install","title":"4.2.2 \u7f16\u8bd1\u5b89\u88c5"},{"location":"linux/server/deploy_django/deploy_django.index/#423","text":"[root@leco Python-3.7.1]# python3 -V Python 3.7.1 [root@leco Python-3.7.1]# pip3 -V pip 10.0.1 from /usr/local/lib/python3.7/site-packages/pip (python 3.7)","title":"4.2.3 \u6d4b\u8bd5"},{"location":"linux/server/deploy_django/deploy_django.index/#43","text":"[root@leco Python-3.7.1]# pip3 install virtualenv","title":"4.3 \u5b89\u88c5\u865a\u62df\u73af\u5883"},{"location":"linux/server/deploy_django/deploy_django.index/#44","text":"\u627e\u5230\u9879\u76ee\u7684\u6839\u76ee\u5f55\uff0c\u5220\u9664windows\u81ea\u5e26\u7684\u865a\u62df\u73af\u5883\uff0c\u91cd\u65b0\u521b\u5efa\u548c\u5b89\u88c5\u5305 [root@leco bookms]# ls book bookms_02 db.sqlite3 manage.py requirements.txt static templates venv \u5220\u9664windows\u7684\u865a\u62df\u73af\u5883\uff0c\u82e5\u662f\u672c\u8eab\u5728linux\u4e0a\u7684\u5c31\u4e0d\u7528\u5220\u9664\u3002Windows\u7684\u6709\u70b9\u95ee\u9898 [root@leco bookms]# rm -rf venv [root@leco bookms]# virtualenv venv \u8fdb\u5165\u865a\u62df\u73af\u5883\uff0c\u6b64\u65f6\u5b89\u88c5\u7684\u5305\u90fd\u662f\u5728\u672c\u9879\u76ee\u7684\u865a\u62df\u73af\u5883\u4e2d\u3002 [root@cairui bookms]# source venv/bin/activate (venv) [root@cairui bookms]# \u8fdb\u5165\u865a\u62df\u73af\u5883\u540e\u524d\u9762\u4f1a\u591a(venv),(venv)\u662f\u865a\u62df\u73af\u5883\u7684\u540d\u5b57\u3002 (venv) [root@leco bookms]# pip install -r requirements.txt (venv) [root@leco bookms]# pip list Package Version ------------ ------- asn1crypto 0.24.0 cffi 1.11.5 cryptography 2.4.2 Django 2.1.4 idna 2.8 pip 18.1 pycparser 2.19 PyMySQL 0.9.2 pytz 2018.7 setuptools 39.1.0 six 1.12.0 wheel 0.32.3","title":"4.4 \u865a\u62df\u73af\u5883"},{"location":"linux/server/deploy_django/deploy_django.index/#5","text":"","title":"5. \u914d\u7f6e"},{"location":"linux/server/deploy_django/deploy_django.index/#51","text":"(venv) [root@leco bookms]# vim bookms_02/settings.py ALLOWED_HOSTS = ['*'] \u5730\u5740\u9650\u5236 \u661f\u53f7\u8868\u793a\u4e0d\u9650\u5236\u8bbf\u95ee\u7684IP\u5730\u5740","title":"5.1 \u8bbf\u95ee\u8bbe\u7f6e"},{"location":"linux/server/deploy_django/deploy_django.index/#52","text":"(venv) [root@leco bookms]# vim bookms_02/settings.py DATABASES = { 'default': { 'ENGINE': 'django.db.backends.mysql', 'NAME': 'book_orm', 'USER':'root', 'PASSWORD':'root', 'HOST':'127.0.0.1', 'PORT':'3306', } } \u914d\u7f6e\u53c2\u6570\u8be6\u89e3 'ENGINE' : 'django.db.backends.mysql' , \u4f7f\u7528 mysql\u6570\u636e\u5e93 'NAME' : 'book_orm' , \u6307\u5b9a\u6570\u636e\u5e93\u540d\uff0c\u9700\u8981\u624b\u52a8\u5148\u521b\u5efa 'USER' : 'root' , \u6570\u636e\u5e93\u767b\u5f55\u7528\u6237\u540d 'PASSWORD' : 'root' , \u6570\u636e\u5e93\u767b\u5f55\u7528\u6237\u540d\u5bf9\u5e94\u7684\u5bc6\u7801 'HOST' : '127.0.0.1' , mysql\u6570\u636e\u5e93\u7684IP\u5730\u5740 \u3002 'PORT' : '3306' , mysql\u7aef\u53e3","title":"5.2 \u6570\u636e\u914d\u7f6e"},{"location":"linux/server/deploy_django/deploy_django.index/#6","text":"","title":"6.\u521b\u5efa\u6570\u636e\u5e93"},{"location":"linux/server/deploy_django/deploy_django.index/#61","text":"[root@leco Python-3.7.1]# mysql -uroot -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 4 Server version: 5.6.42 MySQL Community Server (GPL) Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> create database book_orm DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;","title":"6.1 \u521b\u5efa\u6570\u636e\u5e93"},{"location":"linux/server/deploy_django/deploy_django.index/#62","text":"\u6570\u636e\u8868\u521b\u5efa (venv) [root@leco bookms]# ls book bookms_02 db.sqlite3 manage.py requirements.txt static templates venv (venv) [root@leco bookms]# python3 manage.py makemigrations (venv) [root@leco bookms]# python3 manage.py migrate \u533a\u522b python manage . py makemigrations makemigrations\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2amigrations\u6587\u4ef6\u5939 \uff0c\u8be5\u6587\u4ef6\u5939\u7684\u5185\u5bb9\u5c31\u662f\u6570\u636e\u5e93\u8981\u6267\u884c\u7684\u5185\u5bb9 python manage . py migrate migrate\u5c31\u662f\u6267\u884c\u4e4b\u524d\u751f\u6210\u7684migrations\u6587\u4ef6 \uff0c\u8fd9\u4e00\u6b65\u624d\u662f\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u4e00\u6b65","title":"6.2 \u6570\u636e\u8fc1\u79fb"},{"location":"linux/server/deploy_django/deploy_django.index/#63","text":"(venv) [root@leco bookms]# python3 manage.py runserver 0.0.0.0:7000 Performing system checks... System check identified no issues (0 silenced). (0.000) SELECT @@SQL_AUTO_IS_NULL; args=None (0.000) SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED; args=None (0.001) SHOW FULL TABLES; args=None (0.003) SELECT `django_migrations`.`app`, `django_migrations`.`name` FROM `django_migrations`; args=() December 24, 2018 - 07:16:02 Django version 2.1.4, using settings 'bookms_02.settings' Starting development server at http://0.0.0.0:7000/ Quit the server with CONTROL-C. \u65b0\u5f00\u4e00\u4e2a\u7ec8\u7aef\u6d4b\u8bd5 [root@leco Python-3.7.1]# curl 127.0.0.1:7000 <!DOCTYPE html> <html lang=\"en\"> <head> <meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\"> <title>Page not found at /</title> <meta name=\"robots\" content=\"NONE,NOARCHIVE\"> <style type=\"text/css\"> html * { padding:0; margin:0; } body * { padding:10px 20px; } body * * { padding:0; } body { font:small sans-serif; background:#eee; color:#000; } body>div { border-bottom:1px solid #ddd; } h1 { font-weight:normal; margin-bottom:.4em; } h1 span { font-size:60%; color:#666; font-weight:normal; } table { border:none; border-collapse: collapse; width:100%; } td, th { vertical-align:top; padding:2px 3px; } th { width:12em; text-align:right; color:#666; padding-right:.5em; } #info { background:#f6f6f6; } #info ol { margin: 0.5em 4em; } #info ol li { font-family: monospace; } #summary { background: #ffc; } #explanation { background:#eee; border-bottom: 0px none; } </style> </head> <body> <div id=\"summary\"> <h1>Page not found <span>(404)</span></h1> <table class=\"meta\"> <tr> <th>Request Method:</th> <td>GET</td> </tr> <tr> <th>Request URL:</th> <td>http://127.0.0.1:7000/</td> </tr> </table> </div> <div id=\"info\"> <p> Using the URLconf defined in <code>bookms_02.urls</code>, Django tried these URL patterns, in this order: </p> <ol> <li> admin/ </li> <li> books/add/$ </li> <li> books/$ </li> <li> books/(\\d+)/change </li> <li> books/(\\d+)/delete </li> </ol> <p> The empty path didn't match any of these. </p> </div> <div id=\"explanation\"> <p> You're seeing this error because you have <code>DEBUG = True</code> in your Django settings file. Change that to <code>False</code>, and Django will display a standard 404 page. </p> </div> </body> </html> \u4ee5\u4e0a\u6d4b\u8bd5OK\u3002","title":"6.3 \u6d4b\u8bd5"},{"location":"linux/server/deploy_django/deploy_django.index/#64","text":"(venv) [root@leco bookms]# mkdir conf (venv) [root@leco bookms]# mv bookms.conf socket.xml uwsgi.ini uwsgi_params conf/ (venv) [root@leco conf]# cat bookms.conf upstream django { # server unix:///path/to/your/mysite/mysite.sock; # for a file socket # \u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u7684\u7aef\u53e3 server 127.0.0.1:8000; # for a web port socket (we'll use this first) } server{ listen 80; server_name localhost; charset utf-8; access_log off; location /static { alias /usr/share/nginx/html/bookms/static; # \u8981\u4e0e\u4e4b\u524ddjango\u7684setting.py\u4e2d\u6dfb\u52a0\u7684static\u9759\u6001\u6587\u4ef6\u8f6c\u79fb\u76ee\u5f55\u4e00\u81f4 } location / { uwsgi_pass django; include /usr/share/nginx/html/bookms/conf/uwsgi_params; } } (venv) [root@leco conf]# cat socket.xml <uwsgi> <socket>:8000</socket> <chdir>/usr/share/nginx/html/HelloWorld</chdir> <module>hello.wsgi</module> <processes>4</processes> <!-- \u8fdb\u7a0b\u6570 --> <daemonize>uwsgi.log</daemonize> </uwsgi> (venv) [root@leco conf]# cat uwsgi.ini [uwsgi] # Django-related settings # Django\u9879\u76ee\u672c\u5730\u7aef\u53e3 socket = :8000 # \u9879\u76ee\u6839\u76ee\u5f55\u4f4d\u7f6e chdir = /usr/share/nginx/html/bookms # wsgi.py\u6587\u4ef6\u5728\u9879\u76ee\u7684\u4e2d\u7684\u76f8\u5bf9\u4f4d\u7f6e wsgi-file = /usr/share/nginx/html/bookms/bookms_02/wsgi.py module =bookms.wsgi # \u8fdb\u7a0b\u8bbe\u7f6e\uff0c\u65e0\u9700\u53d8\u52a8 # master master = true # maximum number of worker processes # \u542f\u52a84\u4e2auwsgi\u8fdb\u7a0b processes = 4 # ... with appropriate permissions - may be needed # chmod-socket = 664 # clear environment on exit vacuum = true pidfile=uwsgi.pid daemonize=uwsgi.log (venv) [root@leco conf]# cat uwsgi_params # \u8fd9\u4e2a\u662f\u56fa\u5b9a\u7684\u6587\u4ef6\uff0c uwsgi_param QUERY_STRING $query_string; uwsgi_param REQUEST_METHOD $request_method; uwsgi_param CONTENT_TYPE $content_type; uwsgi_param CONTENT_LENGTH $content_length; uwsgi_param REQUEST_URI $request_uri; uwsgi_param PATH_INFO $document_uri; uwsgi_param DOCUMENT_ROOT $document_root; uwsgi_param SERVER_PROTOCOL $server_protocol; uwsgi_param REQUEST_SCHEME $scheme; uwsgi_param HTTPS $https if_not_empty; uwsgi_param REMOTE_ADDR $remote_addr; uwsgi_param REMOTE_PORT $remote_port; uwsgi_param SERVER_PORT $server_port; uwsgi_param SERVER_NAME $server_name (venv) [root@leco conf]# ls bookms.conf socket.xml uwsgi.ini uwsgi_params (venv) [root@leco conf]# pwd /usr/share/nginx/html/bookms/conf","title":"6.4 \u521b\u5efa\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/deploy_django/deploy_django.index/#7-uwsgi","text":"(venv) [root@leco conf]# pip3 install uwsgi Looking in indexes: http://mirrors.cloud.aliyuncs.com/pypi/simple/ Collecting uwsgi Installing collected packages: uwsgi Successfully installed uwsgi-2.0.17.1 (venv) [root@leco conf]# uwsgi --ini uwsgi.ini [uWSGI] getting INI configuration from uwsgi.ini (venv) [root@leco conf]# ls bookms.conf socket.xml uwsgi.ini uwsgi.log uwsgi_params uwsgi.pid (venv) [root@leco conf]# ps axf|grep uwsgi 2589 pts/0 S+ 0:00 | \\_ grep uwsgi 31935 ? S 0:00 uwsgi --ini uwsgi.ini 31936 ? S 0:00 \\_ uwsgi --ini uwsgi.ini 31937 ? S 0:00 \\_ uwsgi --ini uwsgi.ini 31938 ? S 0:00 \\_ uwsgi --ini uwsgi.ini 31939 ? S 0:00 \\_ uwsgi --ini uwsgi.ini \u6ce8\u610f uwsgi\u5728\u54ea\u4e2a\u76ee\u5f55\u542f\u52a8 \uff0c\u5c31\u4f1a\u5728\u54ea\u4e2a\u76ee\u5f55\u751f\u6210 uwsgi . pid\u548cuswgi . log\u6587\u4ef6 \u3002 \u542f\u52a8\uff1a uwsgi -- ini uwsgi . ini \u505c\u6b62\uff1a uwsgi -- stop uwsgi . pid \u91cd\u542f\uff1a uwsgi -- reload uwsgi . pid \u5f3a\u5236\u505c\u6b62\uff1a killall - 9 uwsgi \u8fd9\u91cc\u6211\u4eec\u542f\u52a8 uwsgi\u670d\u52a1 \uff0c\u53ef\u4ee5\u901a\u8fc7 ps - ef | grep uwsgi\u770b\u5230\u5df2\u7ecf\u6709\u56db\u4e2auwsgi\u670d\u52a1\u542f\u52a8 \u3002 /usr/share/nginx/html/bookms/conf (venv) [root@leco conf]# pwd /usr/share/nginx/html/bookms/conf (venv) [root@leco conf]# ln -sf /usr/share/nginx/html/bookms/conf/bookms.conf /etc/nginx/conf.d/ (venv) [root@leco conf]# ll /etc/nginx/conf.d/ total 8 lrwxrwxrwx 1 root root 45 Dec 24 15:27 bookms.conf -> /usr/share/nginx/html/bookms/conf/bookms.conf (venv) [root@leco conf]# /etc/init.d/nginx configtest nginx: the configuration file /etc/nginx/nginx.conf syntax is ok nginx: configuration file /etc/nginx/nginx.conf test is successful (venv) [root@leco conf]# /etc/init.d/nginx restart Stopping nginx: [ OK ] Starting nginx: [ OK ] (venv) [root@leco conf]#","title":"7. \u5b89\u88c5\u8c03\u8bd5uwsgi"},{"location":"linux/server/deploy_django/deploy_django.index/#8","text":"","title":"8. \u6d4f\u89c8\u5668\u6d4b\u8bd5"},{"location":"linux/server/deploy_django/deploy_django.index/#9","text":"","title":"9. \u6c47\u603b\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/deploy_django/deploy_django.index/#91-booksconf","text":"upstream django { # server unix:///path/to/your/mysite/mysite.sock; # for a file socket # \u8bbe\u7f6e\u672c\u5730\u670d\u52a1\u7684\u7aef\u53e3 server 127.0.0.1:8000; # for a web port socket (we'll use this first) } server{ listen 80; server_name localhost; charset utf-8; access_log off; location /static { alias /usr/share/nginx/html/bookms/static; #\u8981\u4e0e\u4e4b\u524ddjango\u7684setting.py\u4e2d\u6dfb\u52a0\u7684static\u9759\u6001\u6587\u4ef6\u8f6c\u79fb\u76ee\u5f55\u4e00\u81f4 } location / { uwsgi_pass django; include /usr/share/nginx/html/bookms/conf/uwsgi_params; } }","title":"9.1 books.conf"},{"location":"linux/server/deploy_django/deploy_django.index/#92-socketxml","text":"<uwsgi> <socket>:8000</socket> <chdir>/usr/share/nginx/html/HelloWorld</chdir> <module>hello.wsgi</module> <processes>4</processes> <!-- \u8fdb\u7a0b\u6570 --> <daemonize>uwsgi.log</daemonize> </uwsgi>","title":"9.2 socket.xml"},{"location":"linux/server/deploy_django/deploy_django.index/#93-uwsgiini","text":"[uwsgi] # Django-related settings # Django\u9879\u76ee\u672c\u5730\u7aef\u53e3 socket = :8000 # \u9879\u76ee\u6839\u76ee\u5f55\u4f4d\u7f6e chdir = /usr/share/nginx/html/bookms # wsgi.py\u6587\u4ef6\u5728\u9879\u76ee\u7684\u4e2d\u7684\u76f8\u5bf9\u4f4d\u7f6e wsgi-file = /usr/share/nginx/html/bookms/bookms_02/wsgi.py module =booksms.wsgi # \u8fdb\u7a0b\u8bbe\u7f6e\uff0c\u65e0\u9700\u53d8\u52a8 # master master = true # maximum number of worker processes # \u542f\u52a84\u4e2auwsgi\u8fdb\u7a0b processes = 4 # ... with appropriate permissions - may be needed # chmod-socket = 664 # clear environment on exit vacuum = true pidfile=uwsgi.pid daemonize=uwsgi.log","title":"9.3 uwsgi.ini"},{"location":"linux/server/deploy_django/deploy_django.index/#94-uwsgi_params","text":"uwsgi_param QUERY_STRING $query_string; uwsgi_param REQUEST_METHOD $request_method; uwsgi_param CONTENT_TYPE $content_type; uwsgi_param CONTENT_LENGTH $content_length; uwsgi_param REQUEST_URI $request_uri; uwsgi_param PATH_INFO $document_uri; uwsgi_param DOCUMENT_ROOT $document_root; uwsgi_param SERVER_PROTOCOL $server_protocol; uwsgi_param REQUEST_SCHEME $scheme; uwsgi_param HTTPS $https if_not_empty; uwsgi_param REMOTE_ADDR $remote_addr; uwsgi_param REMOTE_PORT $remote_port; uwsgi_param SERVER_PORT $server_port; uwsgi_param SERVER_NAME $server_name;","title":"9.4 uwsgi_params"},{"location":"linux/server/harbor/harbor.index/","text":"Harbor Docker\u4f01\u4e1a\u7ea7\u79c1\u6709\u4ed3\u5e93 1. Harbor\u7b80\u4ecb \u00b6 Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002 \u955c\u50cf\u7684\u5b58\u50a8harbor\u4f7f\u7528\u7684\u662f\u5b98\u65b9\u7684docker registry(v2\u547d\u540d\u662fdistribution)\u670d\u52a1\u53bb\u5b8c\u6210\u3002harbor\u5728docker distribution\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u4e86\u4e00\u4e9b\u5b89\u5168\u3001\u8bbf\u95ee\u63a7\u5236\u3001\u7ba1\u7406\u7684\u529f\u80fd\u4ee5\u6ee1\u8db3\u4f01\u4e1a\u5bf9\u4e8e\u955c\u50cf\u4ed3\u5e93\u7684\u9700\u6c42\u3002harbor\u4ee5docker-compose\u7684\u89c4\u8303\u5f62\u5f0f\u7ec4\u7ec7\u5404\u4e2a\u7ec4\u4ef6\uff0c\u5e76\u901a\u8fc7docker-compose\u5de5\u5177\u8fdb\u884c\u542f\u505c\u3002 docker\u7684registry\u662f\u7528\u672c\u5730\u5b58\u50a8\u6216\u8005s3\u90fd\u662f\u53ef\u4ee5\u7684\uff0charbor\u7684\u529f\u80fd\u662f\u5728\u6b64\u4e4b\u4e0a\u63d0\u4f9b\u7528\u6237\u6743\u9650\u7ba1\u7406\u3001\u955c\u50cf\u590d\u5236\u7b49\u529f\u80fd\uff0c\u63d0\u9ad8\u4f7f\u7528\u7684registry\u7684\u6548\u7387\u3002Harbor\u7684\u955c\u50cf\u62f7\u8d1d\u529f\u80fd\u662f\u901a\u8fc7docker registry\u7684API\u53bb\u62f7\u8d1d\uff0c\u8fd9\u79cd\u505a\u6cd5\u5c4f\u853d\u4e86\u7e41\u7410\u7684\u5e95\u5c42\u6587\u4ef6\u64cd\u4f5c\u3001\u4e0d\u4ec5\u53ef\u4ee5\u5229\u7528\u73b0\u6709docker registry\u529f\u80fd\u4e0d\u5fc5\u91cd\u590d\u9020\u8f6e\u5b50\uff0c\u800c\u4e14\u53ef\u4ee5\u89e3\u51b3\u51b2\u7a81\u548c\u4e00\u81f4\u6027\u7684\u95ee\u9898\u3002 1.1 Harbor\u67b6\u6784 \u00b6 \u4e3b\u8981\u7ec4\u4ef6\u5305\u62ec: Proxy\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6nginx\u3002\u5b83\u662f\u4e00\u4e2anginx\u53cd\u5411\u4ee3\u7406\uff0c\u4ee3\u7406Notary client\uff08\u955c\u50cf\u8ba4\u8bc1\uff09\u3001Docker client\uff08\u955c\u50cf\u4e0a\u4f20\u4e0b\u8f7d\u7b49\uff09\u548c\u6d4f\u89c8\u5668\u7684\u8bbf\u95ee\u8bf7\u6c42\uff08Core Service\uff09\u7ed9\u540e\u7aef\u7684\u5404\u670d\u52a1\uff1b UI\uff08Core Service\uff09\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-ui\u3002\u5e95\u5c42\u6570\u636e\u5b58\u50a8\u4f7f\u7528mysql\u6570\u636e\u5e93\uff0c\u4e3b\u8981\u63d0\u4f9b\u4e86\u56db\u4e2a\u5b50\u529f\u80fd\uff1a UI\uff1a\u4e00\u4e2aweb\u7ba1\u7406\u9875\u9762ui\uff1b API\uff1aHarbor\u66b4\u9732\u7684API\u670d\u52a1\uff1b Auth\uff1a\u7528\u6237\u8ba4\u8bc1\u670d\u52a1\uff0cdecode\u540e\u7684token\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u5728\u8fd9\u91cc\u8fdb\u884c\u8ba4\u8bc1\uff1bauth\u540e\u7aef\u53ef\u4ee5\u63a5db\u3001ldap\u3001uaa\u4e09\u79cd\u8ba4\u8bc1\u5b9e\u73b0\uff1b Token\u670d\u52a1\uff08\u4e0a\u56fe\u4e2d\u672a\u4f53\u73b0\uff09\uff1a\u8d1f\u8d23\u6839\u636e\u7528\u6237\u5728\u6bcf\u4e2aproject\u4e2d\u7684role\u6765\u4e3a\u6bcf\u4e00\u4e2adocker push/pull\u547d\u4ee4issuing\u4e00\u4e2atoken\uff0c\u5982\u679c\u4ecedocker client\u53d1\u9001\u7ed9registry\u7684\u8bf7\u6c42\u6ca1\u6709\u5e26token\uff0cregistry\u4f1a\u91cd\u5b9a\u5411\u8bf7\u6c42\u5230token\u670d\u52a1\u521b\u5efatoken\u3002 Registry\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6registry\u3002\u8d1f\u8d23\u5b58\u50a8\u955c\u50cf\u6587\u4ef6\uff0c\u548c\u5904\u7406\u955c\u50cf\u7684pull/push\u547d\u4ee4\u3002Harbor\u5bf9\u955c\u50cf\u8fdb\u884c\u5f3a\u5236\u7684\u8bbf\u95ee\u63a7\u5236\uff0cRegistry\u4f1a\u5c06\u5ba2\u6237\u7aef\u7684\u6bcf\u4e2apull\u3001push\u8bf7\u6c42\u8f6c\u53d1\u5230token\u670d\u52a1\u6765\u83b7\u53d6\u6709\u6548\u7684token\u3002 Admin Service\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-adminserver\u3002\u662f\u7cfb\u7edf\u7684\u914d\u7f6e\u7ba1\u7406\u4e2d\u5fc3\u9644\u5e26\u68c0\u67e5\u5b58\u50a8\u7528\u91cf\uff0cui\u548cjobserver\u542f\u52a8\u65f6\u5019\u9700\u8981\u52a0\u8f7dadminserver\u7684\u914d\u7f6e\uff1b Job Sevice\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-jobservice\u3002\u8d1f\u8d23\u955c\u50cf\u590d\u5236\u5de5\u4f5c\u7684\uff0c\u4ed6\u548cregistry\u901a\u4fe1\uff0c\u4ece\u4e00\u4e2aregistry pull\u955c\u50cf\u7136\u540epush\u5230\u53e6\u4e00\u4e2aregistry\uff0c\u5e76\u8bb0\u5f55job_log\uff1b Log Collector\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-log\u3002\u65e5\u5fd7\u6c47\u603b\u7ec4\u4ef6\uff0c\u901a\u8fc7docker\u7684log-driver\u628a\u65e5\u5fd7\u6c47\u603b\u5230\u4e00\u8d77\uff1b Volnerability Scanning\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6clair\u3002\u8d1f\u8d23\u955c\u50cf\u626b\u63cf Notary\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6notary\u3002\u8d1f\u8d23\u955c\u50cf\u8ba4\u8bc1 DB\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-db\uff0c\u8d1f\u8d23\u5b58\u50a8project\u3001 user\u3001 role\u3001replication\u3001image_scan\u3001access\u7b49\u7684metadata\u6570\u636e\u3002 1.2 Docker Registery \u00b6 1.Registry\u7528\u4e8e\u4fdd\u5b58docker\u955c\u50cf\uff0c\u5305\u62ec\u955c\u50cf\u7684\u5c42\u6b21\u7ed3\u6784\u548c\u5143\u6570\u636e 2.\u7528\u6237\u53ef\u81ea\u5efaRegistry\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5b98\u65b9\u7684Docker Hub Docker Registery \u5206\u7c7b 1.Sponsor Registry \u7b2c\u4e09\u65b9Registry\uff0c\u4f9b\u5ba2\u6237\u548cDocker\u793e\u533a\u4f7f\u7528 2.Mirror Registry \u7b2c\u4e09\u65b9Registry\uff0c\u53ea\u8ba9\u5ba2\u6237\u4f7f\u7528 3.Vendor Registry \u7531\u53d1\u5e03Docker\u955c\u50cf\u7684\u4f9b\u5e94\u5546\u63d0\u4f9b\u7684Registry 4.Private Registry \u901a\u8fc7\u8bbe\u6709\u9632\u706b\u5899\u548c\u989d\u5916\u7684\u5b89\u5168\u5c42\u7684\u79c1\u6709\u5b9e\u4f53\u63d0\u4f9b\u7684Registry 2. \u7cfb\u7edf\u90e8\u7f72\u57fa\u7840 \u00b6 \u670d\u52a1\u5668\u7684ip\u89c4\u5212 \u673a\u5668 IP \u7cfb\u7edf Docker Registry 192.168.183.134 Centos 7\uff08\u968f\u4fbf\u4f60\u4ec0\u4e48\u7cfb\u7edf\uff09 Docker Client 192.168.183.133 Centos 7\uff08\u968f\u4fbf\u4f60\u4ec0\u4e48\u7cfb\u7edf\uff09\u63a8\u9001\u955c\u50cf Docker Client 192.168.183.135 Centos 7\uff08\u968f\u4fbf\u4f60\u4ec0\u4e48\u7cfb\u7edf\uff09\u62c9\u53d6\u955c\u50cf \u540d\u8bcd\u89e3\u91ca No \u540d\u8bcd \u89e3\u91ca 1 Docker Registry Docker\u79c1\u6709\u4ed3\u5e93\uff08\u672c\u5730\uff09 2 Docker Client \u4e0a\u4f20\u548c\u4e0b\u8f7d\u7684docker\u5ba2\u6237\u7aef 3. Docker\u81ea\u5e26\u4ed3\u5e93 \u00b6 3.1 \u5b89\u88c5\u5b98\u65b9\u81ea\u5e26\u4ed3\u5e93 \u00b6 3.1.1 \u5b89\u88c5 \u00b6 [root@leco ~]# yum install docker-registry [root@leco ~]# yum info docker-registry Loaded plugins: fastestmirror Loading mirror speeds from cached hostfile * base: mirrors.aliyun.com * epel: mirrors.aliyun.com * extras: mirrors.aliyun.com * updates: mirrors.aliyun.com Available Packages Name : docker-registry Arch : x86_64 Version : 0.9.1 Release : 7.el7 Size : 123 k Repo : extras/7/x86_64 Summary : Registry server for Docker URL : https://github.com/docker/docker-registry License : ASL 2.0 Description : Registry server for Docker (hosting/delivering of repositories and images). 3.1.2 \u67e5\u770b\u5b89\u88c5\u4fe1\u606f \u00b6 [root@leco ~]# rpm -ql docker-distribution /etc/docker-distribution/registry/config.yml /usr/bin/registry /usr/lib/systemd/system/docker-distribution.service /usr/share/doc/docker-distribution-2.6.2 /usr/share/doc/docker-distribution-2.6.2/AUTHORS /usr/share/doc/docker-distribution-2.6.2/CONTRIBUTING.md /usr/share/doc/docker-distribution-2.6.2/LICENSE /usr/share/doc/docker-distribution-2.6.2/MAINTAINERS /usr/share/doc/docker-distribution-2.6.2/README.md /var/lib/registry [root@leco registry]# pwd /etc/docker-distribution/registry [root@leco registry]# cat config.yml version: 0.1 log: fields: service: registry storage: cache: layerinfo: inmemory filesystem: rootdirectory: /var/lib/registry # \u4ed3\u5e93\u7684\u5b58\u50a8\u8def\u5f84\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\uff08\u627e\u5927\u70b9\u7684\u7a7a\u95f4\u914d\u7f6e\uff09 http: # \u4ed3\u5e93\u534f\u8bae addr: :5000 # \u4ed3\u5e93\u7aef\u53e3 3.1.3 \u542f\u52a8\u4ed3\u5e93 \u00b6 [root@leco registry]# systemctl start docker-distribution.service 3.1.4 \u5f00\u673a\u81ea\u542f\u52a8 \u00b6 [root@leco registry]# systemctl enable docker-distribution.service Created symlink from /etc/systemd/system/multi-user.target.wants/docker-distribution.service to /usr/lib/systemd/system/docker-distribution.service. 3.1.5 \u67e5\u770b\u670d\u52a1 \u00b6 [root@leco registry]# ss -tnl State Recv-Q Send-Q Local Address:Port Peer Address:Port LISTEN 0 100 127.0.0.1:25 *:* LISTEN 0 128 *:22 *:* LISTEN 0 100 ::1:25 :::* LISTEN 0 128 :::5000 :::* LISTEN 0 128 :::22 :::* 3.2 Docker\u5ba2\u6237\u7aef\u64cd\u4f5c \u00b6 \u627e\u4e00\u4e2a\u65b0\u7684docker\u5ba2\u6237\u7aef\u6d4b\u8bd5\u63a8\u62c9 3.2.1 \u6253tag \u00b6 \u73b0\u5728\u5ba2\u6237\u7aef\u6807\u7b7edocker\u79c1\u6709\u4ed3\u5e93\u5730\u5740\u3002\u4e0d\u6253\u6807\u7b7e\u9ed8\u8ba4\u63a8\u9001\u5230docker github\u4e0a [root@localhost img4]# docker tag myweb:v0.3-11 192.168.183.134:5000/myweb:v0.3-11 3.2.2 \u67e5\u770btag\u4fe1\u606f \u00b6 [root@localhost img4]# docker images |grep 5000 192.168.183.134:5000/myweb v0.3-11 44ef73a3a19b 39 minutes ago 18MB [root@localhost img4]# docker push 192.168.183.134:5000/myweb:v0.3-11 The push refers to repository [192.168.183.134:5000/myweb] Get https://192.168.183.134:5000/v2/: http: server gave HTTP response to HTTPS client \u6b64\u65f6\u8981\u5728\u5ba2\u6237\u7aef\u6539\u53d8\u914d\u7f6e\uff0c\u53d8\u6210http\u534f\u8bae\uff08docker \u4ed3\u5e93\u9ed8\u8ba4\u662fhttps\u534f\u8bae\uff0c\u6211\u4eec\u4f7f\u7528http\u534f\u8bae\uff09 [root@localhost img4]# cat !$ cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"insecure-registries\":[\"192.168.183.134:5000\"] } \u5176\u4e2dinsecure-registries\u540e\u9762\u662fdocker\u4ed3\u5e93\u7684\u5730\u5740\u548c\u7aef\u53e3\u3002 [root@localhost img4]# systemctl restart docker 3.2.3 push \u00b6 \u4fee\u6539\u534f\u8bae\u540e\u91cd\u542fdocker\u7136\u540e\u5728push\u955c\u50cf\u5230\u79c1\u6709\u4ed3\u5e93\u91cc\u9762 [root@localhost img4]# docker push 192.168.183.134:5000/myweb:v0.3-11 The push refers to repository [192.168.183.134:5000/myweb] 347a19806329: Pushed 20555723c54b: Pushed a79fe6dff072: Pushed 87deea508850: Pushed 90c4db1d5ef5: Pushed cd7100a72410: Pushed v0.3-11: digest: sha256:be593f8f6e45181416242b37183b3c5429745e3623424a1a9b672afab898714e size: 1568 3.2.4 \u4ed3\u5e93\u67e5\u770b \u00b6 docker\u79c1\u6709\u4ed3\u5e93\u7aef\u67e5\u770b [root@leco registry]# ls /var/lib/registry/docker/registry/v2/repositories/myweb/_layers/sha256/ 44ef73a3a19b95ae6f7e0c4bf92f0fcc876dce929340455c591430203b4bc151 4b15fa862ac67691a8bc682937be38197ebebe580f01b1bcc0ee823fc43709aa 5e38f0c1e3e667d4fd01ac85ebcd4337579471d841a925d4be81bde53a482614 7d4e05a01906143afc15671a53151ea9755dac230db376a8b8364b21ca774dbc 8aeac9a3205fce5e21ab65ccce330fe389a9aaf47e4b682970b1772ae25a1d73 b430473be128c1302a75e8381dfbaa45182fec81db4f75b749e4896d7816c2ea ff3a5c916c92643ff77519ffa742d3ec61b7f591b6b7504599d95a4a41134e28 \u53ef\u89c1\u4ecedocker\u5ba2\u6237\u7aefpush\u4e0a\u7684\u955c\u50cf\u5df2\u7ecf\u63a8\u9001\u8fc7\u6765\uff0c\u7ecf\u8fc7hash\u4e86\u3002 3.2.5 pull \u00b6 \u5728\u5176\u4ed6\u673a\u5668\u4e0a\u6d4b\u8bd5\uff08pull\u955c\u50cf\uff09 [root@leco registry]# cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"bip\": \"10.0.0.1/16\", \"insecure-registries\":[\"192.168.183.134:5000\"] } [root@leco registry]# systemctl restart docker [root@leco registry]# docker pull 192.168.183.134:5000/myweb:v0.3-11 v0.3-11: Pulling from myweb ff3a5c916c92: Pull complete b430473be128: Pull complete 7d4e05a01906: Pull complete 8aeac9a3205f: Pull complete 5e38f0c1e3e6: Pull complete 4b15fa862ac6: Pull complete Digest: sha256:be593f8f6e45181416242b37183b3c5429745e3623424a1a9b672afab898714e Status: Downloaded newer image for 192.168.183.134:5000/myweb:v0.3-11 [root@leco registry]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE 192.168.183.134:5000/myweb v0.3-11 44ef73a3a19b About an hour ago 18MB 4. Harbor \u00b6 4.1 \u53c2\u8003\u6587\u6863 \u00b6 \u5b98\u65b9\u6587\u6863 \u5b89\u88c5\u6b65\u9aa4 4.2 \u4e0b\u8f7d\u5b89\u88c5 \u00b6 \u4e0b\u8f7d\u5b89\u88c5\u540e\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u89e3\u538b\u914d\u7f6e\u5b89\u88c5\u3002 4.2.1 \u5173\u95ed\u4ed3\u5e93 \u00b6 \u5173\u95ed\u4e4b\u524d\u81ea\u5e26\uff08github\u81ea\u5df1\u7684\uff09\u7684\u955c\u50cf\u4ed3\u5e93 [root@leco ~]# netstat -lnp|grep 5000 tcp6 0 0 :::5000 :::* LISTEN 17540/registry [root@leco ~]# systemctl stop docker-distribution [root@leco ~]# netstat -lnp|grep 500 [root@leco opt]# ls harbor-offline-installer-v1.5.3.tgz myimages.gz [root@leco opt]# tar xf harbor-offline-installer-v1.5.3.tgz -C /usr/local/ [root@leco opt]# cd /usr/local/harbor/ [root@leco harbor]# pwd /usr/local/harbor [root@leco harbor]# ll total 895716 drwxr-xr-x 4 root root 37 Sep 20 17:37 common -rw-r--r-- 1 root root 1185 Sep 12 14:19 docker-compose.clair.yml -rw-r--r-- 1 root root 1725 Sep 12 14:19 docker-compose.notary.yml -rw-r--r-- 1 root root 3596 Sep 12 14:19 docker-compose.yml drwxr-xr-x 3 root root 156 Sep 12 14:19 ha -rw-r--r-- 1 root root 6955 Sep 20 17:32 harbor.cfg -rw-r--r-- 1 root root 6956 Sep 20 17:31 harbor.cfg.ori -rw-r--r-- 1 root root 915878468 Sep 12 14:21 harbor.v1.5.3.tar.gz -rwxr-xr-x 1 root root 5773 Sep 12 14:19 install.sh -rw-r--r-- 1 root root 10764 Sep 12 14:19 LICENSE -rw-r--r-- 1 root root 482 Sep 12 14:19 NOTICE -rw-r--r-- 1 root root 1247461 Sep 12 14:19 open_source_license -rwxr-xr-x 1 root root 27840 Sep 12 14:19 prepare [root@leco harbor]# cp harbor.cfg harbor.cfg.ori 4.2.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u00b6 [root@leco harbor]# diff harbor.cfg harbor.cfg.ori 7c7 < hostname = 192.168.183.134 --- > hostname = reg.mydomain.com \u4fee\u6539hostname\uff0chostname\u662f\u5bf9\u5916\u8bbf\u95ee\u7684\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u57df\u540d\u53ef\u4ee5ip\u5730\u5740\uff0c\u6211\u4eec\u8fd9\u4f7f\u7528ip\uff08\u4e5f\u5c31\u662fdocker\u7684\u79c1\u6709\u4ed3\u5e93\u5730\u5740\uff09 4.2.3 \u5f00\u59cb\u5b89\u88c5 \u00b6 [root@leco harbor]# sh install.sh [Step 0]: checking installation environment ... Note: docker version: 18.06.1 \u2716 Need to install docker-compose(1.7.1+) by yourself first and run this script again. 4.2.4 \u5b89\u88c5\u7f16\u6392\u5de5\u5177 \u00b6 \u5148\u8981\u5b89\u88c5docker-compose \u56e0\u4e3aharbor\u4f7f\u7528\u901a\u8fc7docker-compose\u7f16\u6392\u5de5\u5177\u53bb\u5b89\u88c5 [root@leco harbor]# yum install -y docker-compose [root@leco harbor]# sh install.sh [Step 0]: checking installation environment ... Note: docker version: 18.06.1 Note: docker-compose version: 1.18.0 [Step 1]: loading Harbor images ... dba693fc2701: Loading layer [==================================================>] 133.4MB/133.4MB 5773887c4c41: Loading layer [==================================================>] 30.09MB/30.09MB 6fc2abbcae42: Loading layer [==================================================>] 15.37MB/15.37MB d85f176a11ec: Loading layer [==================================================>] 15.37MB/15.37MB Loaded image: vmware/harbor-adminserver:v1.5.3 462b14c85230: Loading layer [==================================================>] 410.1MB/410.1MB c2e0c8cb2903: Loading layer [==================================================>] 9.216kB/9.216kB 11bdb24cded2: Loading layer [==================================================>] 9.216kB/9.216kB 5d8f974b49ef: Loading layer [==================================================>] 7.68kB/7.68kB ee04f13f4147: Loading layer [==================================================>] 1.536kB/1.536kB 799db4dfe41a: Loading layer [==================================================>] 11.78kB/11.78kB f7d813585bdd: Loading layer [==================================================>] 2.56kB/2.56kB 6300bbdbd7ab: Loading layer [==================================================>] 3.072kB/3.072kB Loaded image: vmware/harbor-db:v1.5.3 1d7516778a05: Loading layer [==================================================>] 30.09MB/30.09MB f7ec8d1b47d0: Loading layer [==================================================>] 20.91MB/20.91MB 22b0ad749c21: Loading layer [==================================================>] 20.91MB/20.91MB Loaded image: vmware/harbor-jobservice:v1.5.3 2d449d67c05a: Loading layer [==================================================>] 89.58MB/89.58MB 0bfd4e706575: Loading layer [==================================================>] 3.072kB/3.072kB 6100e173c230: Loading layer [==================================================>] 59.9kB/59.9kB 86fe093d1358: Loading layer [==================================================>] 61.95kB/61.95kB Loaded image: vmware/redis-photon:v1.5.3 Loaded image: photon:1.0 3bf3086a6569: Loading layer [==================================================>] 30.09MB/30.09MB 641d0f77d675: Loading layer [==================================================>] 10.95MB/10.95MB 89efbaabea87: Loading layer [==================================================>] 17.3MB/17.3MB 1276e51f4dc2: Loading layer [==================================================>] 15.87kB/15.87kB 49e187d04e78: Loading layer [==================================================>] 3.072kB/3.072kB e62fbfea411d: Loading layer [==================================================>] 28.24MB/28.24MB Loaded image: vmware/notary-signer-photon:v0.5.1-v1.5.3 Loaded image: vmware/mariadb-photon:v1.5.3 201f6ade61d8: Loading layer [==================================================>] 102.5MB/102.5MB 81221fbb5879: Loading layer [==================================================>] 6.656kB/6.656kB 2268e3c9e521: Loading layer [==================================================>] 2.048kB/2.048kB 9fca06f4b193: Loading layer [==================================================>] 7.68kB/7.68kB Loaded image: vmware/postgresql-photon:v1.5.3 11d6e8a232c9: Loading layer [==================================================>] 30.09MB/30.09MB 42650b04d53d: Loading layer [==================================================>] 24.41MB/24.41MB a1cd8af19e29: Loading layer [==================================================>] 7.168kB/7.168kB 4b1cda90ba19: Loading layer [==================================================>] 10.56MB/10.56MB 1351f0f3006a: Loading layer [==================================================>] 24.4MB/24.4MB Loaded image: vmware/harbor-ui:v1.5.3 e335f4c3af7d: Loading layer [==================================================>] 79.93MB/79.93MB 2aea487bc2c4: Loading layer [==================================================>] 3.584kB/3.584kB d2efec3de68b: Loading layer [==================================================>] 3.072kB/3.072kB d0d71a5ce1dd: Loading layer [==================================================>] 4.096kB/4.096kB 19930367abf0: Loading layer [==================================================>] 3.584kB/3.584kB 03e5b7640db5: Loading layer [==================================================>] 9.728kB/9.728kB Loaded image: vmware/harbor-log:v1.5.3 5aebe8cc938c: Loading layer [==================================================>] 11.97MB/11.97MB Loaded image: vmware/nginx-photon:v1.5.3 ede6a57cbd7e: Loading layer [==================================================>] 30.09MB/30.09MB 4d6dd4fc1d87: Loading layer [==================================================>] 2.56kB/2.56kB c86a69f49f60: Loading layer [==================================================>] 2.56kB/2.56kB 0cf6e04c5927: Loading layer [==================================================>] 2.048kB/2.048kB 6fbff4fe9739: Loading layer [==================================================>] 22.8MB/22.8MB 6f527a618092: Loading layer [==================================================>] 22.8MB/22.8MB Loaded image: vmware/registry-photon:v2.6.2-v1.5.3 e29a8834501b: Loading layer [==================================================>] 12.16MB/12.16MB aaf67f1da2c7: Loading layer [==================================================>] 17.3MB/17.3MB 8d5718232133: Loading layer [==================================================>] 15.87kB/15.87kB fc89aca1dd12: Loading layer [==================================================>] 3.072kB/3.072kB 076eb5a76f6d: Loading layer [==================================================>] 29.46MB/29.46MB Loaded image: vmware/notary-server-photon:v0.5.1-v1.5.3 454c81edbd3b: Loading layer [==================================================>] 135.2MB/135.2MB e99db1275091: Loading layer [==================================================>] 395.4MB/395.4MB 051e4ee23882: Loading layer [==================================================>] 9.216kB/9.216kB 6cca4437b6f6: Loading layer [==================================================>] 9.216kB/9.216kB 1d48fc08c8bc: Loading layer [==================================================>] 7.68kB/7.68kB 0419724fd942: Loading layer [==================================================>] 1.536kB/1.536kB 543c0c1ee18d: Loading layer [==================================================>] 655.2MB/655.2MB 4190aa7e89b8: Loading layer [==================================================>] 103.9kB/103.9kB Loaded image: vmware/harbor-migrator:v1.5.0 45878c64fc3c: Loading layer [==================================================>] 165.3MB/165.3MB fc3d407ce98f: Loading layer [==================================================>] 10.93MB/10.93MB d7a0785bb902: Loading layer [==================================================>] 2.048kB/2.048kB a17e0f23bc84: Loading layer [==================================================>] 48.13kB/48.13kB 57c7181f2336: Loading layer [==================================================>] 10.97MB/10.97MB Loaded image: vmware/clair-photon:v2.0.5-v1.5.3 [Step 2]: preparing environment ... Generated and saved secret to file: /data/secretkey Generated configuration file: ./common/config/nginx/nginx.conf Generated configuration file: ./common/config/adminserver/env Generated configuration file: ./common/config/ui/env Generated configuration file: ./common/config/registry/config.yml Generated configuration file: ./common/config/db/env Generated configuration file: ./common/config/jobservice/env Generated configuration file: ./common/config/jobservice/config.yml Generated configuration file: ./common/config/log/logrotate.conf Generated configuration file: ./common/config/jobservice/config.yml Generated configuration file: ./common/config/ui/app.conf Generated certificate, key file: ./common/config/ui/private_key.pem, cert file: ./common/config/registry/root.crt The configuration files are ready, please use docker-compose to start the service. Creating harbor-log ... done [Step 3]: checking existing instance of Harbor ... Creating registry ... done Creating harbor-ui ... done Creating network \"harbor_harbor\" with the default driver Creating nginx ... done Creating harbor-db ... Creating registry ... Creating harbor-adminserver ... Creating redis ... Creating harbor-ui ... Creating harbor-jobservice ... Creating nginx ... \u2714 ----Harbor has been installed and started successfully.---- Now you should be able to visit the admin portal at http://192.168.183.134. For more details, please visit https://github.com/vmware/harbor . \u53ef\u4ee5\u770b\u5230\u4ee5\u4e0a\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\u3002\u6211\u4eec\u901a\u8fc7web\u8bbf\u95eeharbor\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0a\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\u3002 \u5b89\u88c5\u5b8c\u6bd5\u540e\u67e5\u770bdocker Harbor\u5176\u5b9e\u4e5f\u662f\u52a0\u8f7ddocker\u955c\u50cf 4.3 Web\u64cd\u4f5c \u00b6 4.3.1 \u7b80\u5355\u4ecb\u7ecd \u00b6 \u9ed8\u8ba4\u8d26\u53f7\u548c\u5bc6\u7801\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c \u8d26\u53f7\u662f: admin \u5bc6\u7801\u662f: Harbor12345 4.3.2 \u65b0\u5efa\u7528\u6237 \u00b6 \u56e0\u4e3aharbor\u662f\u591a\u4eba\u7684\u79c1\u6709\u4ed3\u5e93\uff0c\u6240\u4ee5\u5efa\u7acb\u666e\u901a\u7528\u6237\uff0c\u5bf9\u5e94\u5efa\u7acb\u79c1\u6709\u7684\u4ed3\u5e93\uff0c\u7136\u540edocker\u5ba2\u6237\u7aef\u901a\u8fc7\u4f7f\u7528\u8fd9\u4e2a\u65b0\u5efa\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u767b\u5f55harbor\u7136\u540e\u63a8\u9001\u5230\u81ea\u5df1\u7684\u4ed3\u5e93\u4e2d\u3002 4.3.3 \u65b0\u5efa\u79c1\u6709\u4ed3\u5e93 \u00b6 4.3.4 \u666e\u901a\u7528\u6237\u767b\u5f55 \u00b6 4.3.5 \u666e\u901a\u7528\u6237\u65b0\u5efa\u9879\u76ee \u00b6 4.4 \u5ba2\u6237\u7aef\u64cd\u4f5c\u63a8\u9001 \u00b6 4.4.1 pull\u955c\u50cf \u00b6 [root@localhost img4]# ifconfig ens33 ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500 inet 192.168.183.133 netmask 255.255.255.0 broadcast 192.168.183.255 ether 00:0c:29:9e:1f:67 txqueuelen 1000 (Ethernet) RX packets 66573 bytes 17079495 (16.2 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 36722 bytes 16771887 (15.9 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 [root@localhost img4]# cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"insecure-registries\":[\"192.168.183.134\"] } [root@localhost img4]# systemctl restart docker 4.4.2 \u5ba2\u6237\u7aef\u6253tag \u00b6 \u6253tag\u7684\u76ee\u7684\u4e3b\u8981\u662f\u63a8\u9001\u7684\u955c\u50cf\u5230\u79c1\u6709\u4ed3\u5e93\u800c\u4e0d\u662f\u63a8\u9001\u5230dockerhub\u4e0a\uff08\u9ed8\u8ba4\u90fd\u662f\u63a8\u9001\u5230dockerhub\u4e0a\uff09 [root@localhost img4]# docker tag myweb:v0.3-4 192.168.183.134/myweb/myweb:v0.3-4 [root@localhost img4]# docker tag myweb:v0.3-5 192.168.183.134/myweb/myweb:v0.3-5 [root@localhost img4]# docker tag myweb:v0.3-6 192.168.183.134/myweb/myweb:v0.3-6 [root@localhost img4]# docker tag myweb:v0.3-7 192.168.183.134/myweb/myweb:v0.3-7 4.4.3 \u767b\u5f55 \u00b6 [root@localhost img4]# docker login 192.168.183.134 Username: caimengzhi #\u8d26\u53f7\u662fweb\u767b\u5f55\u7684\u8d26\u53f7\u548c\u5bc6\u7801 Password: WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded 4.4.4 \u63a8\u9001\u955c\u50cf \u00b6 [root@localhost img4]# docker push 192.168.183.134/myweb/myweb <\u82e5\u662f\u63a8\u9001\u4e0d\u6307\u5b9a\u955c\u50cftag\uff0c\u4f1a\u63a8\u9001\u6240\u6709192.168.183.134/myweb/myweb\u7684\u955c\u50cf> The push refers to repository [192.168.183.134/myweb/myweb] a8dcd6aa3279: Pushed 9a07ffbe3d7d: Pushed 955e7d7f7300: Pushed 95bb4e754f2d: Pushed ebf12965380b: Pushed v0.3-4: digest: sha256:bff4611d26ab5ea7df2a2038f5c806060343e8dcb72f4e7d9c8186f9f29ab1d2 size: 1360 02d539f1584f: Pushed 9a07ffbe3d7d: Layer already exists 955e7d7f7300: Layer already exists 95bb4e754f2d: Layer already exists ebf12965380b: Layer already exists v0.3-5: digest: sha256:d989d072b34649c6c3db1b90cc8e9da01fc0851db7154087f8c20d9276c6b19e size: 1360 cf1c42bcc62e: Pushed 31d53a6ec2f6: Pushed 9a07ffbe3d7d: Layer already exists 955e7d7f7300: Layer already exists 95bb4e754f2d: Layer already exists ebf12965380b: Layer already exists v0.3-6: digest: sha256:f001406ad67619ca5a20595f5392099f4c89aabc03a577a9e2b21951daa6625b size: 1567 cf1c42bcc62e: Layer already exists 31d53a6ec2f6: Layer already exists 9a07ffbe3d7d: Layer already exists 955e7d7f7300: Layer already exists 95bb4e754f2d: Layer already exists ebf12965380b: Layer already exists v0.3-7: digest: sha256:f001406ad67619ca5a20595f5392099f4c89aabc03a577a9e2b21951daa6625b size: 1567 4.4.5 \u67e5\u770b\u63a8\u9001\u60c5\u51b5 \u00b6 \u63a8\u9001\u5b8c\u6bd5\u540e\u5728docker\u79c1\u6709\u4ed3\u5e93\u4e0aweb\u67e5\u770b\u4e4b\u524d\u63a8\u9001\u7684\u60c5\u51b5\u3002 4.5 \u5ba2\u6237\u7aef\u64cd\u4f5c\u62c9 \u00b6 \u65b0\u627e\u4e00\u4e2a\u522b\u7684\u673a\u5668\u53bb\u62c9\u53bb\u64cd\u4f5c 4.5.1 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u00b6 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff08http\uff09 [root@leco ~]# cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"insecure-registries\":[\"192.168.183.134\"] } 4.5.2 \u91cd\u542fdocker \u00b6 [root@leco ~]# systemctl restart docker [root@leco ~]# ifconfig ens33 ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500 inet 192.168.183.135 netmask 255.255.255.0 broadcast 192.168.183.255 ether 00:0c:29:5e:f3:38 txqueuelen 1000 (Ethernet) RX packets 32850 bytes 2734678 (2.6 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 3833 bytes 375551 (366.7 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 4.5.3 \u767b\u5f55 \u00b6 [root@leco ~]# docker login 192.168.183.134 Username: caimengzhi Password: WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded 4.5.4 \u5730\u5740 \u00b6 \u767b\u5f55web\u754c\u9762\u627e\u5230pull\u7684\u5730\u5740 [root@leco ~]# docker pull 192.168.183.134/myweb/myweb:v0.3-7 v0.3-7: Pulling from myweb/myweb c67f3896b22c: Pull complete 428de5b8d58a: Pull complete 7efd417f3e28: Pull complete 61a56b170416: Pull complete e7206a413d4c: Pull complete 54a1363d75f0: Pull complete Digest: sha256:f001406ad67619ca5a20595f5392099f4c89aabc03a577a9e2b21951daa6625b Status: Downloaded newer image for 192.168.183.134/myweb/myweb:v0.3-7 4.5.5 \u67e5\u770b\u672c\u5730\u955c\u50cf \u00b6 [root@leco ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE 192.168.183.134/myweb/myweb v0.3-7 5799f549739a 3 hours ago 17.4MB 4.6 Harbor \u670d\u52a1\u64cd\u4f5c \u00b6 4.6.1 \u6682\u505c \u00b6 [root@leco ~]# docker-compose pause 4.6.2 \u505c\u6b62 \u00b6 [root@leco ~]# docker-compose stop 4.6.3 \u542f\u52a8 \u00b6 [root@leco ~]# docker-compose start [root@leco harbor]# pwd /usr/local/harbor [root@leco harbor]# ll total 895716 drwxr-xr-x 4 root root 37 Sep 20 17:37 common -rw-r--r-- 1 root root 1185 Sep 12 14:19 docker-compose.clair.yml -rw-r--r-- 1 root root 1725 Sep 12 14:19 docker-compose.notary.yml -rw-r--r-- 1 root root 3596 Sep 12 14:19 docker-compose.yml drwxr-xr-x 3 root root 156 Sep 12 14:19 ha -rw-r--r-- 1 root root 6955 Sep 20 17:32 harbor.cfg -rw-r--r-- 1 root root 6956 Sep 20 17:31 harbor.cfg.ori -rw-r--r-- 1 root root 915878468 Sep 12 14:21 harbor.v1.5.3.tar.gz -rwxr-xr-x 1 root root 5773 Sep 12 14:19 install.sh -rw-r--r-- 1 root root 10764 Sep 12 14:19 LICENSE -rw-r--r-- 1 root root 482 Sep 12 14:19 NOTICE -rw-r--r-- 1 root root 1247461 Sep 12 14:19 open_source_license -rwxr-xr-x 1 root root 27840 Sep 12 14:19 prepare \u4ee5\u4e0a\u64cd\u4f5c\u90fd\u8981\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u6267\u884c\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u52a0\u8f7ddocker-compose.yml\u6587\u4ef6 4.7 Harbor \u90ae\u4ef6 \u00b6 4.7.1 \u90ae\u4ef6\u914d\u7f6e \u00b6 \u6211\u4f7f\u7528\u7684163\u7684\u90ae\u7bb1\u8bf7\u6309\u7167\u4e0a\u8ff0\u53c2\u6570\u627e\u5230\u81ea\u5df1\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5176\u4ed6\u90ae\u7bb1\u8bf7\u767e\u5ea6\u81ea\u884c\u914d\u7f6e\u3002 \u914d\u7f6e\u5b8c\u540e\u3002\u68c0\u9a8c 4.7.2 \u5fd8\u8bb0\u767b\u5f55\u5bc6\u7801 \u00b6 \u7136\u540e\u91cd\u65b0\u767b\u5f55 4.8 QA \u00b6 Q\uff1aMaster-Slave\u7684\u955c\u50cf\u67b6\u6784\u4e2d,\u5982\u679cSlave Registy\u4e2d\u7684\u955c\u50cf\u88ab\u5220\u9664\u4e86\uff0c\u4f1a\u4e0d\u4f1a\u518d\u6b21\u81ea\u52a8\u4eceMaster Reg\u91cc\u9762\u81ea\u52a8\u540c\u6b65\uff1f A\uff1a\u5982\u679c\u505c\u6b62\u540e\u518d\u91cd\u65b0\u542f\u52a8\u590d\u5236\u7b56\u7565\uff0c\u53ef\u4ee5\u540c\u6b65\u88ab\u5220\u9664\u7684\u955c\u50cf\u3002 Q\uff1a\u5bf9\u4e8e\u591a\u4e2a\u6295\u4ea7\u5730\uff0c\u591a\u4e2a\u4ed3\u5e93\uff0c\u54ea\u79cd\u65b9\u5f0f\u7684\u9ad8\u53ef\u7528\u65b9\u6848\u597d\u4e48\uff1f\u7b2c\u4e00\u79cd\uff0c\u5171\u4eab\u5b58\u50a8\u5b58\u50a8\u53ef\u80fd\u4f1a\u51fa\u73b0\u5355\u70b9\u6545\u969c\u4e48\uff1f A\uff1a\u5171\u4eab\u5b58\u50a8\u53ea\u9002\u5408\u540c\u4e00\u6570\u636e\u4e2d\u5fc3\uff0c\u591a\u4e2a\u4ea7\u5730\u5ef6\u65f6\u592a\u5927\uff0c\u4e0d\u9002\u5408\u5171\u4eab\u5b58\u50a8\u3002 Q\uff1aRegistry\u4e4b\u95f4\u540c\u6b65\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f A\uff1aRegistry API\u3002 Q\uff1a\u5728\u5b58\u50a8\u8fd9\u5757\u8003\u8651\u8fc7\u63d0\u4f9b\u63d2\u4ef6\u65b9\u5f0f\u53ef\u4ee5\u8c03\u7528\u5916\u90e8\u6a21\u5757\uff0c\u6bd4\u5982\u4ee5\u63d2\u4ef6\u65b9\u5f0f\u652f\u6301s3\u8fd9\u79cd\u5bf9\u8c61\u5b58\u50a8\uff1f A\uff1aHarbor\u652f\u6301\u5176\u4ed6\u5b58\u50a8\u65b9\u5f0f\uff0c\u53c2\u89c1Harbor\u6587\u6863\u3002","title":"1. Harbor"},{"location":"linux/server/harbor/harbor.index/#1-harbor","text":"Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002 \u955c\u50cf\u7684\u5b58\u50a8harbor\u4f7f\u7528\u7684\u662f\u5b98\u65b9\u7684docker registry(v2\u547d\u540d\u662fdistribution)\u670d\u52a1\u53bb\u5b8c\u6210\u3002harbor\u5728docker distribution\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u4e86\u4e00\u4e9b\u5b89\u5168\u3001\u8bbf\u95ee\u63a7\u5236\u3001\u7ba1\u7406\u7684\u529f\u80fd\u4ee5\u6ee1\u8db3\u4f01\u4e1a\u5bf9\u4e8e\u955c\u50cf\u4ed3\u5e93\u7684\u9700\u6c42\u3002harbor\u4ee5docker-compose\u7684\u89c4\u8303\u5f62\u5f0f\u7ec4\u7ec7\u5404\u4e2a\u7ec4\u4ef6\uff0c\u5e76\u901a\u8fc7docker-compose\u5de5\u5177\u8fdb\u884c\u542f\u505c\u3002 docker\u7684registry\u662f\u7528\u672c\u5730\u5b58\u50a8\u6216\u8005s3\u90fd\u662f\u53ef\u4ee5\u7684\uff0charbor\u7684\u529f\u80fd\u662f\u5728\u6b64\u4e4b\u4e0a\u63d0\u4f9b\u7528\u6237\u6743\u9650\u7ba1\u7406\u3001\u955c\u50cf\u590d\u5236\u7b49\u529f\u80fd\uff0c\u63d0\u9ad8\u4f7f\u7528\u7684registry\u7684\u6548\u7387\u3002Harbor\u7684\u955c\u50cf\u62f7\u8d1d\u529f\u80fd\u662f\u901a\u8fc7docker registry\u7684API\u53bb\u62f7\u8d1d\uff0c\u8fd9\u79cd\u505a\u6cd5\u5c4f\u853d\u4e86\u7e41\u7410\u7684\u5e95\u5c42\u6587\u4ef6\u64cd\u4f5c\u3001\u4e0d\u4ec5\u53ef\u4ee5\u5229\u7528\u73b0\u6709docker registry\u529f\u80fd\u4e0d\u5fc5\u91cd\u590d\u9020\u8f6e\u5b50\uff0c\u800c\u4e14\u53ef\u4ee5\u89e3\u51b3\u51b2\u7a81\u548c\u4e00\u81f4\u6027\u7684\u95ee\u9898\u3002","title":"1. Harbor\u7b80\u4ecb"},{"location":"linux/server/harbor/harbor.index/#11-harbor","text":"\u4e3b\u8981\u7ec4\u4ef6\u5305\u62ec: Proxy\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6nginx\u3002\u5b83\u662f\u4e00\u4e2anginx\u53cd\u5411\u4ee3\u7406\uff0c\u4ee3\u7406Notary client\uff08\u955c\u50cf\u8ba4\u8bc1\uff09\u3001Docker client\uff08\u955c\u50cf\u4e0a\u4f20\u4e0b\u8f7d\u7b49\uff09\u548c\u6d4f\u89c8\u5668\u7684\u8bbf\u95ee\u8bf7\u6c42\uff08Core Service\uff09\u7ed9\u540e\u7aef\u7684\u5404\u670d\u52a1\uff1b UI\uff08Core Service\uff09\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-ui\u3002\u5e95\u5c42\u6570\u636e\u5b58\u50a8\u4f7f\u7528mysql\u6570\u636e\u5e93\uff0c\u4e3b\u8981\u63d0\u4f9b\u4e86\u56db\u4e2a\u5b50\u529f\u80fd\uff1a UI\uff1a\u4e00\u4e2aweb\u7ba1\u7406\u9875\u9762ui\uff1b API\uff1aHarbor\u66b4\u9732\u7684API\u670d\u52a1\uff1b Auth\uff1a\u7528\u6237\u8ba4\u8bc1\u670d\u52a1\uff0cdecode\u540e\u7684token\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u5728\u8fd9\u91cc\u8fdb\u884c\u8ba4\u8bc1\uff1bauth\u540e\u7aef\u53ef\u4ee5\u63a5db\u3001ldap\u3001uaa\u4e09\u79cd\u8ba4\u8bc1\u5b9e\u73b0\uff1b Token\u670d\u52a1\uff08\u4e0a\u56fe\u4e2d\u672a\u4f53\u73b0\uff09\uff1a\u8d1f\u8d23\u6839\u636e\u7528\u6237\u5728\u6bcf\u4e2aproject\u4e2d\u7684role\u6765\u4e3a\u6bcf\u4e00\u4e2adocker push/pull\u547d\u4ee4issuing\u4e00\u4e2atoken\uff0c\u5982\u679c\u4ecedocker client\u53d1\u9001\u7ed9registry\u7684\u8bf7\u6c42\u6ca1\u6709\u5e26token\uff0cregistry\u4f1a\u91cd\u5b9a\u5411\u8bf7\u6c42\u5230token\u670d\u52a1\u521b\u5efatoken\u3002 Registry\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6registry\u3002\u8d1f\u8d23\u5b58\u50a8\u955c\u50cf\u6587\u4ef6\uff0c\u548c\u5904\u7406\u955c\u50cf\u7684pull/push\u547d\u4ee4\u3002Harbor\u5bf9\u955c\u50cf\u8fdb\u884c\u5f3a\u5236\u7684\u8bbf\u95ee\u63a7\u5236\uff0cRegistry\u4f1a\u5c06\u5ba2\u6237\u7aef\u7684\u6bcf\u4e2apull\u3001push\u8bf7\u6c42\u8f6c\u53d1\u5230token\u670d\u52a1\u6765\u83b7\u53d6\u6709\u6548\u7684token\u3002 Admin Service\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-adminserver\u3002\u662f\u7cfb\u7edf\u7684\u914d\u7f6e\u7ba1\u7406\u4e2d\u5fc3\u9644\u5e26\u68c0\u67e5\u5b58\u50a8\u7528\u91cf\uff0cui\u548cjobserver\u542f\u52a8\u65f6\u5019\u9700\u8981\u52a0\u8f7dadminserver\u7684\u914d\u7f6e\uff1b Job Sevice\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-jobservice\u3002\u8d1f\u8d23\u955c\u50cf\u590d\u5236\u5de5\u4f5c\u7684\uff0c\u4ed6\u548cregistry\u901a\u4fe1\uff0c\u4ece\u4e00\u4e2aregistry pull\u955c\u50cf\u7136\u540epush\u5230\u53e6\u4e00\u4e2aregistry\uff0c\u5e76\u8bb0\u5f55job_log\uff1b Log Collector\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-log\u3002\u65e5\u5fd7\u6c47\u603b\u7ec4\u4ef6\uff0c\u901a\u8fc7docker\u7684log-driver\u628a\u65e5\u5fd7\u6c47\u603b\u5230\u4e00\u8d77\uff1b Volnerability Scanning\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6clair\u3002\u8d1f\u8d23\u955c\u50cf\u626b\u63cf Notary\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6notary\u3002\u8d1f\u8d23\u955c\u50cf\u8ba4\u8bc1 DB\uff1a\u5bf9\u5e94\u542f\u52a8\u7ec4\u4ef6harbor-db\uff0c\u8d1f\u8d23\u5b58\u50a8project\u3001 user\u3001 role\u3001replication\u3001image_scan\u3001access\u7b49\u7684metadata\u6570\u636e\u3002","title":"1.1 Harbor\u67b6\u6784"},{"location":"linux/server/harbor/harbor.index/#12-docker-registery","text":"1.Registry\u7528\u4e8e\u4fdd\u5b58docker\u955c\u50cf\uff0c\u5305\u62ec\u955c\u50cf\u7684\u5c42\u6b21\u7ed3\u6784\u548c\u5143\u6570\u636e 2.\u7528\u6237\u53ef\u81ea\u5efaRegistry\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5b98\u65b9\u7684Docker Hub Docker Registery \u5206\u7c7b 1.Sponsor Registry \u7b2c\u4e09\u65b9Registry\uff0c\u4f9b\u5ba2\u6237\u548cDocker\u793e\u533a\u4f7f\u7528 2.Mirror Registry \u7b2c\u4e09\u65b9Registry\uff0c\u53ea\u8ba9\u5ba2\u6237\u4f7f\u7528 3.Vendor Registry \u7531\u53d1\u5e03Docker\u955c\u50cf\u7684\u4f9b\u5e94\u5546\u63d0\u4f9b\u7684Registry 4.Private Registry \u901a\u8fc7\u8bbe\u6709\u9632\u706b\u5899\u548c\u989d\u5916\u7684\u5b89\u5168\u5c42\u7684\u79c1\u6709\u5b9e\u4f53\u63d0\u4f9b\u7684Registry","title":"1.2 Docker Registery"},{"location":"linux/server/harbor/harbor.index/#2","text":"\u670d\u52a1\u5668\u7684ip\u89c4\u5212 \u673a\u5668 IP \u7cfb\u7edf Docker Registry 192.168.183.134 Centos 7\uff08\u968f\u4fbf\u4f60\u4ec0\u4e48\u7cfb\u7edf\uff09 Docker Client 192.168.183.133 Centos 7\uff08\u968f\u4fbf\u4f60\u4ec0\u4e48\u7cfb\u7edf\uff09\u63a8\u9001\u955c\u50cf Docker Client 192.168.183.135 Centos 7\uff08\u968f\u4fbf\u4f60\u4ec0\u4e48\u7cfb\u7edf\uff09\u62c9\u53d6\u955c\u50cf \u540d\u8bcd\u89e3\u91ca No \u540d\u8bcd \u89e3\u91ca 1 Docker Registry Docker\u79c1\u6709\u4ed3\u5e93\uff08\u672c\u5730\uff09 2 Docker Client \u4e0a\u4f20\u548c\u4e0b\u8f7d\u7684docker\u5ba2\u6237\u7aef","title":"2. \u7cfb\u7edf\u90e8\u7f72\u57fa\u7840"},{"location":"linux/server/harbor/harbor.index/#3-docker","text":"","title":"3. Docker\u81ea\u5e26\u4ed3\u5e93"},{"location":"linux/server/harbor/harbor.index/#31","text":"","title":"3.1 \u5b89\u88c5\u5b98\u65b9\u81ea\u5e26\u4ed3\u5e93"},{"location":"linux/server/harbor/harbor.index/#311","text":"[root@leco ~]# yum install docker-registry [root@leco ~]# yum info docker-registry Loaded plugins: fastestmirror Loading mirror speeds from cached hostfile * base: mirrors.aliyun.com * epel: mirrors.aliyun.com * extras: mirrors.aliyun.com * updates: mirrors.aliyun.com Available Packages Name : docker-registry Arch : x86_64 Version : 0.9.1 Release : 7.el7 Size : 123 k Repo : extras/7/x86_64 Summary : Registry server for Docker URL : https://github.com/docker/docker-registry License : ASL 2.0 Description : Registry server for Docker (hosting/delivering of repositories and images).","title":"3.1.1 \u5b89\u88c5"},{"location":"linux/server/harbor/harbor.index/#312","text":"[root@leco ~]# rpm -ql docker-distribution /etc/docker-distribution/registry/config.yml /usr/bin/registry /usr/lib/systemd/system/docker-distribution.service /usr/share/doc/docker-distribution-2.6.2 /usr/share/doc/docker-distribution-2.6.2/AUTHORS /usr/share/doc/docker-distribution-2.6.2/CONTRIBUTING.md /usr/share/doc/docker-distribution-2.6.2/LICENSE /usr/share/doc/docker-distribution-2.6.2/MAINTAINERS /usr/share/doc/docker-distribution-2.6.2/README.md /var/lib/registry [root@leco registry]# pwd /etc/docker-distribution/registry [root@leco registry]# cat config.yml version: 0.1 log: fields: service: registry storage: cache: layerinfo: inmemory filesystem: rootdirectory: /var/lib/registry # \u4ed3\u5e93\u7684\u5b58\u50a8\u8def\u5f84\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\uff08\u627e\u5927\u70b9\u7684\u7a7a\u95f4\u914d\u7f6e\uff09 http: # \u4ed3\u5e93\u534f\u8bae addr: :5000 # \u4ed3\u5e93\u7aef\u53e3","title":"3.1.2 \u67e5\u770b\u5b89\u88c5\u4fe1\u606f"},{"location":"linux/server/harbor/harbor.index/#313","text":"[root@leco registry]# systemctl start docker-distribution.service","title":"3.1.3 \u542f\u52a8\u4ed3\u5e93"},{"location":"linux/server/harbor/harbor.index/#314","text":"[root@leco registry]# systemctl enable docker-distribution.service Created symlink from /etc/systemd/system/multi-user.target.wants/docker-distribution.service to /usr/lib/systemd/system/docker-distribution.service.","title":"3.1.4 \u5f00\u673a\u81ea\u542f\u52a8"},{"location":"linux/server/harbor/harbor.index/#315","text":"[root@leco registry]# ss -tnl State Recv-Q Send-Q Local Address:Port Peer Address:Port LISTEN 0 100 127.0.0.1:25 *:* LISTEN 0 128 *:22 *:* LISTEN 0 100 ::1:25 :::* LISTEN 0 128 :::5000 :::* LISTEN 0 128 :::22 :::*","title":"3.1.5 \u67e5\u770b\u670d\u52a1"},{"location":"linux/server/harbor/harbor.index/#32-docker","text":"\u627e\u4e00\u4e2a\u65b0\u7684docker\u5ba2\u6237\u7aef\u6d4b\u8bd5\u63a8\u62c9","title":"3.2 Docker\u5ba2\u6237\u7aef\u64cd\u4f5c"},{"location":"linux/server/harbor/harbor.index/#321-tag","text":"\u73b0\u5728\u5ba2\u6237\u7aef\u6807\u7b7edocker\u79c1\u6709\u4ed3\u5e93\u5730\u5740\u3002\u4e0d\u6253\u6807\u7b7e\u9ed8\u8ba4\u63a8\u9001\u5230docker github\u4e0a [root@localhost img4]# docker tag myweb:v0.3-11 192.168.183.134:5000/myweb:v0.3-11","title":"3.2.1 \u6253tag"},{"location":"linux/server/harbor/harbor.index/#322-tag","text":"[root@localhost img4]# docker images |grep 5000 192.168.183.134:5000/myweb v0.3-11 44ef73a3a19b 39 minutes ago 18MB [root@localhost img4]# docker push 192.168.183.134:5000/myweb:v0.3-11 The push refers to repository [192.168.183.134:5000/myweb] Get https://192.168.183.134:5000/v2/: http: server gave HTTP response to HTTPS client \u6b64\u65f6\u8981\u5728\u5ba2\u6237\u7aef\u6539\u53d8\u914d\u7f6e\uff0c\u53d8\u6210http\u534f\u8bae\uff08docker \u4ed3\u5e93\u9ed8\u8ba4\u662fhttps\u534f\u8bae\uff0c\u6211\u4eec\u4f7f\u7528http\u534f\u8bae\uff09 [root@localhost img4]# cat !$ cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"insecure-registries\":[\"192.168.183.134:5000\"] } \u5176\u4e2dinsecure-registries\u540e\u9762\u662fdocker\u4ed3\u5e93\u7684\u5730\u5740\u548c\u7aef\u53e3\u3002 [root@localhost img4]# systemctl restart docker","title":"3.2.2 \u67e5\u770btag\u4fe1\u606f"},{"location":"linux/server/harbor/harbor.index/#323-push","text":"\u4fee\u6539\u534f\u8bae\u540e\u91cd\u542fdocker\u7136\u540e\u5728push\u955c\u50cf\u5230\u79c1\u6709\u4ed3\u5e93\u91cc\u9762 [root@localhost img4]# docker push 192.168.183.134:5000/myweb:v0.3-11 The push refers to repository [192.168.183.134:5000/myweb] 347a19806329: Pushed 20555723c54b: Pushed a79fe6dff072: Pushed 87deea508850: Pushed 90c4db1d5ef5: Pushed cd7100a72410: Pushed v0.3-11: digest: sha256:be593f8f6e45181416242b37183b3c5429745e3623424a1a9b672afab898714e size: 1568","title":"3.2.3 push"},{"location":"linux/server/harbor/harbor.index/#324","text":"docker\u79c1\u6709\u4ed3\u5e93\u7aef\u67e5\u770b [root@leco registry]# ls /var/lib/registry/docker/registry/v2/repositories/myweb/_layers/sha256/ 44ef73a3a19b95ae6f7e0c4bf92f0fcc876dce929340455c591430203b4bc151 4b15fa862ac67691a8bc682937be38197ebebe580f01b1bcc0ee823fc43709aa 5e38f0c1e3e667d4fd01ac85ebcd4337579471d841a925d4be81bde53a482614 7d4e05a01906143afc15671a53151ea9755dac230db376a8b8364b21ca774dbc 8aeac9a3205fce5e21ab65ccce330fe389a9aaf47e4b682970b1772ae25a1d73 b430473be128c1302a75e8381dfbaa45182fec81db4f75b749e4896d7816c2ea ff3a5c916c92643ff77519ffa742d3ec61b7f591b6b7504599d95a4a41134e28 \u53ef\u89c1\u4ecedocker\u5ba2\u6237\u7aefpush\u4e0a\u7684\u955c\u50cf\u5df2\u7ecf\u63a8\u9001\u8fc7\u6765\uff0c\u7ecf\u8fc7hash\u4e86\u3002","title":"3.2.4 \u4ed3\u5e93\u67e5\u770b"},{"location":"linux/server/harbor/harbor.index/#325-pull","text":"\u5728\u5176\u4ed6\u673a\u5668\u4e0a\u6d4b\u8bd5\uff08pull\u955c\u50cf\uff09 [root@leco registry]# cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"bip\": \"10.0.0.1/16\", \"insecure-registries\":[\"192.168.183.134:5000\"] } [root@leco registry]# systemctl restart docker [root@leco registry]# docker pull 192.168.183.134:5000/myweb:v0.3-11 v0.3-11: Pulling from myweb ff3a5c916c92: Pull complete b430473be128: Pull complete 7d4e05a01906: Pull complete 8aeac9a3205f: Pull complete 5e38f0c1e3e6: Pull complete 4b15fa862ac6: Pull complete Digest: sha256:be593f8f6e45181416242b37183b3c5429745e3623424a1a9b672afab898714e Status: Downloaded newer image for 192.168.183.134:5000/myweb:v0.3-11 [root@leco registry]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE 192.168.183.134:5000/myweb v0.3-11 44ef73a3a19b About an hour ago 18MB","title":"3.2.5 pull"},{"location":"linux/server/harbor/harbor.index/#4-harbor","text":"","title":"4. Harbor"},{"location":"linux/server/harbor/harbor.index/#41","text":"\u5b98\u65b9\u6587\u6863 \u5b89\u88c5\u6b65\u9aa4","title":"4.1 \u53c2\u8003\u6587\u6863"},{"location":"linux/server/harbor/harbor.index/#42","text":"\u4e0b\u8f7d\u5b89\u88c5\u540e\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u89e3\u538b\u914d\u7f6e\u5b89\u88c5\u3002","title":"4.2 \u4e0b\u8f7d\u5b89\u88c5"},{"location":"linux/server/harbor/harbor.index/#421","text":"\u5173\u95ed\u4e4b\u524d\u81ea\u5e26\uff08github\u81ea\u5df1\u7684\uff09\u7684\u955c\u50cf\u4ed3\u5e93 [root@leco ~]# netstat -lnp|grep 5000 tcp6 0 0 :::5000 :::* LISTEN 17540/registry [root@leco ~]# systemctl stop docker-distribution [root@leco ~]# netstat -lnp|grep 500 [root@leco opt]# ls harbor-offline-installer-v1.5.3.tgz myimages.gz [root@leco opt]# tar xf harbor-offline-installer-v1.5.3.tgz -C /usr/local/ [root@leco opt]# cd /usr/local/harbor/ [root@leco harbor]# pwd /usr/local/harbor [root@leco harbor]# ll total 895716 drwxr-xr-x 4 root root 37 Sep 20 17:37 common -rw-r--r-- 1 root root 1185 Sep 12 14:19 docker-compose.clair.yml -rw-r--r-- 1 root root 1725 Sep 12 14:19 docker-compose.notary.yml -rw-r--r-- 1 root root 3596 Sep 12 14:19 docker-compose.yml drwxr-xr-x 3 root root 156 Sep 12 14:19 ha -rw-r--r-- 1 root root 6955 Sep 20 17:32 harbor.cfg -rw-r--r-- 1 root root 6956 Sep 20 17:31 harbor.cfg.ori -rw-r--r-- 1 root root 915878468 Sep 12 14:21 harbor.v1.5.3.tar.gz -rwxr-xr-x 1 root root 5773 Sep 12 14:19 install.sh -rw-r--r-- 1 root root 10764 Sep 12 14:19 LICENSE -rw-r--r-- 1 root root 482 Sep 12 14:19 NOTICE -rw-r--r-- 1 root root 1247461 Sep 12 14:19 open_source_license -rwxr-xr-x 1 root root 27840 Sep 12 14:19 prepare [root@leco harbor]# cp harbor.cfg harbor.cfg.ori","title":"4.2.1 \u5173\u95ed\u4ed3\u5e93"},{"location":"linux/server/harbor/harbor.index/#422","text":"[root@leco harbor]# diff harbor.cfg harbor.cfg.ori 7c7 < hostname = 192.168.183.134 --- > hostname = reg.mydomain.com \u4fee\u6539hostname\uff0chostname\u662f\u5bf9\u5916\u8bbf\u95ee\u7684\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u57df\u540d\u53ef\u4ee5ip\u5730\u5740\uff0c\u6211\u4eec\u8fd9\u4f7f\u7528ip\uff08\u4e5f\u5c31\u662fdocker\u7684\u79c1\u6709\u4ed3\u5e93\u5730\u5740\uff09","title":"4.2.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/harbor/harbor.index/#423","text":"[root@leco harbor]# sh install.sh [Step 0]: checking installation environment ... Note: docker version: 18.06.1 \u2716 Need to install docker-compose(1.7.1+) by yourself first and run this script again.","title":"4.2.3 \u5f00\u59cb\u5b89\u88c5"},{"location":"linux/server/harbor/harbor.index/#424","text":"\u5148\u8981\u5b89\u88c5docker-compose \u56e0\u4e3aharbor\u4f7f\u7528\u901a\u8fc7docker-compose\u7f16\u6392\u5de5\u5177\u53bb\u5b89\u88c5 [root@leco harbor]# yum install -y docker-compose [root@leco harbor]# sh install.sh [Step 0]: checking installation environment ... Note: docker version: 18.06.1 Note: docker-compose version: 1.18.0 [Step 1]: loading Harbor images ... dba693fc2701: Loading layer [==================================================>] 133.4MB/133.4MB 5773887c4c41: Loading layer [==================================================>] 30.09MB/30.09MB 6fc2abbcae42: Loading layer [==================================================>] 15.37MB/15.37MB d85f176a11ec: Loading layer [==================================================>] 15.37MB/15.37MB Loaded image: vmware/harbor-adminserver:v1.5.3 462b14c85230: Loading layer [==================================================>] 410.1MB/410.1MB c2e0c8cb2903: Loading layer [==================================================>] 9.216kB/9.216kB 11bdb24cded2: Loading layer [==================================================>] 9.216kB/9.216kB 5d8f974b49ef: Loading layer [==================================================>] 7.68kB/7.68kB ee04f13f4147: Loading layer [==================================================>] 1.536kB/1.536kB 799db4dfe41a: Loading layer [==================================================>] 11.78kB/11.78kB f7d813585bdd: Loading layer [==================================================>] 2.56kB/2.56kB 6300bbdbd7ab: Loading layer [==================================================>] 3.072kB/3.072kB Loaded image: vmware/harbor-db:v1.5.3 1d7516778a05: Loading layer [==================================================>] 30.09MB/30.09MB f7ec8d1b47d0: Loading layer [==================================================>] 20.91MB/20.91MB 22b0ad749c21: Loading layer [==================================================>] 20.91MB/20.91MB Loaded image: vmware/harbor-jobservice:v1.5.3 2d449d67c05a: Loading layer [==================================================>] 89.58MB/89.58MB 0bfd4e706575: Loading layer [==================================================>] 3.072kB/3.072kB 6100e173c230: Loading layer [==================================================>] 59.9kB/59.9kB 86fe093d1358: Loading layer [==================================================>] 61.95kB/61.95kB Loaded image: vmware/redis-photon:v1.5.3 Loaded image: photon:1.0 3bf3086a6569: Loading layer [==================================================>] 30.09MB/30.09MB 641d0f77d675: Loading layer [==================================================>] 10.95MB/10.95MB 89efbaabea87: Loading layer [==================================================>] 17.3MB/17.3MB 1276e51f4dc2: Loading layer [==================================================>] 15.87kB/15.87kB 49e187d04e78: Loading layer [==================================================>] 3.072kB/3.072kB e62fbfea411d: Loading layer [==================================================>] 28.24MB/28.24MB Loaded image: vmware/notary-signer-photon:v0.5.1-v1.5.3 Loaded image: vmware/mariadb-photon:v1.5.3 201f6ade61d8: Loading layer [==================================================>] 102.5MB/102.5MB 81221fbb5879: Loading layer [==================================================>] 6.656kB/6.656kB 2268e3c9e521: Loading layer [==================================================>] 2.048kB/2.048kB 9fca06f4b193: Loading layer [==================================================>] 7.68kB/7.68kB Loaded image: vmware/postgresql-photon:v1.5.3 11d6e8a232c9: Loading layer [==================================================>] 30.09MB/30.09MB 42650b04d53d: Loading layer [==================================================>] 24.41MB/24.41MB a1cd8af19e29: Loading layer [==================================================>] 7.168kB/7.168kB 4b1cda90ba19: Loading layer [==================================================>] 10.56MB/10.56MB 1351f0f3006a: Loading layer [==================================================>] 24.4MB/24.4MB Loaded image: vmware/harbor-ui:v1.5.3 e335f4c3af7d: Loading layer [==================================================>] 79.93MB/79.93MB 2aea487bc2c4: Loading layer [==================================================>] 3.584kB/3.584kB d2efec3de68b: Loading layer [==================================================>] 3.072kB/3.072kB d0d71a5ce1dd: Loading layer [==================================================>] 4.096kB/4.096kB 19930367abf0: Loading layer [==================================================>] 3.584kB/3.584kB 03e5b7640db5: Loading layer [==================================================>] 9.728kB/9.728kB Loaded image: vmware/harbor-log:v1.5.3 5aebe8cc938c: Loading layer [==================================================>] 11.97MB/11.97MB Loaded image: vmware/nginx-photon:v1.5.3 ede6a57cbd7e: Loading layer [==================================================>] 30.09MB/30.09MB 4d6dd4fc1d87: Loading layer [==================================================>] 2.56kB/2.56kB c86a69f49f60: Loading layer [==================================================>] 2.56kB/2.56kB 0cf6e04c5927: Loading layer [==================================================>] 2.048kB/2.048kB 6fbff4fe9739: Loading layer [==================================================>] 22.8MB/22.8MB 6f527a618092: Loading layer [==================================================>] 22.8MB/22.8MB Loaded image: vmware/registry-photon:v2.6.2-v1.5.3 e29a8834501b: Loading layer [==================================================>] 12.16MB/12.16MB aaf67f1da2c7: Loading layer [==================================================>] 17.3MB/17.3MB 8d5718232133: Loading layer [==================================================>] 15.87kB/15.87kB fc89aca1dd12: Loading layer [==================================================>] 3.072kB/3.072kB 076eb5a76f6d: Loading layer [==================================================>] 29.46MB/29.46MB Loaded image: vmware/notary-server-photon:v0.5.1-v1.5.3 454c81edbd3b: Loading layer [==================================================>] 135.2MB/135.2MB e99db1275091: Loading layer [==================================================>] 395.4MB/395.4MB 051e4ee23882: Loading layer [==================================================>] 9.216kB/9.216kB 6cca4437b6f6: Loading layer [==================================================>] 9.216kB/9.216kB 1d48fc08c8bc: Loading layer [==================================================>] 7.68kB/7.68kB 0419724fd942: Loading layer [==================================================>] 1.536kB/1.536kB 543c0c1ee18d: Loading layer [==================================================>] 655.2MB/655.2MB 4190aa7e89b8: Loading layer [==================================================>] 103.9kB/103.9kB Loaded image: vmware/harbor-migrator:v1.5.0 45878c64fc3c: Loading layer [==================================================>] 165.3MB/165.3MB fc3d407ce98f: Loading layer [==================================================>] 10.93MB/10.93MB d7a0785bb902: Loading layer [==================================================>] 2.048kB/2.048kB a17e0f23bc84: Loading layer [==================================================>] 48.13kB/48.13kB 57c7181f2336: Loading layer [==================================================>] 10.97MB/10.97MB Loaded image: vmware/clair-photon:v2.0.5-v1.5.3 [Step 2]: preparing environment ... Generated and saved secret to file: /data/secretkey Generated configuration file: ./common/config/nginx/nginx.conf Generated configuration file: ./common/config/adminserver/env Generated configuration file: ./common/config/ui/env Generated configuration file: ./common/config/registry/config.yml Generated configuration file: ./common/config/db/env Generated configuration file: ./common/config/jobservice/env Generated configuration file: ./common/config/jobservice/config.yml Generated configuration file: ./common/config/log/logrotate.conf Generated configuration file: ./common/config/jobservice/config.yml Generated configuration file: ./common/config/ui/app.conf Generated certificate, key file: ./common/config/ui/private_key.pem, cert file: ./common/config/registry/root.crt The configuration files are ready, please use docker-compose to start the service. Creating harbor-log ... done [Step 3]: checking existing instance of Harbor ... Creating registry ... done Creating harbor-ui ... done Creating network \"harbor_harbor\" with the default driver Creating nginx ... done Creating harbor-db ... Creating registry ... Creating harbor-adminserver ... Creating redis ... Creating harbor-ui ... Creating harbor-jobservice ... Creating nginx ... \u2714 ----Harbor has been installed and started successfully.---- Now you should be able to visit the admin portal at http://192.168.183.134. For more details, please visit https://github.com/vmware/harbor . \u53ef\u4ee5\u770b\u5230\u4ee5\u4e0a\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\u3002\u6211\u4eec\u901a\u8fc7web\u8bbf\u95eeharbor\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0a\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\u3002 \u5b89\u88c5\u5b8c\u6bd5\u540e\u67e5\u770bdocker Harbor\u5176\u5b9e\u4e5f\u662f\u52a0\u8f7ddocker\u955c\u50cf","title":"4.2.4 \u5b89\u88c5\u7f16\u6392\u5de5\u5177"},{"location":"linux/server/harbor/harbor.index/#43-web","text":"","title":"4.3 Web\u64cd\u4f5c"},{"location":"linux/server/harbor/harbor.index/#431","text":"\u9ed8\u8ba4\u8d26\u53f7\u548c\u5bc6\u7801\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c \u8d26\u53f7\u662f: admin \u5bc6\u7801\u662f: Harbor12345","title":"4.3.1 \u7b80\u5355\u4ecb\u7ecd"},{"location":"linux/server/harbor/harbor.index/#432","text":"\u56e0\u4e3aharbor\u662f\u591a\u4eba\u7684\u79c1\u6709\u4ed3\u5e93\uff0c\u6240\u4ee5\u5efa\u7acb\u666e\u901a\u7528\u6237\uff0c\u5bf9\u5e94\u5efa\u7acb\u79c1\u6709\u7684\u4ed3\u5e93\uff0c\u7136\u540edocker\u5ba2\u6237\u7aef\u901a\u8fc7\u4f7f\u7528\u8fd9\u4e2a\u65b0\u5efa\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u767b\u5f55harbor\u7136\u540e\u63a8\u9001\u5230\u81ea\u5df1\u7684\u4ed3\u5e93\u4e2d\u3002","title":"4.3.2 \u65b0\u5efa\u7528\u6237"},{"location":"linux/server/harbor/harbor.index/#433","text":"","title":"4.3.3 \u65b0\u5efa\u79c1\u6709\u4ed3\u5e93"},{"location":"linux/server/harbor/harbor.index/#434","text":"","title":"4.3.4 \u666e\u901a\u7528\u6237\u767b\u5f55"},{"location":"linux/server/harbor/harbor.index/#435","text":"","title":"4.3.5 \u666e\u901a\u7528\u6237\u65b0\u5efa\u9879\u76ee"},{"location":"linux/server/harbor/harbor.index/#44","text":"","title":"4.4 \u5ba2\u6237\u7aef\u64cd\u4f5c\u63a8\u9001"},{"location":"linux/server/harbor/harbor.index/#441-pull","text":"[root@localhost img4]# ifconfig ens33 ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500 inet 192.168.183.133 netmask 255.255.255.0 broadcast 192.168.183.255 ether 00:0c:29:9e:1f:67 txqueuelen 1000 (Ethernet) RX packets 66573 bytes 17079495 (16.2 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 36722 bytes 16771887 (15.9 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 [root@localhost img4]# cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"insecure-registries\":[\"192.168.183.134\"] } [root@localhost img4]# systemctl restart docker","title":"4.4.1 pull\u955c\u50cf"},{"location":"linux/server/harbor/harbor.index/#442-tag","text":"\u6253tag\u7684\u76ee\u7684\u4e3b\u8981\u662f\u63a8\u9001\u7684\u955c\u50cf\u5230\u79c1\u6709\u4ed3\u5e93\u800c\u4e0d\u662f\u63a8\u9001\u5230dockerhub\u4e0a\uff08\u9ed8\u8ba4\u90fd\u662f\u63a8\u9001\u5230dockerhub\u4e0a\uff09 [root@localhost img4]# docker tag myweb:v0.3-4 192.168.183.134/myweb/myweb:v0.3-4 [root@localhost img4]# docker tag myweb:v0.3-5 192.168.183.134/myweb/myweb:v0.3-5 [root@localhost img4]# docker tag myweb:v0.3-6 192.168.183.134/myweb/myweb:v0.3-6 [root@localhost img4]# docker tag myweb:v0.3-7 192.168.183.134/myweb/myweb:v0.3-7","title":"4.4.2 \u5ba2\u6237\u7aef\u6253tag"},{"location":"linux/server/harbor/harbor.index/#443","text":"[root@localhost img4]# docker login 192.168.183.134 Username: caimengzhi #\u8d26\u53f7\u662fweb\u767b\u5f55\u7684\u8d26\u53f7\u548c\u5bc6\u7801 Password: WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded","title":"4.4.3 \u767b\u5f55"},{"location":"linux/server/harbor/harbor.index/#444","text":"[root@localhost img4]# docker push 192.168.183.134/myweb/myweb <\u82e5\u662f\u63a8\u9001\u4e0d\u6307\u5b9a\u955c\u50cftag\uff0c\u4f1a\u63a8\u9001\u6240\u6709192.168.183.134/myweb/myweb\u7684\u955c\u50cf> The push refers to repository [192.168.183.134/myweb/myweb] a8dcd6aa3279: Pushed 9a07ffbe3d7d: Pushed 955e7d7f7300: Pushed 95bb4e754f2d: Pushed ebf12965380b: Pushed v0.3-4: digest: sha256:bff4611d26ab5ea7df2a2038f5c806060343e8dcb72f4e7d9c8186f9f29ab1d2 size: 1360 02d539f1584f: Pushed 9a07ffbe3d7d: Layer already exists 955e7d7f7300: Layer already exists 95bb4e754f2d: Layer already exists ebf12965380b: Layer already exists v0.3-5: digest: sha256:d989d072b34649c6c3db1b90cc8e9da01fc0851db7154087f8c20d9276c6b19e size: 1360 cf1c42bcc62e: Pushed 31d53a6ec2f6: Pushed 9a07ffbe3d7d: Layer already exists 955e7d7f7300: Layer already exists 95bb4e754f2d: Layer already exists ebf12965380b: Layer already exists v0.3-6: digest: sha256:f001406ad67619ca5a20595f5392099f4c89aabc03a577a9e2b21951daa6625b size: 1567 cf1c42bcc62e: Layer already exists 31d53a6ec2f6: Layer already exists 9a07ffbe3d7d: Layer already exists 955e7d7f7300: Layer already exists 95bb4e754f2d: Layer already exists ebf12965380b: Layer already exists v0.3-7: digest: sha256:f001406ad67619ca5a20595f5392099f4c89aabc03a577a9e2b21951daa6625b size: 1567","title":"4.4.4 \u63a8\u9001\u955c\u50cf"},{"location":"linux/server/harbor/harbor.index/#445","text":"\u63a8\u9001\u5b8c\u6bd5\u540e\u5728docker\u79c1\u6709\u4ed3\u5e93\u4e0aweb\u67e5\u770b\u4e4b\u524d\u63a8\u9001\u7684\u60c5\u51b5\u3002","title":"4.4.5  \u67e5\u770b\u63a8\u9001\u60c5\u51b5"},{"location":"linux/server/harbor/harbor.index/#45","text":"\u65b0\u627e\u4e00\u4e2a\u522b\u7684\u673a\u5668\u53bb\u62c9\u53bb\u64cd\u4f5c","title":"4.5 \u5ba2\u6237\u7aef\u64cd\u4f5c\u62c9"},{"location":"linux/server/harbor/harbor.index/#451","text":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff08http\uff09 [root@leco ~]# cat /etc/docker/daemon.json { \"registry-mirrors\": [\"http://3e930982.m.daocloud.io\"], \"insecure-registries\":[\"192.168.183.134\"] }","title":"4.5.1 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/harbor/harbor.index/#452-docker","text":"[root@leco ~]# systemctl restart docker [root@leco ~]# ifconfig ens33 ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500 inet 192.168.183.135 netmask 255.255.255.0 broadcast 192.168.183.255 ether 00:0c:29:5e:f3:38 txqueuelen 1000 (Ethernet) RX packets 32850 bytes 2734678 (2.6 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 3833 bytes 375551 (366.7 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0","title":"4.5.2 \u91cd\u542fdocker"},{"location":"linux/server/harbor/harbor.index/#453","text":"[root@leco ~]# docker login 192.168.183.134 Username: caimengzhi Password: WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded","title":"4.5.3 \u767b\u5f55"},{"location":"linux/server/harbor/harbor.index/#454","text":"\u767b\u5f55web\u754c\u9762\u627e\u5230pull\u7684\u5730\u5740 [root@leco ~]# docker pull 192.168.183.134/myweb/myweb:v0.3-7 v0.3-7: Pulling from myweb/myweb c67f3896b22c: Pull complete 428de5b8d58a: Pull complete 7efd417f3e28: Pull complete 61a56b170416: Pull complete e7206a413d4c: Pull complete 54a1363d75f0: Pull complete Digest: sha256:f001406ad67619ca5a20595f5392099f4c89aabc03a577a9e2b21951daa6625b Status: Downloaded newer image for 192.168.183.134/myweb/myweb:v0.3-7","title":"4.5.4 \u5730\u5740"},{"location":"linux/server/harbor/harbor.index/#455","text":"[root@leco ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE 192.168.183.134/myweb/myweb v0.3-7 5799f549739a 3 hours ago 17.4MB","title":"4.5.5 \u67e5\u770b\u672c\u5730\u955c\u50cf"},{"location":"linux/server/harbor/harbor.index/#46-harbor","text":"","title":"4.6 Harbor \u670d\u52a1\u64cd\u4f5c"},{"location":"linux/server/harbor/harbor.index/#461","text":"[root@leco ~]# docker-compose pause","title":"4.6.1 \u6682\u505c"},{"location":"linux/server/harbor/harbor.index/#462","text":"[root@leco ~]# docker-compose stop","title":"4.6.2 \u505c\u6b62"},{"location":"linux/server/harbor/harbor.index/#463","text":"[root@leco ~]# docker-compose start [root@leco harbor]# pwd /usr/local/harbor [root@leco harbor]# ll total 895716 drwxr-xr-x 4 root root 37 Sep 20 17:37 common -rw-r--r-- 1 root root 1185 Sep 12 14:19 docker-compose.clair.yml -rw-r--r-- 1 root root 1725 Sep 12 14:19 docker-compose.notary.yml -rw-r--r-- 1 root root 3596 Sep 12 14:19 docker-compose.yml drwxr-xr-x 3 root root 156 Sep 12 14:19 ha -rw-r--r-- 1 root root 6955 Sep 20 17:32 harbor.cfg -rw-r--r-- 1 root root 6956 Sep 20 17:31 harbor.cfg.ori -rw-r--r-- 1 root root 915878468 Sep 12 14:21 harbor.v1.5.3.tar.gz -rwxr-xr-x 1 root root 5773 Sep 12 14:19 install.sh -rw-r--r-- 1 root root 10764 Sep 12 14:19 LICENSE -rw-r--r-- 1 root root 482 Sep 12 14:19 NOTICE -rw-r--r-- 1 root root 1247461 Sep 12 14:19 open_source_license -rwxr-xr-x 1 root root 27840 Sep 12 14:19 prepare \u4ee5\u4e0a\u64cd\u4f5c\u90fd\u8981\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u6267\u884c\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u52a0\u8f7ddocker-compose.yml\u6587\u4ef6","title":"4.6.3 \u542f\u52a8"},{"location":"linux/server/harbor/harbor.index/#47-harbor","text":"","title":"4.7 Harbor \u90ae\u4ef6"},{"location":"linux/server/harbor/harbor.index/#471","text":"\u6211\u4f7f\u7528\u7684163\u7684\u90ae\u7bb1\u8bf7\u6309\u7167\u4e0a\u8ff0\u53c2\u6570\u627e\u5230\u81ea\u5df1\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5176\u4ed6\u90ae\u7bb1\u8bf7\u767e\u5ea6\u81ea\u884c\u914d\u7f6e\u3002 \u914d\u7f6e\u5b8c\u540e\u3002\u68c0\u9a8c","title":"4.7.1 \u90ae\u4ef6\u914d\u7f6e"},{"location":"linux/server/harbor/harbor.index/#472","text":"\u7136\u540e\u91cd\u65b0\u767b\u5f55","title":"4.7.2 \u5fd8\u8bb0\u767b\u5f55\u5bc6\u7801"},{"location":"linux/server/harbor/harbor.index/#48-qa","text":"Q\uff1aMaster-Slave\u7684\u955c\u50cf\u67b6\u6784\u4e2d,\u5982\u679cSlave Registy\u4e2d\u7684\u955c\u50cf\u88ab\u5220\u9664\u4e86\uff0c\u4f1a\u4e0d\u4f1a\u518d\u6b21\u81ea\u52a8\u4eceMaster Reg\u91cc\u9762\u81ea\u52a8\u540c\u6b65\uff1f A\uff1a\u5982\u679c\u505c\u6b62\u540e\u518d\u91cd\u65b0\u542f\u52a8\u590d\u5236\u7b56\u7565\uff0c\u53ef\u4ee5\u540c\u6b65\u88ab\u5220\u9664\u7684\u955c\u50cf\u3002 Q\uff1a\u5bf9\u4e8e\u591a\u4e2a\u6295\u4ea7\u5730\uff0c\u591a\u4e2a\u4ed3\u5e93\uff0c\u54ea\u79cd\u65b9\u5f0f\u7684\u9ad8\u53ef\u7528\u65b9\u6848\u597d\u4e48\uff1f\u7b2c\u4e00\u79cd\uff0c\u5171\u4eab\u5b58\u50a8\u5b58\u50a8\u53ef\u80fd\u4f1a\u51fa\u73b0\u5355\u70b9\u6545\u969c\u4e48\uff1f A\uff1a\u5171\u4eab\u5b58\u50a8\u53ea\u9002\u5408\u540c\u4e00\u6570\u636e\u4e2d\u5fc3\uff0c\u591a\u4e2a\u4ea7\u5730\u5ef6\u65f6\u592a\u5927\uff0c\u4e0d\u9002\u5408\u5171\u4eab\u5b58\u50a8\u3002 Q\uff1aRegistry\u4e4b\u95f4\u540c\u6b65\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f A\uff1aRegistry API\u3002 Q\uff1a\u5728\u5b58\u50a8\u8fd9\u5757\u8003\u8651\u8fc7\u63d0\u4f9b\u63d2\u4ef6\u65b9\u5f0f\u53ef\u4ee5\u8c03\u7528\u5916\u90e8\u6a21\u5757\uff0c\u6bd4\u5982\u4ee5\u63d2\u4ef6\u65b9\u5f0f\u652f\u6301s3\u8fd9\u79cd\u5bf9\u8c61\u5b58\u50a8\uff1f A\uff1aHarbor\u652f\u6301\u5176\u4ed6\u5b58\u50a8\u65b9\u5f0f\uff0c\u53c2\u89c1Harbor\u6587\u6863\u3002","title":"4.8 QA"},{"location":"linux/server/pppoe/pppoe.index/","text":"PPPOE\u670d\u52a1\u5668 \u00b6 1. \u7cfb\u7edf\u90e8\u7f72\u57fa\u7840 \u00b6 \u670d\u52a1\u5668\u7684ip\u89c4\u5212 \u89d2\u8272 IP \u7f51\u5173 \u7cfb\u7edf PPPOE server 192.168.10.109 \u5185\u7f51 192.168.5.109 \u5916\u7f51 192.168.5.1 Linux Centos 6.8 x64 PPPOE Client 192.168.10.90 \u5185\u7f51 Xp sp3 x86 PPPOE Client 192.168.10.80 \u5185\u7f51 Centos 68 x64 2. \u670d\u52a1\u7aef\u642d\u5efa \u00b6 2.1 \u5b89\u88c5 \u00b6 \u67e5\u770b\u662f\u5426\u5b89\u88c5\u6240\u9700\u8981\u7684\u5305\u3002 [root@mfsdata02 ppp]# rpm -qa |grep rp-pppoe rp-pppoe-3.10-16.el6.x86_64 \u6ca1\u6709\u8bdd\u5c31\u5b89\u88c5 yum install rp-pppoe 2.2 \u67e5\u770b\u914d\u7f6e\u6587\u4ef6 \u00b6 \u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\u5728/etc/ppp\u4e0b [root@mfsdata02 ~]# cd /etc/ppp/ [root@mfsdata02 ppp]# cp chap-secrets chap-secrets.ori [root@mfsdata02 ppp]# cp pppoe-server-options pppoe-server-options.ori [root@mfsdata02 ppp]# ll total 64 -rw------- 1 root root 189 Jan 16 19:09 chap-secrets -rw------- 1 root root 78 Jan 16 18:33 chap-secrets.ori -rwxr-xr-x. 1 root root 2276 May 11 2016 firewall-masq -rwxr-xr-x. 1 root root 978 May 11 2016 firewall-standalone -rwxr-xr-x. 1 root root 386 Apr 12 2016 ip-down -rwxr-xr-x. 1 root root 3262 Apr 12 2016 ip-down.ipv6to4 -rwxr-xr-x. 1 root root 430 Apr 12 2016 ip-up -rwxr-xr-x. 1 root root 6517 Apr 12 2016 ip-up.ipv6to4 -rwxr-xr-x. 1 root root 1687 Apr 12 2016 ipv6-down -rwxr-xr-x. 1 root root 3196 Apr 12 2016 ipv6-up -rw-r--r--. 1 root root 5 Mar 16 2015 options -rw-------. 1 root root 77 Mar 16 2015 pap-secrets drwxr-xr-x. 2 root root 4096 Jul 13 2016 peers -rw-r--r-- 1 root root 140 Jan 16 18:33 pppoe-server-options -rw-r--r-- 1 root root 104 Jan 16 18:32 pppoe-server-options.ori \u5907\u4efd pppoe-server-options.ori \u662f\u6211\u624b\u52a8\u5907\u4efd\u7684\u6587\u4ef6\uff0c\u4e3b\u8981\u4fee\u6539\u8fd9\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6 2.3 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u00b6 \u914d\u7f6e\u6587\u4ef6pppoe-server-options\u4fee\u6539\u5982\u4e0b # PPP options for the PPPoE server # LIC: GPL #require-pap require-chap #\u9a8c\u8bc1\u65b9\u5f0f,\u5982\u679c\u9009pap\u7684\u8bdd\uff0c\u5c31\u5230pap-secrets\u6587\u4ef6\u4e2d\u589e\u52a0\u7528\u6237 login lcp-echo-interval 10 lcp-echo-failure 2 ms-dns 202.106.0.20 ms-dns 8.8.8.8 2.4 \u6dfb\u52a0\u8d26\u53f7\u4fe1\u606f \u00b6 \u6dfb\u52a0\u7528\u6237\uff0c\u8bbe\u7f6e\u8d26\u6237\u548c\u5bc6\u7801 [root@mfsdata02 ppp]# cat chap-secrets # Secrets for authentication using CHAP # client server secret IP addresses cmz * cmz * cmz2 * cmz2 192.168.10.3 #\u53ef\u4ee5\u6307\u5b9a\u5ba2\u6237\u7aef\u7684\u5730\u5740\u4e5f\u53ef\u4ee5\u4e0d\u6307\u5b9a 2.5 \u5f00\u542f\u5185\u6838ip\u8f6c\u53d1 \u00b6 [root@mfsdata02 ppp]# sed -i \"s#net.ipv4.ip_forward = 0#net.ipv4.ip_forward = 1#g\" /etc/sysctl.conf [root@mfsdata02 ppp]# sysctl -p net.ipv4.ip_forward = 1 2.6 \u9632\u706b\u5899\u914d\u7f6e \u00b6 \u9632\u706b\u5899\u8bbe\u7f6e\uff0c\u8bbe\u7f6e\u5c40\u57df\u7f51\u5185\u673a\u5668\u5171\u4eab\u4e0a\u7f51 [root@mfsdata02 ppp]# iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE [root@mfsdata02 ppp]# iptables -t nat -nL Chain PREROUTING (policy ACCEPT) target prot opt source destination Chain POSTROUTING (policy ACCEPT) target prot opt source destination MASQUERADE all -- 0.0.0.0/0 0.0.0.0/0 Chain OUTPUT (policy ACCEPT) target prot opt source destination eth0\u4e3a\u51fa\u53e3\u7684\u7f51\u5361\uff0c\u5c31\u662f\u53ef\u4ee5\u548c\u5916\u7f51\u8fde\u901a\u7684\u90a3\u5757\u3002\u5230\u73b0\u5728\u8fd9\u4e2apppoe\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u5de5\u4f5c\u4e86\u3002 2.7 \u542f\u52a8 \u00b6 \u542f\u52a8pppoe\u670d\u52a1 [root@mfsdata02 ppp]# pppoe-server -I eth1 -L 192.168.10.109 -R 192.168.10.2 -N 20 \u53c2\u6570\u89e3\u91ca I\uff1a\u6307\u5b9a\u54cd\u5e94PPPOE\u8bf7\u6c42\u7684\u7aef\u53e3\uff0c\u73b0\u5728\u4f7f\u7528\u7684eth1\uff0c\u4e5f\u5c31\u662f\u5185\u7f51\u7684\u3002 L\uff1aPPPOE\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff0c\u5ba2\u6237\u7aef\u8fde\u63a5\u53ef\u4ee5\u770b\u5230\u7684\u670d\u52a1\u5668\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u4efb\u610f\u4e5f\u5c31\u662fpppoe\u5ba2\u6237\u7aef\u7684\u865a\u62df\u7f51\u5173\u3002 \uff08\u6ce8\u610f\uff1a\u6b64IP\u5730\u5740\u53ef\u4ee5\u4e0d\u662f\u7f51\u5361\u7684IP\u5730\u5740\uff0c\u800c\u662fPPPOE\u670d\u52a1\u5668\u7684\u865a\u62dfIP\uff0c\u6211\u4f7f\u7528\u4e86\u672c\u5730\u7684ip) R\uff1a\u8fd9\u662f\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u7684\u5730\u5740\u6c60\u8d77\u59cb\u5730\u5740\uff0c\u672c\u4f8b\u4e2d\u4ece192.168.10.2\u5f00\u59cb N\uff1a\u5730\u5740\u6c60\u7684IP\u5730\u5740\u9012\u589e\u51e0\u4e2a\uff0c\u672c\u4f8b\u4e2d\u6dfb\u589e10\uff0c\u4e5f\u5c31\u662f\u4ece192.168.10.2\u5f00\u59cb\u5206\u914d\uff0c\u4e00\u5171\u5206\u914d20\u4e2aIP\u5730\u5740 2.8 \u914d\u7f6e\u81ea\u542f\u52a8 \u00b6 [root@mfsdata02 ppp]# echo \"pppoe-server -I eth1 -L 192.168.10.109 -R 192.168.10.2 -N 20\" >> /etc/rc.d/rc.local \u5ba2\u6237\u7aef\u8fde\u63a5\u4e4b\u540e\u6b64\u65f6\u5728\u670d\u52a1\u7aef\u80fd\u770b\u5230\u4e00\u4e2apppo\u7684\u7f51\u7edc\u4fe1\u606f\u3002\u6ce8\u610f\u4e00\u5b9a\u8981\u662f\u5728\u5ba2\u6237\u7aef\u8fde\u63a5\u4e4b\u540e\u624d\u80fd\u770b\u5230\u8be5\u4fe1\u606f\u3002 [root@mfsdata02 ppp]# ifconfig eth0 Link encap:Ethernet HWaddr 00:0C:29:87:F2:BF inet addr:192.168.5.109 Bcast:192.168.5.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fe87:f2bf/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:15648 errors:0 dropped:0 overruns:0 frame:0 TX packets:10539 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:16369623 (15.6 MiB) TX bytes:982976 (959.9 KiB) eth1 Link encap:Ethernet HWaddr 00:0C:29:87:F2:C9 inet addr:192.168.10.109 Bcast:192.168.10.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fe87:f2c9/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:6002 errors:0 dropped:0 overruns:0 frame:0 TX packets:814 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:453691 (443.0 KiB) TX bytes:60473 (59.0 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:23 errors:0 dropped:0 overruns:0 frame:0 TX packets:23 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:2160 (2.1 KiB) TX bytes:2160 (2.1 KiB) ppp0 Link encap:Point-to-Point Protocol inet addr:192.168.10.109 P-t-P:192.168.1.3 Mask:255.255.255.255 UP POINTOPOINT RUNNING NOARP MULTICAST MTU:1480 Metric:1 RX packets:2184 errors:0 dropped:0 overruns:0 frame:0 TX packets:471 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:3 RX bytes:130073 (127.0 KiB) TX bytes:28127 (27.4 KiB) 3. windows \u5ba2\u6237\u7aef\u6d4b\u8bd5 \u00b6 \u627e\u5176\u4ed6\u673a\u5668\u6d4b\u8bd5 3.1 \u62e8\u53f7\u4e4b\u524d\u68c0\u67e5 \u00b6 \u5ba2\u6237\u7aef\u62e8\u53f7\u6d41\u7a0b 3.2 \u62e8\u53f7 \u00b6 \u9009\u62e9\u5ba2\u6237\u7aef\u62e8\u53f7\u767b\u5f55\u6d4b\u8bd5 3.3 \u62e8\u53f7\u540e\u68c0\u67e5 \u00b6 \u4ee5\u4e0b\u662fdos\u547d\u4ee4\u884c\uff0c\u8be6\u7ec6\u6d4b\u8bd5\u8fc7\u7a0b\uff1a \u6ca1\u6709\u62e8\u53f7\u4e4b\u524d\u64cd\u4f5c Microsoft Windows XP [\u7248\u672c 5.1.2600] (C) \u7248\u6743\u6240\u6709 1985-2001 Microsoft Corp. C:\\Documents and Settings\\Administrator>ipconfig Windows IP Configuration Ethernet adapter \u672c\u5730\u8fde\u63a5: Connection-specific DNS Suffix . : IP Address. . . . . . . . . . . . : 192.168.10.90 #\u672c\u5730\u5c31\u662f\u4e4b\u524d\u5185\u7f51\u7684\u5730\u5740 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : C:\\Documents and Settings\\Administrator>ping 192.168.10.109 #\u53ef\u4ee5ping\u901apppoe\u670d\u52a1\u5668\u7aef\u5185\u7f51\u7684\u5730\u5740 Pinging 192.168.10.109 with 32 bytes of data: Reply from 192.168.10.109: bytes=32 time<1ms TTL=64 Reply from 192.168.10.109: bytes=32 time<1ms TTL=64 Ping statistics for 192.168.10.109: Packets: Sent = 2, Received = 2, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 0ms, Maximum = 0ms, Average = 0ms Control-C ^C C:\\Documents and Settings\\Administrator>ping 192.168.5.1 #\u867d\u7136\u80fdping\u901apppoe\u5185\u7f51\u5730\u5740\u4f46\u662fping\u4e0d\u540cpppoe\u670d\u52a1\u7aef\u5916\u7f51\u5730\u5740\u7f51\u5173\u5730\u5740\uff0c\u6b64\u65f6\u8fd8\u6ca1\u6709\u62e8\u53f7 Pinging 192.168.5.1 with 32 bytes of data: Destination host unreachable. Destination host unreachable. Ping statistics for 192.168.5.1: Packets: Sent = 2, Received = 0, Lost = 2 (100% loss), Control-C ^C \u6ca1\u6709\u62e8\u53f7\u4e4b\u540e\u64cd\u4f5c C:\\Documents and Settings\\Administrator>ping 192.168.5.1 Pinging 192.168.5.1 with 32 bytes of data: Reply from 192.168.5.1: bytes=32 time=8ms TTL=127 Reply from 192.168.5.1: bytes=32 time=15ms TTL=127 Ping statistics for 192.168.5.1: Packets: Sent = 2, Received = 2, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 8ms, Maximum = 15ms, Average = 11ms Control-C ^C C:\\Documents and Settings\\Administrator>ping 192.168.10.109 Pinging 192.168.10.109 with 32 bytes of data: Reply from 192.168.10.109: bytes=32 time=3ms TTL=64 Reply from 192.168.10.109: bytes=32 time=14ms TTL=64 Ping statistics for 192.168.10.109: Packets: Sent = 2, Received = 2, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 3ms, Maximum = 14ms, Average = 8ms Control-C ^C C:\\Documents and Settings\\Administrator>ipconfig Windows IP Configuration Ethernet adapter \u672c\u5730\u8fde\u63a5: Connection-specific DNS Suffix . : IP Address. . . . . . . . . . . . : 192.168.10.90 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : PPP adapter \u5bbd\u5e26\u8fde\u63a5: #\u62e8\u53f7\u6210\u529f\u540e\u5c31\u4f1a\u53d1\u73b0\u6709\u4e2appp\u5ba2\u6237\u7aef\u4ea7\u751f\uff0c\u62e8\u53f7\u4e4b\u524d\u662f\u6ca1\u6709\u7684 Connection-specific DNS Suffix . : IP Address. . . . . . . . . . . . : 10.67.15.18 Subnet Mask . . . . . . . . . . . : 255.255.255.255 Default Gateway . . . . . . . . . : 10.67.15.18 C:\\Documents and Settings\\Administrator>ping baidu.com #\u62e8\u53f7\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u6b63\u5e38\u4e0a\u7f51 Pinging baidu.com [180.149.132.47] with 32 bytes of data: Reply from 180.149.132.47: bytes=32 time=41ms TTL=54 Ping statistics for 180.149.132.47: Packets: Sent = 1, Received = 1, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 41ms, Maximum = 41ms, Average = 41ms Control-C ^C 4. linux \u5ba2\u6237\u7aef\u6d4b\u8bd5 \u00b6 \u5ba2\u6237\u7aef\u9009\u62e9centos\uff0c\u62e8\u53f7\u4e0a\u7f51\uff0c\u64cd\u4f5c\u8fc7\u7a0b\u5982\u4e0b\uff1a 4.1 \u62e8\u53f7\u4e4b\u524d\u64cd\u4f5c\u68c0\u67e5 \u00b6 [root@mfsdata01 ~]# cat /etc/issue CentOS release 6.8 (Final) Kernel \\r on an \\m [root@mfsdata01 ~]# uname -a Linux mfsdata01 2.6.32-642.6.2.el6.x86_64 #1 SMP Wed Oct 26 06:52:09 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux [root@mfsdata01 ~]# ifconfig eth0 Link encap:Ethernet HWaddr 00:0C:29:F1:FB:05 inet addr:192.168.10.80 Bcast:192.168.10.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fef1:fb05/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:30766 errors:0 dropped:0 overruns:0 frame:0 TX packets:9953 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:18534315 (17.6 MiB) TX bytes:638381 (623.4 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:8 errors:0 dropped:0 overruns:0 frame:0 TX packets:8 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:480 (480.0 b) TX bytes:480 (480.0 b) \u6b64\u65f6\u53ea\u53ef\u4ee5ping\u901apppoeserver\u5185\u7f51\u7684\u5730\u5740\uff0c\u5982\u4e0b\uff1a [root@mfsdata01 ~]# ping 192.168.10.109 -c 1 PING 192.168.10.109 (192.168.10.109) 56(84) bytes of data. 64 bytes from 192.168.10.109: icmp_seq=1 ttl=64 time=0.300 ms --- 192.168.10.109 ping statistics --- 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 0.300/0.300/0.300/0.000 ms [root@mfsdata01 ~]# ping 192.168.5.1 -c 1 connect: Network is unreachable [root@mfsdata01 ~]# ping baidu.com -c 1 ping: unknown host baidu.com 4.2 \u5efa\u7acbPPPoe\u94fe\u63a5 \u00b6 [root@mfsdata01 ~]# adsl-setup # < \u5efa\u7acbADSL\u8fde\u63a5\u6211\u7684\u662f\u7b2c\u4e8c\u6b21\u91cd\u65b0\u914d\u7f6e Welcome to the PPPoE client setup. First, I will run some checks on your system to make sure the PPPoE client is installed properly... The following DSL config was found on your system: Device: Name: ppp0 DSLppp0 Please enter the device if you want to configure the present DSL config (default ppp0) or enter 'n' if you want to create a new one: n LOGIN NAME Enter your Login Name: cmz #\u8f93\u5165ADSL\u8fde\u63a5\u7684\u7528\u6237\u540d INTERFACE Enter the Ethernet interface connected to the PPPoE modem For Solaris, this is likely to be something like /dev/hme0. For Linux, it will be ethX, where 'X' is a number. (default eth0): #\u6307\u5b9a\u7f51\u7edc\u8bbe\u5907 Do you want the link to come up on demand, or stay up continuously? If you want it to come up on demand, enter the idle time in seconds after which the link should be dropped. If you want the link to stay up permanently, enter 'no' (two letters, lower-case.) NOTE: Demand-activated links do not interact well with dynamic IP addresses. You may have some problems with demand-activated links. Enter the demand value (default no): #\u63a5\u53d7\u9ed8\u8ba4\u8bbe\u7f6e DNS Please enter the IP address of your ISP's primary DNS server. If your ISP claims that 'the server will provide dynamic DNS addresses', enter 'server' (all lower-case) here. #\u8f93\u5165DNS\u5730\u5740\uff0c\u4e0d\u8f93\u5165\u4e0d\u80fd\u89e3\u6790 If you just press enter, I will assume you know what you are doing and not modify your DNS setup. Enter the DNS information here: 114.114.114.114 Please enter the IP address of your ISP's secondary DNS server. If you just press enter, I will assume there is only one DNS server. Enter the secondary DNS server address here: 8.8.8.8 PASSWORD Please enter your Password: #\u6b64\u65f6\u8f93\u5165ADSL\u8d26\u53f7cmz\u5bf9\u5e94\u7684\u5bc6\u7801 \u4e5f\u662fcmz Please re-enter your Password: #\u518d\u8f93\u5165\u4e00\u6b21 USERCTRL Please enter 'yes' (three letters, lower-case.) if you want to allow normal user to start or stop DSL connection (default yes): no #\u586b\u5165NO\uff0c\u4e0d\u5141\u8bb8\u4e00\u822c\u7684\u7528\u6237\u8fde\u63a5PPPoE FIREWALLING Please choose the firewall rules to use. Note that these rules are very basic. You are strongly encouraged to use a more sophisticated firewall setup; however, these will provide basic security. If you are running any servers on your machine, you must choose 'NONE' and set up firewalling yourself. Otherwise, the firewall rules will deny access to all standard servers like Web, e-mail, ftp, etc. If you are using SSH, the rules will block outgoing SSH connections which allocate a privileged source port. The firewall choices are: 0 - NONE: This script will not set any firewall rules. You are responsible for ensuring the security of your machine. You are STRONGLY recommended to use some kind of firewall rules. 1 - STANDALONE: Appropriate for a basic stand-alone web-surfing workstation 2 - MASQUERADE: Appropriate for a machine acting as an Internet gateway for a LAN Choose a type of firewall (0-2): 0 #\u8f93\u51650\uff0c\u4e0d\u5728\u8fd9\u91cc\u8bbe\u7f6e\u9632\u706b\u5899 Start this connection at boot time Do you want to start this connection at boot time? Please enter no or yes (default no):yes #\u586byes,\u7cfb\u7edf\u542f\u52a8\u81ea\u52a8\u8fde\u63a5ADSL ** Summary of what you entered ** Ethernet Interface: eth0 User name: cmz Activate-on-demand: No Primary DNS: 114.114.114.114 Secondary DNS: 8.8.8.8 Firewalling: NONE User Control: no Accept these settings and adjust configuration files (y/n)? y Adjusting /etc/sysconfig/network-scripts/ifcfg-ppp1 Adjusting /etc/resolv.conf (But first backing it up to /etc/resolv.conf.bak) Adjusting /etc/ppp/chap-secrets and /etc/ppp/pap-secrets (But first backing it up to /etc/ppp/chap-secrets.bak) (But first backing it up to /etc/ppp/pap-secrets.bak) Congratulations, it should be all set up! Type '/sbin/ifup ppp1' to bring up your xDSL link and '/sbin/ifdown ppp1' to bring it down. Type '/sbin/pppoe-status /etc/sysconfig/network-scripts/ifcfg-ppp1' to see the link status. [root@mfsdata01 ~]# adsl-start #\u542f\u52a8adsl [root@mfsdata01 ~]# #\u2190 \u7a0d\u7b49\u7247\u523b\u540e\u82e5\u542f\u52a8\u6210\u529f\u540e\u51fa\u73b0\u63d0\u793a\u7b26\uff08\u65e0\u4efb\u4f55\u63d0\u793a\u5373\u610f\u5473\u7740\u8fde\u63a5\u6210\u529f\uff09 \u8fd9\u65f6\uff0c\u901a\u8fc7\u201cifconfig\u201d\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u5404\u7f51\u7edc\u63a5\u53e3\u7684\u4fe1\u606f\uff08IP\u5730\u5740\u7b49\u7b49\uff09\u3002 [root@mfsdata01 ~]# ifconfig eth0 Link encap:Ethernet HWaddr 00:0C:29:F1:FB:05 inet addr:192.168.10.80 Bcast:192.168.10.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fef1:fb05/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:31553 errors:0 dropped:0 overruns:0 frame:0 TX packets:10328 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:18597215 (17.7 MiB) TX bytes:688437 (672.3 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:8 errors:0 dropped:0 overruns:0 frame:0 TX packets:8 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:480 (480.0 b) TX bytes:480 (480.0 b) ppp0 Link encap:Point-to-Point Protocol inet addr:10.67.15.20 P-t-P:192.168.10.109 Mask:255.255.255.255 UP POINTOPOINT RUNNING NOARP MULTICAST MTU:1492 Metric:1 RX packets:3 errors:0 dropped:0 overruns:0 frame:0 TX packets:11 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:3 RX bytes:30 (30.0 b) TX bytes:1086 (1.0 KiB) [root@mfsdata01 ~]# ping baidu.com PING baidu.com (180.149.132.47) 56(84) bytes of data. 64 bytes from 180.149.132.47: icmp_seq=1 ttl=54 time=29.6 ms 64 bytes from 180.149.132.47: icmp_seq=2 ttl=54 time=34.8 ms ^C --- baidu.com ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 1630ms rtt min/avg/max/mdev = 29.611/32.248/34.885/2.637 ms","title":"1. PPPOE"},{"location":"linux/server/pppoe/pppoe.index/#pppoe","text":"","title":"PPPOE\u670d\u52a1\u5668"},{"location":"linux/server/pppoe/pppoe.index/#1","text":"\u670d\u52a1\u5668\u7684ip\u89c4\u5212 \u89d2\u8272 IP \u7f51\u5173 \u7cfb\u7edf PPPOE server 192.168.10.109 \u5185\u7f51 192.168.5.109 \u5916\u7f51 192.168.5.1 Linux Centos 6.8 x64 PPPOE Client 192.168.10.90 \u5185\u7f51 Xp sp3 x86 PPPOE Client 192.168.10.80 \u5185\u7f51 Centos 68 x64","title":"1. \u7cfb\u7edf\u90e8\u7f72\u57fa\u7840"},{"location":"linux/server/pppoe/pppoe.index/#2","text":"","title":"2. \u670d\u52a1\u7aef\u642d\u5efa"},{"location":"linux/server/pppoe/pppoe.index/#21","text":"\u67e5\u770b\u662f\u5426\u5b89\u88c5\u6240\u9700\u8981\u7684\u5305\u3002 [root@mfsdata02 ppp]# rpm -qa |grep rp-pppoe rp-pppoe-3.10-16.el6.x86_64 \u6ca1\u6709\u8bdd\u5c31\u5b89\u88c5 yum install rp-pppoe","title":"2.1 \u5b89\u88c5"},{"location":"linux/server/pppoe/pppoe.index/#22","text":"\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\u5728/etc/ppp\u4e0b [root@mfsdata02 ~]# cd /etc/ppp/ [root@mfsdata02 ppp]# cp chap-secrets chap-secrets.ori [root@mfsdata02 ppp]# cp pppoe-server-options pppoe-server-options.ori [root@mfsdata02 ppp]# ll total 64 -rw------- 1 root root 189 Jan 16 19:09 chap-secrets -rw------- 1 root root 78 Jan 16 18:33 chap-secrets.ori -rwxr-xr-x. 1 root root 2276 May 11 2016 firewall-masq -rwxr-xr-x. 1 root root 978 May 11 2016 firewall-standalone -rwxr-xr-x. 1 root root 386 Apr 12 2016 ip-down -rwxr-xr-x. 1 root root 3262 Apr 12 2016 ip-down.ipv6to4 -rwxr-xr-x. 1 root root 430 Apr 12 2016 ip-up -rwxr-xr-x. 1 root root 6517 Apr 12 2016 ip-up.ipv6to4 -rwxr-xr-x. 1 root root 1687 Apr 12 2016 ipv6-down -rwxr-xr-x. 1 root root 3196 Apr 12 2016 ipv6-up -rw-r--r--. 1 root root 5 Mar 16 2015 options -rw-------. 1 root root 77 Mar 16 2015 pap-secrets drwxr-xr-x. 2 root root 4096 Jul 13 2016 peers -rw-r--r-- 1 root root 140 Jan 16 18:33 pppoe-server-options -rw-r--r-- 1 root root 104 Jan 16 18:32 pppoe-server-options.ori \u5907\u4efd pppoe-server-options.ori \u662f\u6211\u624b\u52a8\u5907\u4efd\u7684\u6587\u4ef6\uff0c\u4e3b\u8981\u4fee\u6539\u8fd9\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6","title":"2.2 \u67e5\u770b\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/pppoe/pppoe.index/#23","text":"\u914d\u7f6e\u6587\u4ef6pppoe-server-options\u4fee\u6539\u5982\u4e0b # PPP options for the PPPoE server # LIC: GPL #require-pap require-chap #\u9a8c\u8bc1\u65b9\u5f0f,\u5982\u679c\u9009pap\u7684\u8bdd\uff0c\u5c31\u5230pap-secrets\u6587\u4ef6\u4e2d\u589e\u52a0\u7528\u6237 login lcp-echo-interval 10 lcp-echo-failure 2 ms-dns 202.106.0.20 ms-dns 8.8.8.8","title":"2.3 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/pppoe/pppoe.index/#24","text":"\u6dfb\u52a0\u7528\u6237\uff0c\u8bbe\u7f6e\u8d26\u6237\u548c\u5bc6\u7801 [root@mfsdata02 ppp]# cat chap-secrets # Secrets for authentication using CHAP # client server secret IP addresses cmz * cmz * cmz2 * cmz2 192.168.10.3 #\u53ef\u4ee5\u6307\u5b9a\u5ba2\u6237\u7aef\u7684\u5730\u5740\u4e5f\u53ef\u4ee5\u4e0d\u6307\u5b9a","title":"2.4 \u6dfb\u52a0\u8d26\u53f7\u4fe1\u606f"},{"location":"linux/server/pppoe/pppoe.index/#25-ip","text":"[root@mfsdata02 ppp]# sed -i \"s#net.ipv4.ip_forward = 0#net.ipv4.ip_forward = 1#g\" /etc/sysctl.conf [root@mfsdata02 ppp]# sysctl -p net.ipv4.ip_forward = 1","title":"2.5 \u5f00\u542f\u5185\u6838ip\u8f6c\u53d1"},{"location":"linux/server/pppoe/pppoe.index/#26","text":"\u9632\u706b\u5899\u8bbe\u7f6e\uff0c\u8bbe\u7f6e\u5c40\u57df\u7f51\u5185\u673a\u5668\u5171\u4eab\u4e0a\u7f51 [root@mfsdata02 ppp]# iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE [root@mfsdata02 ppp]# iptables -t nat -nL Chain PREROUTING (policy ACCEPT) target prot opt source destination Chain POSTROUTING (policy ACCEPT) target prot opt source destination MASQUERADE all -- 0.0.0.0/0 0.0.0.0/0 Chain OUTPUT (policy ACCEPT) target prot opt source destination eth0\u4e3a\u51fa\u53e3\u7684\u7f51\u5361\uff0c\u5c31\u662f\u53ef\u4ee5\u548c\u5916\u7f51\u8fde\u901a\u7684\u90a3\u5757\u3002\u5230\u73b0\u5728\u8fd9\u4e2apppoe\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u5de5\u4f5c\u4e86\u3002","title":"2.6 \u9632\u706b\u5899\u914d\u7f6e"},{"location":"linux/server/pppoe/pppoe.index/#27","text":"\u542f\u52a8pppoe\u670d\u52a1 [root@mfsdata02 ppp]# pppoe-server -I eth1 -L 192.168.10.109 -R 192.168.10.2 -N 20 \u53c2\u6570\u89e3\u91ca I\uff1a\u6307\u5b9a\u54cd\u5e94PPPOE\u8bf7\u6c42\u7684\u7aef\u53e3\uff0c\u73b0\u5728\u4f7f\u7528\u7684eth1\uff0c\u4e5f\u5c31\u662f\u5185\u7f51\u7684\u3002 L\uff1aPPPOE\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff0c\u5ba2\u6237\u7aef\u8fde\u63a5\u53ef\u4ee5\u770b\u5230\u7684\u670d\u52a1\u5668\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u4efb\u610f\u4e5f\u5c31\u662fpppoe\u5ba2\u6237\u7aef\u7684\u865a\u62df\u7f51\u5173\u3002 \uff08\u6ce8\u610f\uff1a\u6b64IP\u5730\u5740\u53ef\u4ee5\u4e0d\u662f\u7f51\u5361\u7684IP\u5730\u5740\uff0c\u800c\u662fPPPOE\u670d\u52a1\u5668\u7684\u865a\u62dfIP\uff0c\u6211\u4f7f\u7528\u4e86\u672c\u5730\u7684ip) R\uff1a\u8fd9\u662f\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u7684\u5730\u5740\u6c60\u8d77\u59cb\u5730\u5740\uff0c\u672c\u4f8b\u4e2d\u4ece192.168.10.2\u5f00\u59cb N\uff1a\u5730\u5740\u6c60\u7684IP\u5730\u5740\u9012\u589e\u51e0\u4e2a\uff0c\u672c\u4f8b\u4e2d\u6dfb\u589e10\uff0c\u4e5f\u5c31\u662f\u4ece192.168.10.2\u5f00\u59cb\u5206\u914d\uff0c\u4e00\u5171\u5206\u914d20\u4e2aIP\u5730\u5740","title":"2.7 \u542f\u52a8"},{"location":"linux/server/pppoe/pppoe.index/#28","text":"[root@mfsdata02 ppp]# echo \"pppoe-server -I eth1 -L 192.168.10.109 -R 192.168.10.2 -N 20\" >> /etc/rc.d/rc.local \u5ba2\u6237\u7aef\u8fde\u63a5\u4e4b\u540e\u6b64\u65f6\u5728\u670d\u52a1\u7aef\u80fd\u770b\u5230\u4e00\u4e2apppo\u7684\u7f51\u7edc\u4fe1\u606f\u3002\u6ce8\u610f\u4e00\u5b9a\u8981\u662f\u5728\u5ba2\u6237\u7aef\u8fde\u63a5\u4e4b\u540e\u624d\u80fd\u770b\u5230\u8be5\u4fe1\u606f\u3002 [root@mfsdata02 ppp]# ifconfig eth0 Link encap:Ethernet HWaddr 00:0C:29:87:F2:BF inet addr:192.168.5.109 Bcast:192.168.5.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fe87:f2bf/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:15648 errors:0 dropped:0 overruns:0 frame:0 TX packets:10539 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:16369623 (15.6 MiB) TX bytes:982976 (959.9 KiB) eth1 Link encap:Ethernet HWaddr 00:0C:29:87:F2:C9 inet addr:192.168.10.109 Bcast:192.168.10.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fe87:f2c9/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:6002 errors:0 dropped:0 overruns:0 frame:0 TX packets:814 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:453691 (443.0 KiB) TX bytes:60473 (59.0 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:23 errors:0 dropped:0 overruns:0 frame:0 TX packets:23 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:2160 (2.1 KiB) TX bytes:2160 (2.1 KiB) ppp0 Link encap:Point-to-Point Protocol inet addr:192.168.10.109 P-t-P:192.168.1.3 Mask:255.255.255.255 UP POINTOPOINT RUNNING NOARP MULTICAST MTU:1480 Metric:1 RX packets:2184 errors:0 dropped:0 overruns:0 frame:0 TX packets:471 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:3 RX bytes:130073 (127.0 KiB) TX bytes:28127 (27.4 KiB)","title":"2.8 \u914d\u7f6e\u81ea\u542f\u52a8"},{"location":"linux/server/pppoe/pppoe.index/#3-windows","text":"\u627e\u5176\u4ed6\u673a\u5668\u6d4b\u8bd5","title":"3. windows \u5ba2\u6237\u7aef\u6d4b\u8bd5"},{"location":"linux/server/pppoe/pppoe.index/#31","text":"\u5ba2\u6237\u7aef\u62e8\u53f7\u6d41\u7a0b","title":"3.1 \u62e8\u53f7\u4e4b\u524d\u68c0\u67e5"},{"location":"linux/server/pppoe/pppoe.index/#32","text":"\u9009\u62e9\u5ba2\u6237\u7aef\u62e8\u53f7\u767b\u5f55\u6d4b\u8bd5","title":"3.2 \u62e8\u53f7"},{"location":"linux/server/pppoe/pppoe.index/#33","text":"\u4ee5\u4e0b\u662fdos\u547d\u4ee4\u884c\uff0c\u8be6\u7ec6\u6d4b\u8bd5\u8fc7\u7a0b\uff1a \u6ca1\u6709\u62e8\u53f7\u4e4b\u524d\u64cd\u4f5c Microsoft Windows XP [\u7248\u672c 5.1.2600] (C) \u7248\u6743\u6240\u6709 1985-2001 Microsoft Corp. C:\\Documents and Settings\\Administrator>ipconfig Windows IP Configuration Ethernet adapter \u672c\u5730\u8fde\u63a5: Connection-specific DNS Suffix . : IP Address. . . . . . . . . . . . : 192.168.10.90 #\u672c\u5730\u5c31\u662f\u4e4b\u524d\u5185\u7f51\u7684\u5730\u5740 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : C:\\Documents and Settings\\Administrator>ping 192.168.10.109 #\u53ef\u4ee5ping\u901apppoe\u670d\u52a1\u5668\u7aef\u5185\u7f51\u7684\u5730\u5740 Pinging 192.168.10.109 with 32 bytes of data: Reply from 192.168.10.109: bytes=32 time<1ms TTL=64 Reply from 192.168.10.109: bytes=32 time<1ms TTL=64 Ping statistics for 192.168.10.109: Packets: Sent = 2, Received = 2, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 0ms, Maximum = 0ms, Average = 0ms Control-C ^C C:\\Documents and Settings\\Administrator>ping 192.168.5.1 #\u867d\u7136\u80fdping\u901apppoe\u5185\u7f51\u5730\u5740\u4f46\u662fping\u4e0d\u540cpppoe\u670d\u52a1\u7aef\u5916\u7f51\u5730\u5740\u7f51\u5173\u5730\u5740\uff0c\u6b64\u65f6\u8fd8\u6ca1\u6709\u62e8\u53f7 Pinging 192.168.5.1 with 32 bytes of data: Destination host unreachable. Destination host unreachable. Ping statistics for 192.168.5.1: Packets: Sent = 2, Received = 0, Lost = 2 (100% loss), Control-C ^C \u6ca1\u6709\u62e8\u53f7\u4e4b\u540e\u64cd\u4f5c C:\\Documents and Settings\\Administrator>ping 192.168.5.1 Pinging 192.168.5.1 with 32 bytes of data: Reply from 192.168.5.1: bytes=32 time=8ms TTL=127 Reply from 192.168.5.1: bytes=32 time=15ms TTL=127 Ping statistics for 192.168.5.1: Packets: Sent = 2, Received = 2, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 8ms, Maximum = 15ms, Average = 11ms Control-C ^C C:\\Documents and Settings\\Administrator>ping 192.168.10.109 Pinging 192.168.10.109 with 32 bytes of data: Reply from 192.168.10.109: bytes=32 time=3ms TTL=64 Reply from 192.168.10.109: bytes=32 time=14ms TTL=64 Ping statistics for 192.168.10.109: Packets: Sent = 2, Received = 2, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 3ms, Maximum = 14ms, Average = 8ms Control-C ^C C:\\Documents and Settings\\Administrator>ipconfig Windows IP Configuration Ethernet adapter \u672c\u5730\u8fde\u63a5: Connection-specific DNS Suffix . : IP Address. . . . . . . . . . . . : 192.168.10.90 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : PPP adapter \u5bbd\u5e26\u8fde\u63a5: #\u62e8\u53f7\u6210\u529f\u540e\u5c31\u4f1a\u53d1\u73b0\u6709\u4e2appp\u5ba2\u6237\u7aef\u4ea7\u751f\uff0c\u62e8\u53f7\u4e4b\u524d\u662f\u6ca1\u6709\u7684 Connection-specific DNS Suffix . : IP Address. . . . . . . . . . . . : 10.67.15.18 Subnet Mask . . . . . . . . . . . : 255.255.255.255 Default Gateway . . . . . . . . . : 10.67.15.18 C:\\Documents and Settings\\Administrator>ping baidu.com #\u62e8\u53f7\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u6b63\u5e38\u4e0a\u7f51 Pinging baidu.com [180.149.132.47] with 32 bytes of data: Reply from 180.149.132.47: bytes=32 time=41ms TTL=54 Ping statistics for 180.149.132.47: Packets: Sent = 1, Received = 1, Lost = 0 (0% loss), Approximate round trip times in milli-seconds: Minimum = 41ms, Maximum = 41ms, Average = 41ms Control-C ^C","title":"3.3 \u62e8\u53f7\u540e\u68c0\u67e5"},{"location":"linux/server/pppoe/pppoe.index/#4-linux","text":"\u5ba2\u6237\u7aef\u9009\u62e9centos\uff0c\u62e8\u53f7\u4e0a\u7f51\uff0c\u64cd\u4f5c\u8fc7\u7a0b\u5982\u4e0b\uff1a","title":"4. linux \u5ba2\u6237\u7aef\u6d4b\u8bd5"},{"location":"linux/server/pppoe/pppoe.index/#41","text":"[root@mfsdata01 ~]# cat /etc/issue CentOS release 6.8 (Final) Kernel \\r on an \\m [root@mfsdata01 ~]# uname -a Linux mfsdata01 2.6.32-642.6.2.el6.x86_64 #1 SMP Wed Oct 26 06:52:09 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux [root@mfsdata01 ~]# ifconfig eth0 Link encap:Ethernet HWaddr 00:0C:29:F1:FB:05 inet addr:192.168.10.80 Bcast:192.168.10.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fef1:fb05/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:30766 errors:0 dropped:0 overruns:0 frame:0 TX packets:9953 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:18534315 (17.6 MiB) TX bytes:638381 (623.4 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:8 errors:0 dropped:0 overruns:0 frame:0 TX packets:8 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:480 (480.0 b) TX bytes:480 (480.0 b) \u6b64\u65f6\u53ea\u53ef\u4ee5ping\u901apppoeserver\u5185\u7f51\u7684\u5730\u5740\uff0c\u5982\u4e0b\uff1a [root@mfsdata01 ~]# ping 192.168.10.109 -c 1 PING 192.168.10.109 (192.168.10.109) 56(84) bytes of data. 64 bytes from 192.168.10.109: icmp_seq=1 ttl=64 time=0.300 ms --- 192.168.10.109 ping statistics --- 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 0.300/0.300/0.300/0.000 ms [root@mfsdata01 ~]# ping 192.168.5.1 -c 1 connect: Network is unreachable [root@mfsdata01 ~]# ping baidu.com -c 1 ping: unknown host baidu.com","title":"4.1 \u62e8\u53f7\u4e4b\u524d\u64cd\u4f5c\u68c0\u67e5"},{"location":"linux/server/pppoe/pppoe.index/#42-pppoe","text":"[root@mfsdata01 ~]# adsl-setup # < \u5efa\u7acbADSL\u8fde\u63a5\u6211\u7684\u662f\u7b2c\u4e8c\u6b21\u91cd\u65b0\u914d\u7f6e Welcome to the PPPoE client setup. First, I will run some checks on your system to make sure the PPPoE client is installed properly... The following DSL config was found on your system: Device: Name: ppp0 DSLppp0 Please enter the device if you want to configure the present DSL config (default ppp0) or enter 'n' if you want to create a new one: n LOGIN NAME Enter your Login Name: cmz #\u8f93\u5165ADSL\u8fde\u63a5\u7684\u7528\u6237\u540d INTERFACE Enter the Ethernet interface connected to the PPPoE modem For Solaris, this is likely to be something like /dev/hme0. For Linux, it will be ethX, where 'X' is a number. (default eth0): #\u6307\u5b9a\u7f51\u7edc\u8bbe\u5907 Do you want the link to come up on demand, or stay up continuously? If you want it to come up on demand, enter the idle time in seconds after which the link should be dropped. If you want the link to stay up permanently, enter 'no' (two letters, lower-case.) NOTE: Demand-activated links do not interact well with dynamic IP addresses. You may have some problems with demand-activated links. Enter the demand value (default no): #\u63a5\u53d7\u9ed8\u8ba4\u8bbe\u7f6e DNS Please enter the IP address of your ISP's primary DNS server. If your ISP claims that 'the server will provide dynamic DNS addresses', enter 'server' (all lower-case) here. #\u8f93\u5165DNS\u5730\u5740\uff0c\u4e0d\u8f93\u5165\u4e0d\u80fd\u89e3\u6790 If you just press enter, I will assume you know what you are doing and not modify your DNS setup. Enter the DNS information here: 114.114.114.114 Please enter the IP address of your ISP's secondary DNS server. If you just press enter, I will assume there is only one DNS server. Enter the secondary DNS server address here: 8.8.8.8 PASSWORD Please enter your Password: #\u6b64\u65f6\u8f93\u5165ADSL\u8d26\u53f7cmz\u5bf9\u5e94\u7684\u5bc6\u7801 \u4e5f\u662fcmz Please re-enter your Password: #\u518d\u8f93\u5165\u4e00\u6b21 USERCTRL Please enter 'yes' (three letters, lower-case.) if you want to allow normal user to start or stop DSL connection (default yes): no #\u586b\u5165NO\uff0c\u4e0d\u5141\u8bb8\u4e00\u822c\u7684\u7528\u6237\u8fde\u63a5PPPoE FIREWALLING Please choose the firewall rules to use. Note that these rules are very basic. You are strongly encouraged to use a more sophisticated firewall setup; however, these will provide basic security. If you are running any servers on your machine, you must choose 'NONE' and set up firewalling yourself. Otherwise, the firewall rules will deny access to all standard servers like Web, e-mail, ftp, etc. If you are using SSH, the rules will block outgoing SSH connections which allocate a privileged source port. The firewall choices are: 0 - NONE: This script will not set any firewall rules. You are responsible for ensuring the security of your machine. You are STRONGLY recommended to use some kind of firewall rules. 1 - STANDALONE: Appropriate for a basic stand-alone web-surfing workstation 2 - MASQUERADE: Appropriate for a machine acting as an Internet gateway for a LAN Choose a type of firewall (0-2): 0 #\u8f93\u51650\uff0c\u4e0d\u5728\u8fd9\u91cc\u8bbe\u7f6e\u9632\u706b\u5899 Start this connection at boot time Do you want to start this connection at boot time? Please enter no or yes (default no):yes #\u586byes,\u7cfb\u7edf\u542f\u52a8\u81ea\u52a8\u8fde\u63a5ADSL ** Summary of what you entered ** Ethernet Interface: eth0 User name: cmz Activate-on-demand: No Primary DNS: 114.114.114.114 Secondary DNS: 8.8.8.8 Firewalling: NONE User Control: no Accept these settings and adjust configuration files (y/n)? y Adjusting /etc/sysconfig/network-scripts/ifcfg-ppp1 Adjusting /etc/resolv.conf (But first backing it up to /etc/resolv.conf.bak) Adjusting /etc/ppp/chap-secrets and /etc/ppp/pap-secrets (But first backing it up to /etc/ppp/chap-secrets.bak) (But first backing it up to /etc/ppp/pap-secrets.bak) Congratulations, it should be all set up! Type '/sbin/ifup ppp1' to bring up your xDSL link and '/sbin/ifdown ppp1' to bring it down. Type '/sbin/pppoe-status /etc/sysconfig/network-scripts/ifcfg-ppp1' to see the link status. [root@mfsdata01 ~]# adsl-start #\u542f\u52a8adsl [root@mfsdata01 ~]# #\u2190 \u7a0d\u7b49\u7247\u523b\u540e\u82e5\u542f\u52a8\u6210\u529f\u540e\u51fa\u73b0\u63d0\u793a\u7b26\uff08\u65e0\u4efb\u4f55\u63d0\u793a\u5373\u610f\u5473\u7740\u8fde\u63a5\u6210\u529f\uff09 \u8fd9\u65f6\uff0c\u901a\u8fc7\u201cifconfig\u201d\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u5404\u7f51\u7edc\u63a5\u53e3\u7684\u4fe1\u606f\uff08IP\u5730\u5740\u7b49\u7b49\uff09\u3002 [root@mfsdata01 ~]# ifconfig eth0 Link encap:Ethernet HWaddr 00:0C:29:F1:FB:05 inet addr:192.168.10.80 Bcast:192.168.10.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fef1:fb05/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:31553 errors:0 dropped:0 overruns:0 frame:0 TX packets:10328 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:18597215 (17.7 MiB) TX bytes:688437 (672.3 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:8 errors:0 dropped:0 overruns:0 frame:0 TX packets:8 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:480 (480.0 b) TX bytes:480 (480.0 b) ppp0 Link encap:Point-to-Point Protocol inet addr:10.67.15.20 P-t-P:192.168.10.109 Mask:255.255.255.255 UP POINTOPOINT RUNNING NOARP MULTICAST MTU:1492 Metric:1 RX packets:3 errors:0 dropped:0 overruns:0 frame:0 TX packets:11 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:3 RX bytes:30 (30.0 b) TX bytes:1086 (1.0 KiB) [root@mfsdata01 ~]# ping baidu.com PING baidu.com (180.149.132.47) 56(84) bytes of data. 64 bytes from 180.149.132.47: icmp_seq=1 ttl=54 time=29.6 ms 64 bytes from 180.149.132.47: icmp_seq=2 ttl=54 time=34.8 ms ^C --- baidu.com ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 1630ms rtt min/avg/max/mdev = 29.611/32.248/34.885/2.637 ms","title":"4.2 \u5efa\u7acbPPPoe\u94fe\u63a5"},{"location":"linux/server/redis/redis-sentinel/","text":"Redis Sentinel 1. \u4ecb\u7ecd \u00b6 REmote DIctionary Server(Redis) \u662f\u4e00\u4e2a\u7531Salvatore Sanfilippo\u5199\u7684key-value\u5b58\u50a8\u7cfb\u7edf\u3002Redis\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4f7f\u7528ANSI C\u8bed\u8a00\u7f16\u5199\u3001\u9075\u5b88BSD\u534f\u8bae\u3001\u652f\u6301\u7f51\u7edc\u3001\u53ef\u57fa\u4e8e\u5185\u5b58\u4ea6\u53ef\u6301\u4e45\u5316\u7684\u65e5\u5fd7\u578b\u3001Key-Value\u6570\u636e\u5e93\uff0c\u5e76\u63d0\u4f9b\u591a\u79cd\u8bed\u8a00\u7684API\u3002\u5b83\u901a\u5e38\u88ab\u79f0\u4e3a\u6570\u636e\u7ed3\u6784\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u503c\uff08value\uff09\u53ef\u4ee5\u662f \u5b57\u7b26\u4e32(String), \u54c8\u5e0c(Map), \u5217\u8868(list), \u96c6\u5408(sets) \u548c \u6709\u5e8f\u96c6\u5408(sorted sets)\u7b49\u7c7b\u578b\u3002Redis \u662f\u5b8c\u5168\u5f00\u6e90\u514d\u8d39\u7684\uff0c\u9075\u5b88BSD\u534f\u8bae\uff0c\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684key-value\u6570\u636e\u5e93\u3002Redis \u4e0e\u5176\u4ed6 key - value \u7f13\u5b58\u4ea7\u54c1\u6709\u4ee5\u4e0b\u4e09\u4e2a\u7279\u70b9\uff1a Redis\u652f\u6301\u6570\u636e\u7684\u6301\u4e45\u5316\uff0c\u53ef\u4ee5\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u4fdd\u6301\u5728\u78c1\u76d8\u4e2d\uff0c\u91cd\u542f\u7684\u65f6\u5019\u53ef\u4ee5\u518d\u6b21\u52a0\u8f7d\u8fdb\u884c\u4f7f\u7528\u3002 Redis\u4e0d\u4ec5\u4ec5\u652f\u6301\u7b80\u5355\u7684key-value\u7c7b\u578b\u7684\u6570\u636e\uff0c\u540c\u65f6\u8fd8\u63d0\u4f9blist\uff0cset\uff0czset\uff0chash\u7b49\u6570\u636e\u7ed3\u6784\u7684\u5b58\u50a8\u3002 Redis\u652f\u6301\u6570\u636e\u7684\u5907\u4efd\uff0c\u5373master-slave\u6a21\u5f0f\u7684\u6570\u636e\u5907\u4efd\u3002 1.1 \u4f18\u52bf \u00b6 \u6027\u80fd\u6781\u9ad8 \u2013 Redis\u80fd\u8bfb\u7684\u901f\u5ea6\u662f110000\u6b21/s,\u5199\u7684\u901f\u5ea6\u662f81000\u6b21/s \u3002 \u4e30\u5bcc\u7684\u6570\u636e\u7c7b\u578b\u2013Redis\u652f\u6301\u4e8c\u8fdb\u5236\u6848\u4f8b\u7684 Strings, Lists, Hashes, Sets \u53ca Ordered Sets \u6570\u636e\u7c7b\u578b\u64cd\u4f5c\u3002 \u539f\u5b50 \u2013 Redis\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u540c\u65f6Redis\u8fd8\u652f\u6301\u5bf9\u51e0\u4e2a\u64cd\u4f5c\u5168\u5e76\u540e\u7684\u539f\u5b50\u6027\u6267\u884c\u3002 \u4e30\u5bcc\u7684\u7279\u6027 \u2013 Redis\u8fd8\u652f\u6301 publish/subscribe, \u901a\u77e5, key \u8fc7\u671f\u7b49\u7b49\u7279\u6027\u3002 1.2 \u6bd4\u8f83 \u00b6 Redis\u4e0e\u5176\u4ed6key-value\u5b58\u50a8\u6709\u4ec0\u4e48\u4e0d\u540c - Redis\u6709\u7740\u66f4\u4e3a\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\u5e76\u4e14\u63d0\u4f9b\u5bf9\u4ed6\u4eec\u7684\u539f\u5b50\u6027\u64cd\u4f5c\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e0d\u540c\u4e8e\u5176\u4ed6\u6570\u636e\u5e93\u7684\u8fdb\u5316\u8def\u5f84\u3002Redis\u7684\u6570\u636e\u7c7b\u578b\u90fd\u662f\u57fa\u4e8e\u57fa\u672c\u6570\u636e\u7ed3\u6784\u7684\u540c\u65f6\u5bf9\u7a0b\u5e8f\u5458\u900f\u660e\uff0c\u65e0\u9700\u8fdb\u884c\u989d\u5916\u7684\u62bd\u8c61\u3002 - Redis\u8fd0\u884c\u5728\u5185\u5b58\u4e2d\u4f46\u662f\u53ef\u4ee5\u6301\u4e45\u5316\u5230\u78c1\u76d8\uff0c\u6240\u4ee5\u5728\u5bf9\u4e0d\u540c\u6570\u636e\u96c6\u8fdb\u884c\u9ad8\u901f\u8bfb\u5199\u65f6\u9700\u8981\u6743\u8861\u5185\u5b58\uff0c\u5e94\u4e3a\u6570\u636e\u91cf\u4e0d\u80fd\u5927\u4e8e\u786c\u4ef6\u5185\u5b58\u3002\u5728\u5185\u5b58\u6570\u636e\u5e93\u65b9\u9762\u7684\u53e6\u4e00\u4e2a\u4f18\u70b9\u662f\uff0c \u76f8\u6bd4\u5728\u78c1\u76d8\u4e0a\u76f8\u540c\u7684\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5728\u5185\u5b58\u4e2d\u64cd\u4f5c\u8d77\u6765\u975e\u5e38\u7b80\u5355\uff0c\u8fd9\u6837Redis\u53ef\u4ee5\u505a\u5f88\u591a\u5185\u90e8\u590d\u6742\u6027\u5f88\u5f3a\u7684\u4e8b\u60c5\u3002 \u540c\u65f6\uff0c\u5728\u78c1\u76d8\u683c\u5f0f\u65b9\u9762\u4ed6\u4eec\u662f\u7d27\u51d1\u7684\u4ee5\u8ffd\u52a0\u7684\u65b9\u5f0f\u4ea7\u751f\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5e76\u4e0d\u9700\u8981\u8fdb\u884c\u968f\u673a\u8bbf\u95ee\u3002 2. redis sentinel \u4ecb\u7ecd \u00b6 2.1 Sentinel\u662f\u4ec0\u4e48 \u00b6 \u7528\u4e8e\u76d1\u89c6master\u662f\u5426\u6b63\u5e38\u5728\u7ebf\uff0c\u82e5\u679c\u8bf4master\u6302\u6389\u4e86\uff0cSentinel\u4f1a\u8ba9\u5176\u4e2d\u4e00\u4e2aslave\u9876\u4e0a\u53bb\u3002 2.2 \u5f00\u591a\u5c11\u4e2aSentinel\u5408\u9002 \u00b6 \u5f003\u4e2aSentinel\uff0c\u6216\u8005\u8bf4\u5f00\u5947\u6570\u4e2a\uff0cSentinel\u7684\u539f\u7406\u5c31\u662f\u4e00\u76f4\u76d1\u89c6\u7740master\u662f\u5426\u5728\u7ebf\uff0c\u5982\u679c\u662f\u6302\u6389\uff0cSentinel\u7684\u96c6\u7fa4\u8ffd\u9009\u4e3e\u5176\u4e2d\u4e00\u4e2a\u9886\u5934Sentinel\uff0c\u7136\u540e\u7531\u4e8e\u9886\u5934\u7684Sentinel\u6267\u884cslaveof\u547d\u4ee4\u8ba9slave\u4f5c\u4e3amaster\uff0c\u7136\u540eSentinel\u96c6\u7fa4\u673a\u9009\u76d1\u89c6\u65b0\u7684master\uff0c\u8001\u7684master\u8fd8\u662f\u4f1a\u4e00\u76f4\u76d1\u89c6\u7740\u5982\u679c\u542f\u52a8\u4e86\u90a3\u4e48\u8001\u7684master\u4f1a\u505a\u4e3a\u65b0\u7684master\u7684slave 2.3 Sentinel\u5224\u65admaster\u4e0b\u7ebf\u7684\u4e24\u79cd\u6807\u51c6 \u00b6 \u4e3b\u89c2\u4e0b\u7ebf Sentinel\u53d1\u73b0master\u6ca1\u6709\u5728\u6307\u5b9a\u65f6\u95f4\u8fd4\u56de\u4fe1\u606f\uff0c\u8fd9\u79cd\u60c5\u51b5\u5457\u8ba4\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\u3002[\u6307\u5b9a\u65f6\u95f4\uff1a\u8fd9\u4e2a\u65f6\u95f4\u662f\u6211\u4eec\u8bbe\u7f6e\u7684] \u5ba2\u89c2\u4e0b\u7ebf sentinel\u8be2\u95eeSentinel\u96c6\u7fa4\uff0c\u7bee\u4e0b\u5176\u4ed6\u7684Sentinel\u662f\u5426\u4e5f\u6807\u8bb0\u8fd9\u4e2amaster\u662f\u5426\u4e0b\u7ebf\u5982\u679c\u6807\u8bb0Sentinel\u4e0b\u7ebf\u7684\u4e2a\u6570\u8fbe\u5230\u4e00\u4e2a\u9608\u503c\uff0cSentinel\u4f1a\u5c06master\u6807\u8bb0\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\uff0c\u8fd9\u65f6\u5019\u4f1a\u9009\u53d6\u9886\u5934\u7684Sentinel\uff0c\u7531Sentinel\u9009\u53d6master\u4e0b\u9762\u7684\u4e00\u4e2aslave\u53bb\u4f5c\u4e3a\u65b0\u7684master\u3002 3. \u51c6\u5907 \u00b6 3.1 \u6761\u4ef6 \u00b6 \u5b9e\u9a8c\u73af\u5883: 1\u4e3b\u4e24\u4ece\uff0c3\u4e2aSentinel 3.2 \u914d\u7f6e \u00b6 \u8bbe\u7f6eSentinel\u56db\u4e2a\u6761\u4ef6: IP \u4e0b\u7ebf\u9600\u503c slave\u4e2a\u6570 \u6062\u590d\u65f6\u957f 3.2.1 ip\u5730\u5740 \u00b6 \u4f60\u8981\u76d1\u89c6\u4e3b\u670d\u52a1\u5668\u7684ip\u5730\u5740\uff0c\u4ee5\u53ca\u8bbe\u7f6eSentinel\u6807\u8bb0\u5ba2\u89c2\u4e0b\u7ebf\u7684\u9608\u503c Note sentinel monitor < \u88ab\u76d1\u63a7\u7684\u540d\u5b57\u4e5f\u5c31\u662f run_id > < ip > < port > < \u56e2\u4f53\u53f7 > sentinel monitor mymaster 127.0 . 0.1 6379 2 3.2.2 \u4e0b\u7ebf\u9600\u503c \u00b6 Note Sentinel\u8ba4\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\u7684\u4e00\u4e2a\u9608\u503c sentinel down - after - milliseconds mymaster 30000 3.2.3 slave\u4e2a\u6570 \u00b6 Note \u6545\u969c\u6062\u590d\u671f\u95f4\u53ef\u4ee5\u540c\u65f6 slave\u7684\u4e2a\u6570 sentinel parallel - syncs mymaster 1 3.2.3 \u6062\u590d\u65f6\u957f \u00b6 Note \u6545\u969c\u6062\u590d\u5141\u8bb8\u7684\u6700\u5927\u65f6\u957f sentinel failover - timeout mymaster 180000 4. redis sentinel \u00b6 4.1 \u73af\u5883\u51c6\u5907 \u00b6 \u91c7\u7528\u540c\u4e00\u7f51\u7edc\u5185\u7684\u4e09\u53f0docker\u4e3b\u673a\uff08\u53ef\u4ee5\u662f\u7269\u7406\u4e3b\u673a\u3001\u865a\u62df\u673a\u6216docker\u5bb9\u5668\uff09\uff0c\u8981\u6c42\u4e09\u53f0\u4e3b\u673a\u4e4b\u95f4\u90fd\u80fd\u76f8\u4e92\u8bbf\u95ee\uff0c\u6bcf\u4e00\u53f0\u4e3b\u673a\u4e0a\u90fd\u5b89\u88c5redis-server\u3001redis-sentinel\u3002redis-server\u8d1f\u8d23\u63d0\u4f9bRedis\u7f13\u5b58\u670d\u52a1\uff0c\u4e09\u53f0\u4e3b\u673a\u95f4\u7684\u5173\u7cfb\u662fmaster-slave-slave,redis-sentinel\u8d1f\u8d23\u63d0\u4f9bRedis\u9ad8\u53ef\u7528\uff0cVIP\u59cb\u7ec8\u5728redis-server master\u4e0a\uff0c\u4fdd\u8bc1\u5bf9\u4e0a\u5c42\u5e94\u7528\u53ef\u5199\u53ef\u8bfb\u3002\u4e09\u53f0\u4e3b\u673a\u7684\u5197\u4f59\u5ea6\u662f1\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u6709\u4e00\u53f0\u4e3b\u673a\u5b95\u673a\u65f6\u53e6\u5916\u4e24\u53f0\u4e2d\u81f3\u5c11\u6709\u4e00\u53f0\u4e3b\u673a\u53ef\u4ee5\u63d0\u4f9bRedis\u7f13\u5b58\u670d\u52a1\u3002 \u5982\u56fe\u6240\u793a\uff0c\u6709\u4e09\u53f0\u4e3b\u673a\uff0c\u5206\u522b\u6807\u8bc6\u4e3aRedis1\u3001Redis2\u3001Redis3\uff0c\u5b83\u4eec\u7684\u89d2\u8272\u548c\u914d\u7f6e\u7b49\u4fe1\u606f\u5982\u4e0b\uff1a \u4e3b\u673a\u6807\u8bc6 IP\u5730\u5740 \u9884\u8bbe\u89d2\u8272 172.17.0.6 redis-server redis-sentinel vip 172.17.0.14 redis-server redis-sentinel 172.17.0.16 redis-server redis-sentinel Redis\u4e3b\u4ece\u7cfb\u7edf\uff0c\u9664\u4e86\u505a\u6570\u636e\u5197\u4f59\uff0c\u5f00\u53ef\u4ee5\u505a\u9ad8\u53ef\u7528\u6027\u707e\u5907\u3002Reids\u63d0\u4f9b\u4e86Sentinel\u5de5\u5177\u6765\u76d1\u63a7\u5404Master\u7684\u72b6\u6001\uff0c\u5982\u679cMaster\u5f02\u5e38\uff0c\u5219\u4f1a\u505a\u4e3b\u4ece\u5207\u6362\uff0c\u5c06slave\u4f5c\u4e3amaster\uff0c\u5c06master\u4f5c\u4e3aslave\u3002\u4e3b\u4ece\u5207\u6362\u4e4b\u540e\uff0cmaster_redis.conf\u3001slave_redis.conf\u548csentinel.conf\u7684\u5185\u5bb9\u90fd\u4f1a\u53d1\u751f\u6539\u53d8\u3002master_redis.conf\u4e2d\u4f1a\u591a\u4e86\u4e00\u53e5slaveof\u7684\u914d\u7f6e\uff0csentinel.conf\u7684\u76d1\u63a7\u76ee\u6807\u4e5f\u968f\u4e4b\u8c03\u6362\uff0c\u8fd9\u4e00\u70b9\u8981\u6ce8\u610f\u3002 4.2 \u64cd\u4f5c\u6d41\u7a0b \u00b6 \u6574\u4f53\u6d41\u7a0b\u5982\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff0c\u4ee5\u4e0b\u6211\u4f7f\u7528docker\u5b89\u88c5\uff0c\u5bbf\u4e3b\u673a\u7c7b\u4f3c\u3002 - \u542f\u52a8\u4e09\u53f0ubuntu12.04 64\u4f4d\u955c\u50cf\u4f5c\u4e3adocker\u5bb9\u5668 - \u5b89\u88c5\u4f9d\u8d56\u5305 - \u5b89\u88c5tcl8.6.1 - \u5b89\u88c5redis3.0.2 - \u914d\u7f6eredis\u4e00\u4e3b\u4e24\u4ece\u6a21\u5f0f - \u6d4b\u8bd5redis\u4e00\u4e3b\u4e24\u4ece - \u914d\u7f6esentinel\u76d1\u63a7 - \u6d4b\u8bd5sentinel\u76d1\u63a7\u6a21\u5f0f - \u542f\u52a8redis\u7a0b\u5e8f - \u542f\u52a8sentinel\u76d1\u63a7\u7a0b\u5e8f - \u6d4b\u8bd5\u53ca\u6392\u9519 4.3 \u62d3\u6251\u6f14\u53d8 \u00b6 4.3.1 \u5f00\u59cb\u6a21\u5f0f \u00b6 \u5f00\u59cb\u7684\u4e09\u4e2asentinel\u76d1\u63a7\u4e00\u4e2aredis\u7684\u4e3b\u3002\u5f53redis\u4e3b\u5b95\u673a\u4ee5\u540e\uff0c\u67b6\u6784\u56fe\u53c8\u53d8\u4e86\u6a21\u5f0f\u3002 4.3.2 master\u5b95\u673a \u00b6 Master redis\u5b95\u673a\u540e\uff0c\u65b0\u4e3b\u542f\u52a8\uff0c\u5728master redis\u5728\u6307\u5b9a\u65f6\u95f4\u6ca1\u6709\u54cd\u5e94\uff0c\u4e09\u4e2asentinel\u4ef2\u88c1\u6709\u4e24\u4eba\u8ba4\u4e3a\u4e0b\u7ebf\u6b64\u65f6\u4ef2\u88c1\u5904\u65b0\u4e3bredis\uff0c\u542f\u52a8\u65b0\u7684master redis\u540e\uff0csentinel\u540c\u65f6\u76d1\u63a7\u8001\u7684master redis\u3002 4.3.3 master\u4fee\u590d\u540e \u00b6 \u5f53\u539f\u6765\u7684master redis\u6062\u590d\u540e\uff0c\u6b64\u65f6\u539f\u6765\u7684\u4e3b\u5c31\u81ea\u52a8\u53d8\u6210\u4ece\u53bb\u81ea\u52a8\u540c\u6b65\u65b0\u7684\u4e3b\uff0c\u67b6\u6784\u6a21\u5f0f\u6062\u590d\u6210\u4ee5\u4e0b\u3002 4.4 \u542f\u52a8\u955c\u50cf \u00b6 \u542f\u52a8\u955c\u50cf root@leco:~# docker run -itd --privileged -p 36379:6379 -p 36380:26379 -v /usr/local/src/ sentienl1 bash root@leco:~# docker run -itd --privileged -p 36381:6379 -p 36382:26379 -v /usr/local/src/ sentienl2 bash root@leco:~# docker run -itd --privileged -p 36383:6379 -p 36384:26379 -v /usr/local/src/ sentienl3 bash Note \u6b64\u65f6\u7aef\u53e3\u6620\u5c04\u51fa redis\u7684\u7aef\u53e36379\u548csentinel\u7684\u7aef\u53e326379\u5230\u5bbf\u4e3b\u673a \u3002 -- privileged \u662f\u83b7\u53d6\u81f3\u9ad8\u65e0\u4e0a\u7684 root\u6743\u9650 \u3002 - v\u662f\u6570\u636e\u5377\u7ba1\u7406 \u3002 - d\u662f\u540e\u53f0\u65b9\u5f0f\u8fd0\u884c \uff0c\u4e3a\u4e86\u5728\u5bb9\u5668\u5185 exit\u540e\u5bb9\u5668\u4e0d\u9000\u51fa \u3002 \u6ce8\u610f \u6211\u53ea\u5217\u51fa\u5b89\u88c5\u4e86\u5176\u4e2d\u4e00\u4e2a docker\u91cc\u9762\u7684\u4f9d\u8d56\u5305\u5176\u4ed6\u4e24docker\u5b89\u88c5\u4e00\u6837 \u3002\u76ee\u7684\u662f\u5229\u4e8e\u6d4b\u8bd5\uff0c\u6700\u540e\u53ef\u4ee5\u5378\u8f7d\u5728\u5236\u4f5c\u6210\u65b0\u7684\u955c\u50cf\u65f6\u5019\u3002 4.5.2 \u5b89\u88c5tcl \u5305 \u00b6 root@8d7240ab9c47:~# tar xzvf tcl8.6.1-src.tar.gz -C /usr/local/ root@8d7240ab9c47:~# cd /usr/local/tcl8.6.1/unix root@8d7240ab9c47:~# ./configure root@8d7240ab9c47:~# make root@8d7240ab9c47:~# make install 4.5.3 \u5b89\u88c5redis \u00b6 root@8d7240ab9c47:~# tar xvfz redis-3.0.2.tar.gz root@8d7240ab9c47:~# cd redis-3.0.2 root@8d7240ab9c47:~# make root@8d7240ab9c47:~# cd src root@8d7240ab9c47:~# make install root@8d7240ab9c47:~# make PREFIX=/usr/local/redis install root@8d7240ab9c47:~# useradd -s /sbin/nologin redis root@8d7240ab9c47:~# mkdir /usr/local/redis/var root@8d7240ab9c47:~# chmod 777 /usr/local/redis/var/ root@8d7240ab9c47:~# mkdir -p /usr/local/redis/etc #\u653e\u7f6e\u914d\u7f6e\u6587\u4ef6\u5730\u65b9 \u6ce8\u610f \u6211\u53ea\u5217\u51fa\u5b89\u88c5\u4e86\u5176\u4e2d\u4e00\u4e2a docker\u91cc\u9762\u7684redis , tcl \uff0c\u6b64\u65f6\u5148\u505a\u4e3a\u4e3b\uff0c\u5176\u4ed6\u4e24\u4ece redis docker\u5b89\u88c5\u4e00\u6837 \u3002 4.6 \u914d\u7f6e\u4e3b\u4ece \u00b6 4.6.1 \u4e3b\u4ece\u914d\u7f6e \u00b6 Master redis.conf\u914d\u7f6e\u6587\u4ef6\u4fee\u6539 root@8d7240ab9c47:~# cat /usr/local/redis/etc/redis.conf daemonize yes # \u540e\u53f0\u8fd0\u884c pidfile \"/usr/local/redis/var/redis.pid\" # \u8fd0\u884cpid\u6587\u4ef6 port 6379 # \u7aef\u53e3 timeout 300 # \u8d85\u65f6 loglevel debug # debug\u6a21\u5f0f logfile \"/usr/local/redis/var/redis.log\" # \u65e5\u5fd7\u6587\u4ef6 databases 16 save 900 1 save 300 10 save 60 10000 rdbcompression yes dbfilename \"dump.rdb\" dir \"/usr/local/redis/var\" appendonly no appendfsync always bind 0.0.0.0 # \u65b9\u5f0fip\u9650\u5236 Slave1 redis.conf\u914d\u7f6e\u6587\u4ef6\u4fee\u6539 root@38b072848ccd:/# cat /usr/local/redis/etc/redis.conf daemonize yes pidfile \"/usr/local/redis/var/redis.pid\" port 6379 timeout 300 loglevel debug logfile \"/usr/local/redis/var/redis.log\" databases 16 save 900 1 save 300 10 save 60 10000 rdbcompression yes dbfilename \"dump.rdb\" dir \"/usr/local/redis/var\" appendonly no appendfsync always bind 0.0.0.0 slaveof 172.17.0.2 6379 # master ip Slave2 redis.conf\u914d\u7f6e\u6587\u4ef6\u4fee\u6539 root@56c0344c59a0:/# cat /usr/local/redis/etc/redis.conf daemonize yes pidfile \"/usr/local/redis/var/redis.pid\" port 6379 timeout 300 loglevel debug logfile \"/usr/local/redis/var/redis.log\" databases 16 save 900 1 save 300 10 save 60 10000 rdbcompression yes dbfilename \"dump.rdb\" dir \"/usr/local/redis/var\" appendonly no appendfsync always bind 0.0.0.0 slaveof 172.17.0.2 6379 \u7279\u522b\u6ce8\u610f \u4e00\u5b9a\u8981\u4fee\u8fd9\u4e2a\u4e3a 0.0 . 0.0 \u5426\u5219\u5bbf\u4e3b\u673a\u8fde\u63a5\u4e0d\u5230 docker\u5bb9\u5668\u91cc\u9762\u7684redis \u542f\u52a8\u811a\u672c [root@linux-node2 init.d]# cat /etc/init.d/redis #!/bin/sh # # Simple Redis init.d script conceived to work on Linux systems # as it does use of the /proc filesystem. # chkconfig: 2345 90 10 # description: Redis is a persistent key-value database # REDISPORT=6379 EXEC=/usr/local/bin/redis-server CLIEXEC=/usr/local/bin/redis-cli PIDFILE=/var/run/redis_${REDISPORT}.pid #CONF=\"/etc/redis/${REDISPORT}.conf\" CONF=\"/usr/local/redis/etc/redis.conf\" case \"$1\" in start) if [ -f $PIDFILE ] then echo \"$PIDFILE exists, process is already running or crashed\" else echo \"Starting Redis server...\" $EXEC $CONF echo $(ps aux|grep redis|grep -v grep|grep 6379|awk '{print $2}')>$PIDFILE fi ;; stop) if [ ! -f $PIDFILE ] then echo \"$PIDFILE does not exist, process is not running\" else PID=$(cat $PIDFILE) echo \"Stopping ...\" $CLIEXEC -p $REDISPORT shutdown while [ -x /proc/${PID} ] do echo \"Waiting for Redis to shutdown ...\" sleep 1 done echo \"Redis stopped\" cd /var/run/ && rm -f redis_${REDISPORT}.pid fi ;; *) echo \"Please use start or stop as first argument\" ;; esac [root@linux-node2 init.d]# chmod +x /etc/init.d/redis 4.7 \u542f\u52a8 \u00b6 4.7.1 \u542f\u52a8 \u00b6 #root@8d7240ab9c47:~# redis-server /usr/local/redis/etc/redis.conf root@8d7240ab9c47:~# /etc/init.d/redis start Starting Redis server... 4.7.2 \u505c\u6b62 \u00b6 #root@8d7240ab9c47:~# redis-cli shutdown root@8d7240ab9c47:~# /etc/init.d/redis stop \u6ce8\u610f \u5176\u4ed6\u4e24\u4e2a\u4ece redis\u542f\u52a8\u65b9\u5f0f\u4e00\u6837 \u3002 4.8 \u6d4b\u8bd5\u4e3b\u4ece \u00b6 \u4fdd\u8bc1\u4e09\u53f0redis\u90fd\u542f\u52a8\u540e\uff0c\u67e5\u770b 127.0.0.1:6379> info \u3002\u3002\u3002\u3002\u3002\u3002 # Replication role:master connected_slaves:2 slave0:ip=172.17.0.6,port=6379,state=online,offset=10912,lag=0 slave1:ip=172.17.0.4,port=6379,state=online,offset=10912,lag=0 \u3002\u3002\u3002\u3002\u3002\u3002 \u6bcf\u4e2aredis\u90fd\u4f1a\u6709\u8be5info\uff0c\u53ef\u770b\u51fa\u5176\u4e2d\u6bcf\u4e2aredis\u7684\u8eab\u4efdrole\u3002\u5176\u4e2dmaster\u53ef\u4ee5\u770b\u51fa\u5b83\u7684\u4e24\u4e2aslave\u60c5\u51b5\u3002 4.8.1 \u4e3b\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9 \u00b6 127.0.0.1:6379> set realcloud 1234 OK 127.0.0.1:6379> get realcloud \"1234\" 4.8.2 Redis slave1\u67e5\u770b \u00b6 127.0.0.1:6379> get realcloud \"1234\" 4.8.2 Redis slave2\u67e5\u770b \u00b6 127.0.0.1:6379> get realcloud \"1234\" \u4ece\u4e0a\u53ef\u4ee5\u770b\u51faredis\u4e00\u4e3b\u4e24\u4ece\uff0c\u5b89\u88c5\uff0c\u6d4b\u8bd5OK\u3002 4.8 \u914d\u7f6esentinel \u00b6 \u4e09\u53f0\u673a\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u4e00\u6837\u3002 4.8.1 \u914d\u7f6esentinel \u00b6 root@8d7240ab9c47:~# cat /usr/local/redis/etc/sentinel.conf port 26379 dir /usr/local/redis/var_sentinel sentinel monitor mymaster 172.17.0.2 6379 2 #\u8be5IP\u662fredis\u4e3b\u7684IP\u3002\u6839\u636e\u60c5\u51b5\u6539\u5199\u3002 sentinel down-after-milliseconds mymaster 10000 sentinel parallel-syncs mymaster 1 sentinel failover-timeout mymaster 60000 #sentinel client-reconfig-script mymaster /script/failover.sh 4.8.2 \u542f\u52a8 sentinel \u00b6 root@8d7240ab9c47:~#mkdir /usr/local/redis/var_sentinel root@8d7240ab9c47:~# redis-sentinel /usr/local/redis/etc/sentinel.conf >/usr/local/redis/var_sentinel/sentinel.log & 4.8.3 \u67e5\u770b \u00b6 \u5728\u4e3bredis\u4e0a\u8fdb\u5165sentinel\u3002 root@8d7240ab9c47:~# redis-cli -p 26379 127.0.0.1:26379> sentinel master mymaster 1) \"name\" 2) \"mymaster\" 3) \"ip\" 4) \"172.17.0.2\" 5) \"port\" 6) \"6379\" 7) \"runid\" 8) \"eb05e2906f6e3f916fbca5f3f3e421560f2bbf21\" 9) \"flags\" 10) \"master\" 11) \"pending-commands\" 12) \"0\" 13) \"last-ping-sent\" 14) \"0\" 15) \"last-ok-ping-reply\" 16) \"451\" 17) \"last-ping-reply\" 18) \"451\" 19) \"down-after-milliseconds\" 20) \"10000\" 21) \"info-refresh\" 22) \"3492\" 23) \"role-reported\" 24) \"master\" 25) \"role-reported-time\" 26) \"5854962\" 27) \"config-epoch\" 28) \"0\" 29) \"num-slaves\" 30) \"2\" 31) \"num-other-sentinels\" 32) \"2\" 33) \"quorum\" 34) \"2\" 35) \"failover-timeout\" 36) \"60000\" 37) \"parallel-syncs\" 38) \"1\" 127.0.0.1:26379> \u6ce8\u610f redis\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f6379 redis - sentinel \u9ed8\u8ba4\u7aef\u53e3\u662f 26379 4.9 \u6545\u969c\u6a21\u62df \u00b6 4.9.1 master\u5b95\u673a \u00b6 root@8d7240ab9c47:~# redis-cli shutdown #\u4e3b\u5b95\u673a 4.9.2 \u67e5\u770bredis\u4e3b\u4ece\u60c5\u51b5 \u00b6 root@38b072848ccd:~# redis-cli info #\u6b64\u65f6\u4e3amaster root@56c0344c59a0:~# redis-cli info 4.9.3 \u67e5\u770bsentinel\u60c5\u51b5 \u00b6 root@38b072848ccd:~# redis-cli -p 26379 127.0.0.1:26379> sentinel master mymaster 1) \"name\" 2) \"mymaster\" 3) \"ip\" 4) \"172.17.0.4\" 5) \"port\" 6) \"6379\" \u6b64\u65f6\u5728kill\u5f53\u524d\u7684master\u3002Sentinel\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u53c8\u4f17\u7b79\u51fa\u5f53\u524d\u65b0\u7684master\u3002\u5f53\u4e4b\u524d\u7684master \u53c8\u542f\u52a8\u597d\u4ee5\u540esentinel\u53c8\u4e3b\u52a8\u5c06\u4e4b\u524d\u7684master\u6dfb\u52a0\u5230\u65b0\u7684master\u4e2d\uff0c\u4f5c\u4e3aslave\u3002\u76ee\u524d\u4e3a\u6b62redis\u7684sentinel\u6d4b\u8bd5OK\u3002","title":"1. redis-sentinel"},{"location":"linux/server/redis/redis-sentinel/#1","text":"REmote DIctionary Server(Redis) \u662f\u4e00\u4e2a\u7531Salvatore Sanfilippo\u5199\u7684key-value\u5b58\u50a8\u7cfb\u7edf\u3002Redis\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4f7f\u7528ANSI C\u8bed\u8a00\u7f16\u5199\u3001\u9075\u5b88BSD\u534f\u8bae\u3001\u652f\u6301\u7f51\u7edc\u3001\u53ef\u57fa\u4e8e\u5185\u5b58\u4ea6\u53ef\u6301\u4e45\u5316\u7684\u65e5\u5fd7\u578b\u3001Key-Value\u6570\u636e\u5e93\uff0c\u5e76\u63d0\u4f9b\u591a\u79cd\u8bed\u8a00\u7684API\u3002\u5b83\u901a\u5e38\u88ab\u79f0\u4e3a\u6570\u636e\u7ed3\u6784\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u503c\uff08value\uff09\u53ef\u4ee5\u662f \u5b57\u7b26\u4e32(String), \u54c8\u5e0c(Map), \u5217\u8868(list), \u96c6\u5408(sets) \u548c \u6709\u5e8f\u96c6\u5408(sorted sets)\u7b49\u7c7b\u578b\u3002Redis \u662f\u5b8c\u5168\u5f00\u6e90\u514d\u8d39\u7684\uff0c\u9075\u5b88BSD\u534f\u8bae\uff0c\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684key-value\u6570\u636e\u5e93\u3002Redis \u4e0e\u5176\u4ed6 key - value \u7f13\u5b58\u4ea7\u54c1\u6709\u4ee5\u4e0b\u4e09\u4e2a\u7279\u70b9\uff1a Redis\u652f\u6301\u6570\u636e\u7684\u6301\u4e45\u5316\uff0c\u53ef\u4ee5\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u4fdd\u6301\u5728\u78c1\u76d8\u4e2d\uff0c\u91cd\u542f\u7684\u65f6\u5019\u53ef\u4ee5\u518d\u6b21\u52a0\u8f7d\u8fdb\u884c\u4f7f\u7528\u3002 Redis\u4e0d\u4ec5\u4ec5\u652f\u6301\u7b80\u5355\u7684key-value\u7c7b\u578b\u7684\u6570\u636e\uff0c\u540c\u65f6\u8fd8\u63d0\u4f9blist\uff0cset\uff0czset\uff0chash\u7b49\u6570\u636e\u7ed3\u6784\u7684\u5b58\u50a8\u3002 Redis\u652f\u6301\u6570\u636e\u7684\u5907\u4efd\uff0c\u5373master-slave\u6a21\u5f0f\u7684\u6570\u636e\u5907\u4efd\u3002","title":"1. \u4ecb\u7ecd"},{"location":"linux/server/redis/redis-sentinel/#11","text":"\u6027\u80fd\u6781\u9ad8 \u2013 Redis\u80fd\u8bfb\u7684\u901f\u5ea6\u662f110000\u6b21/s,\u5199\u7684\u901f\u5ea6\u662f81000\u6b21/s \u3002 \u4e30\u5bcc\u7684\u6570\u636e\u7c7b\u578b\u2013Redis\u652f\u6301\u4e8c\u8fdb\u5236\u6848\u4f8b\u7684 Strings, Lists, Hashes, Sets \u53ca Ordered Sets \u6570\u636e\u7c7b\u578b\u64cd\u4f5c\u3002 \u539f\u5b50 \u2013 Redis\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u540c\u65f6Redis\u8fd8\u652f\u6301\u5bf9\u51e0\u4e2a\u64cd\u4f5c\u5168\u5e76\u540e\u7684\u539f\u5b50\u6027\u6267\u884c\u3002 \u4e30\u5bcc\u7684\u7279\u6027 \u2013 Redis\u8fd8\u652f\u6301 publish/subscribe, \u901a\u77e5, key \u8fc7\u671f\u7b49\u7b49\u7279\u6027\u3002","title":"1.1 \u4f18\u52bf"},{"location":"linux/server/redis/redis-sentinel/#12","text":"Redis\u4e0e\u5176\u4ed6key-value\u5b58\u50a8\u6709\u4ec0\u4e48\u4e0d\u540c - Redis\u6709\u7740\u66f4\u4e3a\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\u5e76\u4e14\u63d0\u4f9b\u5bf9\u4ed6\u4eec\u7684\u539f\u5b50\u6027\u64cd\u4f5c\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e0d\u540c\u4e8e\u5176\u4ed6\u6570\u636e\u5e93\u7684\u8fdb\u5316\u8def\u5f84\u3002Redis\u7684\u6570\u636e\u7c7b\u578b\u90fd\u662f\u57fa\u4e8e\u57fa\u672c\u6570\u636e\u7ed3\u6784\u7684\u540c\u65f6\u5bf9\u7a0b\u5e8f\u5458\u900f\u660e\uff0c\u65e0\u9700\u8fdb\u884c\u989d\u5916\u7684\u62bd\u8c61\u3002 - Redis\u8fd0\u884c\u5728\u5185\u5b58\u4e2d\u4f46\u662f\u53ef\u4ee5\u6301\u4e45\u5316\u5230\u78c1\u76d8\uff0c\u6240\u4ee5\u5728\u5bf9\u4e0d\u540c\u6570\u636e\u96c6\u8fdb\u884c\u9ad8\u901f\u8bfb\u5199\u65f6\u9700\u8981\u6743\u8861\u5185\u5b58\uff0c\u5e94\u4e3a\u6570\u636e\u91cf\u4e0d\u80fd\u5927\u4e8e\u786c\u4ef6\u5185\u5b58\u3002\u5728\u5185\u5b58\u6570\u636e\u5e93\u65b9\u9762\u7684\u53e6\u4e00\u4e2a\u4f18\u70b9\u662f\uff0c \u76f8\u6bd4\u5728\u78c1\u76d8\u4e0a\u76f8\u540c\u7684\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5728\u5185\u5b58\u4e2d\u64cd\u4f5c\u8d77\u6765\u975e\u5e38\u7b80\u5355\uff0c\u8fd9\u6837Redis\u53ef\u4ee5\u505a\u5f88\u591a\u5185\u90e8\u590d\u6742\u6027\u5f88\u5f3a\u7684\u4e8b\u60c5\u3002 \u540c\u65f6\uff0c\u5728\u78c1\u76d8\u683c\u5f0f\u65b9\u9762\u4ed6\u4eec\u662f\u7d27\u51d1\u7684\u4ee5\u8ffd\u52a0\u7684\u65b9\u5f0f\u4ea7\u751f\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5e76\u4e0d\u9700\u8981\u8fdb\u884c\u968f\u673a\u8bbf\u95ee\u3002","title":"1.2 \u6bd4\u8f83"},{"location":"linux/server/redis/redis-sentinel/#2-redis-sentinel","text":"","title":"2. redis sentinel \u4ecb\u7ecd"},{"location":"linux/server/redis/redis-sentinel/#21-sentinel","text":"\u7528\u4e8e\u76d1\u89c6master\u662f\u5426\u6b63\u5e38\u5728\u7ebf\uff0c\u82e5\u679c\u8bf4master\u6302\u6389\u4e86\uff0cSentinel\u4f1a\u8ba9\u5176\u4e2d\u4e00\u4e2aslave\u9876\u4e0a\u53bb\u3002","title":"2.1 Sentinel\u662f\u4ec0\u4e48"},{"location":"linux/server/redis/redis-sentinel/#22-sentinel","text":"\u5f003\u4e2aSentinel\uff0c\u6216\u8005\u8bf4\u5f00\u5947\u6570\u4e2a\uff0cSentinel\u7684\u539f\u7406\u5c31\u662f\u4e00\u76f4\u76d1\u89c6\u7740master\u662f\u5426\u5728\u7ebf\uff0c\u5982\u679c\u662f\u6302\u6389\uff0cSentinel\u7684\u96c6\u7fa4\u8ffd\u9009\u4e3e\u5176\u4e2d\u4e00\u4e2a\u9886\u5934Sentinel\uff0c\u7136\u540e\u7531\u4e8e\u9886\u5934\u7684Sentinel\u6267\u884cslaveof\u547d\u4ee4\u8ba9slave\u4f5c\u4e3amaster\uff0c\u7136\u540eSentinel\u96c6\u7fa4\u673a\u9009\u76d1\u89c6\u65b0\u7684master\uff0c\u8001\u7684master\u8fd8\u662f\u4f1a\u4e00\u76f4\u76d1\u89c6\u7740\u5982\u679c\u542f\u52a8\u4e86\u90a3\u4e48\u8001\u7684master\u4f1a\u505a\u4e3a\u65b0\u7684master\u7684slave","title":"2.2 \u5f00\u591a\u5c11\u4e2aSentinel\u5408\u9002"},{"location":"linux/server/redis/redis-sentinel/#23-sentinelmaster","text":"\u4e3b\u89c2\u4e0b\u7ebf Sentinel\u53d1\u73b0master\u6ca1\u6709\u5728\u6307\u5b9a\u65f6\u95f4\u8fd4\u56de\u4fe1\u606f\uff0c\u8fd9\u79cd\u60c5\u51b5\u5457\u8ba4\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\u3002[\u6307\u5b9a\u65f6\u95f4\uff1a\u8fd9\u4e2a\u65f6\u95f4\u662f\u6211\u4eec\u8bbe\u7f6e\u7684] \u5ba2\u89c2\u4e0b\u7ebf sentinel\u8be2\u95eeSentinel\u96c6\u7fa4\uff0c\u7bee\u4e0b\u5176\u4ed6\u7684Sentinel\u662f\u5426\u4e5f\u6807\u8bb0\u8fd9\u4e2amaster\u662f\u5426\u4e0b\u7ebf\u5982\u679c\u6807\u8bb0Sentinel\u4e0b\u7ebf\u7684\u4e2a\u6570\u8fbe\u5230\u4e00\u4e2a\u9608\u503c\uff0cSentinel\u4f1a\u5c06master\u6807\u8bb0\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\uff0c\u8fd9\u65f6\u5019\u4f1a\u9009\u53d6\u9886\u5934\u7684Sentinel\uff0c\u7531Sentinel\u9009\u53d6master\u4e0b\u9762\u7684\u4e00\u4e2aslave\u53bb\u4f5c\u4e3a\u65b0\u7684master\u3002","title":"2.3 Sentinel\u5224\u65admaster\u4e0b\u7ebf\u7684\u4e24\u79cd\u6807\u51c6"},{"location":"linux/server/redis/redis-sentinel/#3","text":"","title":"3. \u51c6\u5907"},{"location":"linux/server/redis/redis-sentinel/#31","text":"\u5b9e\u9a8c\u73af\u5883: 1\u4e3b\u4e24\u4ece\uff0c3\u4e2aSentinel","title":"3.1 \u6761\u4ef6"},{"location":"linux/server/redis/redis-sentinel/#32","text":"\u8bbe\u7f6eSentinel\u56db\u4e2a\u6761\u4ef6: IP \u4e0b\u7ebf\u9600\u503c slave\u4e2a\u6570 \u6062\u590d\u65f6\u957f","title":"3.2 \u914d\u7f6e"},{"location":"linux/server/redis/redis-sentinel/#321-ip","text":"\u4f60\u8981\u76d1\u89c6\u4e3b\u670d\u52a1\u5668\u7684ip\u5730\u5740\uff0c\u4ee5\u53ca\u8bbe\u7f6eSentinel\u6807\u8bb0\u5ba2\u89c2\u4e0b\u7ebf\u7684\u9608\u503c Note sentinel monitor < \u88ab\u76d1\u63a7\u7684\u540d\u5b57\u4e5f\u5c31\u662f run_id > < ip > < port > < \u56e2\u4f53\u53f7 > sentinel monitor mymaster 127.0 . 0.1 6379 2","title":"3.2.1 ip\u5730\u5740"},{"location":"linux/server/redis/redis-sentinel/#322","text":"Note Sentinel\u8ba4\u4e3a\u4e3b\u89c2\u4e0b\u7ebf\u7684\u4e00\u4e2a\u9608\u503c sentinel down - after - milliseconds mymaster 30000","title":"3.2.2 \u4e0b\u7ebf\u9600\u503c"},{"location":"linux/server/redis/redis-sentinel/#323-slave","text":"Note \u6545\u969c\u6062\u590d\u671f\u95f4\u53ef\u4ee5\u540c\u65f6 slave\u7684\u4e2a\u6570 sentinel parallel - syncs mymaster 1","title":"3.2.3 slave\u4e2a\u6570"},{"location":"linux/server/redis/redis-sentinel/#323","text":"Note \u6545\u969c\u6062\u590d\u5141\u8bb8\u7684\u6700\u5927\u65f6\u957f sentinel failover - timeout mymaster 180000","title":"3.2.3 \u6062\u590d\u65f6\u957f"},{"location":"linux/server/redis/redis-sentinel/#4-redis-sentinel","text":"","title":"4. redis sentinel"},{"location":"linux/server/redis/redis-sentinel/#41","text":"\u91c7\u7528\u540c\u4e00\u7f51\u7edc\u5185\u7684\u4e09\u53f0docker\u4e3b\u673a\uff08\u53ef\u4ee5\u662f\u7269\u7406\u4e3b\u673a\u3001\u865a\u62df\u673a\u6216docker\u5bb9\u5668\uff09\uff0c\u8981\u6c42\u4e09\u53f0\u4e3b\u673a\u4e4b\u95f4\u90fd\u80fd\u76f8\u4e92\u8bbf\u95ee\uff0c\u6bcf\u4e00\u53f0\u4e3b\u673a\u4e0a\u90fd\u5b89\u88c5redis-server\u3001redis-sentinel\u3002redis-server\u8d1f\u8d23\u63d0\u4f9bRedis\u7f13\u5b58\u670d\u52a1\uff0c\u4e09\u53f0\u4e3b\u673a\u95f4\u7684\u5173\u7cfb\u662fmaster-slave-slave,redis-sentinel\u8d1f\u8d23\u63d0\u4f9bRedis\u9ad8\u53ef\u7528\uff0cVIP\u59cb\u7ec8\u5728redis-server master\u4e0a\uff0c\u4fdd\u8bc1\u5bf9\u4e0a\u5c42\u5e94\u7528\u53ef\u5199\u53ef\u8bfb\u3002\u4e09\u53f0\u4e3b\u673a\u7684\u5197\u4f59\u5ea6\u662f1\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u6709\u4e00\u53f0\u4e3b\u673a\u5b95\u673a\u65f6\u53e6\u5916\u4e24\u53f0\u4e2d\u81f3\u5c11\u6709\u4e00\u53f0\u4e3b\u673a\u53ef\u4ee5\u63d0\u4f9bRedis\u7f13\u5b58\u670d\u52a1\u3002 \u5982\u56fe\u6240\u793a\uff0c\u6709\u4e09\u53f0\u4e3b\u673a\uff0c\u5206\u522b\u6807\u8bc6\u4e3aRedis1\u3001Redis2\u3001Redis3\uff0c\u5b83\u4eec\u7684\u89d2\u8272\u548c\u914d\u7f6e\u7b49\u4fe1\u606f\u5982\u4e0b\uff1a \u4e3b\u673a\u6807\u8bc6 IP\u5730\u5740 \u9884\u8bbe\u89d2\u8272 172.17.0.6 redis-server redis-sentinel vip 172.17.0.14 redis-server redis-sentinel 172.17.0.16 redis-server redis-sentinel Redis\u4e3b\u4ece\u7cfb\u7edf\uff0c\u9664\u4e86\u505a\u6570\u636e\u5197\u4f59\uff0c\u5f00\u53ef\u4ee5\u505a\u9ad8\u53ef\u7528\u6027\u707e\u5907\u3002Reids\u63d0\u4f9b\u4e86Sentinel\u5de5\u5177\u6765\u76d1\u63a7\u5404Master\u7684\u72b6\u6001\uff0c\u5982\u679cMaster\u5f02\u5e38\uff0c\u5219\u4f1a\u505a\u4e3b\u4ece\u5207\u6362\uff0c\u5c06slave\u4f5c\u4e3amaster\uff0c\u5c06master\u4f5c\u4e3aslave\u3002\u4e3b\u4ece\u5207\u6362\u4e4b\u540e\uff0cmaster_redis.conf\u3001slave_redis.conf\u548csentinel.conf\u7684\u5185\u5bb9\u90fd\u4f1a\u53d1\u751f\u6539\u53d8\u3002master_redis.conf\u4e2d\u4f1a\u591a\u4e86\u4e00\u53e5slaveof\u7684\u914d\u7f6e\uff0csentinel.conf\u7684\u76d1\u63a7\u76ee\u6807\u4e5f\u968f\u4e4b\u8c03\u6362\uff0c\u8fd9\u4e00\u70b9\u8981\u6ce8\u610f\u3002","title":"4.1 \u73af\u5883\u51c6\u5907"},{"location":"linux/server/redis/redis-sentinel/#42","text":"\u6574\u4f53\u6d41\u7a0b\u5982\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff0c\u4ee5\u4e0b\u6211\u4f7f\u7528docker\u5b89\u88c5\uff0c\u5bbf\u4e3b\u673a\u7c7b\u4f3c\u3002 - \u542f\u52a8\u4e09\u53f0ubuntu12.04 64\u4f4d\u955c\u50cf\u4f5c\u4e3adocker\u5bb9\u5668 - \u5b89\u88c5\u4f9d\u8d56\u5305 - \u5b89\u88c5tcl8.6.1 - \u5b89\u88c5redis3.0.2 - \u914d\u7f6eredis\u4e00\u4e3b\u4e24\u4ece\u6a21\u5f0f - \u6d4b\u8bd5redis\u4e00\u4e3b\u4e24\u4ece - \u914d\u7f6esentinel\u76d1\u63a7 - \u6d4b\u8bd5sentinel\u76d1\u63a7\u6a21\u5f0f - \u542f\u52a8redis\u7a0b\u5e8f - \u542f\u52a8sentinel\u76d1\u63a7\u7a0b\u5e8f - \u6d4b\u8bd5\u53ca\u6392\u9519","title":"4.2 \u64cd\u4f5c\u6d41\u7a0b"},{"location":"linux/server/redis/redis-sentinel/#43","text":"","title":"4.3 \u62d3\u6251\u6f14\u53d8"},{"location":"linux/server/redis/redis-sentinel/#431","text":"\u5f00\u59cb\u7684\u4e09\u4e2asentinel\u76d1\u63a7\u4e00\u4e2aredis\u7684\u4e3b\u3002\u5f53redis\u4e3b\u5b95\u673a\u4ee5\u540e\uff0c\u67b6\u6784\u56fe\u53c8\u53d8\u4e86\u6a21\u5f0f\u3002","title":"4.3.1 \u5f00\u59cb\u6a21\u5f0f"},{"location":"linux/server/redis/redis-sentinel/#432-master","text":"Master redis\u5b95\u673a\u540e\uff0c\u65b0\u4e3b\u542f\u52a8\uff0c\u5728master redis\u5728\u6307\u5b9a\u65f6\u95f4\u6ca1\u6709\u54cd\u5e94\uff0c\u4e09\u4e2asentinel\u4ef2\u88c1\u6709\u4e24\u4eba\u8ba4\u4e3a\u4e0b\u7ebf\u6b64\u65f6\u4ef2\u88c1\u5904\u65b0\u4e3bredis\uff0c\u542f\u52a8\u65b0\u7684master redis\u540e\uff0csentinel\u540c\u65f6\u76d1\u63a7\u8001\u7684master redis\u3002","title":"4.3.2 master\u5b95\u673a"},{"location":"linux/server/redis/redis-sentinel/#433-master","text":"\u5f53\u539f\u6765\u7684master redis\u6062\u590d\u540e\uff0c\u6b64\u65f6\u539f\u6765\u7684\u4e3b\u5c31\u81ea\u52a8\u53d8\u6210\u4ece\u53bb\u81ea\u52a8\u540c\u6b65\u65b0\u7684\u4e3b\uff0c\u67b6\u6784\u6a21\u5f0f\u6062\u590d\u6210\u4ee5\u4e0b\u3002","title":"4.3.3 master\u4fee\u590d\u540e"},{"location":"linux/server/redis/redis-sentinel/#44","text":"\u542f\u52a8\u955c\u50cf root@leco:~# docker run -itd --privileged -p 36379:6379 -p 36380:26379 -v /usr/local/src/ sentienl1 bash root@leco:~# docker run -itd --privileged -p 36381:6379 -p 36382:26379 -v /usr/local/src/ sentienl2 bash root@leco:~# docker run -itd --privileged -p 36383:6379 -p 36384:26379 -v /usr/local/src/ sentienl3 bash Note \u6b64\u65f6\u7aef\u53e3\u6620\u5c04\u51fa redis\u7684\u7aef\u53e36379\u548csentinel\u7684\u7aef\u53e326379\u5230\u5bbf\u4e3b\u673a \u3002 -- privileged \u662f\u83b7\u53d6\u81f3\u9ad8\u65e0\u4e0a\u7684 root\u6743\u9650 \u3002 - v\u662f\u6570\u636e\u5377\u7ba1\u7406 \u3002 - d\u662f\u540e\u53f0\u65b9\u5f0f\u8fd0\u884c \uff0c\u4e3a\u4e86\u5728\u5bb9\u5668\u5185 exit\u540e\u5bb9\u5668\u4e0d\u9000\u51fa \u3002 \u6ce8\u610f \u6211\u53ea\u5217\u51fa\u5b89\u88c5\u4e86\u5176\u4e2d\u4e00\u4e2a docker\u91cc\u9762\u7684\u4f9d\u8d56\u5305\u5176\u4ed6\u4e24docker\u5b89\u88c5\u4e00\u6837 \u3002\u76ee\u7684\u662f\u5229\u4e8e\u6d4b\u8bd5\uff0c\u6700\u540e\u53ef\u4ee5\u5378\u8f7d\u5728\u5236\u4f5c\u6210\u65b0\u7684\u955c\u50cf\u65f6\u5019\u3002","title":"4.4 \u542f\u52a8\u955c\u50cf"},{"location":"linux/server/redis/redis-sentinel/#452-tcl","text":"root@8d7240ab9c47:~# tar xzvf tcl8.6.1-src.tar.gz -C /usr/local/ root@8d7240ab9c47:~# cd /usr/local/tcl8.6.1/unix root@8d7240ab9c47:~# ./configure root@8d7240ab9c47:~# make root@8d7240ab9c47:~# make install","title":"4.5.2 \u5b89\u88c5tcl \u5305"},{"location":"linux/server/redis/redis-sentinel/#453-redis","text":"root@8d7240ab9c47:~# tar xvfz redis-3.0.2.tar.gz root@8d7240ab9c47:~# cd redis-3.0.2 root@8d7240ab9c47:~# make root@8d7240ab9c47:~# cd src root@8d7240ab9c47:~# make install root@8d7240ab9c47:~# make PREFIX=/usr/local/redis install root@8d7240ab9c47:~# useradd -s /sbin/nologin redis root@8d7240ab9c47:~# mkdir /usr/local/redis/var root@8d7240ab9c47:~# chmod 777 /usr/local/redis/var/ root@8d7240ab9c47:~# mkdir -p /usr/local/redis/etc #\u653e\u7f6e\u914d\u7f6e\u6587\u4ef6\u5730\u65b9 \u6ce8\u610f \u6211\u53ea\u5217\u51fa\u5b89\u88c5\u4e86\u5176\u4e2d\u4e00\u4e2a docker\u91cc\u9762\u7684redis , tcl \uff0c\u6b64\u65f6\u5148\u505a\u4e3a\u4e3b\uff0c\u5176\u4ed6\u4e24\u4ece redis docker\u5b89\u88c5\u4e00\u6837 \u3002","title":"4.5.3 \u5b89\u88c5redis"},{"location":"linux/server/redis/redis-sentinel/#46","text":"","title":"4.6 \u914d\u7f6e\u4e3b\u4ece"},{"location":"linux/server/redis/redis-sentinel/#461","text":"Master redis.conf\u914d\u7f6e\u6587\u4ef6\u4fee\u6539 root@8d7240ab9c47:~# cat /usr/local/redis/etc/redis.conf daemonize yes # \u540e\u53f0\u8fd0\u884c pidfile \"/usr/local/redis/var/redis.pid\" # \u8fd0\u884cpid\u6587\u4ef6 port 6379 # \u7aef\u53e3 timeout 300 # \u8d85\u65f6 loglevel debug # debug\u6a21\u5f0f logfile \"/usr/local/redis/var/redis.log\" # \u65e5\u5fd7\u6587\u4ef6 databases 16 save 900 1 save 300 10 save 60 10000 rdbcompression yes dbfilename \"dump.rdb\" dir \"/usr/local/redis/var\" appendonly no appendfsync always bind 0.0.0.0 # \u65b9\u5f0fip\u9650\u5236 Slave1 redis.conf\u914d\u7f6e\u6587\u4ef6\u4fee\u6539 root@38b072848ccd:/# cat /usr/local/redis/etc/redis.conf daemonize yes pidfile \"/usr/local/redis/var/redis.pid\" port 6379 timeout 300 loglevel debug logfile \"/usr/local/redis/var/redis.log\" databases 16 save 900 1 save 300 10 save 60 10000 rdbcompression yes dbfilename \"dump.rdb\" dir \"/usr/local/redis/var\" appendonly no appendfsync always bind 0.0.0.0 slaveof 172.17.0.2 6379 # master ip Slave2 redis.conf\u914d\u7f6e\u6587\u4ef6\u4fee\u6539 root@56c0344c59a0:/# cat /usr/local/redis/etc/redis.conf daemonize yes pidfile \"/usr/local/redis/var/redis.pid\" port 6379 timeout 300 loglevel debug logfile \"/usr/local/redis/var/redis.log\" databases 16 save 900 1 save 300 10 save 60 10000 rdbcompression yes dbfilename \"dump.rdb\" dir \"/usr/local/redis/var\" appendonly no appendfsync always bind 0.0.0.0 slaveof 172.17.0.2 6379 \u7279\u522b\u6ce8\u610f \u4e00\u5b9a\u8981\u4fee\u8fd9\u4e2a\u4e3a 0.0 . 0.0 \u5426\u5219\u5bbf\u4e3b\u673a\u8fde\u63a5\u4e0d\u5230 docker\u5bb9\u5668\u91cc\u9762\u7684redis \u542f\u52a8\u811a\u672c [root@linux-node2 init.d]# cat /etc/init.d/redis #!/bin/sh # # Simple Redis init.d script conceived to work on Linux systems # as it does use of the /proc filesystem. # chkconfig: 2345 90 10 # description: Redis is a persistent key-value database # REDISPORT=6379 EXEC=/usr/local/bin/redis-server CLIEXEC=/usr/local/bin/redis-cli PIDFILE=/var/run/redis_${REDISPORT}.pid #CONF=\"/etc/redis/${REDISPORT}.conf\" CONF=\"/usr/local/redis/etc/redis.conf\" case \"$1\" in start) if [ -f $PIDFILE ] then echo \"$PIDFILE exists, process is already running or crashed\" else echo \"Starting Redis server...\" $EXEC $CONF echo $(ps aux|grep redis|grep -v grep|grep 6379|awk '{print $2}')>$PIDFILE fi ;; stop) if [ ! -f $PIDFILE ] then echo \"$PIDFILE does not exist, process is not running\" else PID=$(cat $PIDFILE) echo \"Stopping ...\" $CLIEXEC -p $REDISPORT shutdown while [ -x /proc/${PID} ] do echo \"Waiting for Redis to shutdown ...\" sleep 1 done echo \"Redis stopped\" cd /var/run/ && rm -f redis_${REDISPORT}.pid fi ;; *) echo \"Please use start or stop as first argument\" ;; esac [root@linux-node2 init.d]# chmod +x /etc/init.d/redis","title":"4.6.1 \u4e3b\u4ece\u914d\u7f6e"},{"location":"linux/server/redis/redis-sentinel/#47","text":"","title":"4.7 \u542f\u52a8"},{"location":"linux/server/redis/redis-sentinel/#471","text":"#root@8d7240ab9c47:~# redis-server /usr/local/redis/etc/redis.conf root@8d7240ab9c47:~# /etc/init.d/redis start Starting Redis server...","title":"4.7.1 \u542f\u52a8"},{"location":"linux/server/redis/redis-sentinel/#472","text":"#root@8d7240ab9c47:~# redis-cli shutdown root@8d7240ab9c47:~# /etc/init.d/redis stop \u6ce8\u610f \u5176\u4ed6\u4e24\u4e2a\u4ece redis\u542f\u52a8\u65b9\u5f0f\u4e00\u6837 \u3002","title":"4.7.2 \u505c\u6b62"},{"location":"linux/server/redis/redis-sentinel/#48","text":"\u4fdd\u8bc1\u4e09\u53f0redis\u90fd\u542f\u52a8\u540e\uff0c\u67e5\u770b 127.0.0.1:6379> info \u3002\u3002\u3002\u3002\u3002\u3002 # Replication role:master connected_slaves:2 slave0:ip=172.17.0.6,port=6379,state=online,offset=10912,lag=0 slave1:ip=172.17.0.4,port=6379,state=online,offset=10912,lag=0 \u3002\u3002\u3002\u3002\u3002\u3002 \u6bcf\u4e2aredis\u90fd\u4f1a\u6709\u8be5info\uff0c\u53ef\u770b\u51fa\u5176\u4e2d\u6bcf\u4e2aredis\u7684\u8eab\u4efdrole\u3002\u5176\u4e2dmaster\u53ef\u4ee5\u770b\u51fa\u5b83\u7684\u4e24\u4e2aslave\u60c5\u51b5\u3002","title":"4.8 \u6d4b\u8bd5\u4e3b\u4ece"},{"location":"linux/server/redis/redis-sentinel/#481","text":"127.0.0.1:6379> set realcloud 1234 OK 127.0.0.1:6379> get realcloud \"1234\"","title":"4.8.1 \u4e3b\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9"},{"location":"linux/server/redis/redis-sentinel/#482-redis-slave1","text":"127.0.0.1:6379> get realcloud \"1234\"","title":"4.8.2 Redis slave1\u67e5\u770b"},{"location":"linux/server/redis/redis-sentinel/#482-redis-slave2","text":"127.0.0.1:6379> get realcloud \"1234\" \u4ece\u4e0a\u53ef\u4ee5\u770b\u51faredis\u4e00\u4e3b\u4e24\u4ece\uff0c\u5b89\u88c5\uff0c\u6d4b\u8bd5OK\u3002","title":"4.8.2 Redis slave2\u67e5\u770b"},{"location":"linux/server/redis/redis-sentinel/#48-sentinel","text":"\u4e09\u53f0\u673a\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u4e00\u6837\u3002","title":"4.8 \u914d\u7f6esentinel"},{"location":"linux/server/redis/redis-sentinel/#481-sentinel","text":"root@8d7240ab9c47:~# cat /usr/local/redis/etc/sentinel.conf port 26379 dir /usr/local/redis/var_sentinel sentinel monitor mymaster 172.17.0.2 6379 2 #\u8be5IP\u662fredis\u4e3b\u7684IP\u3002\u6839\u636e\u60c5\u51b5\u6539\u5199\u3002 sentinel down-after-milliseconds mymaster 10000 sentinel parallel-syncs mymaster 1 sentinel failover-timeout mymaster 60000 #sentinel client-reconfig-script mymaster /script/failover.sh","title":"4.8.1 \u914d\u7f6esentinel"},{"location":"linux/server/redis/redis-sentinel/#482-sentinel","text":"root@8d7240ab9c47:~#mkdir /usr/local/redis/var_sentinel root@8d7240ab9c47:~# redis-sentinel /usr/local/redis/etc/sentinel.conf >/usr/local/redis/var_sentinel/sentinel.log &","title":"4.8.2 \u542f\u52a8 sentinel"},{"location":"linux/server/redis/redis-sentinel/#483","text":"\u5728\u4e3bredis\u4e0a\u8fdb\u5165sentinel\u3002 root@8d7240ab9c47:~# redis-cli -p 26379 127.0.0.1:26379> sentinel master mymaster 1) \"name\" 2) \"mymaster\" 3) \"ip\" 4) \"172.17.0.2\" 5) \"port\" 6) \"6379\" 7) \"runid\" 8) \"eb05e2906f6e3f916fbca5f3f3e421560f2bbf21\" 9) \"flags\" 10) \"master\" 11) \"pending-commands\" 12) \"0\" 13) \"last-ping-sent\" 14) \"0\" 15) \"last-ok-ping-reply\" 16) \"451\" 17) \"last-ping-reply\" 18) \"451\" 19) \"down-after-milliseconds\" 20) \"10000\" 21) \"info-refresh\" 22) \"3492\" 23) \"role-reported\" 24) \"master\" 25) \"role-reported-time\" 26) \"5854962\" 27) \"config-epoch\" 28) \"0\" 29) \"num-slaves\" 30) \"2\" 31) \"num-other-sentinels\" 32) \"2\" 33) \"quorum\" 34) \"2\" 35) \"failover-timeout\" 36) \"60000\" 37) \"parallel-syncs\" 38) \"1\" 127.0.0.1:26379> \u6ce8\u610f redis\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f6379 redis - sentinel \u9ed8\u8ba4\u7aef\u53e3\u662f 26379","title":"4.8.3 \u67e5\u770b"},{"location":"linux/server/redis/redis-sentinel/#49","text":"","title":"4.9 \u6545\u969c\u6a21\u62df"},{"location":"linux/server/redis/redis-sentinel/#491-master","text":"root@8d7240ab9c47:~# redis-cli shutdown #\u4e3b\u5b95\u673a","title":"4.9.1 master\u5b95\u673a"},{"location":"linux/server/redis/redis-sentinel/#492-redis","text":"root@38b072848ccd:~# redis-cli info #\u6b64\u65f6\u4e3amaster root@56c0344c59a0:~# redis-cli info","title":"4.9.2 \u67e5\u770bredis\u4e3b\u4ece\u60c5\u51b5"},{"location":"linux/server/redis/redis-sentinel/#493-sentinel","text":"root@38b072848ccd:~# redis-cli -p 26379 127.0.0.1:26379> sentinel master mymaster 1) \"name\" 2) \"mymaster\" 3) \"ip\" 4) \"172.17.0.4\" 5) \"port\" 6) \"6379\" \u6b64\u65f6\u5728kill\u5f53\u524d\u7684master\u3002Sentinel\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u53c8\u4f17\u7b79\u51fa\u5f53\u524d\u65b0\u7684master\u3002\u5f53\u4e4b\u524d\u7684master \u53c8\u542f\u52a8\u597d\u4ee5\u540esentinel\u53c8\u4e3b\u52a8\u5c06\u4e4b\u524d\u7684master\u6dfb\u52a0\u5230\u65b0\u7684master\u4e2d\uff0c\u4f5c\u4e3aslave\u3002\u76ee\u524d\u4e3a\u6b62redis\u7684sentinel\u6d4b\u8bd5OK\u3002","title":"4.9.3 \u67e5\u770bsentinel\u60c5\u51b5"},{"location":"linux/server/sersync/sersync/","text":"Sersync\u6570\u636e\u540c\u6b65 \u00b6 \u4e00.rsync\u4ecb\u7ecd \u00b6 rsync\u662f\u7c7bunix\u7cfb\u7edf\u4e0b\u7684\u6570\u636e\u955c\u50cf\u5907\u4efd\u5de5\u5177\u2014\u2014remote sync\u3002\u4e00\u6b3e\u5feb\u901f\u589e\u91cf\u5907\u4efd\u5de5\u5177 Remote Sync\uff0c\u8fdc\u7a0b\u540c\u6b65\u652f\u6301\u672c\u5730\u590d\u5236\uff0c\u6216\u8005\u4e0e\u5176\u4ed6SSH\u3001rsync\u4e3b\u673a\u540c\u6b65\u3002 \u5b83\u7684\u7279\u6027\u5982\u4e0b\uff1a - \u53ef\u4ee5\u955c\u50cf\u4fdd\u5b58\u6574\u4e2a\u76ee\u5f55\u6811\u548c\u6587\u4ef6\u7cfb\u7edf\u3002 - \u53ef\u4ee5\u5f88\u5bb9\u6613\u505a\u5230\u4fdd\u6301\u539f\u6765\u6587\u4ef6\u7684\u6743\u9650\u3001\u65f6\u95f4\u3001\u8f6f\u786c\u94fe\u63a5\u7b49\u7b49\u3002 - \u65e0\u987b\u7279\u6b8a\u6743\u9650\u5373\u53ef\u5b89\u88c5\u3002 - \u5feb\u901f\uff1a\u7b2c\u4e00\u6b21\u540c\u6b65\u65f6 rsync \u4f1a\u590d\u5236\u5168\u90e8\u5185\u5bb9\uff0c\u4f46\u5728\u4e0b\u4e00\u6b21\u53ea\u4f20\u8f93\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u3002rsync \u5728\u4f20\u8f93\u6570\u636e\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u5b9e\u884c\u538b\u7f29\u53ca\u89e3\u538b\u7f29\u64cd\u4f5c\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u66f4\u5c11\u7684\u5e26\u5bbd\u3002 - \u5b89\u5168\uff1a\u53ef\u4ee5\u4f7f\u7528scp\u3001ssh\u7b49\u65b9\u5f0f\u6765\u4f20\u8f93\u6587\u4ef6\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u7684socket\u8fde\u63a5\u3002 - \u652f\u6301\u533f\u540d\u4f20\u8f93\uff0c\u4ee5\u65b9\u4fbf\u8fdb\u884c\u7f51\u7ad9\u955c\u8c61\u3002 IP \u89d2\u8272 \u5b89\u88c5\u8f6f\u4ef6 \u76ee\u5f55 \u76ee\u7684 192.168.91.166 Rsync \u670d\u52a1\u7aef rsync /data \u5c06192.168.91.156 rsync \u5ba2\u6237\u7aef\u4e0a\u7684/data\u4e0b\u76ee\u5f55\u5b9e\u65f6\u63a8\u9001\u5230192.168.91.166 rsync\u670d\u52a1\u5668\u7aef/data\u4e0b 192.168.91.156 Rsync \u5ba2\u6237\u7aef serync /data \u4e8c.rsync\u7684\u5b89\u88c5 \u00b6 yum install -y rsync \u4e09.rsync\u901a\u8fc7ssh\u8ba4\u8bc1\u4f20\u8f93 \u00b6 3.1\u5c06\u6570\u636e\u53d1\u9001\u5230\u8fdc\u7aef \u00b6 rsync -avz -P \u672c\u5730\u76ee\u5f55 -e 'ssh -p \u7aef\u53e3\u53f7' \u8fdc\u7aef\u7528\u6237\u540d@\u8fdc\u7aefIP:\u8fdc\u7aef\u8def\u5f84 root@template /tmp 16:33:07 # cat rsync.txt \u6211\u662frsync\u6d4b\u8bd5 root@template /tmp 16:34:02 # rsync -avzP /tmp/rsync.txt -e 'ssh -p 22' root@192.168.44.100:/tmp The authenticity of host '192.168.44.100(192.168.44.100)' can't be established. RSA key fingerprint is57:22:33:d6:43:40:31:84:88:19:5d:f5:fc:7d:4e:ce. Are you sure you want to continue connecting(yes/no)? yes Warning: Permanently added '192.168.44.100' (RSA) tothe list of known hosts. reverse mapping checking getaddrinfo for bogon[192.168.44.100] failed - POSSIBLE BREAK-IN ATTEMPT! root@192.168.44.100's password: sending incremental file list rsync.txt 18100% 0.00kB/s 0:00:00 (xfer#1, to-check=0/1) sent 93 bytes received 31 bytes 13.05 bytes/sec total size is 18 speedup is 0.15 \u8be6\u7ec6\u53c2\u6570\uff1a -v, --verbose \u8be6\u7ec6\u6a21\u5f0f\u8f93\u51fa -q, --quiet \u7cbe\u7b80\u8f93\u51fa\u6a21\u5f0f -c, --checksum \u6253\u5f00\u6821\u9a8c\u5f00\u5173\uff0c\u5f3a\u5236\u5bf9\u6587\u4ef6\u4f20\u8f93\u8fdb\u884c\u6821\u9a8c -a, --archive \u5f52\u6863\u6a21\u5f0f\uff0c\u8868\u793a\u4ee5\u9012\u5f52\u65b9\u5f0f\u4f20\u8f93\u6587\u4ef6\uff0c\u5e76\u4fdd\u6301\u6240\u6709\u6587\u4ef6\u5c5e\u6027\uff0c\u7b49\u4e8e-rlptgoD -r, --recursive \u5bf9\u5b50\u76ee\u5f55\u4ee5\u9012\u5f52\u6a21\u5f0f\u5904\u7406 -R, --relative \u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u4fe1\u606f -b, --backup \u521b\u5efa\u5907\u4efd\uff0c\u4e5f\u5c31\u662f\u5bf9\u4e8e\u76ee\u7684\u5df2\u7ecf\u5b58\u5728\u6709\u540c\u6837\u7684\u6587\u4ef6\u540d\u65f6\uff0c\u5c06\u8001\u7684\u6587\u4ef6\u91cd\u65b0\u547d\u540d\u4e3a~filename\u3002\u53ef\u4ee5\u4f7f\u7528--suffix\u9009\u9879\u6765\u6307\u5b9a\u4e0d\u540c\u7684\u5907\u4efd\u6587\u4ef6\u524d\u7f00\u3002 --backup-dir \u5c06\u5907\u4efd\u6587\u4ef6(\u5982~filename)\u5b58\u653e\u5728\u5728\u76ee\u5f55\u4e0b\u3002 -suffix=SUFFIX \u5b9a\u4e49\u5907\u4efd\u6587\u4ef6\u524d\u7f00 -u, --update \u4ec5\u4ec5\u8fdb\u884c\u66f4\u65b0\uff0c\u4e5f\u5c31\u662f\u8df3\u8fc7\u6240\u6709\u5df2\u7ecf\u5b58\u5728\u4e8eDST\uff0c\u5e76\u4e14\u6587\u4ef6\u65f6\u95f4\u665a\u4e8e\u8981\u5907\u4efd\u7684\u6587\u4ef6\u3002(\u4e0d\u8986\u76d6\u66f4\u65b0\u7684\u6587\u4ef6) -l, --links \u4fdd\u7559\u8f6f\u94fe\u7ed3 -L, --copy-links \u60f3\u5bf9\u5f85\u5e38\u89c4\u6587\u4ef6\u4e00\u6837\u5904\u7406\u8f6f\u94fe\u7ed3 --copy-unsafe-links \u4ec5\u4ec5\u62f7\u8d1d\u6307\u5411SRC\u8def\u5f84\u76ee\u5f55\u6811\u4ee5\u5916\u7684\u94fe\u7ed3 --safe-links \u5ffd\u7565\u6307\u5411SRC\u8def\u5f84\u76ee\u5f55\u6811\u4ee5\u5916\u7684\u94fe\u7ed3 -H, --hard-links \u4fdd\u7559\u786c\u94fe\u7ed3 -p, --perms \u4fdd\u6301\u6587\u4ef6\u6743\u9650 -o, --owner \u4fdd\u6301\u6587\u4ef6\u5c5e\u4e3b\u4fe1\u606f -g, --group \u4fdd\u6301\u6587\u4ef6\u5c5e\u7ec4\u4fe1\u606f -D, --devices \u4fdd\u6301\u8bbe\u5907\u6587\u4ef6\u4fe1\u606f -t, --times \u4fdd\u6301\u6587\u4ef6\u65f6\u95f4\u4fe1\u606f -S, --sparse \u5bf9\u7a00\u758f\u6587\u4ef6\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u4ee5\u8282\u7701DST\u7684\u7a7a\u95f4 -n, --dry-run\u73b0\u5b9e\u54ea\u4e9b\u6587\u4ef6\u5c06\u88ab\u4f20\u8f93 -W, --whole-file \u62f7\u8d1d\u6587\u4ef6\uff0c\u4e0d\u8fdb\u884c\u589e\u91cf\u68c0\u6d4b -x, --one-file-system \u4e0d\u8981\u8de8\u8d8a\u6587\u4ef6\u7cfb\u7edf\u8fb9\u754c -B, --block-size=SIZE \u68c0\u9a8c\u7b97\u6cd5\u4f7f\u7528\u7684\u5757\u5c3a\u5bf8\uff0c\u9ed8\u8ba4\u662f700\u5b57\u8282 -e, --rsh=COMMAND \u6307\u5b9a\u4f7f\u7528rsh\u3001ssh\u65b9\u5f0f\u8fdb\u884c\u6570\u636e\u540c\u6b65 --rsync-path=PATH \u6307\u5b9a\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684rsync\u547d\u4ee4\u6240\u5728\u8def\u5f84\u4fe1\u606f -C, --cvs-exclude \u4f7f\u7528\u548cCVS\u4e00\u6837\u7684\u65b9\u6cd5\u81ea\u52a8\u5ffd\u7565\u6587\u4ef6\uff0c\u7528\u6765\u6392\u9664\u90a3\u4e9b\u4e0d\u5e0c\u671b\u4f20\u8f93\u7684\u6587\u4ef6 --existing \u4ec5\u4ec5\u66f4\u65b0\u90a3\u4e9b\u5df2\u7ecf\u5b58\u5728\u4e8eDST\u7684\u6587\u4ef6\uff0c\u800c\u4e0d\u5907\u4efd\u90a3\u4e9b\u65b0\u521b\u5efa\u7684\u6587\u4ef6 --delete \u5220\u9664\u90a3\u4e9bDST\u4e2dSRC\u6ca1\u6709\u7684\u6587\u4ef6 --delete-excluded \u540c\u6837\u5220\u9664\u63a5\u6536\u7aef\u90a3\u4e9b\u88ab\u8be5\u9009\u9879\u6307\u5b9a\u6392\u9664\u7684\u6587\u4ef6 --delete-after \u4f20\u8f93\u7ed3\u675f\u4ee5\u540e\u518d\u5220\u9664 --ignore-errors \u53ca\u65f6\u51fa\u73b0IO\u9519\u8bef\u4e5f\u8fdb\u884c\u5220\u9664 --max-delete=NUM \u6700\u591a\u5220\u9664NUM\u4e2a\u6587\u4ef6 --partial \u4fdd\u7559\u90a3\u4e9b\u56e0\u6545\u6ca1\u6709\u5b8c\u5168\u4f20\u8f93\u7684\u6587\u4ef6\uff0c\u4ee5\u662f\u52a0\u5feb\u968f\u540e\u7684\u518d\u6b21\u4f20\u8f93 --force \u5f3a\u5236\u5220\u9664\u76ee\u5f55\uff0c\u5373\u4f7f\u4e0d\u4e3a\u7a7a --numeric-ids \u4e0d\u5c06\u6570\u5b57\u7684\u7528\u6237\u548c\u7ec4ID\u5339\u914d\u4e3a\u7528\u6237\u540d\u548c\u7ec4\u540d --timeout=TIME IP\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u79d2 -I, --ignore-times \u4e0d\u8df3\u8fc7\u90a3\u4e9b\u6709\u540c\u6837\u7684\u65f6\u95f4\u548c\u957f\u5ea6\u7684\u6587\u4ef6 --size-only \u5f53\u51b3\u5b9a\u662f\u5426\u8981\u5907\u4efd\u6587\u4ef6\u65f6\uff0c\u4ec5\u4ec5\u5bdf\u770b\u6587\u4ef6\u5927\u5c0f\u800c\u4e0d\u8003\u8651\u6587\u4ef6\u65f6\u95f4 --modify-window=NUM \u51b3\u5b9a\u6587\u4ef6\u662f\u5426\u65f6\u95f4\u76f8\u540c\u65f6\u4f7f\u7528\u7684\u65f6\u95f4\u6233\u7a97\u53e3\uff0c\u9ed8\u8ba4\u4e3a0 -T --temp-dir=DIR \u5728DIR\u4e2d\u521b\u5efa\u4e34\u65f6\u6587\u4ef6 --compare-dest=DIR \u540c\u6837\u6bd4\u8f83DIR\u4e2d\u7684\u6587\u4ef6\u6765\u51b3\u5b9a\u662f\u5426\u9700\u8981\u5907\u4efd -P \u7b49\u540c\u4e8e --partial --progress \u663e\u793a\u5907\u4efd\u8fc7\u7a0b -z, --compress \u5bf9\u5907\u4efd\u7684\u6587\u4ef6\u5728\u4f20\u8f93\u65f6\u8fdb\u884c\u538b\u7f29\u5904\u7406 --exclude=PATTERN \u6307\u5b9a\u6392\u9664\u4e0d\u9700\u8981\u4f20\u8f93\u7684\u6587\u4ef6\u6a21\u5f0f --include=PATTERN \u6307\u5b9a\u4e0d\u6392\u9664\u800c\u9700\u8981\u4f20\u8f93\u7684\u6587\u4ef6\u6a21\u5f0f --exclude-from=FILE \u6392\u9664FILE\u4e2d\u6307\u5b9a\u6a21\u5f0f\u7684\u6587\u4ef6 --include-from=FILE \u4e0d\u6392\u9664FILE\u6307\u5b9a\u6a21\u5f0f\u5339\u914d\u7684\u6587\u4ef6 --version \u6253\u5370\u7248\u672c\u4fe1\u606f --address \u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u5730\u5740 --config=FILE \u6307\u5b9a\u5176\u4ed6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u7684rsyncd.conf\u6587\u4ef6 --port=PORT \u6307\u5b9a\u5176\u4ed6\u7684rsync\u670d\u52a1\u7aef\u53e3 --blocking-io \u5bf9\u8fdc\u7a0bshell\u4f7f\u7528\u963b\u585eIO -stats \u7ed9\u51fa\u67d0\u4e9b\u6587\u4ef6\u7684\u4f20\u8f93\u72b6\u6001 --progress \u5728\u4f20\u8f93\u65f6\u73b0\u5b9e\u4f20\u8f93\u8fc7\u7a0b --log-format=formAT \u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u683c\u5f0f --password-file=FILE \u4eceFILE\u4e2d\u5f97\u5230\u5bc6\u7801 --bwlimit=KBPS \u9650\u5236I/O\u5e26\u5bbd\uff0cKBytes per second -h, --help \u663e\u793a\u5e2e\u52a9\u4fe1\u606f 3.2\u4ece\u8fdc\u7aef\u62c9\u53d6\u6570\u636e \u00b6 rsync -avz -P -e 'ssh -p \u7aef\u53e3\u53f7' \u8fdc\u7aef\u7528\u6237\u540d@\u8fdc\u7aefIP:\u8fdc\u7aef\u8def\u5f84 \u672c\u5730\u76ee\u5f55 root@template /tmp 16:34:19 # rsync -avzP -e 'ssh -p 22'root@192.168.44.100:/tmp/rsync.txt /tmp reverse mapping checking getaddrinfo for bogon[192.168.44.100] failed - POSSIBLE BREAK-IN ATTEMPT! root@192.168.44.100's password: receiving incremental file list rsync.txt 19100% 18.55kB/s 0:00:00 (xfer#1, to-check=0/1) sent 36 bytes received 99 bytes 30.00 bytes/sec total size is 19 speedup is 0.14 root@template /tmp 16:39:26 # cat rsync.txt \u6211\u662frsync\u6d4b\u8bd52 \u56db.\u901a\u8fc7rsync\u8ba4\u8bc1\u4f20\u8f93 \u00b6 4.1\u5907\u4efd\u670d\u52a1\u5668\u914d\u7f6e \u00b6 \u4e5f\u5c31\u662f\u670d\u52a1\u5668\u7aef192.168.91.166 4.1.1\u521b\u5efarsync\u540c\u6b65\u7528\u6237 \u00b6 [root@salt-master data]# useradd -M -s /sbin/nologin rsync 4.1.2\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u00b6 \uff08vim /etc/rsyncd.conf\uff09 [root@salt-master data]# cat /etc/rsyncd.conf #config_______________start ##rsyncd.conf start## uid = root #\u6b64\u65f6\u7528\u6237\u53ef\u4ee5\u662f\u522b\u7684\uff0c\u4f46\u662f\u53ea\u8981\u6709\u7ba1\u7406\u670d\u52a1\u7aef\u4e0b/data\u7684\u6743\u9650\u5373\u53ef,\u4e0d\u4e00\u5b9a\u975e\u5f97\u8981\u7528root gid = root use chroot = no #\u5185\u7f51\u8bbe\u7f6e\u4e3ano max connections = 200 #\u6700\u5927\u8fde\u63a5\u6570\u9ed8\u8ba4\u4e3a0\u65e0\u9650\u5927\uff0c\u8d1f\u6570\u4e3a\u5173\u95ed timeout = 300 #\u8d85\u65f6\u9ed8\u8ba4\u4e3a0 notimeout\u65e0\u8d85\u65f6\u65f6\u95f4 \u5efa\u8bae200-600\uff085-10\u5206\u949f\uff09 pid file = /var/run/rsyncd.pid lock file = /var/run/rsync.lock log file = /var/log/rsyncd.log [data] #\u65b0\u5efa\u7684\u6a21\u5757\u540d comment = datafile by caimengzhi at 2016-11-10 #\u6ce8\u91ca\u90e8\u5206 path = /data/ #\u9ed8\u8ba4\u4e0a\u4f20\u548c\u4e0b\u8f7d\u7684\u8def\u5f84 ignore errors #\u5ffd\u7565\u9519\u8bef read only = false #\u7981\u6b62\u53ea\u8bfb\u53ef\u5199 list = false #\u7981\u6b62\u5217\u8868 hosts allow = 192.168.91.0/24 #\u6307\u5b9a\u53ef\u4ee5\u8fde\u63a5\u7684\u5ba2\u6237\u7aefip\u6216\u5730\u5740\u6bb5 hosts deny = 0.0.0.0/32 #\u6307\u5b9a\u4e0d\u53ef\u4ee5\u8fde\u63a5\u7684ip\u6216\u5730\u5740\u6bb5 auth users = rsync_body #\u5ba2\u6237\u7aef\u540c\u6b65\u7684\u865a\u62df\u7528\u6237 secrets file = /etc/rsync.password #\u5ba2\u6237\u7aef\u540c\u6b65\u7684\u865a\u62df\u673a\u7528\u6237\u7684\u5bc6\u7801 \u5feb\u901f cat >>/etc/rsyncd.conf<<EOF #config_______________start ##rsyncd.conf start## uid = root gid = root use chroot = no max connections = 200 timeout = 300 pid file = /var/run/rsyncd.pid lock file = /var/run/rsync.lock log file = /var/log/rsyncd.log [data] comment = datafile by caimengzhi at 2016-11-10 path = /data/ ignore errors read only = false list = false hosts allow = 192.168.91.0/24 hosts deny = 0.0.0.0/32 auth users = rsync_body secrets file = /etc/rsync.password EOF 4.1.3\u6dfb\u52a0\u5bc6\u7801\u6587\u4ef6 \u00b6 [root@salt-master data]# echo 'rsync_body:admin' >> /etc/rsync.password #\u6dfb\u52a0\u8d26\u6237\u548c\u5bc6\u7801\uff0c\u524d\u9762\u662f\u540c\u6b65\u65f6\u5019\u7684\u865a\u62df\u8d26\u53f7\u548c\u5bc6\u7801 [root@salt-master data]# cat /etc/rsync.password rsync_body:admin [root@salt-master data]# chmod 600 /etc/rsync.password 4.1.4\u542f\u52a8\u670d\u52a1 [root@salt-master data]# rsync --daemon #rsync\u670d\u52a1\u7aef\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u65b9\u5f0f\u542f\u52a8\uff0c\u4e14\u7aef\u53e3\u662ftcp\u534f\u8bae\u7684873 [root@salt-master data]# ps -ef | grep rsync |grep -v grep root 7247 1 0 17:21 ? 00:00:00 rsync --daemon [root@salt-master data]# netstat -lnp| grep 873 tcp 0 0 0.0.0.0:873 0.0.0.0:* LISTEN 7247/rsync tcp 0 0 :::873 :::* LISTEN 7247/rsync [root@salt-master data]# lsof -i:873 COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME rsync 7247 root 4u IPv4 67065 0t0 TCP *:rsync (LISTEN) rsync 7247 root 5u IPv6 67066 0t0 TCP *:rsync (LISTEN) 4.2\u6e90\u6570\u636e\u670d\u52a1\u5668\u914d\u7f6e\u4e5f\u5c31\u662f\u5ba2\u6237\u7aef192.168.91.156 \u00b6 4.2.1\u914d\u7f6e\u5bc6\u7801\u6587\u4ef6 \u00b6 [root@salt-client01 sersync]# echo \"admin\">/etc/rsync.password #\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u914d\u7f6e\u5bc6\u7801\u6587\u4ef6\u5373\u53ef\uff0c\u56e0\u4e3a\u5728\u540c\u6b65\u7684\u65f6\u5019\u4f1a\u6307\u5b9a\u865a\u62df\u540c\u6b65\u8d26\u53f7 [root@salt-client01 sersync]# cat /etc/rsync.password admin [root@salt-client01 sersync]# chmod 600 /etc/rsync.password [root@salt-client01 sersync]# ll /etc/rsync.password -rw------- 1 root root 6 Nov 10 17:26 /etc/rsync.password 4.2.2\u5411\u5907\u4efd\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e \u00b6 rsync -avz -P \u672c\u5730\u76ee\u5f55\u6216\u6587\u4ef6 rsync_backup@\u670d\u52a1\u7aef\u5730\u5740::\u6a21\u5757\u540d--password-file=/etc/rsync.pwd [root@salt-client01 sersync]# rsync -avz /data rsync_body@192.168.91.166::data --password-file=/etc/rsync.password sending incremental file list data/ data/3 sent 88 bytes received 31 bytes 238.00 bytes/sec total size is 0 speedup is 0.00 \u8bf4\u660ersync \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u662fOK\u7684 \u00b6 4.2.3\u4ece\u5907\u4efd\u670d\u52a1\u5668\u62c9\u53d6 \u00b6 rsync -avz -P rsync_backup@\u670d\u52a1\u7aef\u5730\u5740::\u6a21\u5757\u540d \u672c\u5730\u76ee\u5f55\u6216\u6587\u4ef6--password-file=/etc/rsync.pwd \u4e94.sersync\u7684\u7b80\u5355\u539f\u7406 \u00b6 \u91c7\u7528inotify\u6765\u5bf9\u6587\u4ef6\u8fdb\u884c\u76d1\u63a7\uff0c\u5f53\u76d1\u63a7\u5230\u6587\u4ef6\u6709\u6587\u4ef6\u53d1\u751f\u6539\u53d8\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u8c03\u7528rsync\u5b9e\u73b0\u89e6\u53d1\u5f0f\u5b9e\u65f6\u540c\u6b65\uff01 5.1\u5b89\u88c5sersync \u00b6 \uff08\u6ce8\u610fsersync\u662f\u5de5\u4f5c\u5728rsync\u7684\u6e90\u670d\u52a1\u5668\u4e0a\uff0c\u4e5f\u5c31\u662f\u5ba2\u6237\u7aef\u4e0a\uff09 [root@salt-client01 ~]# cd /usr/local/src/ [root@salt-client01 src]# tar -zxvf sersync2.5.4_64bit_binary_stable_final.tar.gz -C /usr/local/ GNU-Linux-x86/ GNU-Linux-x86/sersync2 GNU-Linux-x86/confxml.xml [root@salt-client01 src]# cd /usr/local/ [root@salt-client01 local]# mv GNU-Linux-x86 sersync [root@salt-client01 local]# cd sersync/ [root@salt-client01 sersync]# mkdir conf bin log [root@salt-client01sersync]# mv confxml.xml conf [root@salt-client01sersync]# mv sersync2 bin/sersync 5.2\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u00b6 ***********************************30\u884c\u5f00\u59cb****************************** <commonParams params=\"-artuz\"/> #-artuz\u4e3arsync\u540c\u6b65\u65f6\u7684\u53c2\u6570 <authstart=\"true\" users=\"rsync\u7684\u865a\u62df\u7528\u6237\u540d(rsync_backup)\" passwordfile=\"rsync\u7684\u5bc6\u7801\u6587\u4ef6\"/> <userDefinedPort start=\"true\"port=\"873\"/><!-- port=874 --> <timeout start=\"false\" time=\"100\"/><!--timeout=100 --> <sshstart=\"false\"/> ************************************\u7b2c36\u884c*********************************** <failLogpath=\"\u81ea\u5df1\u5b9a\u4e49\u7684log\u6587\u4ef6\u5939(/usr/local/sersync/log)rsync_fail_log.sh\" timeToExecute=\"60\"/><!--defaultevery 60mins execute once--> ******************************************************************************* *\u6ce8\uff1a\u82e5\u6709\u591a\u4e2a\u76ee\u5f55\u5907\u4efd\u53ef\u4ee5\u7a7f\u4ef6\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6\u5728\u542f\u52a8\u65f6\u7684-o\u53c2\u6570\u4e2d\u6dfb\u52a0\u5373\u53ef [root@salt-client01 conf]# diff confxml.xml confxml.xml.bak 24,25c24,25 < <localpath watch=\"/data/\"> #data\u5c31\u662f\u672c\u5730\u9700\u8981\u540c\u6b65\u7684\u6587\u4ef6\u5939\u5230\u670d\u52a1\u5668\u7aef\u7684\u76ee\u5f55 < <remote ip=\"192.168.91.166\" name=\"data\"/> #data (server\u7684\u6a21\u5757\u540d)\u662frsync \u670d\u52a1\u7aef\u7684\u6587\u4ef6\u5939\uff0c\u4e5f\u5c31\u662f\u63a8\u9001\u5230\u670d\u52a1\u5668\u7aef\u7684\u76ee\u6807\u6587\u4ef6\u5939\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\uff0c --- > <localpath watch=\"/opt/tongbu\"> > <remote ip=\"127.0.0.1\" name=\"tongbu1\"/> 31c31 < <auth start=\"true\" users=\"rsync_body\" passwordfile=\"/etc/rsync.password\"/> #true \u624d\u80fd\u751f\u6548\uff0crsync_body\u540c\u6b65\u65f6\u5019\u865a\u62df\u8d26\u53f7\uff0c\u540e\u9762\u662f\u5bc6\u7801\u6587\u4ef6 --- > <auth start=\"false\" users=\"root\" passwordfile=\"/etc/rsync.pas\"/> 33c33 < <timeout start=\"true\" time=\"100\"/><!-- timeout=100 --> #true \u624d\u80fd\u751f\u6548 --- > <timeout start=\"false\" time=\"100\"/><!-- timeout=100 --> 36c36 < <failLog path=\"/usr/local/sersync/log/rsync_fail_log.sh\" timeToExecute=\"60\"/><!--default every 60mins execute once--> #\u68c0\u6d4brsync\u8fdb\u7a0b\u5224\u65ad\uff0c\u6ca1\u6709\u81ea\u52a8\u542f --- > <failLog path=\"/tmp/rsync_fail_log.sh\" timeToExecute=\"60\"/><!--default every 60mins execute once--> 5.3\u542f\u52a8sersync \u00b6 [root@salt-client01 src]# echo 'export PATH=$PATH:/usr/local/sersync/bin'>>/etc/profile #\u58f0\u660e\u73af\u5883\u53d8\u91cf [root@salt-client01 src]# source /etc/profile [root@salt-client01 src]# sersync2 -r -d -o /usr/local/sersync/conf/confxml.xml #\u542f\u52a8 set the system param execute\uff1aecho 50000000 > /proc/sys/fs/inotify/max_user_watches execute\uff1aecho 327679 > /proc/sys/fs/inotify/max_queued_events parse the command param option: -r rsync all the local files to the remote servers before the sersync work option: -d run as a daemon option: -o config xml name\uff1a /usr/local/sersync/conf/confxml.xml daemon thread num: 10 parse xml config file host ip : localhost host port: 8008 daemon start\uff0csersync run behind the console use rsync password-file : user is rsync_body passwordfile is /etc/rsync.password config xml parse success please set /etc/rsyncd.conf max connections=0 Manually sersync working thread 12 = 1(primary thread) + 1(fail retry thread) + 10(daemon sub threads) Max threads numbers is: 22 = 12(Thread pool nums) + 10(Sub threads) please according your cpu \uff0cuse -n param to adjust the cpu rate ------------------------------------------ rsync the directory recursivly to the remote servers once working please wait... execute command: cd /data && rsync -artuz -R --delete ./ --timeout=100 rsync_body@192.168.91.166::data --password-file=/etc/rsync.password >/dev/null 2>&1 run the sersync: watch path is: /data #\u6b64\u65f6\u53ef\u4ee5\u770b\u51fasersync\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u4e86 \u68c0\u6d4b\u811a\u672c [root@salt-client01 log]# pwd /usr/local/sersync/log [root@salt-client01 log]# vim rsync_fail_log.sh [root@salt-client01 log]# chmod +x rsync_fail_log.sh [root@salt-client01 ~]# cat /usr/local/sersync/log/rsync_fail_log.sh #!/bin/bash #Purpose: Check sersync whether it is alive #Author: cai meng zhi SERSYNC=\"/usr/local/sersync/bin/sersync2\" CONF_FILE=\"/usr/local/sersync/conf/confxml.xml\" STATUS=$(ps aux |grep 'sersync2'|grep -v 'grep'|wc -l) if [ $STATUS -eq 0 ]; then $SERSYNC -d -r -o $CONF_FILE & else exit 0; fi \u811a\u672c\u5199\u597d\u4ee5\u540e\uff0c\u6dfb\u52a0\u5230\u8ba1\u5212\u4efb\u52a1\u4e2d\u53bb */1 * * * * /bin/bash /usr/local/sersync/log/rsync_fail_log.sh > /dev/null 2>&1 \u6d4b\u8bd5\u540c\u6b65\uff1a \u5ba2\u6237\u7aef\u65b0\u589e\u6587\u4ef6 [root@salt-client01 data]# cp /etc/passwd 192.168.91.156.passwd [root@salt-client01 data]# ll total 4 -rw-r--r-- 1 root root 1928 Nov 10 18:15 192.168.91.156.passwd -rw-r--r-- 1 root root 0 Nov 10 17:27 3 \u670d\u52a1\u7aef\u68c0\u6d4b [root@salt-master data]# cd /data/ [root@salt-master data]# ll total 8 -rw-r--r-- 1 root root 1928 Nov 10 18:15 192.168.91.156.passwd #\u8bf4\u660e\u5df2\u7ecf\u540c\u6b65\u8fc7\u6765\u4e86 -rw-r--r-- 1 root root 0 Nov 10 17:27 3 drwxr-xr-x 2 root root 4096 Nov 10 17:27 data \u5ba2\u6237\u7aef\u6d4b\u8bd5\u5220\u9664 [root@salt-client01 data]# rm rf 192.168.91.156.passwd rm: cannot remove `rf': No such file or directory rm: remove regular file `192.168.91.156.passwd'? y [root@salt-client01 data]# ll total 0 -rw-r--r-- 1 root root 0 Nov 10 17:27 3 [root@salt-client01 data]# \u670d\u52a1\u5668\u7aef\uff1a [root@salt-master data]# ll total 4 -rw-r--r-- 1 root root 0 Nov 10 17:27 3 #\u8bf4\u660e\u5df2\u7ecf\u5220\u9664\u6389\u4e86 drwxr-xr-x 2 root root 4096 Nov 10 17:27 data 5.4\u5e38\u89c1\u9519\u8bef\u6c47\u603b \u00b6 \u9519\u8bef\u4e00\uff1a @ERROR: auth failed on module xxxxx rsync: connection unexpectedly closed(90 bytes read so far) rsync error: error in rsync protocoldata stream (code 12) at io.c(150) \u8bf4\u660e\uff1a\u8fd9\u662f\u56e0\u4e3a\u5bc6\u7801\u8bbe\u7f6e\u9519\u4e86\uff0c\u65e0\u6cd5\u767b\u5165\u6210\u529f\uff0c\u68c0\u67e5\u4e00\u4e0brsync.pwd\uff0c\u770b\u5ba2\u670d\u662f\u5426\u5339\u914d\u3002\u8fd8\u6709\u670d\u52a1\u5668\u7aef\u6ca1\u542f\u52a8rsync \u670d\u52a1\u4e5f\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002 \u9519\u8bef\u4e8c\uff1a password file must not beother-accessible continuing without password file Password: \u8bf4\u660e\uff1a\u8fd9\u662f\u56e0\u4e3arsyncd.pwdrsyncd.sec\u7684\u6743\u9650\u4e0d\u5bf9\uff0c\u5e94\u8be5\u8bbe\u7f6e\u4e3a600\u3002\u5982\uff1achmod600 rsyncd.pwd \u9519\u8bef\u4e09\uff1a @ERROR: chroot failed rsync: connection unexpectedly closed(75 bytes read so far) rsync error: error in rsync protocoldata stream (code 12) at io.c(150) \u8bf4\u660e\uff1a\u8fd9\u662f\u56e0\u4e3a\u4f60\u5728 rsync.conf\u4e2d\u8bbe\u7f6e\u7684 path \u8def\u5f84\u4e0d\u5b58\u5728\uff0c\u8981\u65b0\u5efa\u76ee\u5f55\u624d\u80fd\u5f00\u542f\u540c\u6b65 \u9519\u8bef\u56db\uff1a rsync: failed to connect to218.107.243.2: No route to host (113) rsync error: error in socket IO (code10) at clientserver.c(104) [receiver=2.6.9] \u8bf4\u660e\uff1a\u9632\u706b\u5899\u95ee\u9898\u5bfc\u81f4\uff0c\u8fd9\u4e2a\u6700\u597d\u5148\u5f7b\u5e95\u5173\u95ed\u9632\u706b\u5899\uff0c\u6392\u9519\u7684\u57fa\u672c\u6cd5\u5c31\u662f\u8fd9\u6837\uff0c\u65e0\u8bba\u662fS\u8fd8\u662fC\uff0c\u8fd8\u6709ignore errors\u9009\u9879\u95ee\u9898\u4e5f\u4f1a\u5bfc\u81f4 \u9519\u8bef\u4e94\uff1a @ERROR: access denied to www fromunknown (192.168.1.123) rsync: connection unexpectedly closed(0 bytes received so far) [receiver] rsync error: error in rsync protocoldata stream (code 12) at io.c(359) \u8bf4\u660e\uff1a\u6b64\u95ee\u9898\u5f88\u660e\u663e\uff0c\u662f\u914d\u7f6e\u9009\u9879hostallow\u7684\u95ee\u9898\uff0c\u521d\u5b66\u8005\u559c\u6b22\u4e00\u4e2a\u5141\u8bb8\u6bb5\u505a\u6210\u4e00\u4e2a\u914d\u7f6e\uff0c\u7136\u540e\u6a21\u5757\u53c8\u662f\u540c\u4e00\u4e2a\uff0c\u81f4\u4f7f\u5bfc\u81f4 \u9519\u8bef\u516d\uff1a rsync error: received SIGINT,SIGTERM, or SIGHUP (code 20) at rsync.c(244) [generator=2.6.9] rsync error: received SIGUSR1 (code19) at main.c(1182) [receiver=2.6.9] \u8bf4\u660e\uff1a\u5bfc\u81f4\u6b64\u95ee\u9898\u591a\u534a\u662f\u670d\u52a1\u7aef\u670d\u52a1\u6ca1\u6709\u88ab\u6b63\u5e38\u542f\u52a8\uff0c\u5230\u670d\u52a1\u5668\u4e0a\u53bb\u67e5\u67e5\u670d\u52a1\u662f\u5426\u6709\u542f\u52a8\uff0c\u7136\u540e\u67e5\u770b\u4e0b /var/run/rsync.pid \u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u6700\u5e72\u8106\u7684\u65b9\u6cd5\u662f\u6740\u6b7b\u5df2\u7ecf\u542f\u52a8\u4e86\u670d\u52a1\uff0c\u7136\u540e\u518d\u6b21\u542f\u52a8\u670d\u52a1\u6216\u8005\u8ba9\u811a\u672c\u52a0\u5165\u7cfb\u7edf\u542f\u52a8\u670d\u52a1\u7ea7\u522b\u7136\u540eshutdown -r now\u670d\u52a1\u5668 \u9519\u8bef\u4e03\uff1a rsync: read error: Connection resetby peer (104) rsync error: error in rsync protocoldata stream (code 12) at io.c(604) [sender=2.6.9] \u8bf4\u660e\uff1a\u539f\u6570\u636e\u76ee\u5f55\u91cc\u6ca1\u6709\u6570\u636e\u5b58\u5728 \u516d.\u8d44\u6599 \u00b6 \u53c2\u8003\u8d44\u6599","title":"1. sersync"},{"location":"linux/server/sersync/sersync/#sersync","text":"","title":"Sersync\u6570\u636e\u540c\u6b65"},{"location":"linux/server/sersync/sersync/#rsync","text":"rsync\u662f\u7c7bunix\u7cfb\u7edf\u4e0b\u7684\u6570\u636e\u955c\u50cf\u5907\u4efd\u5de5\u5177\u2014\u2014remote sync\u3002\u4e00\u6b3e\u5feb\u901f\u589e\u91cf\u5907\u4efd\u5de5\u5177 Remote Sync\uff0c\u8fdc\u7a0b\u540c\u6b65\u652f\u6301\u672c\u5730\u590d\u5236\uff0c\u6216\u8005\u4e0e\u5176\u4ed6SSH\u3001rsync\u4e3b\u673a\u540c\u6b65\u3002 \u5b83\u7684\u7279\u6027\u5982\u4e0b\uff1a - \u53ef\u4ee5\u955c\u50cf\u4fdd\u5b58\u6574\u4e2a\u76ee\u5f55\u6811\u548c\u6587\u4ef6\u7cfb\u7edf\u3002 - \u53ef\u4ee5\u5f88\u5bb9\u6613\u505a\u5230\u4fdd\u6301\u539f\u6765\u6587\u4ef6\u7684\u6743\u9650\u3001\u65f6\u95f4\u3001\u8f6f\u786c\u94fe\u63a5\u7b49\u7b49\u3002 - \u65e0\u987b\u7279\u6b8a\u6743\u9650\u5373\u53ef\u5b89\u88c5\u3002 - \u5feb\u901f\uff1a\u7b2c\u4e00\u6b21\u540c\u6b65\u65f6 rsync \u4f1a\u590d\u5236\u5168\u90e8\u5185\u5bb9\uff0c\u4f46\u5728\u4e0b\u4e00\u6b21\u53ea\u4f20\u8f93\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u3002rsync \u5728\u4f20\u8f93\u6570\u636e\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u5b9e\u884c\u538b\u7f29\u53ca\u89e3\u538b\u7f29\u64cd\u4f5c\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u66f4\u5c11\u7684\u5e26\u5bbd\u3002 - \u5b89\u5168\uff1a\u53ef\u4ee5\u4f7f\u7528scp\u3001ssh\u7b49\u65b9\u5f0f\u6765\u4f20\u8f93\u6587\u4ef6\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u7684socket\u8fde\u63a5\u3002 - \u652f\u6301\u533f\u540d\u4f20\u8f93\uff0c\u4ee5\u65b9\u4fbf\u8fdb\u884c\u7f51\u7ad9\u955c\u8c61\u3002 IP \u89d2\u8272 \u5b89\u88c5\u8f6f\u4ef6 \u76ee\u5f55 \u76ee\u7684 192.168.91.166 Rsync \u670d\u52a1\u7aef rsync /data \u5c06192.168.91.156 rsync \u5ba2\u6237\u7aef\u4e0a\u7684/data\u4e0b\u76ee\u5f55\u5b9e\u65f6\u63a8\u9001\u5230192.168.91.166 rsync\u670d\u52a1\u5668\u7aef/data\u4e0b 192.168.91.156 Rsync \u5ba2\u6237\u7aef serync /data","title":"\u4e00.rsync\u4ecb\u7ecd"},{"location":"linux/server/sersync/sersync/#rsync_1","text":"yum install -y rsync","title":"\u4e8c.rsync\u7684\u5b89\u88c5"},{"location":"linux/server/sersync/sersync/#rsyncssh","text":"","title":"\u4e09.rsync\u901a\u8fc7ssh\u8ba4\u8bc1\u4f20\u8f93"},{"location":"linux/server/sersync/sersync/#31","text":"rsync -avz -P \u672c\u5730\u76ee\u5f55 -e 'ssh -p \u7aef\u53e3\u53f7' \u8fdc\u7aef\u7528\u6237\u540d@\u8fdc\u7aefIP:\u8fdc\u7aef\u8def\u5f84 root@template /tmp 16:33:07 # cat rsync.txt \u6211\u662frsync\u6d4b\u8bd5 root@template /tmp 16:34:02 # rsync -avzP /tmp/rsync.txt -e 'ssh -p 22' root@192.168.44.100:/tmp The authenticity of host '192.168.44.100(192.168.44.100)' can't be established. RSA key fingerprint is57:22:33:d6:43:40:31:84:88:19:5d:f5:fc:7d:4e:ce. Are you sure you want to continue connecting(yes/no)? yes Warning: Permanently added '192.168.44.100' (RSA) tothe list of known hosts. reverse mapping checking getaddrinfo for bogon[192.168.44.100] failed - POSSIBLE BREAK-IN ATTEMPT! root@192.168.44.100's password: sending incremental file list rsync.txt 18100% 0.00kB/s 0:00:00 (xfer#1, to-check=0/1) sent 93 bytes received 31 bytes 13.05 bytes/sec total size is 18 speedup is 0.15 \u8be6\u7ec6\u53c2\u6570\uff1a -v, --verbose \u8be6\u7ec6\u6a21\u5f0f\u8f93\u51fa -q, --quiet \u7cbe\u7b80\u8f93\u51fa\u6a21\u5f0f -c, --checksum \u6253\u5f00\u6821\u9a8c\u5f00\u5173\uff0c\u5f3a\u5236\u5bf9\u6587\u4ef6\u4f20\u8f93\u8fdb\u884c\u6821\u9a8c -a, --archive \u5f52\u6863\u6a21\u5f0f\uff0c\u8868\u793a\u4ee5\u9012\u5f52\u65b9\u5f0f\u4f20\u8f93\u6587\u4ef6\uff0c\u5e76\u4fdd\u6301\u6240\u6709\u6587\u4ef6\u5c5e\u6027\uff0c\u7b49\u4e8e-rlptgoD -r, --recursive \u5bf9\u5b50\u76ee\u5f55\u4ee5\u9012\u5f52\u6a21\u5f0f\u5904\u7406 -R, --relative \u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u4fe1\u606f -b, --backup \u521b\u5efa\u5907\u4efd\uff0c\u4e5f\u5c31\u662f\u5bf9\u4e8e\u76ee\u7684\u5df2\u7ecf\u5b58\u5728\u6709\u540c\u6837\u7684\u6587\u4ef6\u540d\u65f6\uff0c\u5c06\u8001\u7684\u6587\u4ef6\u91cd\u65b0\u547d\u540d\u4e3a~filename\u3002\u53ef\u4ee5\u4f7f\u7528--suffix\u9009\u9879\u6765\u6307\u5b9a\u4e0d\u540c\u7684\u5907\u4efd\u6587\u4ef6\u524d\u7f00\u3002 --backup-dir \u5c06\u5907\u4efd\u6587\u4ef6(\u5982~filename)\u5b58\u653e\u5728\u5728\u76ee\u5f55\u4e0b\u3002 -suffix=SUFFIX \u5b9a\u4e49\u5907\u4efd\u6587\u4ef6\u524d\u7f00 -u, --update \u4ec5\u4ec5\u8fdb\u884c\u66f4\u65b0\uff0c\u4e5f\u5c31\u662f\u8df3\u8fc7\u6240\u6709\u5df2\u7ecf\u5b58\u5728\u4e8eDST\uff0c\u5e76\u4e14\u6587\u4ef6\u65f6\u95f4\u665a\u4e8e\u8981\u5907\u4efd\u7684\u6587\u4ef6\u3002(\u4e0d\u8986\u76d6\u66f4\u65b0\u7684\u6587\u4ef6) -l, --links \u4fdd\u7559\u8f6f\u94fe\u7ed3 -L, --copy-links \u60f3\u5bf9\u5f85\u5e38\u89c4\u6587\u4ef6\u4e00\u6837\u5904\u7406\u8f6f\u94fe\u7ed3 --copy-unsafe-links \u4ec5\u4ec5\u62f7\u8d1d\u6307\u5411SRC\u8def\u5f84\u76ee\u5f55\u6811\u4ee5\u5916\u7684\u94fe\u7ed3 --safe-links \u5ffd\u7565\u6307\u5411SRC\u8def\u5f84\u76ee\u5f55\u6811\u4ee5\u5916\u7684\u94fe\u7ed3 -H, --hard-links \u4fdd\u7559\u786c\u94fe\u7ed3 -p, --perms \u4fdd\u6301\u6587\u4ef6\u6743\u9650 -o, --owner \u4fdd\u6301\u6587\u4ef6\u5c5e\u4e3b\u4fe1\u606f -g, --group \u4fdd\u6301\u6587\u4ef6\u5c5e\u7ec4\u4fe1\u606f -D, --devices \u4fdd\u6301\u8bbe\u5907\u6587\u4ef6\u4fe1\u606f -t, --times \u4fdd\u6301\u6587\u4ef6\u65f6\u95f4\u4fe1\u606f -S, --sparse \u5bf9\u7a00\u758f\u6587\u4ef6\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u4ee5\u8282\u7701DST\u7684\u7a7a\u95f4 -n, --dry-run\u73b0\u5b9e\u54ea\u4e9b\u6587\u4ef6\u5c06\u88ab\u4f20\u8f93 -W, --whole-file \u62f7\u8d1d\u6587\u4ef6\uff0c\u4e0d\u8fdb\u884c\u589e\u91cf\u68c0\u6d4b -x, --one-file-system \u4e0d\u8981\u8de8\u8d8a\u6587\u4ef6\u7cfb\u7edf\u8fb9\u754c -B, --block-size=SIZE \u68c0\u9a8c\u7b97\u6cd5\u4f7f\u7528\u7684\u5757\u5c3a\u5bf8\uff0c\u9ed8\u8ba4\u662f700\u5b57\u8282 -e, --rsh=COMMAND \u6307\u5b9a\u4f7f\u7528rsh\u3001ssh\u65b9\u5f0f\u8fdb\u884c\u6570\u636e\u540c\u6b65 --rsync-path=PATH \u6307\u5b9a\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684rsync\u547d\u4ee4\u6240\u5728\u8def\u5f84\u4fe1\u606f -C, --cvs-exclude \u4f7f\u7528\u548cCVS\u4e00\u6837\u7684\u65b9\u6cd5\u81ea\u52a8\u5ffd\u7565\u6587\u4ef6\uff0c\u7528\u6765\u6392\u9664\u90a3\u4e9b\u4e0d\u5e0c\u671b\u4f20\u8f93\u7684\u6587\u4ef6 --existing \u4ec5\u4ec5\u66f4\u65b0\u90a3\u4e9b\u5df2\u7ecf\u5b58\u5728\u4e8eDST\u7684\u6587\u4ef6\uff0c\u800c\u4e0d\u5907\u4efd\u90a3\u4e9b\u65b0\u521b\u5efa\u7684\u6587\u4ef6 --delete \u5220\u9664\u90a3\u4e9bDST\u4e2dSRC\u6ca1\u6709\u7684\u6587\u4ef6 --delete-excluded \u540c\u6837\u5220\u9664\u63a5\u6536\u7aef\u90a3\u4e9b\u88ab\u8be5\u9009\u9879\u6307\u5b9a\u6392\u9664\u7684\u6587\u4ef6 --delete-after \u4f20\u8f93\u7ed3\u675f\u4ee5\u540e\u518d\u5220\u9664 --ignore-errors \u53ca\u65f6\u51fa\u73b0IO\u9519\u8bef\u4e5f\u8fdb\u884c\u5220\u9664 --max-delete=NUM \u6700\u591a\u5220\u9664NUM\u4e2a\u6587\u4ef6 --partial \u4fdd\u7559\u90a3\u4e9b\u56e0\u6545\u6ca1\u6709\u5b8c\u5168\u4f20\u8f93\u7684\u6587\u4ef6\uff0c\u4ee5\u662f\u52a0\u5feb\u968f\u540e\u7684\u518d\u6b21\u4f20\u8f93 --force \u5f3a\u5236\u5220\u9664\u76ee\u5f55\uff0c\u5373\u4f7f\u4e0d\u4e3a\u7a7a --numeric-ids \u4e0d\u5c06\u6570\u5b57\u7684\u7528\u6237\u548c\u7ec4ID\u5339\u914d\u4e3a\u7528\u6237\u540d\u548c\u7ec4\u540d --timeout=TIME IP\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u79d2 -I, --ignore-times \u4e0d\u8df3\u8fc7\u90a3\u4e9b\u6709\u540c\u6837\u7684\u65f6\u95f4\u548c\u957f\u5ea6\u7684\u6587\u4ef6 --size-only \u5f53\u51b3\u5b9a\u662f\u5426\u8981\u5907\u4efd\u6587\u4ef6\u65f6\uff0c\u4ec5\u4ec5\u5bdf\u770b\u6587\u4ef6\u5927\u5c0f\u800c\u4e0d\u8003\u8651\u6587\u4ef6\u65f6\u95f4 --modify-window=NUM \u51b3\u5b9a\u6587\u4ef6\u662f\u5426\u65f6\u95f4\u76f8\u540c\u65f6\u4f7f\u7528\u7684\u65f6\u95f4\u6233\u7a97\u53e3\uff0c\u9ed8\u8ba4\u4e3a0 -T --temp-dir=DIR \u5728DIR\u4e2d\u521b\u5efa\u4e34\u65f6\u6587\u4ef6 --compare-dest=DIR \u540c\u6837\u6bd4\u8f83DIR\u4e2d\u7684\u6587\u4ef6\u6765\u51b3\u5b9a\u662f\u5426\u9700\u8981\u5907\u4efd -P \u7b49\u540c\u4e8e --partial --progress \u663e\u793a\u5907\u4efd\u8fc7\u7a0b -z, --compress \u5bf9\u5907\u4efd\u7684\u6587\u4ef6\u5728\u4f20\u8f93\u65f6\u8fdb\u884c\u538b\u7f29\u5904\u7406 --exclude=PATTERN \u6307\u5b9a\u6392\u9664\u4e0d\u9700\u8981\u4f20\u8f93\u7684\u6587\u4ef6\u6a21\u5f0f --include=PATTERN \u6307\u5b9a\u4e0d\u6392\u9664\u800c\u9700\u8981\u4f20\u8f93\u7684\u6587\u4ef6\u6a21\u5f0f --exclude-from=FILE \u6392\u9664FILE\u4e2d\u6307\u5b9a\u6a21\u5f0f\u7684\u6587\u4ef6 --include-from=FILE \u4e0d\u6392\u9664FILE\u6307\u5b9a\u6a21\u5f0f\u5339\u914d\u7684\u6587\u4ef6 --version \u6253\u5370\u7248\u672c\u4fe1\u606f --address \u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u5730\u5740 --config=FILE \u6307\u5b9a\u5176\u4ed6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u7684rsyncd.conf\u6587\u4ef6 --port=PORT \u6307\u5b9a\u5176\u4ed6\u7684rsync\u670d\u52a1\u7aef\u53e3 --blocking-io \u5bf9\u8fdc\u7a0bshell\u4f7f\u7528\u963b\u585eIO -stats \u7ed9\u51fa\u67d0\u4e9b\u6587\u4ef6\u7684\u4f20\u8f93\u72b6\u6001 --progress \u5728\u4f20\u8f93\u65f6\u73b0\u5b9e\u4f20\u8f93\u8fc7\u7a0b --log-format=formAT \u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u683c\u5f0f --password-file=FILE \u4eceFILE\u4e2d\u5f97\u5230\u5bc6\u7801 --bwlimit=KBPS \u9650\u5236I/O\u5e26\u5bbd\uff0cKBytes per second -h, --help \u663e\u793a\u5e2e\u52a9\u4fe1\u606f","title":"3.1\u5c06\u6570\u636e\u53d1\u9001\u5230\u8fdc\u7aef"},{"location":"linux/server/sersync/sersync/#32","text":"rsync -avz -P -e 'ssh -p \u7aef\u53e3\u53f7' \u8fdc\u7aef\u7528\u6237\u540d@\u8fdc\u7aefIP:\u8fdc\u7aef\u8def\u5f84 \u672c\u5730\u76ee\u5f55 root@template /tmp 16:34:19 # rsync -avzP -e 'ssh -p 22'root@192.168.44.100:/tmp/rsync.txt /tmp reverse mapping checking getaddrinfo for bogon[192.168.44.100] failed - POSSIBLE BREAK-IN ATTEMPT! root@192.168.44.100's password: receiving incremental file list rsync.txt 19100% 18.55kB/s 0:00:00 (xfer#1, to-check=0/1) sent 36 bytes received 99 bytes 30.00 bytes/sec total size is 19 speedup is 0.14 root@template /tmp 16:39:26 # cat rsync.txt \u6211\u662frsync\u6d4b\u8bd52","title":"3.2\u4ece\u8fdc\u7aef\u62c9\u53d6\u6570\u636e"},{"location":"linux/server/sersync/sersync/#rsync_2","text":"","title":"\u56db.\u901a\u8fc7rsync\u8ba4\u8bc1\u4f20\u8f93"},{"location":"linux/server/sersync/sersync/#41","text":"\u4e5f\u5c31\u662f\u670d\u52a1\u5668\u7aef192.168.91.166","title":"4.1\u5907\u4efd\u670d\u52a1\u5668\u914d\u7f6e"},{"location":"linux/server/sersync/sersync/#411rsync","text":"[root@salt-master data]# useradd -M -s /sbin/nologin rsync","title":"4.1.1\u521b\u5efarsync\u540c\u6b65\u7528\u6237"},{"location":"linux/server/sersync/sersync/#412","text":"\uff08vim /etc/rsyncd.conf\uff09 [root@salt-master data]# cat /etc/rsyncd.conf #config_______________start ##rsyncd.conf start## uid = root #\u6b64\u65f6\u7528\u6237\u53ef\u4ee5\u662f\u522b\u7684\uff0c\u4f46\u662f\u53ea\u8981\u6709\u7ba1\u7406\u670d\u52a1\u7aef\u4e0b/data\u7684\u6743\u9650\u5373\u53ef,\u4e0d\u4e00\u5b9a\u975e\u5f97\u8981\u7528root gid = root use chroot = no #\u5185\u7f51\u8bbe\u7f6e\u4e3ano max connections = 200 #\u6700\u5927\u8fde\u63a5\u6570\u9ed8\u8ba4\u4e3a0\u65e0\u9650\u5927\uff0c\u8d1f\u6570\u4e3a\u5173\u95ed timeout = 300 #\u8d85\u65f6\u9ed8\u8ba4\u4e3a0 notimeout\u65e0\u8d85\u65f6\u65f6\u95f4 \u5efa\u8bae200-600\uff085-10\u5206\u949f\uff09 pid file = /var/run/rsyncd.pid lock file = /var/run/rsync.lock log file = /var/log/rsyncd.log [data] #\u65b0\u5efa\u7684\u6a21\u5757\u540d comment = datafile by caimengzhi at 2016-11-10 #\u6ce8\u91ca\u90e8\u5206 path = /data/ #\u9ed8\u8ba4\u4e0a\u4f20\u548c\u4e0b\u8f7d\u7684\u8def\u5f84 ignore errors #\u5ffd\u7565\u9519\u8bef read only = false #\u7981\u6b62\u53ea\u8bfb\u53ef\u5199 list = false #\u7981\u6b62\u5217\u8868 hosts allow = 192.168.91.0/24 #\u6307\u5b9a\u53ef\u4ee5\u8fde\u63a5\u7684\u5ba2\u6237\u7aefip\u6216\u5730\u5740\u6bb5 hosts deny = 0.0.0.0/32 #\u6307\u5b9a\u4e0d\u53ef\u4ee5\u8fde\u63a5\u7684ip\u6216\u5730\u5740\u6bb5 auth users = rsync_body #\u5ba2\u6237\u7aef\u540c\u6b65\u7684\u865a\u62df\u7528\u6237 secrets file = /etc/rsync.password #\u5ba2\u6237\u7aef\u540c\u6b65\u7684\u865a\u62df\u673a\u7528\u6237\u7684\u5bc6\u7801 \u5feb\u901f cat >>/etc/rsyncd.conf<<EOF #config_______________start ##rsyncd.conf start## uid = root gid = root use chroot = no max connections = 200 timeout = 300 pid file = /var/run/rsyncd.pid lock file = /var/run/rsync.lock log file = /var/log/rsyncd.log [data] comment = datafile by caimengzhi at 2016-11-10 path = /data/ ignore errors read only = false list = false hosts allow = 192.168.91.0/24 hosts deny = 0.0.0.0/32 auth users = rsync_body secrets file = /etc/rsync.password EOF","title":"4.1.2\u4fee\u6539\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/sersync/sersync/#413","text":"[root@salt-master data]# echo 'rsync_body:admin' >> /etc/rsync.password #\u6dfb\u52a0\u8d26\u6237\u548c\u5bc6\u7801\uff0c\u524d\u9762\u662f\u540c\u6b65\u65f6\u5019\u7684\u865a\u62df\u8d26\u53f7\u548c\u5bc6\u7801 [root@salt-master data]# cat /etc/rsync.password rsync_body:admin [root@salt-master data]# chmod 600 /etc/rsync.password 4.1.4\u542f\u52a8\u670d\u52a1 [root@salt-master data]# rsync --daemon #rsync\u670d\u52a1\u7aef\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u65b9\u5f0f\u542f\u52a8\uff0c\u4e14\u7aef\u53e3\u662ftcp\u534f\u8bae\u7684873 [root@salt-master data]# ps -ef | grep rsync |grep -v grep root 7247 1 0 17:21 ? 00:00:00 rsync --daemon [root@salt-master data]# netstat -lnp| grep 873 tcp 0 0 0.0.0.0:873 0.0.0.0:* LISTEN 7247/rsync tcp 0 0 :::873 :::* LISTEN 7247/rsync [root@salt-master data]# lsof -i:873 COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME rsync 7247 root 4u IPv4 67065 0t0 TCP *:rsync (LISTEN) rsync 7247 root 5u IPv6 67066 0t0 TCP *:rsync (LISTEN)","title":"4.1.3\u6dfb\u52a0\u5bc6\u7801\u6587\u4ef6"},{"location":"linux/server/sersync/sersync/#4219216891156","text":"","title":"4.2\u6e90\u6570\u636e\u670d\u52a1\u5668\u914d\u7f6e\u4e5f\u5c31\u662f\u5ba2\u6237\u7aef192.168.91.156"},{"location":"linux/server/sersync/sersync/#421","text":"[root@salt-client01 sersync]# echo \"admin\">/etc/rsync.password #\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u914d\u7f6e\u5bc6\u7801\u6587\u4ef6\u5373\u53ef\uff0c\u56e0\u4e3a\u5728\u540c\u6b65\u7684\u65f6\u5019\u4f1a\u6307\u5b9a\u865a\u62df\u540c\u6b65\u8d26\u53f7 [root@salt-client01 sersync]# cat /etc/rsync.password admin [root@salt-client01 sersync]# chmod 600 /etc/rsync.password [root@salt-client01 sersync]# ll /etc/rsync.password -rw------- 1 root root 6 Nov 10 17:26 /etc/rsync.password","title":"4.2.1\u914d\u7f6e\u5bc6\u7801\u6587\u4ef6"},{"location":"linux/server/sersync/sersync/#422","text":"rsync -avz -P \u672c\u5730\u76ee\u5f55\u6216\u6587\u4ef6 rsync_backup@\u670d\u52a1\u7aef\u5730\u5740::\u6a21\u5757\u540d--password-file=/etc/rsync.pwd [root@salt-client01 sersync]# rsync -avz /data rsync_body@192.168.91.166::data --password-file=/etc/rsync.password sending incremental file list data/ data/3 sent 88 bytes received 31 bytes 238.00 bytes/sec total size is 0 speedup is 0.00","title":"4.2.2\u5411\u5907\u4efd\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e"},{"location":"linux/server/sersync/sersync/#rsync-ok","text":"","title":"\u8bf4\u660ersync \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u662fOK\u7684"},{"location":"linux/server/sersync/sersync/#423","text":"rsync -avz -P rsync_backup@\u670d\u52a1\u7aef\u5730\u5740::\u6a21\u5757\u540d \u672c\u5730\u76ee\u5f55\u6216\u6587\u4ef6--password-file=/etc/rsync.pwd","title":"4.2.3\u4ece\u5907\u4efd\u670d\u52a1\u5668\u62c9\u53d6"},{"location":"linux/server/sersync/sersync/#sersync_1","text":"\u91c7\u7528inotify\u6765\u5bf9\u6587\u4ef6\u8fdb\u884c\u76d1\u63a7\uff0c\u5f53\u76d1\u63a7\u5230\u6587\u4ef6\u6709\u6587\u4ef6\u53d1\u751f\u6539\u53d8\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u8c03\u7528rsync\u5b9e\u73b0\u89e6\u53d1\u5f0f\u5b9e\u65f6\u540c\u6b65\uff01","title":"\u4e94.sersync\u7684\u7b80\u5355\u539f\u7406"},{"location":"linux/server/sersync/sersync/#51sersync","text":"\uff08\u6ce8\u610fsersync\u662f\u5de5\u4f5c\u5728rsync\u7684\u6e90\u670d\u52a1\u5668\u4e0a\uff0c\u4e5f\u5c31\u662f\u5ba2\u6237\u7aef\u4e0a\uff09 [root@salt-client01 ~]# cd /usr/local/src/ [root@salt-client01 src]# tar -zxvf sersync2.5.4_64bit_binary_stable_final.tar.gz -C /usr/local/ GNU-Linux-x86/ GNU-Linux-x86/sersync2 GNU-Linux-x86/confxml.xml [root@salt-client01 src]# cd /usr/local/ [root@salt-client01 local]# mv GNU-Linux-x86 sersync [root@salt-client01 local]# cd sersync/ [root@salt-client01 sersync]# mkdir conf bin log [root@salt-client01sersync]# mv confxml.xml conf [root@salt-client01sersync]# mv sersync2 bin/sersync","title":"5.1\u5b89\u88c5sersync"},{"location":"linux/server/sersync/sersync/#52","text":"***********************************30\u884c\u5f00\u59cb****************************** <commonParams params=\"-artuz\"/> #-artuz\u4e3arsync\u540c\u6b65\u65f6\u7684\u53c2\u6570 <authstart=\"true\" users=\"rsync\u7684\u865a\u62df\u7528\u6237\u540d(rsync_backup)\" passwordfile=\"rsync\u7684\u5bc6\u7801\u6587\u4ef6\"/> <userDefinedPort start=\"true\"port=\"873\"/><!-- port=874 --> <timeout start=\"false\" time=\"100\"/><!--timeout=100 --> <sshstart=\"false\"/> ************************************\u7b2c36\u884c*********************************** <failLogpath=\"\u81ea\u5df1\u5b9a\u4e49\u7684log\u6587\u4ef6\u5939(/usr/local/sersync/log)rsync_fail_log.sh\" timeToExecute=\"60\"/><!--defaultevery 60mins execute once--> ******************************************************************************* *\u6ce8\uff1a\u82e5\u6709\u591a\u4e2a\u76ee\u5f55\u5907\u4efd\u53ef\u4ee5\u7a7f\u4ef6\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6\u5728\u542f\u52a8\u65f6\u7684-o\u53c2\u6570\u4e2d\u6dfb\u52a0\u5373\u53ef [root@salt-client01 conf]# diff confxml.xml confxml.xml.bak 24,25c24,25 < <localpath watch=\"/data/\"> #data\u5c31\u662f\u672c\u5730\u9700\u8981\u540c\u6b65\u7684\u6587\u4ef6\u5939\u5230\u670d\u52a1\u5668\u7aef\u7684\u76ee\u5f55 < <remote ip=\"192.168.91.166\" name=\"data\"/> #data (server\u7684\u6a21\u5757\u540d)\u662frsync \u670d\u52a1\u7aef\u7684\u6587\u4ef6\u5939\uff0c\u4e5f\u5c31\u662f\u63a8\u9001\u5230\u670d\u52a1\u5668\u7aef\u7684\u76ee\u6807\u6587\u4ef6\u5939\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\uff0c --- > <localpath watch=\"/opt/tongbu\"> > <remote ip=\"127.0.0.1\" name=\"tongbu1\"/> 31c31 < <auth start=\"true\" users=\"rsync_body\" passwordfile=\"/etc/rsync.password\"/> #true \u624d\u80fd\u751f\u6548\uff0crsync_body\u540c\u6b65\u65f6\u5019\u865a\u62df\u8d26\u53f7\uff0c\u540e\u9762\u662f\u5bc6\u7801\u6587\u4ef6 --- > <auth start=\"false\" users=\"root\" passwordfile=\"/etc/rsync.pas\"/> 33c33 < <timeout start=\"true\" time=\"100\"/><!-- timeout=100 --> #true \u624d\u80fd\u751f\u6548 --- > <timeout start=\"false\" time=\"100\"/><!-- timeout=100 --> 36c36 < <failLog path=\"/usr/local/sersync/log/rsync_fail_log.sh\" timeToExecute=\"60\"/><!--default every 60mins execute once--> #\u68c0\u6d4brsync\u8fdb\u7a0b\u5224\u65ad\uff0c\u6ca1\u6709\u81ea\u52a8\u542f --- > <failLog path=\"/tmp/rsync_fail_log.sh\" timeToExecute=\"60\"/><!--default every 60mins execute once-->","title":"5.2\u4fee\u6539\u914d\u7f6e\u6587\u4ef6"},{"location":"linux/server/sersync/sersync/#53sersync","text":"[root@salt-client01 src]# echo 'export PATH=$PATH:/usr/local/sersync/bin'>>/etc/profile #\u58f0\u660e\u73af\u5883\u53d8\u91cf [root@salt-client01 src]# source /etc/profile [root@salt-client01 src]# sersync2 -r -d -o /usr/local/sersync/conf/confxml.xml #\u542f\u52a8 set the system param execute\uff1aecho 50000000 > /proc/sys/fs/inotify/max_user_watches execute\uff1aecho 327679 > /proc/sys/fs/inotify/max_queued_events parse the command param option: -r rsync all the local files to the remote servers before the sersync work option: -d run as a daemon option: -o config xml name\uff1a /usr/local/sersync/conf/confxml.xml daemon thread num: 10 parse xml config file host ip : localhost host port: 8008 daemon start\uff0csersync run behind the console use rsync password-file : user is rsync_body passwordfile is /etc/rsync.password config xml parse success please set /etc/rsyncd.conf max connections=0 Manually sersync working thread 12 = 1(primary thread) + 1(fail retry thread) + 10(daemon sub threads) Max threads numbers is: 22 = 12(Thread pool nums) + 10(Sub threads) please according your cpu \uff0cuse -n param to adjust the cpu rate ------------------------------------------ rsync the directory recursivly to the remote servers once working please wait... execute command: cd /data && rsync -artuz -R --delete ./ --timeout=100 rsync_body@192.168.91.166::data --password-file=/etc/rsync.password >/dev/null 2>&1 run the sersync: watch path is: /data #\u6b64\u65f6\u53ef\u4ee5\u770b\u51fasersync\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u4e86 \u68c0\u6d4b\u811a\u672c [root@salt-client01 log]# pwd /usr/local/sersync/log [root@salt-client01 log]# vim rsync_fail_log.sh [root@salt-client01 log]# chmod +x rsync_fail_log.sh [root@salt-client01 ~]# cat /usr/local/sersync/log/rsync_fail_log.sh #!/bin/bash #Purpose: Check sersync whether it is alive #Author: cai meng zhi SERSYNC=\"/usr/local/sersync/bin/sersync2\" CONF_FILE=\"/usr/local/sersync/conf/confxml.xml\" STATUS=$(ps aux |grep 'sersync2'|grep -v 'grep'|wc -l) if [ $STATUS -eq 0 ]; then $SERSYNC -d -r -o $CONF_FILE & else exit 0; fi \u811a\u672c\u5199\u597d\u4ee5\u540e\uff0c\u6dfb\u52a0\u5230\u8ba1\u5212\u4efb\u52a1\u4e2d\u53bb */1 * * * * /bin/bash /usr/local/sersync/log/rsync_fail_log.sh > /dev/null 2>&1 \u6d4b\u8bd5\u540c\u6b65\uff1a \u5ba2\u6237\u7aef\u65b0\u589e\u6587\u4ef6 [root@salt-client01 data]# cp /etc/passwd 192.168.91.156.passwd [root@salt-client01 data]# ll total 4 -rw-r--r-- 1 root root 1928 Nov 10 18:15 192.168.91.156.passwd -rw-r--r-- 1 root root 0 Nov 10 17:27 3 \u670d\u52a1\u7aef\u68c0\u6d4b [root@salt-master data]# cd /data/ [root@salt-master data]# ll total 8 -rw-r--r-- 1 root root 1928 Nov 10 18:15 192.168.91.156.passwd #\u8bf4\u660e\u5df2\u7ecf\u540c\u6b65\u8fc7\u6765\u4e86 -rw-r--r-- 1 root root 0 Nov 10 17:27 3 drwxr-xr-x 2 root root 4096 Nov 10 17:27 data \u5ba2\u6237\u7aef\u6d4b\u8bd5\u5220\u9664 [root@salt-client01 data]# rm rf 192.168.91.156.passwd rm: cannot remove `rf': No such file or directory rm: remove regular file `192.168.91.156.passwd'? y [root@salt-client01 data]# ll total 0 -rw-r--r-- 1 root root 0 Nov 10 17:27 3 [root@salt-client01 data]# \u670d\u52a1\u5668\u7aef\uff1a [root@salt-master data]# ll total 4 -rw-r--r-- 1 root root 0 Nov 10 17:27 3 #\u8bf4\u660e\u5df2\u7ecf\u5220\u9664\u6389\u4e86 drwxr-xr-x 2 root root 4096 Nov 10 17:27 data","title":"5.3\u542f\u52a8sersync"},{"location":"linux/server/sersync/sersync/#54","text":"\u9519\u8bef\u4e00\uff1a @ERROR: auth failed on module xxxxx rsync: connection unexpectedly closed(90 bytes read so far) rsync error: error in rsync protocoldata stream (code 12) at io.c(150) \u8bf4\u660e\uff1a\u8fd9\u662f\u56e0\u4e3a\u5bc6\u7801\u8bbe\u7f6e\u9519\u4e86\uff0c\u65e0\u6cd5\u767b\u5165\u6210\u529f\uff0c\u68c0\u67e5\u4e00\u4e0brsync.pwd\uff0c\u770b\u5ba2\u670d\u662f\u5426\u5339\u914d\u3002\u8fd8\u6709\u670d\u52a1\u5668\u7aef\u6ca1\u542f\u52a8rsync \u670d\u52a1\u4e5f\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002 \u9519\u8bef\u4e8c\uff1a password file must not beother-accessible continuing without password file Password: \u8bf4\u660e\uff1a\u8fd9\u662f\u56e0\u4e3arsyncd.pwdrsyncd.sec\u7684\u6743\u9650\u4e0d\u5bf9\uff0c\u5e94\u8be5\u8bbe\u7f6e\u4e3a600\u3002\u5982\uff1achmod600 rsyncd.pwd \u9519\u8bef\u4e09\uff1a @ERROR: chroot failed rsync: connection unexpectedly closed(75 bytes read so far) rsync error: error in rsync protocoldata stream (code 12) at io.c(150) \u8bf4\u660e\uff1a\u8fd9\u662f\u56e0\u4e3a\u4f60\u5728 rsync.conf\u4e2d\u8bbe\u7f6e\u7684 path \u8def\u5f84\u4e0d\u5b58\u5728\uff0c\u8981\u65b0\u5efa\u76ee\u5f55\u624d\u80fd\u5f00\u542f\u540c\u6b65 \u9519\u8bef\u56db\uff1a rsync: failed to connect to218.107.243.2: No route to host (113) rsync error: error in socket IO (code10) at clientserver.c(104) [receiver=2.6.9] \u8bf4\u660e\uff1a\u9632\u706b\u5899\u95ee\u9898\u5bfc\u81f4\uff0c\u8fd9\u4e2a\u6700\u597d\u5148\u5f7b\u5e95\u5173\u95ed\u9632\u706b\u5899\uff0c\u6392\u9519\u7684\u57fa\u672c\u6cd5\u5c31\u662f\u8fd9\u6837\uff0c\u65e0\u8bba\u662fS\u8fd8\u662fC\uff0c\u8fd8\u6709ignore errors\u9009\u9879\u95ee\u9898\u4e5f\u4f1a\u5bfc\u81f4 \u9519\u8bef\u4e94\uff1a @ERROR: access denied to www fromunknown (192.168.1.123) rsync: connection unexpectedly closed(0 bytes received so far) [receiver] rsync error: error in rsync protocoldata stream (code 12) at io.c(359) \u8bf4\u660e\uff1a\u6b64\u95ee\u9898\u5f88\u660e\u663e\uff0c\u662f\u914d\u7f6e\u9009\u9879hostallow\u7684\u95ee\u9898\uff0c\u521d\u5b66\u8005\u559c\u6b22\u4e00\u4e2a\u5141\u8bb8\u6bb5\u505a\u6210\u4e00\u4e2a\u914d\u7f6e\uff0c\u7136\u540e\u6a21\u5757\u53c8\u662f\u540c\u4e00\u4e2a\uff0c\u81f4\u4f7f\u5bfc\u81f4 \u9519\u8bef\u516d\uff1a rsync error: received SIGINT,SIGTERM, or SIGHUP (code 20) at rsync.c(244) [generator=2.6.9] rsync error: received SIGUSR1 (code19) at main.c(1182) [receiver=2.6.9] \u8bf4\u660e\uff1a\u5bfc\u81f4\u6b64\u95ee\u9898\u591a\u534a\u662f\u670d\u52a1\u7aef\u670d\u52a1\u6ca1\u6709\u88ab\u6b63\u5e38\u542f\u52a8\uff0c\u5230\u670d\u52a1\u5668\u4e0a\u53bb\u67e5\u67e5\u670d\u52a1\u662f\u5426\u6709\u542f\u52a8\uff0c\u7136\u540e\u67e5\u770b\u4e0b /var/run/rsync.pid \u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u6700\u5e72\u8106\u7684\u65b9\u6cd5\u662f\u6740\u6b7b\u5df2\u7ecf\u542f\u52a8\u4e86\u670d\u52a1\uff0c\u7136\u540e\u518d\u6b21\u542f\u52a8\u670d\u52a1\u6216\u8005\u8ba9\u811a\u672c\u52a0\u5165\u7cfb\u7edf\u542f\u52a8\u670d\u52a1\u7ea7\u522b\u7136\u540eshutdown -r now\u670d\u52a1\u5668 \u9519\u8bef\u4e03\uff1a rsync: read error: Connection resetby peer (104) rsync error: error in rsync protocoldata stream (code 12) at io.c(604) [sender=2.6.9] \u8bf4\u660e\uff1a\u539f\u6570\u636e\u76ee\u5f55\u91cc\u6ca1\u6709\u6570\u636e\u5b58\u5728","title":"5.4\u5e38\u89c1\u9519\u8bef\u6c47\u603b"},{"location":"linux/server/sersync/sersync/#_1","text":"\u53c2\u8003\u8d44\u6599","title":"\u516d.\u8d44\u6599"},{"location":"python/lib/LRU/LRU.index/","text":"1. \u4ecb\u7ecd \u00b6 \u5185\u5b58\u7ba1\u7406\u7684\u4e00\u79cd\u9875\u9762\u7f6e\u6362\u7b97\u6cd5\uff0c\u5bf9\u4e8e\u5728\u5185\u5b58\u4e2d\u4f46\u53c8\u4e0d\u7528\u7684\u6570\u636e\u5757\uff08\u5185\u5b58\u5757\uff09\u53eb\u505aLRU\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u6839\u636e\u54ea\u4e9b\u6570\u636e\u5c5e\u4e8eLRU\u800c\u5c06\u5176\u79fb\u51fa\u5185\u5b58\u800c\u817e\u51fa\u7a7a\u95f4\u6765\u52a0\u8f7d\u53e6\u5916\u7684\u6570\u636e\u3002 \u4ec0\u4e48\u662fLRU\u7b97\u6cd5\uff1f LRU\u662fLeast Recently Used\u7684\u7f29\u5199\uff0c\u5373\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff0c\u5e38\u7528\u4e8e\u9875\u9762\u7f6e\u6362\u7b97\u6cd5\uff0c\u662f\u4e3a\u865a\u62df\u9875\u5f0f\u5b58\u50a8\u7ba1\u7406\u670d\u52a1\u7684\u3002 1.1 \u539f\u7406 \u00b6 \u7b97\u6cd5\u6839\u636e\u6570\u636e\u7684\u5386\u53f2\u8bbf\u95ee\u8bb0\u5f55\u6765\u8fdb\u884c\u6dd8\u6c70\u6570\u636e\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u201c\u5982\u679c\u6570\u636e\u6700\u8fd1\u88ab\u8bbf\u95ee\u8fc7\uff0c\u90a3\u4e48\u5c06\u6765\u88ab\u8bbf\u95ee\u7684\u51e0\u7387\u4e5f\u66f4\u9ad8\u201d\u3002 1.2 \u5b9e\u73b0 \u00b6 \u6700\u5e38\u89c1\u7684\u5b9e\u73b0\u662f\u4f7f\u7528\u4e00\u4e2a\u94fe\u8868\u4fdd\u5b58\u7f13\u5b58\u6570\u636e\uff0c\u8be6\u7ec6\u7b97\u6cd5\u5b9e\u73b0\u5982\u4e0b\uff1a 1. \u65b0\u6570\u636e\u63d2\u5165\u5230\u94fe\u8868\u5934\u90e8\uff1b \u6bcf\u5f53\u7f13\u5b58\u547d\u4e2d\uff08\u5373\u7f13\u5b58\u6570\u636e\u88ab\u8bbf\u95ee\uff09\uff0c\u5219\u5c06\u6570\u636e\u79fb\u5230\u94fe\u8868\u5934\u90e8\uff1b \u5f53\u94fe\u8868\u6ee1\u7684\u65f6\u5019\uff0c\u5c06\u94fe\u8868\u5c3e\u90e8\u7684\u6570\u636e\u4e22\u5f03\u3002 1.3 \u5206\u6790 \u00b6 1.3.1 \u547d\u4e2d\u7387 \u00b6 \u5f53\u5b58\u5728\u70ed\u70b9\u6570\u636e\u65f6\uff0cLRU\u7684\u6548\u7387\u5f88\u597d\uff0c\u4f46\u5076\u53d1\u6027\u7684\u3001\u5468\u671f\u6027\u7684\u6279\u91cf\u64cd\u4f5c\u4f1a\u5bfc\u81f4LRU\u547d\u4e2d\u7387\u6025\u5267\u4e0b\u964d\uff0c\u7f13\u5b58\u6c61\u67d3\u60c5\u51b5\u6bd4\u8f83\u4e25\u91cd\u3002 1.3.2 \u590d\u6742\u5ea6 \u00b6 \u5b9e\u73b0\u7b80\u5355\u3002 1.3.3 \u5f00\u9500 \u00b6 \u547d\u4e2d\u65f6\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u627e\u5230\u547d\u4e2d\u7684\u6570\u636e\u5757\u7d22\u5f15\uff0c\u7136\u540e\u9700\u8981\u5c06\u6570\u636e\u79fb\u5230\u5934\u90e8\u3002 2. \u8be6\u7ec6\u89e3\u91ca\u8fc7\u7a0b \u00b6 2.1 \u54c8\u5e0c\u8868 \u00b6 \u4ec0\u4e48\u662f\u54c8\u5e0c\u94fe\u8868\u5462\uff1f \u6211\u4eec\u90fd\u77e5\u9053\uff0c\u54c8\u5e0c\u8868\u662f\u7531\u82e5\u5e72\u4e2aKey-Value\u6240\u7ec4\u6210\u3002\u5728\u201c\u903b\u8f91\u201d\u4e0a\uff0c\u8fd9\u4e9bKey-Value\u662f\u65e0\u6240\u8c13\u6392\u5217\u987a\u5e8f\u7684\uff0c\u8c01\u5148\u8c01\u540e\u90fd\u4e00\u6837\u3002 \u5728\u54c8\u5e0c\u94fe\u8868\u5f53\u4e2d\uff0c\u8fd9\u4e9bKey-Value\u4e0d\u518d\u662f\u5f7c\u6b64\u65e0\u5173\u7684\u5b58\u5728\uff0c\u800c\u662f\u88ab\u4e00\u4e2a\u94fe\u6761\u4e32\u4e86\u8d77\u6765\u3002\u6bcf\u4e00\u4e2aKey-Value\u90fd\u5177\u6709\u5b83\u7684\u524d\u9a71Key-Value\u3001\u540e\u7ee7Key-Value\uff0c\u5c31\u50cf\u53cc\u5411\u94fe\u8868\u4e2d\u7684\u8282\u70b9\u4e00\u6837\u3002 \u8fd9\u6837\u4e00\u6765\uff0c\u539f\u672c\u65e0\u5e8f\u7684\u54c8\u5e0c\u8868\u62e5\u6709\u4e86\u56fa\u5b9a\u7684\u6392\u5217\u987a\u5e8f\u3002 2.2 \u89e3\u91caLRU\u8fc7\u7a0b \u00b6 \u8ba9\u6211\u4eec\u4ee5\u7528\u6237\u4fe1\u606f\u7684\u9700\u6c42\u4e3a\u4f8b\uff0c\u6765\u6f14\u793a\u4e00\u4e0bLRU\u7b97\u6cd5\u7684\u57fa\u672c\u601d\u8def\uff1a 1.\u5047\u8bbe\u6211\u4eec\u4f7f\u7528\u54c8\u5e0c\u94fe\u8868\u6765\u7f13\u5b58\u7528\u6237\u4fe1\u606f\uff0c\u76ee\u524d\u7f13\u5b58\u4e864\u4e2a\u7528\u6237\uff0c\u8fd94\u4e2a\u7528\u6237\u662f\u6309\u7167\u65f6\u95f4\u987a\u5e8f\u4f9d\u6b21\u4ece\u94fe\u8868\u53f3\u7aef\u63d2\u5165\u7684\u3002 2.\u6b64\u65f6\uff0c\u4e1a\u52a1\u65b9\u8bbf\u95ee\u7528\u62375\uff0c\u7531\u4e8e\u54c8\u5e0c\u94fe\u8868\u4e2d\u6ca1\u6709\u7528\u62375\u7684\u6570\u636e\uff0c\u6211\u4eec\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u51fa\u6765\uff0c\u63d2\u5165\u5230\u7f13\u5b58\u5f53\u4e2d\u3002\u8fd9\u65f6\u5019\uff0c\u94fe\u8868\u4e2d\u6700\u53f3\u7aef\u662f\u6700\u65b0\u8bbf\u95ee\u5230\u7684\u7528\u62375\uff0c\u6700\u5de6\u7aef\u662f\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u7528\u62371\u3002 3.\u63a5\u4e0b\u6765\uff0c\u4e1a\u52a1\u65b9\u8bbf\u95ee\u7528\u62372\uff0c\u54c8\u5e0c\u94fe\u8868\u4e2d\u5b58\u5728\u7528\u62372\u7684\u6570\u636e\uff0c\u6211\u4eec\u600e\u4e48\u505a\u5462\uff1f\u6211\u4eec\u628a\u7528\u62372\u4ece\u5b83\u7684\u524d\u9a71\u8282\u70b9\u548c\u540e\u7ee7\u8282\u70b9\u4e4b\u95f4\u79fb\u9664\uff0c\u91cd\u65b0\u63d2\u5165\u5230\u94fe\u8868\u6700\u53f3\u7aef\u3002\u8fd9\u65f6\u5019\uff0c\u94fe\u8868\u4e2d\u6700\u53f3\u7aef\u53d8\u6210\u4e86\u6700\u65b0\u8bbf\u95ee\u5230\u7684\u7528\u62372\uff0c\u6700\u5de6\u7aef\u4ecd\u7136\u662f\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u7528\u62371\u3002 4.\u63a5\u4e0b\u6765\uff0c\u4e1a\u52a1\u65b9\u8bf7\u6c42\u4fee\u6539\u7528\u62374\u7684\u4fe1\u606f\u3002\u540c\u6837\u9053\u7406\uff0c\u6211\u4eec\u628a\u7528\u62374\u4ece\u539f\u6765\u7684\u4f4d\u7f6e\u79fb\u52a8\u5230\u94fe\u8868\u6700\u53f3\u4fa7\uff0c\u5e76\u628a\u7528\u6237\u4fe1\u606f\u7684\u503c\u66f4\u65b0\u3002\u8fd9\u65f6\u5019\uff0c\u94fe\u8868\u4e2d\u6700\u53f3\u7aef\u662f\u6700\u65b0\u8bbf\u95ee\u5230\u7684\u7528\u62374\uff0c\u6700\u5de6\u7aef\u4ecd\u7136\u662f\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u7528\u62371\u3002 5.\u540e\u6765\u4e1a\u52a1\u65b9\u6362\u53e3\u5473\u4e86\uff0c\u8bbf\u95ee\u7528\u62376\uff0c\u7528\u62376\u5728\u7f13\u5b58\u91cc\u6ca1\u6709\uff0c\u9700\u8981\u63d2\u5165\u5230\u54c8\u5e0c\u94fe\u8868\u3002\u5047\u8bbe\u8fd9\u65f6\u5019\u7f13\u5b58\u5bb9\u91cf\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\uff0c\u5fc5\u987b\u5148\u5220\u9664\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u90a3\u4e48\u4f4d\u4e8e\u54c8\u5e0c\u94fe\u8868\u6700\u5de6\u7aef\u7684\u7528\u62371\u5c31\u4f1a\u88ab\u5220\u9664\u6389\uff0c\u7136\u540e\u518d\u628a\u7528\u62376\u63d2\u5165\u5230\u6700\u53f3\u7aef\u3002 \u4ee5\u4e0a\uff0c\u5c31\u662fLRU\u7b97\u6cd5\u7684\u57fa\u672c\u601d\u8def\u3002 3. python code \u00b6 class LRUcache: def __init__(self, size=3): self.cache = {} self.keys = [] self.size = size def get(self, key): if key in self.cache: self.keys.remove(key) self.keys.insert(0, key) return self.cache[key] else: return None def set(self, key, value): if key in self.cache: self.keys.remove(key) self.keys.insert(0, key) self.cache[key] = value elif len(self.keys) == self.size: old = self.keys.pop() self.cache.pop(old) self.keys.insert(0, key) self.cache[key] = value else: self.keys.insert(0, key) self.cache[key] = value if __name__ == '__main__': LRUcache = LRUcache() LRUcache.set('key_name','summer') LRUcache.set('key_age',30) LRUcache.set('key_job','IT') LRUcache.set('key_salary',20000) LRUcache.set('key_hobby','apple') LRUcache.set('key_love','keke') LRUcache.set('key_name','cmz') print(\"key_name = \",LRUcache.get('key_name')) print(\"key_age = \",LRUcache.get('key_age')) print(\"key_job = \",LRUcache.get('key_job')) print(\"key_salary = \",LRUcache.get('key_salary')) print(\"key_hobby = \",LRUcache.get('key_hobby')) print(\"key_love = \",LRUcache.get('key_love')) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/lru# python lru_demo.py key_name = cmz key_age = None key_job = None key_salary = None key_hobby = apple key_love = keke","title":"1. LRU"},{"location":"python/lib/LRU/LRU.index/#1","text":"\u5185\u5b58\u7ba1\u7406\u7684\u4e00\u79cd\u9875\u9762\u7f6e\u6362\u7b97\u6cd5\uff0c\u5bf9\u4e8e\u5728\u5185\u5b58\u4e2d\u4f46\u53c8\u4e0d\u7528\u7684\u6570\u636e\u5757\uff08\u5185\u5b58\u5757\uff09\u53eb\u505aLRU\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u6839\u636e\u54ea\u4e9b\u6570\u636e\u5c5e\u4e8eLRU\u800c\u5c06\u5176\u79fb\u51fa\u5185\u5b58\u800c\u817e\u51fa\u7a7a\u95f4\u6765\u52a0\u8f7d\u53e6\u5916\u7684\u6570\u636e\u3002 \u4ec0\u4e48\u662fLRU\u7b97\u6cd5\uff1f LRU\u662fLeast Recently Used\u7684\u7f29\u5199\uff0c\u5373\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff0c\u5e38\u7528\u4e8e\u9875\u9762\u7f6e\u6362\u7b97\u6cd5\uff0c\u662f\u4e3a\u865a\u62df\u9875\u5f0f\u5b58\u50a8\u7ba1\u7406\u670d\u52a1\u7684\u3002","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/LRU/LRU.index/#11","text":"\u7b97\u6cd5\u6839\u636e\u6570\u636e\u7684\u5386\u53f2\u8bbf\u95ee\u8bb0\u5f55\u6765\u8fdb\u884c\u6dd8\u6c70\u6570\u636e\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u201c\u5982\u679c\u6570\u636e\u6700\u8fd1\u88ab\u8bbf\u95ee\u8fc7\uff0c\u90a3\u4e48\u5c06\u6765\u88ab\u8bbf\u95ee\u7684\u51e0\u7387\u4e5f\u66f4\u9ad8\u201d\u3002","title":"1.1 \u539f\u7406"},{"location":"python/lib/LRU/LRU.index/#12","text":"\u6700\u5e38\u89c1\u7684\u5b9e\u73b0\u662f\u4f7f\u7528\u4e00\u4e2a\u94fe\u8868\u4fdd\u5b58\u7f13\u5b58\u6570\u636e\uff0c\u8be6\u7ec6\u7b97\u6cd5\u5b9e\u73b0\u5982\u4e0b\uff1a 1. \u65b0\u6570\u636e\u63d2\u5165\u5230\u94fe\u8868\u5934\u90e8\uff1b \u6bcf\u5f53\u7f13\u5b58\u547d\u4e2d\uff08\u5373\u7f13\u5b58\u6570\u636e\u88ab\u8bbf\u95ee\uff09\uff0c\u5219\u5c06\u6570\u636e\u79fb\u5230\u94fe\u8868\u5934\u90e8\uff1b \u5f53\u94fe\u8868\u6ee1\u7684\u65f6\u5019\uff0c\u5c06\u94fe\u8868\u5c3e\u90e8\u7684\u6570\u636e\u4e22\u5f03\u3002","title":"1.2 \u5b9e\u73b0"},{"location":"python/lib/LRU/LRU.index/#13","text":"","title":"1.3 \u5206\u6790"},{"location":"python/lib/LRU/LRU.index/#131","text":"\u5f53\u5b58\u5728\u70ed\u70b9\u6570\u636e\u65f6\uff0cLRU\u7684\u6548\u7387\u5f88\u597d\uff0c\u4f46\u5076\u53d1\u6027\u7684\u3001\u5468\u671f\u6027\u7684\u6279\u91cf\u64cd\u4f5c\u4f1a\u5bfc\u81f4LRU\u547d\u4e2d\u7387\u6025\u5267\u4e0b\u964d\uff0c\u7f13\u5b58\u6c61\u67d3\u60c5\u51b5\u6bd4\u8f83\u4e25\u91cd\u3002","title":"1.3.1 \u547d\u4e2d\u7387"},{"location":"python/lib/LRU/LRU.index/#132","text":"\u5b9e\u73b0\u7b80\u5355\u3002","title":"1.3.2 \u590d\u6742\u5ea6"},{"location":"python/lib/LRU/LRU.index/#133","text":"\u547d\u4e2d\u65f6\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u627e\u5230\u547d\u4e2d\u7684\u6570\u636e\u5757\u7d22\u5f15\uff0c\u7136\u540e\u9700\u8981\u5c06\u6570\u636e\u79fb\u5230\u5934\u90e8\u3002","title":"1.3.3 \u5f00\u9500"},{"location":"python/lib/LRU/LRU.index/#2","text":"","title":"2. \u8be6\u7ec6\u89e3\u91ca\u8fc7\u7a0b"},{"location":"python/lib/LRU/LRU.index/#21","text":"\u4ec0\u4e48\u662f\u54c8\u5e0c\u94fe\u8868\u5462\uff1f \u6211\u4eec\u90fd\u77e5\u9053\uff0c\u54c8\u5e0c\u8868\u662f\u7531\u82e5\u5e72\u4e2aKey-Value\u6240\u7ec4\u6210\u3002\u5728\u201c\u903b\u8f91\u201d\u4e0a\uff0c\u8fd9\u4e9bKey-Value\u662f\u65e0\u6240\u8c13\u6392\u5217\u987a\u5e8f\u7684\uff0c\u8c01\u5148\u8c01\u540e\u90fd\u4e00\u6837\u3002 \u5728\u54c8\u5e0c\u94fe\u8868\u5f53\u4e2d\uff0c\u8fd9\u4e9bKey-Value\u4e0d\u518d\u662f\u5f7c\u6b64\u65e0\u5173\u7684\u5b58\u5728\uff0c\u800c\u662f\u88ab\u4e00\u4e2a\u94fe\u6761\u4e32\u4e86\u8d77\u6765\u3002\u6bcf\u4e00\u4e2aKey-Value\u90fd\u5177\u6709\u5b83\u7684\u524d\u9a71Key-Value\u3001\u540e\u7ee7Key-Value\uff0c\u5c31\u50cf\u53cc\u5411\u94fe\u8868\u4e2d\u7684\u8282\u70b9\u4e00\u6837\u3002 \u8fd9\u6837\u4e00\u6765\uff0c\u539f\u672c\u65e0\u5e8f\u7684\u54c8\u5e0c\u8868\u62e5\u6709\u4e86\u56fa\u5b9a\u7684\u6392\u5217\u987a\u5e8f\u3002","title":"2.1 \u54c8\u5e0c\u8868"},{"location":"python/lib/LRU/LRU.index/#22-lru","text":"\u8ba9\u6211\u4eec\u4ee5\u7528\u6237\u4fe1\u606f\u7684\u9700\u6c42\u4e3a\u4f8b\uff0c\u6765\u6f14\u793a\u4e00\u4e0bLRU\u7b97\u6cd5\u7684\u57fa\u672c\u601d\u8def\uff1a 1.\u5047\u8bbe\u6211\u4eec\u4f7f\u7528\u54c8\u5e0c\u94fe\u8868\u6765\u7f13\u5b58\u7528\u6237\u4fe1\u606f\uff0c\u76ee\u524d\u7f13\u5b58\u4e864\u4e2a\u7528\u6237\uff0c\u8fd94\u4e2a\u7528\u6237\u662f\u6309\u7167\u65f6\u95f4\u987a\u5e8f\u4f9d\u6b21\u4ece\u94fe\u8868\u53f3\u7aef\u63d2\u5165\u7684\u3002 2.\u6b64\u65f6\uff0c\u4e1a\u52a1\u65b9\u8bbf\u95ee\u7528\u62375\uff0c\u7531\u4e8e\u54c8\u5e0c\u94fe\u8868\u4e2d\u6ca1\u6709\u7528\u62375\u7684\u6570\u636e\uff0c\u6211\u4eec\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u51fa\u6765\uff0c\u63d2\u5165\u5230\u7f13\u5b58\u5f53\u4e2d\u3002\u8fd9\u65f6\u5019\uff0c\u94fe\u8868\u4e2d\u6700\u53f3\u7aef\u662f\u6700\u65b0\u8bbf\u95ee\u5230\u7684\u7528\u62375\uff0c\u6700\u5de6\u7aef\u662f\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u7528\u62371\u3002 3.\u63a5\u4e0b\u6765\uff0c\u4e1a\u52a1\u65b9\u8bbf\u95ee\u7528\u62372\uff0c\u54c8\u5e0c\u94fe\u8868\u4e2d\u5b58\u5728\u7528\u62372\u7684\u6570\u636e\uff0c\u6211\u4eec\u600e\u4e48\u505a\u5462\uff1f\u6211\u4eec\u628a\u7528\u62372\u4ece\u5b83\u7684\u524d\u9a71\u8282\u70b9\u548c\u540e\u7ee7\u8282\u70b9\u4e4b\u95f4\u79fb\u9664\uff0c\u91cd\u65b0\u63d2\u5165\u5230\u94fe\u8868\u6700\u53f3\u7aef\u3002\u8fd9\u65f6\u5019\uff0c\u94fe\u8868\u4e2d\u6700\u53f3\u7aef\u53d8\u6210\u4e86\u6700\u65b0\u8bbf\u95ee\u5230\u7684\u7528\u62372\uff0c\u6700\u5de6\u7aef\u4ecd\u7136\u662f\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u7528\u62371\u3002 4.\u63a5\u4e0b\u6765\uff0c\u4e1a\u52a1\u65b9\u8bf7\u6c42\u4fee\u6539\u7528\u62374\u7684\u4fe1\u606f\u3002\u540c\u6837\u9053\u7406\uff0c\u6211\u4eec\u628a\u7528\u62374\u4ece\u539f\u6765\u7684\u4f4d\u7f6e\u79fb\u52a8\u5230\u94fe\u8868\u6700\u53f3\u4fa7\uff0c\u5e76\u628a\u7528\u6237\u4fe1\u606f\u7684\u503c\u66f4\u65b0\u3002\u8fd9\u65f6\u5019\uff0c\u94fe\u8868\u4e2d\u6700\u53f3\u7aef\u662f\u6700\u65b0\u8bbf\u95ee\u5230\u7684\u7528\u62374\uff0c\u6700\u5de6\u7aef\u4ecd\u7136\u662f\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u7528\u62371\u3002 5.\u540e\u6765\u4e1a\u52a1\u65b9\u6362\u53e3\u5473\u4e86\uff0c\u8bbf\u95ee\u7528\u62376\uff0c\u7528\u62376\u5728\u7f13\u5b58\u91cc\u6ca1\u6709\uff0c\u9700\u8981\u63d2\u5165\u5230\u54c8\u5e0c\u94fe\u8868\u3002\u5047\u8bbe\u8fd9\u65f6\u5019\u7f13\u5b58\u5bb9\u91cf\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\uff0c\u5fc5\u987b\u5148\u5220\u9664\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u90a3\u4e48\u4f4d\u4e8e\u54c8\u5e0c\u94fe\u8868\u6700\u5de6\u7aef\u7684\u7528\u62371\u5c31\u4f1a\u88ab\u5220\u9664\u6389\uff0c\u7136\u540e\u518d\u628a\u7528\u62376\u63d2\u5165\u5230\u6700\u53f3\u7aef\u3002 \u4ee5\u4e0a\uff0c\u5c31\u662fLRU\u7b97\u6cd5\u7684\u57fa\u672c\u601d\u8def\u3002","title":"2.2 \u89e3\u91caLRU\u8fc7\u7a0b"},{"location":"python/lib/LRU/LRU.index/#3-python-code","text":"class LRUcache: def __init__(self, size=3): self.cache = {} self.keys = [] self.size = size def get(self, key): if key in self.cache: self.keys.remove(key) self.keys.insert(0, key) return self.cache[key] else: return None def set(self, key, value): if key in self.cache: self.keys.remove(key) self.keys.insert(0, key) self.cache[key] = value elif len(self.keys) == self.size: old = self.keys.pop() self.cache.pop(old) self.keys.insert(0, key) self.cache[key] = value else: self.keys.insert(0, key) self.cache[key] = value if __name__ == '__main__': LRUcache = LRUcache() LRUcache.set('key_name','summer') LRUcache.set('key_age',30) LRUcache.set('key_job','IT') LRUcache.set('key_salary',20000) LRUcache.set('key_hobby','apple') LRUcache.set('key_love','keke') LRUcache.set('key_name','cmz') print(\"key_name = \",LRUcache.get('key_name')) print(\"key_age = \",LRUcache.get('key_age')) print(\"key_job = \",LRUcache.get('key_job')) print(\"key_salary = \",LRUcache.get('key_salary')) print(\"key_hobby = \",LRUcache.get('key_hobby')) print(\"key_love = \",LRUcache.get('key_love')) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/lru# python lru_demo.py key_name = cmz key_age = None key_job = None key_salary = None key_hobby = apple key_love = keke","title":"3. python code"},{"location":"python/lib/SQLAlchemy/1.\u521b\u5efa\u8868/","text":"\u901a\u8fc7sql\u5efa\u8868 from sqlalchemy import create_engine from sqlalchemy.orm import sessionmaker sql = '''create table test1( id int not null primary key, name varchar(50), age int, address varchar(100)); ''' engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=False) conn = engine.connect() conn.execute(sql) engine.connect() # \u8868\u793a\u83b7\u53d6\u5230\u6570\u636e\u5e93\u8fde\u63a5\u3002\u7c7b\u4f3c\u6211\u4eec\u5728MySQLdb\u4e2d\u6e38\u6807course\u7684\u4f5c\u7528\u3002 \u67e5\u770bMySQL mysql> show tables like 'test1'; +-----------------------+ | Tables_in_cmz (test1) | +-----------------------+ | test1 | +-----------------------+ 1 row in set (0.00 sec) mysql> desc test1; +---------+--------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +---------+--------------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | varchar(50) | YES | | NULL | | | age | int(11) | YES | | NULL | | | address | varchar(100) | YES | | NULL | | +---------+--------------+------+-----+---------+-------+ 4 rows in set (0.01 sec) \u901a\u8fc7ORM\u5efa\u8868 from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True) # echo=True\uff0c\u5c31\u662f\u628a\u6574\u4e2a\u8fc7\u7a0b\u6253\u5370\u51fa\u6765 Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b class Test2(Base): __tablename__ = 'test2' # \u8868\u540d id = Column(Integer, primary_key=True) # \u5b57\u6bb5\uff0c\u6574\u5f62\uff0c\u4e3b\u952e column\u662f\u5bfc\u5165\u7684 name = Column(String(32)) password = Column(String(64)) # \u521b\u5efa\u8868\u7ed3\u6784 Base.metadata.create_all(engine) \u67e5\u770bMySQL mysql> show tables like 'test2'; +-----------------------+ | Tables_in_cmz (test2) | +-----------------------+ | test2 | +-----------------------+ 1 row in set (0.00 sec) mysql> desc test2; +----------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +----------+-------------+------+-----+---------+----------------+ | id | int(11) | NO | PRI | NULL | auto_increment | | name | varchar(32) | YES | | NULL | | | password | varchar(64) | YES | | NULL | | +----------+-------------+------+-----+---------+----------------+ 3 rows in set (0.01 sec)","title":"1. \u521b\u5efa\u8868"},{"location":"python/lib/SQLAlchemy/2.\u57fa\u672c\u64cd\u4f5c/","text":"Note \u6ce8\u610f \u4ee5\u4e0b\u4ee3\u7801\u57fa\u4e8ePython3.6 \u4ee5\u524d\u6211\u4eec\u5e38\u7528pymysql\u6765\u64cd\u4f5c\u6570\u636e\u5e93\uff0c\u4e3e\u4e2a\u6817\u5b50 #!/usr/bin/env python # -*- coding:utf-8 -*- # Author: loocha import pymysql #\u521b\u5efa\u8fde\u63a5 conn = pymysql.connect(host='127.0.0.1',port=3306,user='root',passwd='root',db='cmz') #\u521b\u5efa\u6e38\u6807 socket\u4e0a\u5efa\u7acb\u7684\u5b9e\u4f8b cursor=conn.cursor() #\u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u884c\u6570,\u7528\u6e38\u6807\u6267\u884c\uff0c effect_row = cursor.execute(\"select * from user\") # print(cursor.fetchone()) # print(cursor.fetchone()) print(cursor.fetchall()) \u8fd0\u884c\u7ed3\u679c ((1, 'loocha', '123'), (2, 'realcloud', '123')) \u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u6570\u636e\u5168\u90e8\u53d6\u51fa\u6765\u3002 \u63d2\u5165\u6570\u636e\u5462\uff1f # !/usr/bin/env python # -*- coding:utf-8 -*- # Author: loocha import pymysql # \u521b\u5efa\u8fde\u63a5 conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='root', db='cmz') # \u521b\u5efa\u6e38\u6807 socket\u4e0a\u5efa\u7acb\u7684\u5b9e\u4f8b cursor = conn.cursor() # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u884c\u6570,\u7528\u6e38\u6807\u6267\u884c\uff0c # effect_row = cursor.execute(\"select * from user\") # print(cursor.fetchone()) # print(cursor.fetchone()) # print(cursor.fetchall()) data = [ (\"\u5f20\u4e09\", '123'), (\"\u674e\u56db\", '123'), (\"\u738b\u4e94\", '123'), ] cursor.executemany(\"insert into user (name,password) values(%s,%s)\", data) conn.commit() \u6267\u884c\u7ed3\u679c\u540e mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | loocha | 123 | | 2 | realcloud | 123 | | 3 | \u5f20\u4e09 | 123 | | 4 | \u674e\u56db | 123 | | 5 | \u738b\u4e94 | 123 | +----+-----------+----------+ 5 rows in set (0.00 sec) \u6709\u4e2a\u95ee\u9898\uff0c\u4e0a\u9762\u9700\u8981\u6211\u5199\u539f\u751f\u7684SQL\u8bed\u53e5\u6765\u4f7f\u7528\u3002\u5982\u679c\u5199\u539f\u751f\uff0c\u81ea\u5df1\u589e\u5220\u6539\uff0c\u5982\u679c\u7b80\u5355\u8fd8\u884c\uff0c\u590d\u6742\u5c31\u5f88\u9ebb\u70e6\u4e86\uff0c\u91cd\u7528\u6027\u4e0d\u5f3a\uff0c\u56e0\u4e3a\u90fd\u662f\u5199\u6b7b\u5728\u91cc\u9762\uff0c\u5982\u679c\u6570\u636e\u5e93\u7ed3\u679c\u53d8\u5316\u5c31\u7684\u6539\uff0c\u5bf9\u6269\u5c55\u4ec0\u4e48\u90fd\u4e0d\u65b9\u4fbf\uff0c\u5305\u62ec SQL\u6c34\u5e73\u4e5f\u5c31\u4e00\u822c\u822c\uff0c\u5f88\u591a\u60c5\u51b5\u5199\u4e0d\u51fa\u9ad8\u6548\u7684SQL\u8bed\u53e5\uff0c\u6d89\u53ca\u5230\u8f6f\u4ef6\u597d\u6162\u597d\u6162\uff0c\u52a0\u673a\u5668\u90fd\u4e0d\u597d\u4f7f\u3002 \u4e3a\u4e86\u907f\u514d\uff0c\u6211\u4eec\u628a\u539f\u751fSQL\u5199\u6b7b\u5230\u6e90\u4ee3\u7801\u91cc\uff0c\u600e\u4e48\u529e\u5462\uff1f\u5c31\u8981\u5f15\u5165\u4e0b\u9762\u7684\u4e1c\u897f\u3002 SQLAlchemy\u662fpython\u7f16\u7a0b\u8bed\u8a00\u4e0b\u7684\u4e00\u6b3eORM\u6846\u67b6\uff0c\u8be5\u6846\u67b6\u5efa\u7acb\u5728\u6570\u636e\u5e93API\u4e4b\u4e0a\uff0c\u4f7f\u7528\u5173\u7cfb\u5bf9\u8c61\u6620\u5c04\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c\u3002\u7b80\u8a00\u4e4b\u4fbf\u662f\uff1a\u5c06\u5bf9\u8c61\u8f6c\u6362\u6210SQL\uff0c\u7136\u540e\u4f7f\u7528\u6570\u636eAPI\u6267\u884cSQL\u5e76\u83b7\u53d6\u6267\u884c\u7ed3\u679c\u3002 \u8fd9\u6837\uff0c\u5c31\u4e0d\u7528\u5199\u539f\u751f\u7684SQL\u4e86\u3002 \u4ec0\u4e48\u662fORM\uff1f ORM\u5c31\u662f\u5bf9\u8c61\u6620\u5c04\u5173\u7cfb\u7a0b\u5e8f\u3002\u76f8\u5f53\u4e8eORM\u5e2e\u6211\u4eec\u628a\u5bf9\u8c61\u91cc\u7684\u8f6c\u5316\u6210SQL\u7136\u540e\u8ddf\u6570\u636e\u5e93\u4ea4\u4e92 ORM\u7684\u4f18\u70b9\uff1a \u9690\u85cf\u4e86\u6570\u636e\u8bbf\u95ee\u7ec6\u8282\uff0c\u5c01\u95ed\u7684\u901a\u7528\u6570\u636e\u5e93\u4ea4\u4e92\uff0cORM\u7684\u6838\u5fc3\uff0c\u5b83\u4f7f\u5f97\u6211\u4eec\u7684\u901a\u7528\u6570\u636e\u5e93\u4ea4\u4e92\u53d8\u5f97\u7b80\u5355\u6613\u884c\uff0c\u5e76\u4e14\u5b8c\u5168\u4e0d\u7528\u8003\u8651\u8be5\u6b7b\u7684SQL\u8bed\u53e5\u3002\u5feb\u901f\u5f00\u53d1\uff0c\u7531\u6b64\u800c\u6765\u3002 ORM\u4f7f\u6211\u4eec\u6784\u9020\u56fa\u5316\u6570\u636e\u7ed3\u6784\u53d8\u5f97\u7b80\u5355\u6613\u884c\u3002 ORM\u7684\u7f3a\u70b9\uff1a \u65e0\u53ef\u907f\u514d\uff0c\u81ea\u52a8\u5316\u610f\u5473\u7740\u6620\u5c04\u548c\u5173\u8054\u7ba1\u7406\uff0c\u4ee3\u4ef7\u662f\u727a\u7272\u6027\u80fd ORM\u662f\u4e00\u4e2a\u672f\u8bed\uff0c\u4e0d\u662f\u4e00\u4e2a\u8f6f\u4ef6\uff0c\u57fa\u4e8eORM\u7684\u6807\u51c6\u4e0b\uff0c\u6709\u5f88\u591a\u8f6f\u4ef6\uff0c\u6700\u6267\u884c\u7684\u5c31\u662fSQLAlchemy \u5982\u4f55\u4f7f\u7528\uff1f windows/linxu \u4e0b\u5b89\u88c5 pip install sqlalchemy pip install pymysql 1. \u521b\u5efa\u8868 \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:26 @File : \u521b\u5efa\u8868.py @Software: PyCharm \"\"\" from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True) # echo=True\uff0c\u5c31\u662f\u628a\u6574\u4e2a\u8fc7\u7a0b\u6253\u5370\u51fa\u6765 Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) # \u5b57\u6bb5\uff0c\u6574\u5f62\uff0c\u4e3b\u952e column\u662f\u5bfc\u5165\u7684 name = Column(String(32)) password = Column(String(64)) # \u521b\u5efa\u8868\u7ed3\u6784 Base.metadata.create_all(engine) \u8fd0\u884c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-spider/sqlalchemy\u5e93/\u521b\u5efa\u8868.py 2018-12-20 10:27:25,465 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode' 2018-12-20 10:27:25,465 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,466 INFO sqlalchemy.engine.base.Engine SELECT DATABASE() 2018-12-20 10:27:25,466 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,467 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8mb4' and `Collation` = 'utf8mb4_bin' 2018-12-20 10:27:25,467 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,469 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8mb4) COLLATE utf8mb4_bin AS anon_1 2018-12-20 10:27:25,469 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,469 INFO sqlalchemy.engine.base.Engine DESCRIBE `user` 2018-12-20 10:27:25,470 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,474 INFO sqlalchemy.engine.base.Engine ROLLBACK 2018-12-20 10:27:25,474 INFO sqlalchemy.engine.base.Engine CREATE TABLE user ( id INTEGER NOT NULL AUTO_INCREMENT, name VARCHAR(32), password VARCHAR(64), PRIMARY KEY (id) ) 2018-12-20 10:27:25,474 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,492 INFO sqlalchemy.engine.base.Engine COMMIT \u68c0\u67e5\u6570\u636e\u5e93 mysql> show tables like 'user'; +----------------------+ | Tables_in_cmz (user) | +----------------------+ | user | +----------------------+ 1 row in set (0.00 sec) mysql> desc user; +----------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +----------+-------------+------+-----+---------+----------------+ | id | int(11) | NO | PRI | NULL | auto_increment | | name | varchar(32) | YES | | NULL | | | password | varchar(64) | YES | | NULL | | +----------+-------------+------+-----+---------+----------------+ 3 rows in set (0.01 sec) mysql> show create table user; +-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | Table | Create Table | +-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | user | CREATE TABLE `user` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(32) DEFAULT NULL, `password` varchar(64) DEFAULT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 | +-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) \u8868\u5df2\u7ecf\u521b\u5efa\uff0c\u6ce8\u610f\u94fe\u63a5\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u5148\u521b\u5efa\u6570\u636e\u5e93\uff0c\u6307\u5b9a\u94fe\u63a5\u6570\u636e\u5e93\u7684\u5e93\u540d \u5b9e\u73b0\u7ed3\u679c\uff0c\u5c31\u662f\u5728\u6570\u636e\u5e93\u521b\u5efa\u4e86\u4e00\u4e2a\u8868\uff0cuser\uff0c\u518d\u6b21\u6267\u884c\uff0c\u5982\u679c\u6570\u636e\u5e93\u6709\uff0c\u5b83\u5c31\u4e0d\u4f1a\u521b\u5efa\u4e86\u3002 dialect+driver://username:password@host:port/database \u89e3\u91ca dialect\uff0c\u662f\u6570\u636e\u5e93\u7c7b\u578b\uff0c\u5927\u6982\u5305\u62ec\uff1asqlite, mysql, postgresql, oracle, or mssql. driver\uff0c\u662f\u4f7f\u7528\u7684\u6570\u636e\u5e93API\uff0c\u9a71\u52a8\uff0c\u8fde\u63a5\u5305\uff0c\u968f\u4fbf\u53eb\u4ec0\u4e48\u5427\u3002 username\uff0c\u7528\u6237\u540d password\uff0c\u5bc6\u7801 host\uff0c\u7f51\u7edc\u5730\u5740\uff0c\u53ef\u4ee5\u7528ip\uff0c\u57df\u540d\uff0c\u8ba1\u7b97\u673a\u540d\uff0c\u5f53\u7136\u662f\u4f60\u80fd\u8bbf\u95ee\u5230\u7684\u3002 port\uff0c\u6570\u636e\u5e93\u7aef\u53e3\u3002 databas\uff0c\u6570\u636e\u5e93\u540d\u3002 \u5176\u5b9e\u8fd9\u4e9b\u4e5f\u5c31dialect\u548cdirver\u9700\u8981\u89e3\u91ca\u3002 ex\uff1a engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True) 2. \u6570\u636e\u8868\u63d2\u5165\u6570\u636e \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/12/20 10:26 @File : \u521b\u5efa\u8868.py @Software: PyCharm \"\"\" from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True) # echo=True\uff0c\u5c31\u662f\u628a\u6574\u4e2a\u8fc7\u7a0b\u6253\u5370\u51fa\u6765 Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) # \u5b57\u6bb5\uff0c\u6574\u5f62\uff0c\u4e3b\u952e column\u662f\u5bfc\u5165\u7684 name = Column(String(32)) password = Column(String(64)) # \u521b\u5efa\u8868\u7ed3\u6784 # Base.metadata.create_all(engine) ''' \u521b\u5efa\u6570\u636e\uff0c\u6709\u4e2a\u6e38\u6807\u7684\u4e1c\u897f\u53eb\u505asessionmaker\u9700\u8981\u5355\u72ec\u5bfc\u5165 ''' # \u5b9e\u4f8b\u4e0esocket\u7ed1\u5b9a,\u521b\u5efa\u4e0e\u6570\u636e\u5e93\u7684\u7ed8\u753bsession class\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u8fd4\u56de # \u7ed9session\u7684\u662f\u4e00\u4e2aclass\uff0c\u4e0d\u662f\u5b9e\u4f8b Session_class = sessionmaker(bind=engine) # \u751f\u6210session\u5b9e\u4f8b\uff0ccursor Session = Session_class() # \u751f\u4ea7\u4f60\u8981\u521b\u5efa\u7684\u6570\u636e\u5bf9\u8c61 user_obj1 = User(name=\"loocha\", password=\"123\") user_obj2 = User(name=\"realcloud\", password=\"456\") # \u76ee\u524d\u8fd8\u6ca1\u6709\u521b\u5efa\u5bf9\u8c61\uff0c\u53ef\u4ee5\u6253\u5370\u770b\u770b\uff0c\u4e0a\u9762\u53ea\u662f\u7533\u660e print(user_obj1.name, user_obj2.id) # \u628a\u8981\u521b\u5efa\u7684\u6570\u636e\u5bf9\u8c61\u6dfb\u52a0\u5230\u8fd9\u4e2asession\u91cc\uff0c\u4e00\u4f1a\u540c\u4e00\u521b\u5efa Session.add(user_obj1) Session.add(user_obj2) # \u6216\u8005 # session.add_all([user_obj1, user_obj2]) # \u8fd9\u91cc\u4f9d\u65e7\u6ca1\u6709\u521b\u5efa print(user_obj1.name, user_obj2.id) # \u73b0\u5728\u624d\u7edf\u4e00\u63d0\u4ea4\uff0c\u521b\u5efa\u6570\u636e Session.commit() \u68c0\u67e5MySQL mysql> use cmz; Database changed mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | loocha | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec) 3. \u6570\u636e\u8868\u67e5\u8be2\u6570\u636e \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:50 @File : \u67e5\u8be2.py @Software: PyCharm \"\"\" ''' \u5229\u7528ORM\u5b9e\u73b0\u4e00\u4e2a\u67e5\u8868\u7684\u529f\u80fd ''' import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import * # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8') Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) Session_class = sessionmaker(bind=engine) # \u7ed1\u5b9aengine \uff0c\u4f1a\u8fd4\u56de\u7ed9\u4f60\u4e00\u4e2asession\u7c7b\u3002\u6ce8\u610f\u8fd9\u662f\u4e2a\u7c7b session = Session_class() # \u8fd9\u6837\u90fd\u5f97\u5230\u4e86\u6e38\u6807\u4e86 user_obj = session.query(User).filter_by(name='loocha').first() print(user_obj) print(user_obj.name) print(user_obj.password) \u8fd0\u884c\u7ed3\u679c <1 name:loocha> loocha 123 \u6ce8\u610f\uff1a - \u901a\u8fc7.all()\u65b9\u6cd5\u4f1a\u8fd4\u56de\u6240\u6709User\u8868\u91cc\u9762name= 'loocha'\u7684\u5bf9\u8c61\u7ec4\u6210\u4e00\u4e2a\u5217\u8868\uff0c \u300a\u8fd4\u56de\u5217\u8868\u300b - \u7528.first()\u5c31\u53ea\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u4e86\uff0c \u300a\u8fd4\u56de\u5bf9\u8c61\u300b - \u8fd8\u6709\u4e00\u4e2afilter\u65b9\u6cd5\uff0c\u4e0d\u592a\u5efa\u8bae\uff0c\u7528\u6cd5\u4e3a\u53c2\u6570\u8981\u53d8\u4e3asession.query(User).filter(User.name = name)\u53d8\u6210User\u4e2d\u7684name\u5bf9\u8c61\uff0c \u4e00\u822cfilter\u7528\u5728\uff1a\u6a21\u7cca\u67e5\u8be2(\u7edf\u8ba1)\u3001\u591a\u6761\u4ef6\u67e5\u8be2\uff1a session.query(User).filter(User.name.like('li%')).count() \u6a21\u7cca\u67e5\u8be2\uff0c\u5e76\u901a\u8fc7.count()\u7edf\u8ba1 4. \u6570\u636e\u8868\u4fee\u6539\u6570\u636e \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:50 @File : \u67e5\u8be2.py @Software: PyCharm \"\"\" ''' \u5229\u7528ORM\u5b9e\u73b0\u4e00\u4e2a\u521b\u5efa\u8868\u7684\u529f\u80fd ''' import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import * # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8') Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) Session_class = sessionmaker(bind=engine) # \u7ed1\u5b9aengine \uff0c\u4f1a\u8fd4\u56de\u7ed9\u4f60\u4e00\u4e2asession\u7c7b\u3002\u6ce8\u610f\u8fd9\u662f\u4e2a\u7c7b session = Session_class() # \u8fd9\u6837\u90fd\u5f97\u5230\u4e86\u6e38\u6807\u4e86 # \u9996\u5148\u8981\u62ff\u5230\u6570\u636e\uff0c\u7136\u540e\u4fee\u6539 user_obj = session.query(User).filter_by(name='loocha').first() user_obj.name = \"david\" session.commit() \u67e5\u770bMySQL\u6570\u636e # \u4fee\u6539\u4e4b\u524d mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | loocha | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec) # \u4fee\u6539\u4e4b\u540e mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | david | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec) 5. \u6570\u636e\u8868\u5220\u9664\u6570\u636e \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:50 @File : \u5220\u9664.py @Software: PyCharm \"\"\" ''' \u5229\u7528ORM\u5b9e\u73b0\u4e00\u4e2a\u521b\u5efa\u8868\u7684\u529f\u80fd ''' import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker from sqlalchemy.orm import * # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8') Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) Session_class = sessionmaker(bind=engine) # \u7ed1\u5b9aengine \uff0c\u4f1a\u8fd4\u56de\u7ed9\u4f60\u4e00\u4e2asession\u7c7b\u3002\u6ce8\u610f\u8fd9\u662f\u4e2a\u7c7b session = Session_class() # \u8fd9\u6837\u90fd\u5f97\u5230\u4e86\u6e38\u6807\u4e86 user_obj = session.query(User).filter_by(name=\"realcloud\").first() session.delete(user_obj) session.commit() \u67e5\u770bMySQL # \u5220\u9664\u4e4b\u524d mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | david | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec) # \u5220\u9664\u4e4b\u540e mysql> select * from user; +----+-------+----------+ | id | name | password | +----+-------+----------+ | 1 | david | 123 | +----+-------+----------+ 1 row in set (0.00 sec) \u5176\u4ed6\u5220\u9664 - \u5220\u9664 sql \u4e2dlike # \u5220\u9664name\u5b57\u6bb5\u4ee5id\u4e3a\u7ed3\u5c3e\u7684\u6570\u636e user_obj = session.query(User).filter(User.name.like('%id')).first() session.delete(user_obj) session.commit()","title":"2. \u57fa\u672c\u64cd\u4f5c"},{"location":"python/lib/SQLAlchemy/2.\u57fa\u672c\u64cd\u4f5c/#1","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:26 @File : \u521b\u5efa\u8868.py @Software: PyCharm \"\"\" from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True) # echo=True\uff0c\u5c31\u662f\u628a\u6574\u4e2a\u8fc7\u7a0b\u6253\u5370\u51fa\u6765 Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) # \u5b57\u6bb5\uff0c\u6574\u5f62\uff0c\u4e3b\u952e column\u662f\u5bfc\u5165\u7684 name = Column(String(32)) password = Column(String(64)) # \u521b\u5efa\u8868\u7ed3\u6784 Base.metadata.create_all(engine) \u8fd0\u884c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-spider/sqlalchemy\u5e93/\u521b\u5efa\u8868.py 2018-12-20 10:27:25,465 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode' 2018-12-20 10:27:25,465 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,466 INFO sqlalchemy.engine.base.Engine SELECT DATABASE() 2018-12-20 10:27:25,466 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,467 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8mb4' and `Collation` = 'utf8mb4_bin' 2018-12-20 10:27:25,467 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1 2018-12-20 10:27:25,468 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,469 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8mb4) COLLATE utf8mb4_bin AS anon_1 2018-12-20 10:27:25,469 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,469 INFO sqlalchemy.engine.base.Engine DESCRIBE `user` 2018-12-20 10:27:25,470 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,474 INFO sqlalchemy.engine.base.Engine ROLLBACK 2018-12-20 10:27:25,474 INFO sqlalchemy.engine.base.Engine CREATE TABLE user ( id INTEGER NOT NULL AUTO_INCREMENT, name VARCHAR(32), password VARCHAR(64), PRIMARY KEY (id) ) 2018-12-20 10:27:25,474 INFO sqlalchemy.engine.base.Engine {} 2018-12-20 10:27:25,492 INFO sqlalchemy.engine.base.Engine COMMIT \u68c0\u67e5\u6570\u636e\u5e93 mysql> show tables like 'user'; +----------------------+ | Tables_in_cmz (user) | +----------------------+ | user | +----------------------+ 1 row in set (0.00 sec) mysql> desc user; +----------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +----------+-------------+------+-----+---------+----------------+ | id | int(11) | NO | PRI | NULL | auto_increment | | name | varchar(32) | YES | | NULL | | | password | varchar(64) | YES | | NULL | | +----------+-------------+------+-----+---------+----------------+ 3 rows in set (0.01 sec) mysql> show create table user; +-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | Table | Create Table | +-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | user | CREATE TABLE `user` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(32) DEFAULT NULL, `password` varchar(64) DEFAULT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 | +-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) \u8868\u5df2\u7ecf\u521b\u5efa\uff0c\u6ce8\u610f\u94fe\u63a5\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u5148\u521b\u5efa\u6570\u636e\u5e93\uff0c\u6307\u5b9a\u94fe\u63a5\u6570\u636e\u5e93\u7684\u5e93\u540d \u5b9e\u73b0\u7ed3\u679c\uff0c\u5c31\u662f\u5728\u6570\u636e\u5e93\u521b\u5efa\u4e86\u4e00\u4e2a\u8868\uff0cuser\uff0c\u518d\u6b21\u6267\u884c\uff0c\u5982\u679c\u6570\u636e\u5e93\u6709\uff0c\u5b83\u5c31\u4e0d\u4f1a\u521b\u5efa\u4e86\u3002 dialect+driver://username:password@host:port/database \u89e3\u91ca dialect\uff0c\u662f\u6570\u636e\u5e93\u7c7b\u578b\uff0c\u5927\u6982\u5305\u62ec\uff1asqlite, mysql, postgresql, oracle, or mssql. driver\uff0c\u662f\u4f7f\u7528\u7684\u6570\u636e\u5e93API\uff0c\u9a71\u52a8\uff0c\u8fde\u63a5\u5305\uff0c\u968f\u4fbf\u53eb\u4ec0\u4e48\u5427\u3002 username\uff0c\u7528\u6237\u540d password\uff0c\u5bc6\u7801 host\uff0c\u7f51\u7edc\u5730\u5740\uff0c\u53ef\u4ee5\u7528ip\uff0c\u57df\u540d\uff0c\u8ba1\u7b97\u673a\u540d\uff0c\u5f53\u7136\u662f\u4f60\u80fd\u8bbf\u95ee\u5230\u7684\u3002 port\uff0c\u6570\u636e\u5e93\u7aef\u53e3\u3002 databas\uff0c\u6570\u636e\u5e93\u540d\u3002 \u5176\u5b9e\u8fd9\u4e9b\u4e5f\u5c31dialect\u548cdirver\u9700\u8981\u89e3\u91ca\u3002 ex\uff1a engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True)","title":"1. \u521b\u5efa\u8868"},{"location":"python/lib/SQLAlchemy/2.\u57fa\u672c\u64cd\u4f5c/#2","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/12/20 10:26 @File : \u521b\u5efa\u8868.py @Software: PyCharm \"\"\" from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=True) # echo=True\uff0c\u5c31\u662f\u628a\u6574\u4e2a\u8fc7\u7a0b\u6253\u5370\u51fa\u6765 Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) # \u5b57\u6bb5\uff0c\u6574\u5f62\uff0c\u4e3b\u952e column\u662f\u5bfc\u5165\u7684 name = Column(String(32)) password = Column(String(64)) # \u521b\u5efa\u8868\u7ed3\u6784 # Base.metadata.create_all(engine) ''' \u521b\u5efa\u6570\u636e\uff0c\u6709\u4e2a\u6e38\u6807\u7684\u4e1c\u897f\u53eb\u505asessionmaker\u9700\u8981\u5355\u72ec\u5bfc\u5165 ''' # \u5b9e\u4f8b\u4e0esocket\u7ed1\u5b9a,\u521b\u5efa\u4e0e\u6570\u636e\u5e93\u7684\u7ed8\u753bsession class\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u8fd4\u56de # \u7ed9session\u7684\u662f\u4e00\u4e2aclass\uff0c\u4e0d\u662f\u5b9e\u4f8b Session_class = sessionmaker(bind=engine) # \u751f\u6210session\u5b9e\u4f8b\uff0ccursor Session = Session_class() # \u751f\u4ea7\u4f60\u8981\u521b\u5efa\u7684\u6570\u636e\u5bf9\u8c61 user_obj1 = User(name=\"loocha\", password=\"123\") user_obj2 = User(name=\"realcloud\", password=\"456\") # \u76ee\u524d\u8fd8\u6ca1\u6709\u521b\u5efa\u5bf9\u8c61\uff0c\u53ef\u4ee5\u6253\u5370\u770b\u770b\uff0c\u4e0a\u9762\u53ea\u662f\u7533\u660e print(user_obj1.name, user_obj2.id) # \u628a\u8981\u521b\u5efa\u7684\u6570\u636e\u5bf9\u8c61\u6dfb\u52a0\u5230\u8fd9\u4e2asession\u91cc\uff0c\u4e00\u4f1a\u540c\u4e00\u521b\u5efa Session.add(user_obj1) Session.add(user_obj2) # \u6216\u8005 # session.add_all([user_obj1, user_obj2]) # \u8fd9\u91cc\u4f9d\u65e7\u6ca1\u6709\u521b\u5efa print(user_obj1.name, user_obj2.id) # \u73b0\u5728\u624d\u7edf\u4e00\u63d0\u4ea4\uff0c\u521b\u5efa\u6570\u636e Session.commit() \u68c0\u67e5MySQL mysql> use cmz; Database changed mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | loocha | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec)","title":"2. \u6570\u636e\u8868\u63d2\u5165\u6570\u636e"},{"location":"python/lib/SQLAlchemy/2.\u57fa\u672c\u64cd\u4f5c/#3","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:50 @File : \u67e5\u8be2.py @Software: PyCharm \"\"\" ''' \u5229\u7528ORM\u5b9e\u73b0\u4e00\u4e2a\u67e5\u8868\u7684\u529f\u80fd ''' import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import * # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8') Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) Session_class = sessionmaker(bind=engine) # \u7ed1\u5b9aengine \uff0c\u4f1a\u8fd4\u56de\u7ed9\u4f60\u4e00\u4e2asession\u7c7b\u3002\u6ce8\u610f\u8fd9\u662f\u4e2a\u7c7b session = Session_class() # \u8fd9\u6837\u90fd\u5f97\u5230\u4e86\u6e38\u6807\u4e86 user_obj = session.query(User).filter_by(name='loocha').first() print(user_obj) print(user_obj.name) print(user_obj.password) \u8fd0\u884c\u7ed3\u679c <1 name:loocha> loocha 123 \u6ce8\u610f\uff1a - \u901a\u8fc7.all()\u65b9\u6cd5\u4f1a\u8fd4\u56de\u6240\u6709User\u8868\u91cc\u9762name= 'loocha'\u7684\u5bf9\u8c61\u7ec4\u6210\u4e00\u4e2a\u5217\u8868\uff0c \u300a\u8fd4\u56de\u5217\u8868\u300b - \u7528.first()\u5c31\u53ea\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u4e86\uff0c \u300a\u8fd4\u56de\u5bf9\u8c61\u300b - \u8fd8\u6709\u4e00\u4e2afilter\u65b9\u6cd5\uff0c\u4e0d\u592a\u5efa\u8bae\uff0c\u7528\u6cd5\u4e3a\u53c2\u6570\u8981\u53d8\u4e3asession.query(User).filter(User.name = name)\u53d8\u6210User\u4e2d\u7684name\u5bf9\u8c61\uff0c \u4e00\u822cfilter\u7528\u5728\uff1a\u6a21\u7cca\u67e5\u8be2(\u7edf\u8ba1)\u3001\u591a\u6761\u4ef6\u67e5\u8be2\uff1a session.query(User).filter(User.name.like('li%')).count() \u6a21\u7cca\u67e5\u8be2\uff0c\u5e76\u901a\u8fc7.count()\u7edf\u8ba1","title":"3. \u6570\u636e\u8868\u67e5\u8be2\u6570\u636e"},{"location":"python/lib/SQLAlchemy/2.\u57fa\u672c\u64cd\u4f5c/#4","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:50 @File : \u67e5\u8be2.py @Software: PyCharm \"\"\" ''' \u5229\u7528ORM\u5b9e\u73b0\u4e00\u4e2a\u521b\u5efa\u8868\u7684\u529f\u80fd ''' import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import * # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8') Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) Session_class = sessionmaker(bind=engine) # \u7ed1\u5b9aengine \uff0c\u4f1a\u8fd4\u56de\u7ed9\u4f60\u4e00\u4e2asession\u7c7b\u3002\u6ce8\u610f\u8fd9\u662f\u4e2a\u7c7b session = Session_class() # \u8fd9\u6837\u90fd\u5f97\u5230\u4e86\u6e38\u6807\u4e86 # \u9996\u5148\u8981\u62ff\u5230\u6570\u636e\uff0c\u7136\u540e\u4fee\u6539 user_obj = session.query(User).filter_by(name='loocha').first() user_obj.name = \"david\" session.commit() \u67e5\u770bMySQL\u6570\u636e # \u4fee\u6539\u4e4b\u524d mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | loocha | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec) # \u4fee\u6539\u4e4b\u540e mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | david | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec)","title":"4. \u6570\u636e\u8868\u4fee\u6539\u6570\u636e"},{"location":"python/lib/SQLAlchemy/2.\u57fa\u672c\u64cd\u4f5c/#5","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2018/12/20 10:50 @File : \u5220\u9664.py @Software: PyCharm \"\"\" ''' \u5229\u7528ORM\u5b9e\u73b0\u4e00\u4e2a\u521b\u5efa\u8868\u7684\u529f\u80fd ''' import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker from sqlalchemy.orm import * # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8') Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) Session_class = sessionmaker(bind=engine) # \u7ed1\u5b9aengine \uff0c\u4f1a\u8fd4\u56de\u7ed9\u4f60\u4e00\u4e2asession\u7c7b\u3002\u6ce8\u610f\u8fd9\u662f\u4e2a\u7c7b session = Session_class() # \u8fd9\u6837\u90fd\u5f97\u5230\u4e86\u6e38\u6807\u4e86 user_obj = session.query(User).filter_by(name=\"realcloud\").first() session.delete(user_obj) session.commit() \u67e5\u770bMySQL # \u5220\u9664\u4e4b\u524d mysql> select * from user; +----+-----------+----------+ | id | name | password | +----+-----------+----------+ | 1 | david | 123 | | 2 | realcloud | 456 | +----+-----------+----------+ 2 rows in set (0.00 sec) # \u5220\u9664\u4e4b\u540e mysql> select * from user; +----+-------+----------+ | id | name | password | +----+-------+----------+ | 1 | david | 123 | +----+-------+----------+ 1 row in set (0.00 sec) \u5176\u4ed6\u5220\u9664 - \u5220\u9664 sql \u4e2dlike # \u5220\u9664name\u5b57\u6bb5\u4ee5id\u4e3a\u7ed3\u5c3e\u7684\u6570\u636e user_obj = session.query(User).filter(User.name.like('%id')).first() session.delete(user_obj) session.commit()","title":"5. \u6570\u636e\u8868\u5220\u9664\u6570\u636e"},{"location":"python/lib/SQLAlchemy/3.\u56de\u6eda/","text":"\u56de\u6eda\u4e4b\u524d mysql> select * from user; +----+------+----------+ | id | name | password | +----+------+----------+ | 1 | rain | 12345 | +----+------+----------+ 1 row in set (0.00 sec) \u6267\u884c\u4ee3\u7801 from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=False) Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) # \u76f4\u63a5\u8c03\u7528\u57fa\u7c7b\u4e0b\u7684\u65b9\u6cd5 Base.metadata.create_all(engine) # \u5b9e\u4f8b\u4e0esocket\u7ed1\u5b9a,\u521b\u5efa\u4e0e\u6570\u636e\u5e93\u7684\u7ed8\u753bsession class\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u8fd4\u56de # \u7ed9session\u7684\u662f\u4e00\u4e2aclass\uff0c\u4e0d\u662f\u5b9e\u4f8b Session_class = sessionmaker(bind=engine) # \u751f\u6210session\u5b9e\u4f8b\uff0ccursor Session = Session_class() # \u521b\u5efa\u7528\u6237 fake_user = User(name='leco', password=\"666666\") Session.add(fake_user) # \u56de\u6eda Session.rollback() Session.commit() \u6267\u884c\u540e\u7ed3\u679c mysql> select * from user; +----+------+----------+ | id | name | password | +----+------+----------+ | 1 | rain | 12345 | +----+------+----------+ 1 row in set (0.00 sec) \u5220\u9664Session.rollback() \u6267\u884c\u540e\u7ed3\u679c mysql> select * from user; +----+------+----------+ | id | name | password | +----+------+----------+ | 1 | rain | 12345 | | 2 | leco | 666666 | +----+------+----------+ 2 rows in set (0.00 sec) \u6ce8\u610f: - \u56de\u6eda\u5c31\u662fmysql\u7684\u4e00\u4e2a\u4e8b\u52a1\u7684\u7279\u6027\uff0c\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u6267\u884c - \u56de\u6eda\u901a\u8fc7\u901a\u8fc7\u6355\u83b7\u5f02\u5e38\u6765\u5b9e\u73b0\u56de\u6eda\u3002","title":"3. \u56de\u6eda"},{"location":"python/lib/SQLAlchemy/4.\u7edf\u8ba1\u5206\u7ec4/","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/10/20 11:31 @File : \u7edf\u8ba1.py @Software: PyCharm \"\"\" import sqlalchemy from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String from sqlalchemy.orm import sessionmaker from sqlalchemy import func # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=False) Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) # \u76f4\u63a5\u8c03\u7528\u57fa\u7c7b\u4e0b\u7684\u65b9\u6cd5 Base.metadata.create_all(engine) # \u5b9e\u4f8b\u4e0esocket\u7ed1\u5b9a,\u521b\u5efa\u4e0e\u6570\u636e\u5e93\u7684\u7ed8\u753bsession class\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u8fd4\u56de # \u7ed9session\u7684\u662f\u4e00\u4e2aclass\uff0c\u4e0d\u662f\u5b9e\u4f8b Session_class = sessionmaker(bind=engine) # \u751f\u6210session\u5b9e\u4f8b\uff0ccursor Session = Session_class() # \u521b\u5efa\u7528\u6237 # fake_user = User(name='leco', password=\"666666\") # Session.add(fake_user) # Session.rollback() # Session.commit() # print(Session.query(User).filter(User.name.in_(['xiedi', 'rain', 'jack'])).all()) # Session.rollback() # print(Session.query(User).filter(User.name.in_(['leco', 'rain', 'loocha'])).all()) print(Session.query(User).filter(User.name.in_(['leco', 'rain'])).count()) print(Session.query(User.name, func.count(User.name)).group_by(User.name).all()) \u8fd0\u884c\u7ed3\u679c [<__main__.User object at 0x000001C147CFF5C0>, <__main__.User object at 0x000001C147CFF630>] 2 [('leco', 1), ('rain', 1)]","title":"4. \u7edf\u8ba1\u5206\u7ec4"},{"location":"python/lib/SQLAlchemy/5.\u5916\u952e/","text":"MySQL mysql> select * from student; +----+------+---------------+--------+ | id | name | register_date | gender | +----+------+---------------+--------+ | 1 | s2 | 2015-03-01 | F | +----+------+---------------+--------+ 1 row in set (0.00 sec) mysql> select * from user; +----+------+----------+ | id | name | password | +----+------+----------+ | 1 | rain | 12345 | | 2 | leco | 666666 | +----+------+----------+ 2 rows in set (0.00 sec) code from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import Column, Integer, String, DATE, Enum from sqlalchemy.orm import sessionmaker from sqlalchemy import func # \u521b\u5efa\u8fde\u63a5 engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/cmz\", encoding='utf-8', echo=False) Base = declarative_base() # \u751f\u6210ORM\u57fa\u7c7b # \u521b\u5efa\u8868\u7ed3\u6784 class User(Base): __tablename__ = 'user' # \u8868\u540d id = Column(Integer, primary_key=True) name = Column(String(32)) password = Column(String(64)) class Student(Base): __tablename__ = 'student' # \u8868\u540d id = Column(Integer, primary_key=True) # \u5b57\u6bb5\uff0c\u6574\u5f62\uff0c\u4e3b\u952e column\u662f\u5bfc\u5165\u7684 name = Column(String(32), nullable=False) register_date = Column(DATE, nullable=False) gender = Column(String(32), nullable=False) def __repr__(self): return \"<%s name:%s>\" % (self.id, self.name) # \u76f4\u63a5\u8c03\u7528\u57fa\u7c7b\u4e0b\u7684\u65b9\u6cd5 Base.metadata.create_all(engine) # \u5b9e\u4f8b\u4e0esocket\u7ed1\u5b9a,\u521b\u5efa\u4e0e\u6570\u636e\u5e93\u7684\u7ed8\u753bsession class\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u8fd4\u56de # \u7ed9session\u7684\u662f\u4e00\u4e2aclass\uff0c\u4e0d\u662f\u5b9e\u4f8b Session_class = sessionmaker(bind=engine) # \u751f\u6210session\u5b9e\u4f8b\uff0ccursor Session = Session_class() # s1 = Student(name=\"s2\", register_date=\"2015-03-01\", gender=\"F\") # Session.add(s1) print(Session.query(User, Student).filter(User.id == Student.id).all()) print(Session.query(User, Student).filter(User.id == Student.id).first()) Session.commit() \u6267\u884c\u7ed3\u679c [(<__main__.User object at 0x000002717E36D8D0>, <1 name:s2>)] (<__main__.User object at 0x000001CF04082320>, s2)","title":"5. \u5916\u952e"},{"location":"python/lib/SQLAlchemy/6.\u5173\u7cfb\u5b9a\u4e49/","text":"1. \u4e00\u5bf9\u591a\u5173\u7cfb \u00b6 \u5bf9\u4e8e\u4e00\u4e2a\u666e\u901a\u7684\u535a\u5ba2\u5e94\u7528\u6765\u8bf4\uff0c\u7528\u6237\u548c\u6587\u7ae0\u663e\u7136\u662f\u4e00\u4e2a\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u4e00\u7bc7\u6587\u7ae0\u5c5e\u4e8e\u4e00\u4e2a\u7528\u6237\uff0c\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u5199\u5f88\u591a\u7bc7\u6587\u7ae0\uff0c\u90a3\u4e48\u4ed6\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u53ef\u4ee5\u8fd9\u6837\u5b9a\u4e49\uff1a class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True) username = Column(String(64), nullable=False, index=True) password = Column(String(64), nullable=False) email = Column(String(64), nullable=False, index=True) articles = relationship('Article') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.username) class Article(Base): __tablename__ = 'articles' id = Column(Integer, primary_key=True) title = Column(String(255), nullable=False, index=True) content = Column(Text) user_id = Column(Integer, ForeignKey('users.id')) author = relationship('User') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.title) \u6bcf\u7bc7\u6587\u7ae0\u6709\u4e00\u4e2a\u5916\u952e\u6307\u5411 users \u8868\u4e2d\u7684\u4e3b\u952e id\uff0c \u800c\u5728 User \u4e2d\u4f7f\u7528 SQLAlchemy \u63d0\u4f9b\u7684 relationship \u63cf\u8ff0 \u5173\u7cfb\u3002\u800c\u7528\u6237\u4e0e\u6587\u7ae0\u7684\u4e4b\u95f4\u7684\u8fd9\u4e2a\u5173\u7cfb\u662f\u53cc\u5411\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u4e24\u5f20\u8868\u4e2d\u90fd\u5b9a\u4e49\u4e86 relationship\u3002 SQLAlchemy \u63d0\u4f9b\u4e86 backref \u8ba9\u6211\u4eec\u53ef\u4ee5\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u5173\u7cfb\uff1a articles = relationship('Article', backref='author') \u6dfb\u52a0\u4e86\u8fd9\u4e2a\u5c31\u53ef\u4ee5\u4e0d\u7528\u518d\u5728 Article \u4e2d\u5b9a\u4e49 relationship \u4e86\uff01 2. \u4e00\u5bf9\u4e00\u5173\u7cfb \u00b6 \u5728 User \u4e2d\u6211\u4eec\u53ea\u5b9a\u4e49\u4e86\u51e0\u4e2a\u5fc5\u987b\u7684\u5b57\u6bb5\uff0c \u4f46\u901a\u5e38\u7528\u6237\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u4fe1\u606f\uff0c\u4f46\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e0d\u662f\u5fc5\u987b\u586b\u5199\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u4eec\u653e\u5230\u53e6\u4e00\u5f20 UserInfo \u8868\u4e2d\uff0c\u8fd9\u6837User \u548c UserInfo \u5c31\u5f62\u6210\u4e86\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\u3002\u4f60\u53ef\u80fd\u4f1a\u5947\u602a\u4e00\u5bf9\u4e00\u5173\u7cfb\u4e3a\u4ec0\u4e48\u4e0d\u5728\u4e00\u5bf9\u591a\u5173\u7cfb\u524d\u9762\uff1f\u90a3\u662f\u56e0\u4e3a\u4e00\u5bf9\u4e00\u5173\u7cfb\u662f\u57fa\u4e8e\u4e00\u5bf9\u591a\u5b9a\u4e49\u7684\uff1a class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True) username = Column(String(64), nullable=False, index=True) password = Column(String(64), nullable=False) email = Column(String(64), nullable=False, index=True) articles = relationship('Article', backref='author') userinfo = relationship('UserInfo', backref='user', uselist=False) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.username) class UserInfo(Base): __tablename__ = 'userinfos' id = Column(Integer, primary_key=True) name = Column(String(64)) qq = Column(String(11)) phone = Column(String(11)) link = Column(String(64)) user_id = Column(Integer, ForeignKey('users.id')) \u5b9a\u4e49\u65b9\u6cd5\u548c\u4e00\u5bf9\u591a\u76f8\u540c\uff0c\u53ea\u662f\u9700\u8981\u6dfb\u52a0 userlist=False 3. \u591a\u5bf9\u591a\u5173\u7cfb \u00b6 \u4e00\u904d\u535a\u5ba2\u901a\u5e38\u6709\u4e00\u4e2a\u5206\u7c7b\uff0c\u597d\u51e0\u4e2a\u6807\u7b7e\u3002\u6807\u7b7e\u4e0e\u535a\u5ba2\u4e4b\u95f4\u5c31\u662f\u4e00\u4e2a\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u3002\u591a\u5bf9\u591a\u5173\u7cfb\u4e0d\u80fd\u76f4\u63a5\u5b9a\u4e49\uff0c\u9700\u8981\u5206\u89e3\u6210\u4fe9\u4e2a\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u4e3a\u6b64\uff0c\u9700\u8981\u4e00\u5f20\u989d\u5916\u7684\u8868\u6765\u534f\u52a9\u5b8c\u6210\uff1a article_tag = Table( 'article_tag', Base.metadata, Column('article_id', Integer, ForeignKey('articles.id')), Column('tag_id', Integer, ForeignKey('tags.id')) ) class Tag(Base): __tablename__ = 'tags' id = Column(Integer, primary_key=True) name = Column(String(64), nullable=False, index=True) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.name) 4. \u6620\u5c04\u5230\u6570\u636e \u00b6 \u8868\u5df2\u7ecf\u63cf\u8ff0\u597d\u4e86\uff0c\u5728\u6587\u4ef6\u672b\u5c3e\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u5728\u6211\u4eec\u8fde\u63a5\u7684\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u8868\uff1a if __name__ == '__main__': Base.metadata.create_all(engine) \u5b8c\u6574\u4ee3\u7801 # coding: utf-8 import random from faker import Factory from sqlalchemy import create_engine, Table from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import ForeignKey from sqlalchemy import Column, String, Integer, Text from sqlalchemy.orm import sessionmaker, relationship engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/blog\", encoding='utf-8', echo=False) Base = declarative_base() class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True) username = Column(String(64), nullable=False, index=True) password = Column(String(64), nullable=False) email = Column(String(64), nullable=False, index=True) articles = relationship('Article', backref='author') userinfo = relationship('UserInfo', backref='user', uselist=False) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.username) class UserInfo(Base): __tablename__ = 'userinfos' id = Column(Integer, primary_key=True) name = Column(String(64)) qq = Column(String(11)) phone = Column(String(11)) link = Column(String(64)) user_id = Column(Integer, ForeignKey('users.id')) class Article(Base): __tablename__ = 'articles' id = Column(Integer, primary_key=True) title = Column(String(255), nullable=False, index=True) content = Column(Text) user_id = Column(Integer, ForeignKey('users.id')) cate_id = Column(Integer, ForeignKey('categories.id')) tags = relationship('Tag', secondary='article_tag', backref='articles') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.title) class Category(Base): __tablename__ = 'categories' id = Column(Integer, primary_key=True) name = Column(String(64), nullable=False, index=True) articles = relationship('Article', backref='category') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.name) article_tag = Table( 'article_tag', Base.metadata, Column('article_id', Integer, ForeignKey('articles.id')), Column('tag_id', Integer, ForeignKey('tags.id')) ) class Tag(Base): __tablename__ = 'tags' id = Column(Integer, primary_key=True) name = Column(String(64), nullable=False, index=True) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.name) if __name__ == '__main__': Base.metadata.create_all(engine) faker = Factory.create() Session = sessionmaker(bind=engine) session = Session() faker_users = [User( username=faker.name(), password=faker.word(), email=faker.email(), ) for i in range(10)] session.add_all(faker_users) faker_categories = [Category(name=faker.word()) for i in range(5)] session.add_all(faker_categories) faker_tags = [Tag(name=faker.word()) for i in range(20)] session.add_all(faker_tags) for i in range(100): article = Article( title=faker.sentence(), content=' '.join(faker.sentences(nb=random.randint(10, 20))), author=random.choice(faker_users), category=random.choice(faker_categories) ) for tag in random.sample(faker_tags, random.randint(2, 5)): article.tags.append(tag) session.add(article) session.commit() \u68c0\u67e5mysql mysql> show tables; +----------------+ | Tables_in_blog | +----------------+ | article_tag | | articles | | categories | | tags | | userinfos | | users | +----------------+ 6 rows in set (0.00 sec)","title":"6. \u5173\u7cfb\u5b9a\u4e49"},{"location":"python/lib/SQLAlchemy/6.\u5173\u7cfb\u5b9a\u4e49/#1","text":"\u5bf9\u4e8e\u4e00\u4e2a\u666e\u901a\u7684\u535a\u5ba2\u5e94\u7528\u6765\u8bf4\uff0c\u7528\u6237\u548c\u6587\u7ae0\u663e\u7136\u662f\u4e00\u4e2a\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u4e00\u7bc7\u6587\u7ae0\u5c5e\u4e8e\u4e00\u4e2a\u7528\u6237\uff0c\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u5199\u5f88\u591a\u7bc7\u6587\u7ae0\uff0c\u90a3\u4e48\u4ed6\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u53ef\u4ee5\u8fd9\u6837\u5b9a\u4e49\uff1a class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True) username = Column(String(64), nullable=False, index=True) password = Column(String(64), nullable=False) email = Column(String(64), nullable=False, index=True) articles = relationship('Article') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.username) class Article(Base): __tablename__ = 'articles' id = Column(Integer, primary_key=True) title = Column(String(255), nullable=False, index=True) content = Column(Text) user_id = Column(Integer, ForeignKey('users.id')) author = relationship('User') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.title) \u6bcf\u7bc7\u6587\u7ae0\u6709\u4e00\u4e2a\u5916\u952e\u6307\u5411 users \u8868\u4e2d\u7684\u4e3b\u952e id\uff0c \u800c\u5728 User \u4e2d\u4f7f\u7528 SQLAlchemy \u63d0\u4f9b\u7684 relationship \u63cf\u8ff0 \u5173\u7cfb\u3002\u800c\u7528\u6237\u4e0e\u6587\u7ae0\u7684\u4e4b\u95f4\u7684\u8fd9\u4e2a\u5173\u7cfb\u662f\u53cc\u5411\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u4e24\u5f20\u8868\u4e2d\u90fd\u5b9a\u4e49\u4e86 relationship\u3002 SQLAlchemy \u63d0\u4f9b\u4e86 backref \u8ba9\u6211\u4eec\u53ef\u4ee5\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u5173\u7cfb\uff1a articles = relationship('Article', backref='author') \u6dfb\u52a0\u4e86\u8fd9\u4e2a\u5c31\u53ef\u4ee5\u4e0d\u7528\u518d\u5728 Article \u4e2d\u5b9a\u4e49 relationship \u4e86\uff01","title":"1. \u4e00\u5bf9\u591a\u5173\u7cfb"},{"location":"python/lib/SQLAlchemy/6.\u5173\u7cfb\u5b9a\u4e49/#2","text":"\u5728 User \u4e2d\u6211\u4eec\u53ea\u5b9a\u4e49\u4e86\u51e0\u4e2a\u5fc5\u987b\u7684\u5b57\u6bb5\uff0c \u4f46\u901a\u5e38\u7528\u6237\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u4fe1\u606f\uff0c\u4f46\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e0d\u662f\u5fc5\u987b\u586b\u5199\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u4eec\u653e\u5230\u53e6\u4e00\u5f20 UserInfo \u8868\u4e2d\uff0c\u8fd9\u6837User \u548c UserInfo \u5c31\u5f62\u6210\u4e86\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\u3002\u4f60\u53ef\u80fd\u4f1a\u5947\u602a\u4e00\u5bf9\u4e00\u5173\u7cfb\u4e3a\u4ec0\u4e48\u4e0d\u5728\u4e00\u5bf9\u591a\u5173\u7cfb\u524d\u9762\uff1f\u90a3\u662f\u56e0\u4e3a\u4e00\u5bf9\u4e00\u5173\u7cfb\u662f\u57fa\u4e8e\u4e00\u5bf9\u591a\u5b9a\u4e49\u7684\uff1a class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True) username = Column(String(64), nullable=False, index=True) password = Column(String(64), nullable=False) email = Column(String(64), nullable=False, index=True) articles = relationship('Article', backref='author') userinfo = relationship('UserInfo', backref='user', uselist=False) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.username) class UserInfo(Base): __tablename__ = 'userinfos' id = Column(Integer, primary_key=True) name = Column(String(64)) qq = Column(String(11)) phone = Column(String(11)) link = Column(String(64)) user_id = Column(Integer, ForeignKey('users.id')) \u5b9a\u4e49\u65b9\u6cd5\u548c\u4e00\u5bf9\u591a\u76f8\u540c\uff0c\u53ea\u662f\u9700\u8981\u6dfb\u52a0 userlist=False","title":"2. \u4e00\u5bf9\u4e00\u5173\u7cfb"},{"location":"python/lib/SQLAlchemy/6.\u5173\u7cfb\u5b9a\u4e49/#3","text":"\u4e00\u904d\u535a\u5ba2\u901a\u5e38\u6709\u4e00\u4e2a\u5206\u7c7b\uff0c\u597d\u51e0\u4e2a\u6807\u7b7e\u3002\u6807\u7b7e\u4e0e\u535a\u5ba2\u4e4b\u95f4\u5c31\u662f\u4e00\u4e2a\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u3002\u591a\u5bf9\u591a\u5173\u7cfb\u4e0d\u80fd\u76f4\u63a5\u5b9a\u4e49\uff0c\u9700\u8981\u5206\u89e3\u6210\u4fe9\u4e2a\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u4e3a\u6b64\uff0c\u9700\u8981\u4e00\u5f20\u989d\u5916\u7684\u8868\u6765\u534f\u52a9\u5b8c\u6210\uff1a article_tag = Table( 'article_tag', Base.metadata, Column('article_id', Integer, ForeignKey('articles.id')), Column('tag_id', Integer, ForeignKey('tags.id')) ) class Tag(Base): __tablename__ = 'tags' id = Column(Integer, primary_key=True) name = Column(String(64), nullable=False, index=True) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.name)","title":"3. \u591a\u5bf9\u591a\u5173\u7cfb"},{"location":"python/lib/SQLAlchemy/6.\u5173\u7cfb\u5b9a\u4e49/#4","text":"\u8868\u5df2\u7ecf\u63cf\u8ff0\u597d\u4e86\uff0c\u5728\u6587\u4ef6\u672b\u5c3e\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u5728\u6211\u4eec\u8fde\u63a5\u7684\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u8868\uff1a if __name__ == '__main__': Base.metadata.create_all(engine) \u5b8c\u6574\u4ee3\u7801 # coding: utf-8 import random from faker import Factory from sqlalchemy import create_engine, Table from sqlalchemy.ext.declarative import declarative_base from sqlalchemy import ForeignKey from sqlalchemy import Column, String, Integer, Text from sqlalchemy.orm import sessionmaker, relationship engine = create_engine(\"mysql+pymysql://root:root@127.0.0.1/blog\", encoding='utf-8', echo=False) Base = declarative_base() class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True) username = Column(String(64), nullable=False, index=True) password = Column(String(64), nullable=False) email = Column(String(64), nullable=False, index=True) articles = relationship('Article', backref='author') userinfo = relationship('UserInfo', backref='user', uselist=False) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.username) class UserInfo(Base): __tablename__ = 'userinfos' id = Column(Integer, primary_key=True) name = Column(String(64)) qq = Column(String(11)) phone = Column(String(11)) link = Column(String(64)) user_id = Column(Integer, ForeignKey('users.id')) class Article(Base): __tablename__ = 'articles' id = Column(Integer, primary_key=True) title = Column(String(255), nullable=False, index=True) content = Column(Text) user_id = Column(Integer, ForeignKey('users.id')) cate_id = Column(Integer, ForeignKey('categories.id')) tags = relationship('Tag', secondary='article_tag', backref='articles') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.title) class Category(Base): __tablename__ = 'categories' id = Column(Integer, primary_key=True) name = Column(String(64), nullable=False, index=True) articles = relationship('Article', backref='category') def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.name) article_tag = Table( 'article_tag', Base.metadata, Column('article_id', Integer, ForeignKey('articles.id')), Column('tag_id', Integer, ForeignKey('tags.id')) ) class Tag(Base): __tablename__ = 'tags' id = Column(Integer, primary_key=True) name = Column(String(64), nullable=False, index=True) def __repr__(self): return '%s(%r)' % (self.__class__.__name__, self.name) if __name__ == '__main__': Base.metadata.create_all(engine) faker = Factory.create() Session = sessionmaker(bind=engine) session = Session() faker_users = [User( username=faker.name(), password=faker.word(), email=faker.email(), ) for i in range(10)] session.add_all(faker_users) faker_categories = [Category(name=faker.word()) for i in range(5)] session.add_all(faker_categories) faker_tags = [Tag(name=faker.word()) for i in range(20)] session.add_all(faker_tags) for i in range(100): article = Article( title=faker.sentence(), content=' '.join(faker.sentences(nb=random.randint(10, 20))), author=random.choice(faker_users), category=random.choice(faker_categories) ) for tag in random.sample(faker_tags, random.randint(2, 5)): article.tags.append(tag) session.add(article) session.commit() \u68c0\u67e5mysql mysql> show tables; +----------------+ | Tables_in_blog | +----------------+ | article_tag | | articles | | categories | | tags | | userinfos | | users | +----------------+ 6 rows in set (0.00 sec)","title":"4. \u6620\u5c04\u5230\u6570\u636e"},{"location":"python/lib/email/smtp/1.s/","text":"\u53c2\u8003\u5730\u5740 SMTP\uff08Simple Mail Transfer Protocol\uff09\u5373\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae,\u5b83\u662f\u4e00\u7ec4\u7528\u4e8e\u7531\u6e90\u5730\u5740\u5230\u76ee\u7684\u5730\u5740\u4f20\u9001\u90ae\u4ef6\u7684\u89c4\u5219\uff0c\u7531\u5b83\u6765\u63a7\u5236\u4fe1\u4ef6\u7684\u4e2d\u8f6c\u65b9\u5f0f\u3002 python\u7684smtplib\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f88\u65b9\u4fbf\u7684\u9014\u5f84\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u3002\u5b83\u5bf9smtp\u534f\u8bae\u8fdb\u884c\u4e86\u7b80\u5355\u7684\u5c01\u88c5\u3002 Python\u521b\u5efa SMTP \u5bf9\u8c61\u8bed\u6cd5\u5982\u4e0b\uff1a import smtplib smtpObj = smtplib.SMTP( [host [, port [, local_hostname]]] ) \u53c2\u6570 host: SMTP \u670d\u52a1\u5668\u4e3b\u673a\u3002 \u4f60\u53ef\u4ee5\u6307\u5b9a\u4e3b\u673a\u7684ip\u5730\u5740\u6216\u8005\u57df\u540d\u5982: runoob.com\uff0c\u8fd9\u4e2a\u662f\u53ef\u9009\u53c2\u6570\u3002 port: \u5982\u679c\u4f60\u63d0\u4f9b\u4e86 host \u53c2\u6570, \u4f60\u9700\u8981\u6307\u5b9a SMTP \u670d\u52a1\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b SMTP \u7aef\u53e3\u53f7\u4e3a25\u3002 local_hostname: \u5982\u679c SMTP \u5728\u4f60\u7684\u672c\u673a\u4e0a\uff0c\u4f60\u53ea\u9700\u8981\u6307\u5b9a\u670d\u52a1\u5668\u5730\u5740\u4e3a localhost \u5373\u53ef\u3002 Python SMTP \u5bf9\u8c61\u4f7f\u7528 sendmail \u65b9\u6cd5\u53d1\u9001\u90ae\u4ef6\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a SMTP.sendmail(from_addr, to_addrs, msg[, mail_options, rcpt_options]) \u53c2\u6570 from_addr: \u90ae\u4ef6\u53d1\u9001\u8005\u5730\u5740\u3002 to_addrs: \u5b57\u7b26\u4e32\u5217\u8868\uff0c\u90ae\u4ef6\u53d1\u9001\u5730\u5740\u3002 msg: \u53d1\u9001\u6d88\u606f \u8fd9\u91cc\u8981\u6ce8\u610f\u4e00\u4e0b\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0cmsg \u662f\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u90ae\u4ef6\u3002\u6211\u4eec\u77e5\u9053\u90ae\u4ef6\u4e00\u822c\u7531\u6807\u9898\uff0c\u53d1\u4fe1\u4eba\uff0c\u6536\u4ef6\u4eba\uff0c\u90ae\u4ef6\u5185\u5bb9\uff0c\u9644\u4ef6\u7b49\u6784\u6210\uff0c\u53d1\u9001\u90ae\u4ef6\u7684\u65f6\u5019\uff0c\u8981\u6ce8\u610f msg \u7684\u683c\u5f0f\u3002\u8fd9\u4e2a\u683c\u5f0f\u5c31\u662f smtp \u534f\u8bae\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/1/21 11:11 @File : sendmail.py @Software: PyCharm \"\"\" import smtplib from email.mime.text import MIMEText def send_qqmail(send_user, auth_code, contents, subject, recv_user): \"\"\" :param send_user: \u53d1\u9001\u8005\u90ae\u7bb1\u5730\u5740<\u5168\u90e8\u5305\u62ec\u540e\u7f00>\uff0c\u4e5f\u5c31\u662f\u90ae\u7bb1\u767b\u5f55\u8d26\u53f7 :param auth_code: \u53d1\u9001\u8005\u90ae\u7bb1\u7684\u6388\u6743\u7801\uff0c\u800c\u975e\u767b\u5f55\u5bc6\u7801 :param contents: \u90ae\u7bb1\u5730\u5740\u6b63\u6587 :param subject: \u90ae\u7bb1\u4e3b\u9898 :param recv_user: \u63a5\u53d7\u90ae\u7bb1\u5730\u5740 :return: QQ\u53d1\u9001\u90ae\u4ef6 \"\"\" ret = True try: mail_host = 'smtp.qq.com' msg = MIMEText(contents, 'plain', 'utf-8') # \u6784\u9020\u90ae\u4ef6\u6b63\u6587 msg['From'] = send_user # \u6784\u9020\u90ae\u4ef6\u5934\u90e8 msg['To'] = recv_user # \u63a5\u53d7\u8005 msg['Subject'] = subject # \u90ae\u4ef6\u4e3b\u9898 server = smtplib.SMTP_SSL(mail_host, 465) # qq->465, 163->25 server.login(send_user, auth_code) # \u767b\u5f55 server.sendmail(send_user, recv_user, msg.as_string()) except smtplib.SMTPException: ret = False finally: server.quit() # \u5173\u95ed\u8fde\u63a5 return ret if __name__ == '__main__': # send_qqmail('610658552@qq.com', 'bsswzfgmawesbcjd', '\u65b0\u6d6a\u722c\u866b\u6d4b\u8bd5\u7ed3\u679c', '\u65b0\u6d6a\u722c\u866b\u90ae\u4ef6', '610658552@qq.com') ret = send_qqmail(send_user=\"610658552@qq.com\", auth_code=\"bsswzfgmawesbcjd\", contents='\u90ae\u4ef6\u6b63\u6587: \u65b0\u6d6a\u722c\u866b\u7ed3\u679c\u5982\u4e0b', subject='\u90ae\u4ef6\u4e3b\u9898: \u65b0\u6d6a\u722c\u866b\u90ae\u4ef6', recv_user='610658552@qq.com') if ret: print(\"\u90ae\u4ef6\u53d1\u9001\u6210\u529f\") else: print(\"\u90ae\u4ef6\u53d1\u9001\u5931\u8d25\") \u8fd0\u884c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-django/sendmail.py \u90ae\u4ef6\u53d1\u9001\u6210\u529f \u67e5\u770b","title":"1. \u5355\u4eba\u63a5\u53d7\u6587\u4ef6"},{"location":"python/lib/email/smtp/2.d/","text":"\u548c\u5355\u4eba\u63a5\u53d7\u90ae\u4ef6\u7684\u4ee3\u7801\u51e0\u4e4e\u4e00\u81f4\uff0c\u5c31\u662f\u5728\u63a5\u53d7\u90a3\u90e8\u5206\u6539\u4e3a\u5217\u8868\u3002 recv_user.split()\uff0c\u8fd9\u6837\u6539\u53d8\u540e\uff0c\u7ed3\u679c\u662f\u5217\u8868\uff0c\u8fd9\u6837\u5c31\u80fd\u591a\u4eba\u63a5\u53d7\u90ae\u4ef6\u4e86\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/1/21 11:11 @File : sendmail.py @Software: PyCharm \"\"\" import smtplib from email.mime.text import MIMEText def send_qqmail(send_user, auth_code, contents, subject, recv_user): \"\"\" :param send_user: \u53d1\u9001\u8005\u90ae\u7bb1\u5730\u5740<\u5168\u90e8\u5305\u62ec\u540e\u7f00>\uff0c\u4e5f\u5c31\u662f\u90ae\u7bb1\u767b\u5f55\u8d26\u53f7 :param auth_code: \u53d1\u9001\u8005\u90ae\u7bb1\u7684\u6388\u6743\u7801\uff0c\u800c\u975e\u767b\u5f55\u5bc6\u7801 :param contents: \u90ae\u7bb1\u5730\u5740\u6b63\u6587 :param subject: \u90ae\u7bb1\u4e3b\u9898 :param recv_user: \u63a5\u53d7\u90ae\u7bb1\u5730\u5740 :return: QQ\u53d1\u9001\u90ae\u4ef6 \"\"\" ret = True try: mail_host = 'smtp.qq.com' msg = MIMEText(contents, 'plain', 'utf-8') # \u6784\u9020\u90ae\u4ef6\u6b63\u6587 msg['From'] = send_user # \u6784\u9020\u90ae\u4ef6\u5934\u90e8 msg['To'] = recv_user # \u63a5\u53d7\u8005 msg['Subject'] = subject # \u90ae\u4ef6\u4e3b\u9898 server = smtplib.SMTP_SSL(mail_host, 465) # qq->465, 163->25 server.login(send_user, auth_code) # \u767b\u5f55 server.sendmail(send_user, recv_user.split(), msg.as_string()) except smtplib.SMTPException: ret = False finally: server.quit() # \u5173\u95ed\u8fde\u63a5 return ret if __name__ == '__main__': # send_qqmail('610658552@qq.com', 'bsswzfgmawesbcjd', '\u65b0\u6d6a\u722c\u866b\u6d4b\u8bd5\u7ed3\u679c', '\u65b0\u6d6a\u722c\u866b\u90ae\u4ef6', '610658552@qq.com') ret = send_qqmail(send_user=\"610658552@qq.com\", auth_code=\"bsswzfgmawesbcjd\", contents='\u90ae\u4ef6\u6b63\u6587: \u65b0\u6d6a\u722c\u866b\u7ed3\u679c\u5982\u4e0b', subject='\u90ae\u4ef6\u4e3b\u9898: \u65b0\u6d6a\u722c\u866b\u90ae\u4ef6', recv_user=\"610658552@qq.com 3374232095@qq.com\") if ret: print(\"\u90ae\u4ef6\u53d1\u9001\u6210\u529f\") else: print(\"\u90ae\u4ef6\u53d1\u9001\u5931\u8d25\") \u6ce8\u610f\uff1a recv_user.split() \u8f6c\u53d8\u6210\u5217\u8868 \u5728\u8c03\u7528\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u591a\u4e2a\u4eba\u7684\u90ae\u7bb1\u5199\u5728\u53cc\u5f15\u53f7\u4e0b\u9762\uff0c\u4e2d\u95f4\u7528\u7a7a\u683c\u9694\u5f00\uff0c\u540e\u9762\u662f\u6839\u636e\u7a7a\u683c\u6765\u5207\u5206\u7684 ex: recv_user=\"xx3@qq.com xxx1@qq.com xxx2@qq.com\")","title":"2. \u591a\u4eba\u63a5\u53d7\u6587\u4ef6"},{"location":"python/lib/encryption_decryption/base64/1.base64\u4f7f\u7528/","text":"\u5b98\u7f51\u5730\u5740 1. \u7b80\u4ecb \u00b6 \u3000 \u5728\u4e00\u4e9b\u9879\u76ee\u4e2d\uff0c\u63a5\u53e3\u7684\u62a5\u6587\u662f\u901a\u8fc7base64\u52a0\u5bc6\u4f20\u8f93\u7684\uff0c\u6240\u4ee5\u5728\u8fdb\u884c\u63a5\u53e3\u81ea\u52a8\u5316\u65f6\uff0c\u9700\u8981\u5bf9\u6240\u4f20\u7684\u53c2\u6570\u8fdb\u884cbase64\u7f16\u7801\uff0c\u5bf9\u62ff\u5230\u7684\u54cd\u5e94\u62a5\u6587\u8fdb\u884c\u89e3\u7801\u3002 \u3000 Base64\u7f16\u7801\u662f\u4e00\u79cd\u201c\u9632\u541b\u5b50\u4e0d\u9632\u5c0f\u4eba\u201d\u7684\u7f16\u7801\u65b9\u5f0f\u3002\u5e7f\u6cdb\u5e94\u7528\u4e8eMIME\u534f\u8bae\uff0c\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u7684\u4f20\u8f93\u7f16\u7801\uff0c\u751f\u6210\u7684\u7f16\u7801\u53ef\u9006\uff0c\u540e\u4e00\u4e24\u4f4d\u53ef\u80fd\u6709\u201c=\u201d\uff0c\u751f\u6210\u7684\u7f16\u7801\u90fd\u662fascii\u5b57\u7b26\u3002 \u4f18\u70b9\uff1a\u901f\u5ea6\u5feb\uff0cascii\u5b57\u7b26\uff0c\u8089\u773c\u4e0d\u53ef\u7406\u89e3 \u7f3a\u70b9\uff1a\u7f16\u7801\u6bd4\u8f83\u957f\uff0c\u975e\u5e38\u5bb9\u6613\u88ab\u7834\u89e3\uff0c\u4ec5\u9002\u7528\u4e8e\u52a0\u5bc6\u975e\u5173\u952e\u4fe1\u606f\u7684\u573a\u5408 2. python2\u4e2d \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ import base64 s = '\u6211\u662f\u5b57\u7b26\u4e32' a = base64.b64encode(s) print a print base64.b64decode(a) \u8fd0\u884c root@root:~$ python2 1.py 5oiR5piv5a2X56ym5Liy \u6211\u662f\u5b57\u7b26\u4e32 3. python3\u4e2d \u00b6 python3\u4e0d\u592a\u4e00\u6837\uff1a\u56e0\u4e3a3.x\u4e2d\u5b57\u7b26\u90fd\u4e3aunicode\u7f16\u7801\uff0c\u800cb64encode\u51fd\u6570\u7684\u53c2\u6570\u4e3abyte\u7c7b\u578b\uff0c\u6240\u4ee5\u5fc5\u987b\u5148\u8f6c\u7801\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Author : caimengzhi @File : base64\u4f7f\u7528.py @Software: PyCharm \"\"\" import base64 if __name__ == '__main__': s = 'plain text' # base64\u7f16\u7801 t = base64.b64encode(s.encode('UTF-8')) print(\"base64\u7f16\u7801 \",str(t, 'utf-8')) # base64\u89e3\u7801 t = base64.b64decode(t) print(\"base64\u89e3\u7801 \",str(t, 'utf-8')) # base32\u7f16\u7801 t = base64.b32encode(s.encode('UTF-8')) print(\"base32\u7f16\u7801 \",str(t, 'utf-8')) # base32\u89e3\u7801 t = base64.b32decode(t) print(\"base32\u89e3\u7801 \",str(t, 'utf-8')) # base16\u7f16\u7801 t = base64.b16encode(s.encode('UTF-8')) print(\"base16\u7f16\u7801 \",str(t, 'utf-8')) # base16\u89e3\u7801 t = base64.b16decode(t) print(\"base16\u89e3\u7801 \",str(t, 'utf-8')) \u8fd0\u884c\u7ed3\u679c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-django/\u5e93/\u52a0\u5bc6\u548c\u89e3\u5bc6/base64\u4f7f\u7528.py base64\u7f16\u7801 cGxhaW4gdGV4dA== base64\u89e3\u7801 plain text base32\u7f16\u7801 OBWGC2LOEB2GK6DU base32\u89e3\u7801 plain text base16\u7f16\u7801 706C61696E2074657874 base16\u89e3\u7801 plain text \u6ce8\u610f base64.bxxencode\u63a5\u53d7\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4bytes\u7528\u4e8e\u52a0\u5bc6\uff0c\u8fd4\u56de\u4e00\u4e2abytes\u5b58\u50a8\u52a0\u5bc6\u4e4b\u540e\u7684\u5185\u5bb9\u3002 base64.bxxdecode\u63a5\u53d7\u4e00\u4e2a\u5b58\u653e\u7740\u5bc6\u6587\u7684bytes\uff0c\u8fd4\u56de\u4e00\u4e2abytes\u5b58\u653e\u7740\u89e3\u5bc6\u540e\u7684\u5185\u5bb9\u3002","title":"1. base4"},{"location":"python/lib/encryption_decryption/base64/1.base64\u4f7f\u7528/#1","text":"\u5728\u4e00\u4e9b\u9879\u76ee\u4e2d\uff0c\u63a5\u53e3\u7684\u62a5\u6587\u662f\u901a\u8fc7base64\u52a0\u5bc6\u4f20\u8f93\u7684\uff0c\u6240\u4ee5\u5728\u8fdb\u884c\u63a5\u53e3\u81ea\u52a8\u5316\u65f6\uff0c\u9700\u8981\u5bf9\u6240\u4f20\u7684\u53c2\u6570\u8fdb\u884cbase64\u7f16\u7801\uff0c\u5bf9\u62ff\u5230\u7684\u54cd\u5e94\u62a5\u6587\u8fdb\u884c\u89e3\u7801\u3002 \u3000 Base64\u7f16\u7801\u662f\u4e00\u79cd\u201c\u9632\u541b\u5b50\u4e0d\u9632\u5c0f\u4eba\u201d\u7684\u7f16\u7801\u65b9\u5f0f\u3002\u5e7f\u6cdb\u5e94\u7528\u4e8eMIME\u534f\u8bae\uff0c\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u7684\u4f20\u8f93\u7f16\u7801\uff0c\u751f\u6210\u7684\u7f16\u7801\u53ef\u9006\uff0c\u540e\u4e00\u4e24\u4f4d\u53ef\u80fd\u6709\u201c=\u201d\uff0c\u751f\u6210\u7684\u7f16\u7801\u90fd\u662fascii\u5b57\u7b26\u3002 \u4f18\u70b9\uff1a\u901f\u5ea6\u5feb\uff0cascii\u5b57\u7b26\uff0c\u8089\u773c\u4e0d\u53ef\u7406\u89e3 \u7f3a\u70b9\uff1a\u7f16\u7801\u6bd4\u8f83\u957f\uff0c\u975e\u5e38\u5bb9\u6613\u88ab\u7834\u89e3\uff0c\u4ec5\u9002\u7528\u4e8e\u52a0\u5bc6\u975e\u5173\u952e\u4fe1\u606f\u7684\u573a\u5408","title":"1. \u7b80\u4ecb"},{"location":"python/lib/encryption_decryption/base64/1.base64\u4f7f\u7528/#2-python2","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ import base64 s = '\u6211\u662f\u5b57\u7b26\u4e32' a = base64.b64encode(s) print a print base64.b64decode(a) \u8fd0\u884c root@root:~$ python2 1.py 5oiR5piv5a2X56ym5Liy \u6211\u662f\u5b57\u7b26\u4e32","title":"2. python2\u4e2d"},{"location":"python/lib/encryption_decryption/base64/1.base64\u4f7f\u7528/#3-python3","text":"python3\u4e0d\u592a\u4e00\u6837\uff1a\u56e0\u4e3a3.x\u4e2d\u5b57\u7b26\u90fd\u4e3aunicode\u7f16\u7801\uff0c\u800cb64encode\u51fd\u6570\u7684\u53c2\u6570\u4e3abyte\u7c7b\u578b\uff0c\u6240\u4ee5\u5fc5\u987b\u5148\u8f6c\u7801\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Author : caimengzhi @File : base64\u4f7f\u7528.py @Software: PyCharm \"\"\" import base64 if __name__ == '__main__': s = 'plain text' # base64\u7f16\u7801 t = base64.b64encode(s.encode('UTF-8')) print(\"base64\u7f16\u7801 \",str(t, 'utf-8')) # base64\u89e3\u7801 t = base64.b64decode(t) print(\"base64\u89e3\u7801 \",str(t, 'utf-8')) # base32\u7f16\u7801 t = base64.b32encode(s.encode('UTF-8')) print(\"base32\u7f16\u7801 \",str(t, 'utf-8')) # base32\u89e3\u7801 t = base64.b32decode(t) print(\"base32\u89e3\u7801 \",str(t, 'utf-8')) # base16\u7f16\u7801 t = base64.b16encode(s.encode('UTF-8')) print(\"base16\u7f16\u7801 \",str(t, 'utf-8')) # base16\u89e3\u7801 t = base64.b16decode(t) print(\"base16\u89e3\u7801 \",str(t, 'utf-8')) \u8fd0\u884c\u7ed3\u679c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-django/\u5e93/\u52a0\u5bc6\u548c\u89e3\u5bc6/base64\u4f7f\u7528.py base64\u7f16\u7801 cGxhaW4gdGV4dA== base64\u89e3\u7801 plain text base32\u7f16\u7801 OBWGC2LOEB2GK6DU base32\u89e3\u7801 plain text base16\u7f16\u7801 706C61696E2074657874 base16\u89e3\u7801 plain text \u6ce8\u610f base64.bxxencode\u63a5\u53d7\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4bytes\u7528\u4e8e\u52a0\u5bc6\uff0c\u8fd4\u56de\u4e00\u4e2abytes\u5b58\u50a8\u52a0\u5bc6\u4e4b\u540e\u7684\u5185\u5bb9\u3002 base64.bxxdecode\u63a5\u53d7\u4e00\u4e2a\u5b58\u653e\u7740\u5bc6\u6587\u7684bytes\uff0c\u8fd4\u56de\u4e00\u4e2abytes\u5b58\u653e\u7740\u89e3\u5bc6\u540e\u7684\u5185\u5bb9\u3002","title":"3. python3\u4e2d"},{"location":"python/lib/encryption_decryption/base64/2.\u6848\u4f8b/","text":"\u8981\u6c42\uff1a \u64cd\u4f5cexcel \u52a0\u89e3\u5bc6excel\u67d0\u884c\u6570\u636e \u52a0\u89e3\u5bc6excel\u67d0\u5217\u6570\u636e #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Author : summer @File : \u52a0\u89e3\u5bc6.py @Software: PyCharm \"\"\" import os import base64 import openpyxl class encryption_decryption(): def __init__(self, filename, sheet_name=\"Sheet1\", row=None, column=None): self.filename = filename self.row = row self.column = column self.sheet_name = sheet_name self.row = row self.wb = None if not self.check_filename(): exit(\"%s \u6587\u4ef6\u4e0d\u5728\" % self.filename) def check_filename(self): flag = False if os.path.exists(self.filename): wb = openpyxl.load_workbook(self.filename) self.wb = wb flag = True return flag # \u52a0\u5bc6\u67d0\u884c\u6570\u636e def encryption_row(self): sheet = self.wb[self.sheet_name] # \u83b7\u53d6\u5230\u54ea\u4e00\u9875 for cell in list(sheet.rows)[self.row]: # \u7b2crow\u884c cell.value = base64.b64encode(str(cell.value).encode('UTF-8')) self.wb.save('\u52a0\u5bc6\u884c.xlsx') # \u89e3\u5bc6\u67d0\u884c\u6570\u636e def decryption_row(self): sheet = self.wb[self.sheet_name] # \u83b7\u53d6\u5230\u54ea\u4e00\u9875 for cell in list(sheet.rows)[self.row]: # \u7b2crow\u884c cell.value = str(base64.b64decode(cell.value), 'utf-8') self.wb.save('\u89e3\u5bc6\u884c.xlsx') # \u52a0\u5bc6\u67d0\u5217\u6570\u636e def encryption_column(self): sheet = self.wb[self.sheet_name] for cell in list(sheet.columns)[self.column]: # \u7b2ccolumn\u5217 cell.value = base64.b64encode(str(cell.value).encode('UTF-8')) self.wb.save('\u52a0\u5bc6\u5217.xlsx') # \u89e3\u5bc6\u67d0\u5217\u6570\u636e def decryption_column(self): sheet = self.wb[self.sheet_name] for cell in list(sheet.columns)[self.column]: # \u7b2ccolumn\u5217 cell.value = str(base64.b64decode(str(cell.value)), 'utf-8') self.wb.save('\u89e3\u5bc6\u5217.xlsx') if __name__ == '__main__': # \u52a0\u5bc6\u67d0\u884c obj = encryption_decryption(r\".\\example.xlsx\", \"Sheet1\", row=2) obj.encryption_row() # \u89e3\u5bc6\u67d0\u884c obj.decryption_row() # \u52a0\u5bc6\u67d0\u5217 obj = encryption_decryption(r\".\\example.xlsx\", column=2) obj.encryption_column() # \u89e3\u5bc6\u67d0\u5217 obj.decryption_column() \u6539\u8fdb\u7248 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/1/23 16:22 @File : \u52a0\u89e3\u5bc6.py @Software: PyCharm \"\"\" import os import base64 import openpyxl class encryption_decryption(): def __init__(self, filename, sheet_name=\"Sheet1\", row=None, column=None): self.filename = filename self.row = row self.column = column self.sheet_name = sheet_name self.row = row self.wb = None if not self.check_filename(): exit(\"%s \u6587\u4ef6\u4e0d\u5728\" % self.filename) def check_filename(self): if os.path.exists(self.filename): self.wb = openpyxl.load_workbook(self.filename) return True return False def base(self, col_row, mode, outfilename): sheet = self.wb[self.sheet_name] # \u83b7\u53d6\u5230\u54ea\u4e00\u9875 if col_row == \"\u884c\": # \u884c for cell in list(sheet.rows)[self.row]: if mode == \"\u52a0\u5bc6\": cell.value = base64.b64encode(str(cell.value).encode('UTF-8')) elif mode == \"\u89e3\u5bc6\": cell.value = str(base64.b64decode(cell.value), 'utf-8') else: exit(\"\u7f16\u7801\u65b9\u5f0f\u4e0d\u5bf9\u3002\u53ea\u80fd\u6709\uff0c\u52a0\u5bc6encrypt\u548c\u89e3\u5bc6decrypt\") elif col_row == \"\u5217\": for cell in list(sheet.columns)[self.column]: # \u7b2ccolumn\u5217 if mode == \"\u52a0\u5bc6\": cell.value = base64.b64encode(str(cell.value).encode('UTF-8')) elif mode == \"\u89e3\u5bc6\": cell.value = str(base64.b64decode(str(cell.value)), 'utf-8') else: exit(\"\u7f16\u7801\u65b9\u5f0f\u4e0d\u5bf9\u3002\u53ea\u80fd\u6709\uff0c\u52a0\u5bc6encrypt\u548c\u89e3\u5bc6decrypt\") else: exit(\"\u884c\u5217\u4e0d\u5bf9\u3002\u53ea\u80fd\u6709\u9009\u62e9\u52a0\u5bc6\u884c\u6216\u8005\u52a0\u5bc6\u5217\") self.wb.save(outfilename) def data(self, col_row, mode, outfilename): self.base(col_row, mode, outfilename) if __name__ == '__main__': # \u52a0\u89e3\u5bc6\u884c obj = encryption_decryption(r\".\\example.xlsx\", \"Sheet1\", row=2) obj.data(\"\u884c\", \"\u52a0\u5bc6\", \"\u52a0\u5bc6\u884c\u6d4b\u8bd5.xlsx\") obj.data(\"\u884c\", \"\u89e3\u5bc6\", \"\u89e3\u5bc6\u884c\u6d4b\u8bd5.xlsx\") # \u52a0\u89e3\u5bc6\u5217 obj = encryption_decryption(r\".\\example.xlsx\", \"Sheet1\", column=2) obj.data(\"\u5217\", \"\u52a0\u5bc6\", \"\u52a0\u5bc6\u5217\u6d4b\u8bd5.xlsx\") obj.data(\"\u5217\", \"\u89e3\u5bc6\", \"\u89e3\u5bc6\u5217\u6d4b\u8bd5.xlsx\")","title":"2. \u52a0\u89e3\u5bc6execl\u8868"},{"location":"python/lib/execel/1.xlrd_xlwt/","text":"\u7b80\u4ecb \u00b6 python\u64cd\u4f5cexcel\u4e3b\u8981\u7528\u5230xlrd\uff0cxlwt\u548cxlutils\u80fd\u5c06xlrd\u8fd9\u4e09\u4e2a\u5e93 - xlrd\u662f\u53ea\u80fd\u8bfbexcel\u7684\u5e93\uff0c - xlwt\u662f\u53ea\u80fd\u65b0\u5efaexcel\u7684\u5e93\u3002 - xlutils\u80fd\u5c06xlrd.Book\u8f6c\u4e3axlwt.Workbook\uff0c\u4ece\u800c\u5f97\u4ee5\u5728\u73b0\u6709xls\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u6570\u636e\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684xls\uff0c\u5b9e\u73b0\u4fee\u6539 pip install xlrd pip install xlwt pip install xlutils 1. xlrd\u5e93\u4f7f\u7528 \u00b6 Book(class) \u7531xlrd.open_work(\"example.xls\")\u8fd4\u56de nsheets: sheets\u6570 sheet_names: sheet\u540d\u79f0\u5217\u8868 sheets: sheet\u5217\u8868 sheet_by_index(sheetx): \u6309\u5e8f\u53f7\u63d0\u53d6sheet sheet_by_name(sheet_name): \u6309\u540d\u79f0\u63d0\u53d6sheet Sheet(class) \u7531Book object\u76f8\u5173\u65b9\u6cd5\u8fd4\u56de name: \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000sheet\u540d nrows: \u884c\u6570 ncols: \u5217\u6570 cell(rowx,colx): \u7b2crows\u884ccolx\u5217\u7684\u5355\u5143\u683c cell_type(rowx,colx): \u6570\u636e\u7c7b\u578b cell_value(rows,colx): \u6570\u503c col(colx): \u7b2ccolx\u5217\u6240\u6709\u5355\u5143\u683c\u7ec4\u6210\u7684\u5217\u8868 col_slice(colx,start_rowx=0,end_rowx=None): \u7b2ccolx\u5217\u6307\u5b9a\u5355\u5143\u683c\u7ec4\u6210\u7684\u5217\u8868 col_types(colx,start_rowx=0,end_rowx=None): \u7b2ccolx\u5217\u6307\u5b9a\u5355\u5143\u683c\u6570\u503c\u7c7b\u578b\u7ec4\u6210\u7684\u5217\u8868 col_values(colx,start_rowx=0,end_rowx=None): \u7b2ccolx\u5217\u6307\u5b9a\u5355\u5143\u683c\u6570\u503c\u7ec4\u6210\u7684\u5217\u8868 row\u540c\u6837\u6709col\u7684\u5404\u9879\u64cd\u4f5c\uff0c\u6b64\u5904\u7565\u53bb Cell(class) \u7531Sheet object(s)\u76f8\u5173\u65b9\u6cd5\u8fd4\u56de ctype: \u4e00\u4e2aint\u578b\u53d8\u91cf\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u6570\u503c\u7c7b\u578b value: \u5355\u5143\u683c\u7684\u503c 2. xlwt\u5e93\u4f7f\u7528 \u00b6 Workbook(class) \u7531xlwt.Workbook()\u8fd4\u56de encoding: \u7f16\u7801\u65b9\u6848 add_sheet(sheet_name): \u6dfb\u52a0sheet get_sheet(Sheet_name): \u9009\u62e9sheet save(file_name): \u4fdd\u5b58 Worksheet(class) \u7531Workbook object\u76f8\u5173\u65b9\u6cd5\u8fd4\u56de write(rows,colx,cell_value,style): \u7f16\u8f91\u5355\u5143\u683c row(rowx).write(colx,cell_value,style): \u7f16\u8f91\u884c flush_row_data(): \u51cf\u5c11\u5185\u5b58\u538b\u529b\uff0cflush\u4e4b\u524d\u884c\u4e0d\u53ef\u518d\u4fee\u6539 col(colx),write(rows,cell_value,style): \u7f16\u8f91\u5217 easyxf(function) \u521b\u5efaXFStyle instance\uff0c\u683c\u5f0f\u63a7\u5236 expression syntax: (<element>:(<attribute> <value>,)+;)+ <element> - <attribute> - <value>: \uff08\u52a0\u7c97\u4e3a\u9ed8\u8ba4\u683c\u5f0f\uff0c\u4ee5\u4e0b\u6240\u5217\u5e76\u975e\u5168\u90e8\uff09 font - bold - True or False - colour - {colour} - italic - True or False - name - name of the font, Arial - underline - True or False alignment - direction - general, lr, rl - horizontal - general, left, center, right, filled - vertical - bottom, top, center, justified, distributed - shrink_to_fit - True or False bolders - left - an integer width between 0 and 13 - right - an integer width between 0 and 13 - top - an integer width between 0 and 13 - bottom - an integer width between 0 and 13 - diag - an integer width between 0 and 13 - left_colour - {colour}*, automatic colour - right_colour - {colour}*, automatic colour - ... pattern - back_color - {colour}*, automatic colour - fore_colour - {colour}*, automatic colour - pattern - none, solid, fine_dots, sparse_dots {colous}*: black, (dark_)(light_)blue, gold, (dark_)(light_)green, ivory, lavender, (light_)orange, pink, (dark_)red, rose, violet, white, (dark_)(light_)yellow, ... 3. xlutils\u5e93\u4f7f\u7528 \u00b6 copy: \u5c06xlrd.Book\u8f6c\u4e3axlwt.Workbook styles: \u8bfb\u53d6xlrd.Workbook\u7684\u6bcf\u4e00\u4e2a\u5355\u5143\u683c\u7684style display: \u7b80\u5355\u800c\u5b89\u5168\u5730\u5448\u73b0xlrd\u8bfb\u53d6\u7684\u6570\u636e filter: \u62c6\u5206\u4e0e\u6574\u5408\u591a\u4e2axls\u6587\u4ef6 margins: \u67e5\u770b\u8868\u683c\u7a00\u758f\u7a0b\u5ea6 save: \u5e8f\u5217\u5316xlrd.Book\uff0c\u8f6c\u5b58\u4e3abinary xls\u6216stream tips 1. xlrd.open_workbook(fomatting_info=):\u5f53formatting_info=Ture\uff0c\u8bfb\u53d6workbook\u5e76\u4fdd\u7559\u683c\u5f0f 2. xlrd.open_workbook(on_demand=): \u5f53on_demand=True\uff0c\u53ea\u6709\u88ab\u8981\u6c42\u65f6\u624d\u5c06worksheet\u8f7d\u5165\u5185\u5b58\uff0c\u8bfb\u53d6\u5927\u6587\u4ef6\u65f6\u4f7f\u7528 3. xlwt.Worksheet.flush_row_data(): \u51cf\u5c11\u5185\u5b58\u5360\u7528\uff0c\u88ab\u5237\u65b0\u7684\u884c\u4e0d\u80fd\u518d\u8bbf\u95ee\u6216\u4fee\u6539\uff0c\u5efa\u8bae\u6bcf1000\u884c\u5237\u65b0\u4e00\u6b21\uff08\u82e5\u5217\u5f88\u591a\u5f53\u8c03\u6574\uff09 4. xlwt.Workbook(encoding=): \u9009\u62e9\u521b\u5efa\u7684workbook\u7684\u7f16\u7801 \u6848\u4f8b \u00b6 1.\u5bf9excel\u7684\u5199\u64cd\u4f5c\u5b9e\u4f8b\uff1a \u00b6 \u5c06\u4e00\u4e2a\u5217\u8868\u7684\u6570\u636e\u5199\u5165excel, \u7b2c\u4e00\u884c\u662f\u6807\u9898\uff0c\u4e0b\u9762\u884c\u6570\u5177\u4f53\u7684\u6570\u636e #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/1/23 14:08 @File : 1.py @Software: PyCharm \"\"\" import xlwt # \u53ea\u80fd\u5199\u4e0d\u80fd\u8bfb stus = [['\u59d3\u540d', '\u5e74\u9f84', '\u6027\u522b', '\u5206\u6570', '\u624b\u673a\u53f7\u7801'], ['\u5f20\u4e09', 22, '\u5973', 50, '12776238304'], ['\u674e\u56db', 25, '\u7537', 72.5, '11228374621'], ['\u738b\u4e94', 33, '\u7537', 100, '12372615263'], ['\u8d75\u516d', 42, '\u5973', 66.8, '11129374727'] ] book = xlwt.Workbook() # \u65b0\u5efa\u4e00\u4e2aexcel sheet = book.add_sheet('case1_sheet') # \u6dfb\u52a0\u4e00\u4e2asheet\u9875,\u9875\u540d\u5b57\u662fcase1_sheet row = 0 # \u63a7\u5236\u884c for stu in stus: col = 0 # \u63a7\u5236\u5217 for s in stu: # \u518d\u5faa\u73af\u91cc\u9762list\u7684\u503c\uff0c\u6bcf\u4e00\u5217 sheet.write(row, col, s) col += 1 row += 1 book.save('stu_1.xls') # \u4fdd\u5b58\u5230\u5f53\u524d\u76ee\u5f55\u4e0b \u8fd0\u884c\u7ed3\u679c D:\\code\\code-django\\\u5e93\\excel\u64cd\u4f5c \u7684\u76ee\u5f55 2019/01/23 14:12 <DIR> . 2019/01/23 14:12 <DIR> .. 2019/01/23 14:12 796 1.py 2019/01/23 14:12 5,632 stu_1.xls # \u4ea7\u751f\u8fd9\u4e2a\u6587\u4ef6 2019/01/23 14:08 129 __init__.py 3 \u4e2a\u6587\u4ef6 6,557 \u5b57\u8282 2 \u4e2a\u76ee\u5f55 28,743,331,840 \u53ef\u7528\u5b57\u8282 \u4fdd\u5b58\u7684excel\u8868\u683c stu_1.xls \u59d3\u540d \u5e74\u9f84 \u6027\u522b \u5206\u6570 \u624b\u673a\u53f7\u7801 \u5f20\u4e09 22 \u5973 50 12776238304 \u674e\u56db 25 \u7537 72.5 11228374621 \u738b\u4e94 33 \u7537 100 12372615263 \u8d75\u516d 42 \u5973 66.8 11129374727 2.\u5bf9excel \u7684\u8bfb\u64cd\u4f5c\uff1a \u00b6 import xlrd # \u53ea\u80fd\u8bfb\u4e0d\u80fd\u5199 book = xlrd.open_workbook('stu_1.xls') # \u6253\u5f00\u4e00\u4e2aexcel sheet = book.sheet_by_index(0) # \u6839\u636e\u987a\u5e8f\u83b7\u53d6sheet sheet2 = book.sheet_by_name('case1_sheet') # \u6839\u636esheet\u9875\u540d\u5b57\u83b7\u53d6sheet print(sheet.cell(0, 0).value) # \u6307\u5b9a\u884c\u548c\u5217\u83b7\u53d6\u6570\u636e print(sheet.cell(0, 1).value) print(sheet.cell(0, 2).value) print(sheet.cell(0, 3).value) print(sheet.ncols) # \u83b7\u53d6excel\u91cc\u9762\u6709\u591a\u5c11\u5217 print(sheet.nrows) # \u83b7\u53d6excel\u91cc\u9762\u6709\u591a\u5c11\u884c print(sheet.get_rows()) # for i in sheet.get_rows(): print(i) # \u83b7\u53d6\u6bcf\u4e00\u884c\u7684\u6570\u636e print(sheet.row_values(0)) # \u83b7\u53d6\u7b2c\u4e00\u884c for i in range(sheet.nrows): # 0 1 2 3 4 5 print(sheet.row_values(i)) # \u83b7\u53d6\u7b2c\u51e0\u884c\u7684\u6570\u636e print(sheet.col_values(1)) # \u53d6\u7b2c\u4e00\u5217\u7684\u6570\u636e for i in range(sheet.ncols): print(sheet.col_values(i)) # \u83b7\u53d6\u7b2c\u51e0\u5217\u7684\u6570\u636e \u8fd0\u884c\u7ed3\u679c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-django/\u5e93/excel\u64cd\u4f5c/read.py \u59d3\u540d \u5e74\u9f84 \u6027\u522b \u5206\u6570 5 5 <generator object Sheet.get_rows.<locals>.<genexpr> at 0x00000231D5D0D4F8> [text:'\u59d3\u540d', text:'\u5e74\u9f84', text:'\u6027\u522b', text:'\u5206\u6570', text:'\u624b\u673a\u53f7\u7801'] [text:'\u5f20\u4e09', number:22.0, text:'\u5973', number:50.0, text:'12776238304'] [text:'\u674e\u56db', number:25.0, text:'\u7537', number:72.5, text:'11228374621'] [text:'\u738b\u4e94', number:33.0, text:'\u7537', number:100.0, text:'12372615263'] [text:'\u8d75\u516d', number:42.0, text:'\u5973', number:66.8, text:'11129374727'] ['\u59d3\u540d', '\u5e74\u9f84', '\u6027\u522b', '\u5206\u6570', '\u624b\u673a\u53f7\u7801'] ['\u59d3\u540d', '\u5e74\u9f84', '\u6027\u522b', '\u5206\u6570', '\u624b\u673a\u53f7\u7801'] ['\u5f20\u4e09', 22.0, '\u5973', 50.0, '12776238304'] ['\u674e\u56db', 25.0, '\u7537', 72.5, '11228374621'] ['\u738b\u4e94', 33.0, '\u7537', 100.0, '12372615263'] ['\u8d75\u516d', 42.0, '\u5973', 66.8, '11129374727'] ['\u5e74\u9f84', 22.0, 25.0, 33.0, 42.0] ['\u59d3\u540d', '\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d'] ['\u5e74\u9f84', 22.0, 25.0, 33.0, 42.0] ['\u6027\u522b', '\u5973', '\u7537', '\u7537', '\u5973'] ['\u5206\u6570', 50.0, 72.5, 100.0, 66.8] ['\u624b\u673a\u53f7\u7801', '12776238304', '11228374621', '12372615263', '11129374727'] 3.\u5bf9excel\u7684\u4fee\u6539\u64cd\u4f5c\uff1a \u00b6 \u5c06excel\u4e2d\u7684\u67d0\u4e2a\u503c\u4fee\u6539\u5e76\u91cd\u65b0\u4fdd\u5b58 from xlutils.copy import copy import xlrd # xlutils:\u4fee\u6539excel book1 = xlrd.open_workbook('stu_1.xls') book2 = copy(book1) # \u62f7\u8d1d\u4e00\u4efd\u539f\u6765\u7684excel # print(dir(book2)) sheet = book2.get_sheet(0) # \u83b7\u53d6\u7b2c\u51e0\u4e2asheet\u9875\uff0cbook2\u73b0\u5728\u7684\u662fxlutils\u91cc\u7684\u65b9\u6cd5\uff0c\u4e0d\u662fxlrd\u7684 sheet.write(1, 3, 100) # \u4fee\u6539\u5206\u6570 sheet.write(1, 0, '\u5f20\u4e09\u4ed6\u59e5\u7237') # \u4fee\u6539\u59d3\u540d book2.save('stu.xls') \u8fd0\u884c\u540e\u7ed3\u679c \u59d3\u540d \u5e74\u9f84 \u6027\u522b \u5206\u6570 \u624b\u673a\u53f7\u7801 \u5f20\u4e09\u5979\u59e5\u7237 22 \u5973 100 12776238304 \u674e\u56db 25 \u7537 72.5 11228374621 \u738b\u4e94 33 \u7537 100 12372615263 \u8d75\u516d 42 \u5973 66.8 11129374727","title":"1. xlrd_xlwt"},{"location":"python/lib/execel/1.xlrd_xlwt/#_1","text":"python\u64cd\u4f5cexcel\u4e3b\u8981\u7528\u5230xlrd\uff0cxlwt\u548cxlutils\u80fd\u5c06xlrd\u8fd9\u4e09\u4e2a\u5e93 - xlrd\u662f\u53ea\u80fd\u8bfbexcel\u7684\u5e93\uff0c - xlwt\u662f\u53ea\u80fd\u65b0\u5efaexcel\u7684\u5e93\u3002 - xlutils\u80fd\u5c06xlrd.Book\u8f6c\u4e3axlwt.Workbook\uff0c\u4ece\u800c\u5f97\u4ee5\u5728\u73b0\u6709xls\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u6570\u636e\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684xls\uff0c\u5b9e\u73b0\u4fee\u6539 pip install xlrd pip install xlwt pip install xlutils","title":"\u7b80\u4ecb"},{"location":"python/lib/execel/1.xlrd_xlwt/#1-xlrd","text":"Book(class) \u7531xlrd.open_work(\"example.xls\")\u8fd4\u56de nsheets: sheets\u6570 sheet_names: sheet\u540d\u79f0\u5217\u8868 sheets: sheet\u5217\u8868 sheet_by_index(sheetx): \u6309\u5e8f\u53f7\u63d0\u53d6sheet sheet_by_name(sheet_name): \u6309\u540d\u79f0\u63d0\u53d6sheet Sheet(class) \u7531Book object\u76f8\u5173\u65b9\u6cd5\u8fd4\u56de name: \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000sheet\u540d nrows: \u884c\u6570 ncols: \u5217\u6570 cell(rowx,colx): \u7b2crows\u884ccolx\u5217\u7684\u5355\u5143\u683c cell_type(rowx,colx): \u6570\u636e\u7c7b\u578b cell_value(rows,colx): \u6570\u503c col(colx): \u7b2ccolx\u5217\u6240\u6709\u5355\u5143\u683c\u7ec4\u6210\u7684\u5217\u8868 col_slice(colx,start_rowx=0,end_rowx=None): \u7b2ccolx\u5217\u6307\u5b9a\u5355\u5143\u683c\u7ec4\u6210\u7684\u5217\u8868 col_types(colx,start_rowx=0,end_rowx=None): \u7b2ccolx\u5217\u6307\u5b9a\u5355\u5143\u683c\u6570\u503c\u7c7b\u578b\u7ec4\u6210\u7684\u5217\u8868 col_values(colx,start_rowx=0,end_rowx=None): \u7b2ccolx\u5217\u6307\u5b9a\u5355\u5143\u683c\u6570\u503c\u7ec4\u6210\u7684\u5217\u8868 row\u540c\u6837\u6709col\u7684\u5404\u9879\u64cd\u4f5c\uff0c\u6b64\u5904\u7565\u53bb Cell(class) \u7531Sheet object(s)\u76f8\u5173\u65b9\u6cd5\u8fd4\u56de ctype: \u4e00\u4e2aint\u578b\u53d8\u91cf\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u6570\u503c\u7c7b\u578b value: \u5355\u5143\u683c\u7684\u503c","title":"1. xlrd\u5e93\u4f7f\u7528"},{"location":"python/lib/execel/1.xlrd_xlwt/#2-xlwt","text":"Workbook(class) \u7531xlwt.Workbook()\u8fd4\u56de encoding: \u7f16\u7801\u65b9\u6848 add_sheet(sheet_name): \u6dfb\u52a0sheet get_sheet(Sheet_name): \u9009\u62e9sheet save(file_name): \u4fdd\u5b58 Worksheet(class) \u7531Workbook object\u76f8\u5173\u65b9\u6cd5\u8fd4\u56de write(rows,colx,cell_value,style): \u7f16\u8f91\u5355\u5143\u683c row(rowx).write(colx,cell_value,style): \u7f16\u8f91\u884c flush_row_data(): \u51cf\u5c11\u5185\u5b58\u538b\u529b\uff0cflush\u4e4b\u524d\u884c\u4e0d\u53ef\u518d\u4fee\u6539 col(colx),write(rows,cell_value,style): \u7f16\u8f91\u5217 easyxf(function) \u521b\u5efaXFStyle instance\uff0c\u683c\u5f0f\u63a7\u5236 expression syntax: (<element>:(<attribute> <value>,)+;)+ <element> - <attribute> - <value>: \uff08\u52a0\u7c97\u4e3a\u9ed8\u8ba4\u683c\u5f0f\uff0c\u4ee5\u4e0b\u6240\u5217\u5e76\u975e\u5168\u90e8\uff09 font - bold - True or False - colour - {colour} - italic - True or False - name - name of the font, Arial - underline - True or False alignment - direction - general, lr, rl - horizontal - general, left, center, right, filled - vertical - bottom, top, center, justified, distributed - shrink_to_fit - True or False bolders - left - an integer width between 0 and 13 - right - an integer width between 0 and 13 - top - an integer width between 0 and 13 - bottom - an integer width between 0 and 13 - diag - an integer width between 0 and 13 - left_colour - {colour}*, automatic colour - right_colour - {colour}*, automatic colour - ... pattern - back_color - {colour}*, automatic colour - fore_colour - {colour}*, automatic colour - pattern - none, solid, fine_dots, sparse_dots {colous}*: black, (dark_)(light_)blue, gold, (dark_)(light_)green, ivory, lavender, (light_)orange, pink, (dark_)red, rose, violet, white, (dark_)(light_)yellow, ...","title":"2. xlwt\u5e93\u4f7f\u7528"},{"location":"python/lib/execel/1.xlrd_xlwt/#3-xlutils","text":"copy: \u5c06xlrd.Book\u8f6c\u4e3axlwt.Workbook styles: \u8bfb\u53d6xlrd.Workbook\u7684\u6bcf\u4e00\u4e2a\u5355\u5143\u683c\u7684style display: \u7b80\u5355\u800c\u5b89\u5168\u5730\u5448\u73b0xlrd\u8bfb\u53d6\u7684\u6570\u636e filter: \u62c6\u5206\u4e0e\u6574\u5408\u591a\u4e2axls\u6587\u4ef6 margins: \u67e5\u770b\u8868\u683c\u7a00\u758f\u7a0b\u5ea6 save: \u5e8f\u5217\u5316xlrd.Book\uff0c\u8f6c\u5b58\u4e3abinary xls\u6216stream tips 1. xlrd.open_workbook(fomatting_info=):\u5f53formatting_info=Ture\uff0c\u8bfb\u53d6workbook\u5e76\u4fdd\u7559\u683c\u5f0f 2. xlrd.open_workbook(on_demand=): \u5f53on_demand=True\uff0c\u53ea\u6709\u88ab\u8981\u6c42\u65f6\u624d\u5c06worksheet\u8f7d\u5165\u5185\u5b58\uff0c\u8bfb\u53d6\u5927\u6587\u4ef6\u65f6\u4f7f\u7528 3. xlwt.Worksheet.flush_row_data(): \u51cf\u5c11\u5185\u5b58\u5360\u7528\uff0c\u88ab\u5237\u65b0\u7684\u884c\u4e0d\u80fd\u518d\u8bbf\u95ee\u6216\u4fee\u6539\uff0c\u5efa\u8bae\u6bcf1000\u884c\u5237\u65b0\u4e00\u6b21\uff08\u82e5\u5217\u5f88\u591a\u5f53\u8c03\u6574\uff09 4. xlwt.Workbook(encoding=): \u9009\u62e9\u521b\u5efa\u7684workbook\u7684\u7f16\u7801","title":"3. xlutils\u5e93\u4f7f\u7528"},{"location":"python/lib/execel/1.xlrd_xlwt/#_2","text":"","title":"\u6848\u4f8b"},{"location":"python/lib/execel/1.xlrd_xlwt/#1excel","text":"\u5c06\u4e00\u4e2a\u5217\u8868\u7684\u6570\u636e\u5199\u5165excel, \u7b2c\u4e00\u884c\u662f\u6807\u9898\uff0c\u4e0b\u9762\u884c\u6570\u5177\u4f53\u7684\u6570\u636e #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/1/23 14:08 @File : 1.py @Software: PyCharm \"\"\" import xlwt # \u53ea\u80fd\u5199\u4e0d\u80fd\u8bfb stus = [['\u59d3\u540d', '\u5e74\u9f84', '\u6027\u522b', '\u5206\u6570', '\u624b\u673a\u53f7\u7801'], ['\u5f20\u4e09', 22, '\u5973', 50, '12776238304'], ['\u674e\u56db', 25, '\u7537', 72.5, '11228374621'], ['\u738b\u4e94', 33, '\u7537', 100, '12372615263'], ['\u8d75\u516d', 42, '\u5973', 66.8, '11129374727'] ] book = xlwt.Workbook() # \u65b0\u5efa\u4e00\u4e2aexcel sheet = book.add_sheet('case1_sheet') # \u6dfb\u52a0\u4e00\u4e2asheet\u9875,\u9875\u540d\u5b57\u662fcase1_sheet row = 0 # \u63a7\u5236\u884c for stu in stus: col = 0 # \u63a7\u5236\u5217 for s in stu: # \u518d\u5faa\u73af\u91cc\u9762list\u7684\u503c\uff0c\u6bcf\u4e00\u5217 sheet.write(row, col, s) col += 1 row += 1 book.save('stu_1.xls') # \u4fdd\u5b58\u5230\u5f53\u524d\u76ee\u5f55\u4e0b \u8fd0\u884c\u7ed3\u679c D:\\code\\code-django\\\u5e93\\excel\u64cd\u4f5c \u7684\u76ee\u5f55 2019/01/23 14:12 <DIR> . 2019/01/23 14:12 <DIR> .. 2019/01/23 14:12 796 1.py 2019/01/23 14:12 5,632 stu_1.xls # \u4ea7\u751f\u8fd9\u4e2a\u6587\u4ef6 2019/01/23 14:08 129 __init__.py 3 \u4e2a\u6587\u4ef6 6,557 \u5b57\u8282 2 \u4e2a\u76ee\u5f55 28,743,331,840 \u53ef\u7528\u5b57\u8282 \u4fdd\u5b58\u7684excel\u8868\u683c stu_1.xls \u59d3\u540d \u5e74\u9f84 \u6027\u522b \u5206\u6570 \u624b\u673a\u53f7\u7801 \u5f20\u4e09 22 \u5973 50 12776238304 \u674e\u56db 25 \u7537 72.5 11228374621 \u738b\u4e94 33 \u7537 100 12372615263 \u8d75\u516d 42 \u5973 66.8 11129374727","title":"1.\u5bf9excel\u7684\u5199\u64cd\u4f5c\u5b9e\u4f8b\uff1a"},{"location":"python/lib/execel/1.xlrd_xlwt/#2excel","text":"import xlrd # \u53ea\u80fd\u8bfb\u4e0d\u80fd\u5199 book = xlrd.open_workbook('stu_1.xls') # \u6253\u5f00\u4e00\u4e2aexcel sheet = book.sheet_by_index(0) # \u6839\u636e\u987a\u5e8f\u83b7\u53d6sheet sheet2 = book.sheet_by_name('case1_sheet') # \u6839\u636esheet\u9875\u540d\u5b57\u83b7\u53d6sheet print(sheet.cell(0, 0).value) # \u6307\u5b9a\u884c\u548c\u5217\u83b7\u53d6\u6570\u636e print(sheet.cell(0, 1).value) print(sheet.cell(0, 2).value) print(sheet.cell(0, 3).value) print(sheet.ncols) # \u83b7\u53d6excel\u91cc\u9762\u6709\u591a\u5c11\u5217 print(sheet.nrows) # \u83b7\u53d6excel\u91cc\u9762\u6709\u591a\u5c11\u884c print(sheet.get_rows()) # for i in sheet.get_rows(): print(i) # \u83b7\u53d6\u6bcf\u4e00\u884c\u7684\u6570\u636e print(sheet.row_values(0)) # \u83b7\u53d6\u7b2c\u4e00\u884c for i in range(sheet.nrows): # 0 1 2 3 4 5 print(sheet.row_values(i)) # \u83b7\u53d6\u7b2c\u51e0\u884c\u7684\u6570\u636e print(sheet.col_values(1)) # \u53d6\u7b2c\u4e00\u5217\u7684\u6570\u636e for i in range(sheet.ncols): print(sheet.col_values(i)) # \u83b7\u53d6\u7b2c\u51e0\u5217\u7684\u6570\u636e \u8fd0\u884c\u7ed3\u679c \"C:\\Program Files\\Python37\\python.exe\" D:/code/code-django/\u5e93/excel\u64cd\u4f5c/read.py \u59d3\u540d \u5e74\u9f84 \u6027\u522b \u5206\u6570 5 5 <generator object Sheet.get_rows.<locals>.<genexpr> at 0x00000231D5D0D4F8> [text:'\u59d3\u540d', text:'\u5e74\u9f84', text:'\u6027\u522b', text:'\u5206\u6570', text:'\u624b\u673a\u53f7\u7801'] [text:'\u5f20\u4e09', number:22.0, text:'\u5973', number:50.0, text:'12776238304'] [text:'\u674e\u56db', number:25.0, text:'\u7537', number:72.5, text:'11228374621'] [text:'\u738b\u4e94', number:33.0, text:'\u7537', number:100.0, text:'12372615263'] [text:'\u8d75\u516d', number:42.0, text:'\u5973', number:66.8, text:'11129374727'] ['\u59d3\u540d', '\u5e74\u9f84', '\u6027\u522b', '\u5206\u6570', '\u624b\u673a\u53f7\u7801'] ['\u59d3\u540d', '\u5e74\u9f84', '\u6027\u522b', '\u5206\u6570', '\u624b\u673a\u53f7\u7801'] ['\u5f20\u4e09', 22.0, '\u5973', 50.0, '12776238304'] ['\u674e\u56db', 25.0, '\u7537', 72.5, '11228374621'] ['\u738b\u4e94', 33.0, '\u7537', 100.0, '12372615263'] ['\u8d75\u516d', 42.0, '\u5973', 66.8, '11129374727'] ['\u5e74\u9f84', 22.0, 25.0, 33.0, 42.0] ['\u59d3\u540d', '\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d'] ['\u5e74\u9f84', 22.0, 25.0, 33.0, 42.0] ['\u6027\u522b', '\u5973', '\u7537', '\u7537', '\u5973'] ['\u5206\u6570', 50.0, 72.5, 100.0, 66.8] ['\u624b\u673a\u53f7\u7801', '12776238304', '11228374621', '12372615263', '11129374727']","title":"2.\u5bf9excel \u7684\u8bfb\u64cd\u4f5c\uff1a"},{"location":"python/lib/execel/1.xlrd_xlwt/#3excel","text":"\u5c06excel\u4e2d\u7684\u67d0\u4e2a\u503c\u4fee\u6539\u5e76\u91cd\u65b0\u4fdd\u5b58 from xlutils.copy import copy import xlrd # xlutils:\u4fee\u6539excel book1 = xlrd.open_workbook('stu_1.xls') book2 = copy(book1) # \u62f7\u8d1d\u4e00\u4efd\u539f\u6765\u7684excel # print(dir(book2)) sheet = book2.get_sheet(0) # \u83b7\u53d6\u7b2c\u51e0\u4e2asheet\u9875\uff0cbook2\u73b0\u5728\u7684\u662fxlutils\u91cc\u7684\u65b9\u6cd5\uff0c\u4e0d\u662fxlrd\u7684 sheet.write(1, 3, 100) # \u4fee\u6539\u5206\u6570 sheet.write(1, 0, '\u5f20\u4e09\u4ed6\u59e5\u7237') # \u4fee\u6539\u59d3\u540d book2.save('stu.xls') \u8fd0\u884c\u540e\u7ed3\u679c \u59d3\u540d \u5e74\u9f84 \u6027\u522b \u5206\u6570 \u624b\u673a\u53f7\u7801 \u5f20\u4e09\u5979\u59e5\u7237 22 \u5973 100 12776238304 \u674e\u56db 25 \u7537 72.5 11228374621 \u738b\u4e94 33 \u7537 100 12372615263 \u8d75\u516d 42 \u5973 66.8 11129374727","title":"3.\u5bf9excel\u7684\u4fee\u6539\u64cd\u4f5c\uff1a"},{"location":"python/lib/execel/2.openpyxl/","text":"openpyxl\u6a21\u5757\u4ecb\u7ecd \u00b6 openpyxl\u6a21\u5757\u662f\u4e00\u4e2a\u8bfb\u5199Excel 2010\u6587\u6863\u7684Python\u5e93\uff0c\u5982\u679c\u8981\u5904\u7406\u66f4\u65e9\u683c\u5f0f\u7684Excel\u6587\u6863\uff0c\u9700\u8981\u7528\u5230\u989d\u5916\u7684\u5e93\uff0c openpyxl\u662f\u4e00\u4e2a\u6bd4\u8f83\u7efc\u5408\u7684\u5de5\u5177\uff0c\u80fd\u591f\u540c\u65f6\u8bfb\u53d6\u548c\u4fee\u6539Excel\u6587\u6863\u3002\u5176\u4ed6\u5f88\u591a\u7684\u4e0eExcel\u76f8\u5173\u7684\u9879\u76ee\u57fa\u672c\u53ea\u652f\u6301\u8bfb\u6216\u8005\u5199Excel\u4e00\u79cd\u529f\u80fd\u3002 Excel\u6570\u636e\u7684\u7c7b\u578b\u53ca\u7ec4\u7ec7\u65b9\u5f0f \u00b6 openpyxl\u4e2d\u5b9a\u4e49\u4e86\u591a\u79cd\u6570\u636e\u683c\u5f0f\uff0c\u6211\u53ea\u6d89\u53ca\u5230\u4e86\u5176\u4e2d\u6700\u91cd\u8981\u7684\u4e09\u79cd\uff1a - NULL\uff1a \u7a7a\u503c\uff0c\u5bf9\u5e94\u4e8epython\u4e2d\u7684None\uff0c\u8868\u793a\u8fd9\u4e2acell\u91cc\u9762\u6ca1\u6709\u6570\u636e\u3002 - numberic\uff1a \u6570\u5b57\u578b\uff0c\u7edf\u4e00\u6309\u7167\u6d6e\u70b9\u6570\u6765\u8fdb\u884c\u5904\u7406\u3002\u5bf9\u5e94\u4e8epython\u4e2d\u7684float\u3002 - string\uff1a \u5b57\u7b26\u4e32\u578b\uff0c\u5bf9\u5e94\u4e8epython\u4e2d\u7684unicode\u3002 \u6bcf\u4e00\u4e2aExcel\u6570\u636e\u6587\u4ef6\u4ece\u4e0a\u81f3\u4e0b\u5206\u4e3a\u4e09\u4e2a\u5c42\u7ea7\u7684\u5bf9\u8c61\uff1a - workbook\uff1a \u6bcf\u4e00\u4e2aExcel\u6587\u4ef6\u5c31\u662f\u4e00\u4e2aworkbook\u3002 - sheet\uff1a \u6bcf\u4e00\u4e2aworkbook\u4e2d\u53ef\u4ee5\u5305\u542b\u591a\u4e2asheet\uff0c\u5177\u4f53\u5c31\u5bf9\u5e94Excel\u4e2d\u6211\u4eec\u5728\u5de6\u4e0b\u811a\u6240\u770b\u5230\u7684\u201csheet1\u201d,\u201csheet2\u201d\u7b49\u3002 - cell\uff1a \u6bcf\u4e00\u4e2asheet\u5c31\u662f\u6211\u4eec\u901a\u5e38\u6240\u770b\u5230\u7684\u4e00\u4e2a\u8868\u683c\uff0c\u53ef\u4ee5\u542b\u6709m\u884c\uff0cn\u5217\uff0c\u6bcf\u4e2a\u786e\u5b9a\u7684\u884c\u53f7\uff0c\u5217\u53f7\u6240\u5bf9\u5e94\u7684\u4e00\u4e2a\u683c\u5b50\u5c31\u662f\u4e00\u4e2acell\u3002 \u5b89\u88c5openpyxl\u6a21\u5757 \u00b6 pip3 install openpyxl openpyxl\u57fa\u672c\u7528\u6cd5 \u00b6 \u60f3\u8981\u64cd\u4f5cExcel\u9996\u5148\u8981\u4e86\u89e3Excel\u57fa\u672c\u6982\u5ff5\uff0cExcel\u4e2d\u5217\u4ee5\u5b57\u5e55\u547d\u540d\uff0c\u884c\u4ee5\u6570\u5b57\u547d\u540d\uff0c\u6bd4\u5982\u5de6\u4e0a\u89d2\u7b2c\u4e00\u4e2a\u5355\u5143\u683c\u7684\u5750\u6807\u4e3aA1\uff0c\u4e0b\u9762\u7684\u4e3aA2\uff0c\u53f3\u8fb9\u7684B1\u3002 openpyxl\u4e2d\u6709\u4e09\u4e2a\u4e0d\u540c\u5c42\u6b21\u7684\u7c7b\uff0cWorkbook\u662f\u5bf9\u5de5\u4f5c\u7c3f\u7684\u62bd\u8c61\uff0cWorksheet\u662f\u5bf9\u8868\u683c\u7684\u62bd\u8c61\uff0c Cell\u662f\u5bf9\u5355\u5143\u683c\u7684\u62bd\u8c61\uff0c\u6bcf\u4e00\u4e2a\u7c7b\u90fd\u5305\u542b\u4e86\u8bb8\u591a\u5c5e\u6027\u548c\u65b9\u6cd5\u3002 \u64cd\u4f5cExcel\u7684\u4e00\u822c\u573a\u666f: \u00b6 \u6253\u5f00\u6216\u8005\u521b\u5efa\u4e00\u4e2aExcel\u9700\u8981\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61 \u83b7\u53d6\u4e00\u4e2a\u8868\u5219\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61\uff0c\u7136\u540e\u4f7f\u7528\u8be5\u5bf9\u8c61\u7684\u65b9\u6cd5\u6765\u5f97\u5230\u4e00\u4e2aWorksheet\u5bf9\u8c61 \u5982\u679c\u8981\u83b7\u53d6\u8868\u4e2d\u7684\u6570\u636e\uff0c\u90a3\u4e48\u5f97\u5230Worksheet\u5bf9\u8c61\u4ee5\u540e\u518d\u4ece\u4e2d\u83b7\u53d6\u4ee3\u8868\u5355\u5143\u683c\u7684Cell\u5bf9\u8c61 Workbook\u5bf9\u8c61\u4e00\u4e2aWorkbook\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2aExcel\u6587\u6863\uff0c\u56e0\u6b64\u5728\u64cd\u4f5cExcel\u4e4b\u524d\uff0c\u90fd\u5e94\u8be5\u5148\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61\u3002 \u5bf9\u4e8e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Excel\u6587\u6863\uff0c\u76f4\u63a5\u8fdb\u884cWorkbook\u7c7b\u7684\u8c03\u7528\u5373\u53ef\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684Excel\u6587\u6863\uff0c \u53ef\u4ee5\u4f7f\u7528openpyxl\u6a21\u5757\u7684load_workbook\u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\uff0c\u8be5\u51fd\u6570\u5305\u6db5\u591a\u4e2a\u53c2\u6570\uff0c\u4f46\u53ea\u6709filename\u53c2\u6570\u4e3a\u5fc5\u4f20\u53c2\u6570\u3002filename \u662f\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u5bf9\u8c61\u3002 Workbook\u5bf9\u8c61 \u00b6 \u4e00\u4e2aWorkbook\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2aExcel\u6587\u6863\uff0c\u56e0\u6b64\u5728\u64cd\u4f5cExcel\u4e4b\u524d\uff0c\u90fd\u5e94\u8be5\u5148\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61\u3002 \u5bf9\u4e8e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Excel\u6587\u6863\uff0c\u76f4\u63a5\u8fdb\u884cWorkbook\u7c7b\u7684\u8c03\u7528\u5373\u53ef\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684Excel\u6587\u6863\uff0c \u53ef\u4ee5\u4f7f\u7528openpyxl\u6a21\u5757\u7684load_workbook\u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\uff0c\u8be5\u51fd\u6570\u5305\u6db5\u591a\u4e2a\u53c2\u6570\uff0c\u4f46\u53ea\u6709filename\u53c2\u6570\u4e3a\u5fc5\u4f20\u53c2\u6570\u3002 filename \u662f\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u5bf9\u8c61\u3002 PS\uff1aWorkbook\u548cload_workbook\u76f8\u540c\uff0c\u8fd4\u56de\u7684\u90fd\u662f\u4e00\u4e2aWorkbook\u5bf9\u8c61 Workbook\u5bf9\u8c61\u63d0\u4f9b\u4e86\u5f88\u591a\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u5176\u4e2d\uff0c\u5927\u90e8\u5206\u65b9\u6cd5\u90fd\u4e0esheet\u6709\u5173\uff0c\u90e8\u5206\u5c5e\u6027\u5982\u4e0b\uff1a active\uff1a \u83b7\u53d6\u5f53\u524d\u6d3b\u8dc3\u7684Worksheet worksheets\uff1a\u4ee5\u5217\u8868\u7684\u5f62\u5f0f\u8fd4\u56de\u6240\u6709\u7684Worksheet(\u8868\u683c) read_only\uff1a \u5224\u65ad\u662f\u5426\u4ee5read_only\u6a21\u5f0f\u6253\u5f00Excel\u6587\u6863 encoding\uff1a \u83b7\u53d6\u6587\u6863\u7684\u5b57\u7b26\u96c6\u7f16\u7801 properties\uff1a\u83b7\u53d6\u6587\u6863\u7684\u5143\u6570\u636e\uff0c\u5982\u6807\u9898\uff0c\u521b\u5efa\u8005\uff0c\u521b\u5efa\u65e5\u671f\u7b49 sheetnames\uff1a\u83b7\u53d6\u5de5\u4f5c\u7c3f\u4e2d\u7684\u8868\uff08\u5217\u8868\uff09 - \u4f8b\u5b50 import openpyxl excel2 = openpyxl.load_workbook(\"example.xlsx\") excel2.active print(\"excel2 = \", excel2) print(\"excel2.read_only = \",excel2.read_only) print(\"excel2.worksheets = \",excel2.worksheets) print(\"excel2.properties = \",excel2.properties) print(\"excel2.encoding = \",excel2.encoding) \u8fd0\u884c\u7ed3\u679c excel2 = <openpyxl.workbook.workbook.Workbook object at 0x000001B072D2D7F0> excel2.read_only = False excel2.worksheets = [<Worksheet \"Sheet1\">, <Worksheet \"Sheet2\">, <Worksheet \"Sheet3\">] excel2.properties = <openpyxl.packaging.core.DocumentProperties object> Parameters: creator='cmz', title=None, description=None, subject=None, identifier=None, language=None, created=datetime.datetime(2019, 1, 23, 7, 26), modified=datetime.datetime(2019, 1, 23, 7, 26, 46), lastModifiedBy='\u7231\u4e00\u76f4\u5728\u7ebf1409537494', category=None, contentStatus=None, version=None, revision=None, keywords=None, lastPrinted=None excel2.encoding = utf-8 Workbook\u63d0\u4f9b\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a get_sheet_names\uff1a\u83b7\u53d6\u6240\u6709\u8868\u683c\u7684\u540d\u79f0(\u65b0\u7248\u5df2\u7ecf\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u901a\u8fc7Workbook\u7684sheetnames\u5c5e\u6027\u5373\u53ef\u83b7\u53d6) get_sheet_by_name\uff1a\u901a\u8fc7\u8868\u683c\u540d\u79f0\u83b7\u53d6Worksheet\u5bf9\u8c61(\u65b0\u7248\u4e5f\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u901a\u8fc7Worksheet[\u2018\u8868\u540d\u2018]\u83b7\u53d6) get_active_sheet\uff1a\u83b7\u53d6\u6d3b\u8dc3\u7684\u8868\u683c(\u65b0\u7248\u5efa\u8bae\u901a\u8fc7active\u5c5e\u6027\u83b7\u53d6) remove_sheet\uff1a\u5220\u9664\u4e00\u4e2a\u8868\u683c create_sheet\uff1a\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u8868\u683c copy_worksheet\uff1a\u5728Workbook\u5185\u62f7\u8d1d\u8868\u683c Worksheet\u5bf9\u8c61 \u6709\u4e86Worksheet\u5bf9\u8c61\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2aWorksheet\u5bf9\u8c61\u83b7\u53d6\u8868\u683c\u7684\u5c5e\u6027\uff0c\u5f97\u5230\u5355\u5143\u683c\u4e2d\u7684\u6570\u636e\uff0c\u4fee\u6539\u8868\u683c\u4e2d\u7684\u5185\u5bb9\u3002openpyxl\u63d0\u4f9b\u4e86\u975e\u5e38\u7075\u6d3b\u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u8868\u683c\u4e2d\u7684\u5355\u5143\u683c\u548c\u6570\u636e\uff0c\u5e38\u7528\u7684Worksheet\u5c5e\u6027\u5982\u4e0b\uff1a title \uff1a\u8868\u683c\u7684\u6807\u9898 dimensions \uff1a\u8868\u683c\u7684\u5927\u5c0f\uff0c\u8fd9\u91cc\u7684\u5927\u5c0f\u662f\u6307\u542b\u6709\u6570\u636e\u7684\u8868\u683c\u7684\u5927\u5c0f\uff0c\u5373\uff1a\u5de6\u4e0a\u89d2\u7684\u5750\u6807:\u53f3\u4e0b\u89d2\u7684\u5750\u6807 max_row \uff1a\u8868\u683c\u7684\u6700\u5927\u884c min_row \uff1a\u8868\u683c\u7684\u6700\u5c0f\u884c max_column \uff1a\u8868\u683c\u7684\u6700\u5927\u5217 min_column \uff1a\u8868\u683c\u7684\u6700\u5c0f\u5217 rows \uff1a\u6309\u884c\u83b7\u53d6\u5355\u5143\u683c(Cell\u5bf9\u8c61) - \u751f\u6210\u5668 columns \uff1a\u6309\u5217\u83b7\u53d6\u5355\u5143\u683c(Cell\u5bf9\u8c61) - \u751f\u6210\u5668 freeze_panes \uff1a\u51bb\u7ed3\u7a97\u683c values \uff1a\u6309\u884c\u83b7\u53d6\u8868\u683c\u7684\u5185\u5bb9(\u6570\u636e) - \u751f\u6210\u5668 Cell\u5bf9\u8c61 Cell\u5bf9\u8c61\u6bd4\u8f83\u7b80\u5355\uff0c\u5e38\u7528\u7684\u5c5e\u6027\u5982\u4e0b: row \uff1a\u5355\u5143\u683c\u6240\u5728\u7684\u884c column \uff1a\u5355\u5143\u683c\u5750\u5728\u7684\u5217 value \uff1a\u5355\u5143\u683c\u7684\u503c coordinate\uff1a\u5355\u5143\u683c\u7684\u5750\u6807 print(excel2['Sheet1'].cell(row=1,column=2).row) print(excel2['Sheet1'].cell(row=1,column=2).column) print(excel2['Sheet1'].cell(row=1,column=2).value) print(excel2['Sheet1'].cell(row=1,column=2).coordinate) \u7ed3\u679c 1 B \u5e74\u9f84 B1 1. \u8bfb\u53d6Excel\u6587\u6863 \u00b6 \u901a\u8fc7\u8c03\u7528\u65b9\u6cd5load_workbook(filename)\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6\uff0c\u8be5\u65b9\u6cd5\u4e2d\u8fd8\u6709\u4e00\u4e2aread_only\u53c2\u6570\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u6253\u5f00\u65b9\u5f0f\uff0c \u9ed8\u8ba4\u4e3a\u53ef\u8bfb\u53ef\u5199\uff0c\u8be5\u65b9\u6cd5\u6700\u7ec8\u5c06\u8fd4\u56de\u4e00\u4e2aworkbook\u7684\u6570\u636e\u5bf9\u8c61 # \u6587\u4ef6\u5fc5\u987b\u662fxlsx\u683c\u5f0f\uff0c\u5982\u679c\u662f\u5176\u4ed6\u683c\u5f0f\u5728\u6267\u884c\u524d\u53ef\u5229\u7528win32\u8f85\u52a9\u8f6c\u5316 wb = openpyxl.load_workbook('example.xlsx') 1.1 \u83b7\u53d6\u5de5\u4f5c\u8868 \u00b6 \u6bcf\u4e00\u4e2aExcel\u8868\u683c\u4e2d\u90fd\u4f1a\u6709\u5f88\u591a\u5f20sheet\u5de5\u4f5c\u8868\uff0c\u5728\u5bf9\u8868\u683c\u64cd\u4f5c\u524d\u9700\u8981\u5148\u9009\u5b9a\u4e00\u5f20\u5de5\u4f5c\u8868 # \u83b7\u53d6\u6240\u6709\u5de5\u4f5c\u8868\u540d(\u8fd4\u56de\u4e00\u4e2a\u5217\u8868) sheets = wb.get_sheet_names() # \u83b7\u53d6\u67d0\u4e00\u7279\u5b9a\u7684\u5de5\u4f5c\u8868 sheet = wb.get_sheet_by_name('Sheet2') # \u8fc7\u65f6\u5199\u6cd5 sheet = wb['Sheet1'] # \u73b0\u5728\u5199\u6cd5 # \u83b7\u53d6\u5de5\u4f5c\u8868\u7684\u8868\u540d sheet_name = sheet.title # \u4e00\u822c\u6765\u8bf4\uff0c\u8868\u683c\u5927\u591a\u6570\u7528\u5230\u7684\u662f\u6253\u5f00\u65f6\u663e\u793a\u7684\u5de5\u4f5c\u8868\uff0c\u8fd9\u65f6\u53ef\u4ee5\u7528active\u6765\u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u8868 sheet = wb.active 1.2 \u83b7\u53d6\u5355\u5143\u683c \u00b6 \u5bf9Excel\u8868\u683c\u7684\u64cd\u4f5c\u6700\u7ec8\u90fd\u843d\u4e8e\u5bf9\u5355\u5143\u683c\u7684\u64cd\u4f5c\uff0c\u83b7\u53d6\u5355\u5143\u683c\u6709\u4e24\u79cd\u83b7\u53d6\u65b9\u6cd5\uff1asheet[\u5217\u884c\u540d]\u548csheet.cell(row,column) # \u901a\u8fc7sheet[\u5217\u884c\u540d]\u83b7\u53d6 a = sheet['A2'] # \u901a\u8fc7sheet.cell(row,column)\u83b7\u53d6 b = sheet.cell(1, 2) # \u5373sheet['B1'] # \u83b7\u53d6\u5355\u5143\u683c\u5185\u5bb9 print(a.value) # \u83b7\u53d6\u5355\u5143\u683c\u6240\u5728\u5217\u548c\u884c print('a is '+str((a.column,a.row))) \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0csheet.cell(row,column)\u4e2d\u53c2\u6570\u5206\u522b\u662f\u884c\u548c\u5217\uff0c\u4e14\u5fc5\u987b\u4e3a\u6574\u6570\uff0c\u5982\u679c\u5217\u4e3a\u82f1\u6587\u5b57\u6bcd\uff0c\u53ef\u4ee5\u5229\u7528 openpyxl.utils \u4e2d\u7684 column_index_from_string(char)\u8fdb\u884c\u5b57\u6bcd\u6570\u5b57\u7684\u8f6c\u5316\u3002\u987a\u4fbf\u4e00\u8bf4\uff0c\u540c\u7406\u4e5f\u53ef\u4ee5\u5229\u7528get_column_letter(number)\u8fdb\u884c\u6570\u5b57\u5b57\u6bcd\u95f4\u7684\u8f6c\u5316 from openpyxl.utils import get_column_letter, column_index_from_string # \u5bf9\u5217\u8fdb\u884c\u5b57\u6bcd/\u6570\u5b57\u8f6c\u5316 c_num = column_index_from_string('B') # c_num = 2 c_char = get_column_letter(5) # c_char = 'E\u2018 1.3 \u83b7\u53d6\u884c\u548c\u5217 \u00b6 \u5728\u5904\u7406Excel\u8868\u683c\u6709\u65f6\u53ef\u80fd\u9700\u8981\u5bf9\u8868\u683c\u8fdb\u884c\u904d\u5386\u67e5\u627e\uff0copenpyxl\u4e2d\u4fbf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u884c\u548c\u5217\u7684\u751f\u6210\u5668(sheet.rows\u548csheet.columns),\u8fd9\u4e24\u4e2a\u751f\u6210\u5668\u91cc\u9762\u662f\u6bcf\u4e00\u884c\uff08\u6216\u5217\uff09\u7684\u6570\u636e\uff0c\u6bcf\u4e00\u884c\uff08\u6216\u5217\uff09\u53c8\u7531\u4e00\u4e2atuple\u5305\u88f9\uff0c\u501f\u6b64\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5b8c\u6210\u5bf9\u884c\u548c\u5217\u7684\u904d\u5386 # \u5bf9\u884c\u8fdb\u884c\u904d\u5386,\u8f93\u51faA1,B1,C1 for row in sheet.rows: for cell in row: print(cell.value) # \u5bf9\u5217\u8fdb\u884c\u904d\u5386,\u8f93\u51faA1,A2,A3 for column in sheet.columns: for cell in column: print(cell.value) tip \u5b66\u4e60\u65f6\u8fd8\u53d1\u73b0\u4e5f\u53ef\u4ee5\u901a\u8fc7list(sheet.rows)[index](\u6216list(sheet.columns)[index])\u5bf9\u67d0\u4e00\u884c\u6216\u5217\u8fdb\u884c\u904d\u5386\uff0c\u800c\u5728\u6b64\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8esheet.rows(\u6216sheet.columns)\u662f\u751f\u6210\u5668\u7c7b\u578b\uff0c\u662f\u4e0d\u80fd\u76f4\u63a5\u8c03\u7528\u7684\uff0c\u9700\u5c06\u5176\u8f6c\u5316\u4e3a\u4e00\u4e2alist\u7c7b\u578b\uff0c\u7136\u540e\u518d\u901a\u8fc7\u7d22\u5f15\u904d\u5386 # \u5bf9\u67d0\u4e00\u7279\u5b9a\u7684\u884c\u8fdb\u884c\u904d\u5386 for cell in list(sheet.rows)[0]: # \u7b2c0\u884c print(cell.value) # \u5bf9\u67d0\u4e00\u7279\u5b9a\u7684\u5217\u8fdb\u884c\u904d\u5386 for cell in list(sheet.columns)[0]: # \u7b2c0\u5217 print(cell.value) \u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528sheet[\u884c\u5217\u503c:\u884c\u5217\u503c]\u6765\u5bf9\u7ed9\u5b9a\u5355\u5143\u683c\u8303\u56f4\u8fdb\u884c\u904d\u5386 # \u5bf9\u67d0\u4e00\u5355\u5143\u683c\u8303\u56f4\u8fdb\u884c\u904d\u5386 for spaces in sheet['A1':'B2']: for cell in spaces: print(cell.value) \u53e6\u5916\uff0c\u6709\u65f6\u5019\u6211\u4eec\u8fd8\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8868\u683c\u7684\u5927\u5c0f\uff0c\u5373\u83b7\u53d6\u8868\u683c\u884c\u548c\u5217\u7684\u6700\u5927\u503c\uff0c\u53ef\u4ee5\u7528max_row\u548cmax_column\u6765\u83b7\u53d6 # \u83b7\u5f97\u6700\u5927\u5217\u548c\u6700\u5927\u884c print(sheet.max_row) print(sheet.max_column) 2. \u6863\u5199\u5165Excel\u6587\u6863 \u00b6 \u5728\u5f00\u5934\u8bfb\u53d6\u65f6\u5df2\u7ecf\u4ecb\u7ecd\uff0c\u9ed8\u8ba4\u7684\u6253\u5f00\u65b9\u5f0f\u4e3a\u53ef\u8bfb\u53ef\u5199\uff0c\u90a3\u4e48\u4f7f\u7528load_workbook(filename)\u8bfb\u53d6Excel\u6587\u6863\u540e\u4e5f\u5c31\u53ef\u4ee5\u76f4\u63a5\u5199\u5165\u4e86\u3002\u53e6\u5916\uff0c\u5982\u679c\u9700\u8981\u65b0\u5efa\u4e00\u4e2aExcel\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528Workbook()\u65b9\u6cd5\uff0c\u540c\u65f6\u5b83\u4f1a\u81ea\u52a8\u63d0\u4f9b\u4e00\u4e2asheet\u5de5\u4f5c\u8868\u3002\u5bf9\u4e8e\u5220\u9664\u4e00\u4e2a\u5de5\u4f5c\u8868\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528workbook\u5bf9\u8c61\u7684remove(sheet)\u65b9\u6cd5\u5220\u9664 # \u65b0\u5efa\u4e00\u4e2aExcel\u6587\u6863 wb = openpyxl.Workbook() # \u5220\u9664\u67d0\u4e2a\u5de5\u4f5c\u8868 wb.remove(sheet) 2.1 \u5199\u5165\u5355\u5143\u683c \u00b6 \u83b7\u53d6\u5de5\u4f5c\u8868\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u5982\u679c\u4f7f\u7528load_workbook(filename)\u8bfb\u53d6\uff0c\u90a3\u4e48\u83b7\u53d6\u5de5\u4f5c\u8868\u540e\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7sheet[\u884c\u5217\u503c]\u5199\u5165\u5355\u5143\u683c\u3002\u5b66\u4e60\u65f6\uff0c\u6709\u8d44\u6599\u4ecb\u7ecd\u8fd8\u53ef\u4ee5\u4f20\u5165Excel\u4e2d\u7684\u516c\u5f0f\u8fdb\u884c\u8d4b\u503c\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\uff0c\u5728\u8bfb\u53d6\u6587\u4ef6\u65f6\u9700\u8981\u52a0\u4e0a\u53c2\u6570data_only=True\uff0c\u8fd9\u6837\u624d\u80fd\u8fd4\u56de\u6570\u5b57\uff0c\u5426\u5219\u5c06\u8fd4\u56de\u5b57\u7b26\u4e32\uff0c\u5373\u516c\u5f0f\u672c\u8eab # \u76f4\u63a5\u8d4b\u503c sheet['A1'].value = 2 # \u516c\u5f0f\u8d4b\u503c sheet['A6'].value = '=SUM(A1:A5)' \u53e6\u5916\uff0c\u4e5f\u53ef\u4f7f\u7528sheet.append(parameters)\u4e00\u884c\u6216\u591a\u884c\u5199\u5165 # \u5199\u5165\u4e00\u884c row = [1 ,2, 3, 4, 5] sheet.append(row) # \u5199\u5165\u591a\u884c rows = [ ['ID', 'Name', 'Department'], ['001', 'Lee','CS'], ['002', 'John','MA'], ['003', 'Amy','IS'] ] sheet.append(rows) 2.2 \u64cd\u4f5c\u6587\u4ef6 \u00b6 \u5199\u5b8c\u6587\u4ef6\u540e\uff0c\u4f7f\u7528workbook.save(path+filename)\u8fdb\u884c\u4fdd\u5b58\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\u6587\u4ef6\u6269\u5c55\u540d\u4e00\u5b9a\u8981\u662fxlsx\u683c\u5f0f # \u4fdd\u5b58\u6587\u4ef6\u81f3\u5f53\u524d\u76ee\u5f55 wb.save('new_file.xlsx') 3. \u8bbe\u7f6e\u5355\u5143\u683c\u6837\u5f0f \u00b6 \u5355\u5143\u683c\u6837\u5f0f\u4e3b\u8981\u5305\u62ec\u5b57\u4f53\u3001\u8fb9\u6846\u3001\u989c\u8272\u4ee5\u53ca\u5bf9\u9f50\u65b9\u5f0f\u7b49\uff0c\u8fd9\u4e9b\u5747\u4f4d\u4e8eopenpyxl.styles\u5e93\u4e2d # \u5bfc\u5165\u5b57\u4f53\u3001\u8fb9\u6846\u3001\u989c\u8272\u4ee5\u53ca\u5bf9\u9f50\u65b9\u5f0f\u76f8\u5173\u5e93 from openpyxl.styles import Font, Border, Side, PatternFill, colors, Alignment 3.1 \u5b57\u4f53 \u00b6 \u901a\u8fc7sheet\u5355\u5143\u683cfont\u5c5e\u6027\u8bbe\u7f6e\u5b57\u4f53\u98ce\u683c # \u8bbe\u7f6e\u5b57\u4f53\u98ce\u683c\u4e3aTimes New Roman\uff0c\u5927\u5c0f\u4e3a16\uff0c\u7c97\u4f53\u3001\u659c\u4f53\uff0c\u989c\u8272\u84dd\u8272 sheet['A1'].font = Font(name='Times New Roman', size=16, bold=True, italic=True, color=colors.BLUE) 3.2 \u5bf9\u9f50\u65b9\u5f0f \u00b6 \u901a\u8fc7sheet\u5355\u5143\u683calignment\u5c5e\u6027\u8bbe\u7f6e\u6587\u672c\u5bf9\u9f50\u98ce\u683c # \u901a\u8fc7\u53c2\u6570horizontal\u548cvertical\u6765\u8bbe\u7f6e\u6587\u5b57\u5728\u5355\u5143\u683c\u91cc\u7684\u5bf9\u9f50\u65b9\u5f0f\uff0c\u6b64\u5916\u8bbe\u7f6e\u503c\u8fd8\u53ef\u4e3aleft\u548cright sheet['B1'].alignment = Alignment(horizontal='center',vertical='center') 3.3 \u8fb9\u6846 \u00b6 \u901a\u8fc7sheet\u5355\u5143\u683cborder\u5c5e\u6027\u8bbe\u7f6e\u5b57\u4f53\u98ce\u683c # \u9996\u5148\u8bbe\u7f6e\u8fb9\u6846\u56db\u4e2a\u65b9\u5411\u7684\u7ebf\u6761\u79cd\u7c7b left, right, top, bottom = [Side(style='thin', color='000000')] * 4 # \u518d\u5c06\u5404\u65b9\u5411\u7ebf\u6761\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165Border\u65b9\u6cd5 sheet['C1'].border = Border(left=left, right=right, top=top, bottom=bottom) 3.4 \u8bbe\u7f6e\u884c\u9ad8\u548c\u5217\u5bbd \u00b6 \u884c\u548c\u5217\u7684\u957f\u5ea6\u5927\u5c0f\u53ef\u4ee5\u901a\u8fc7row_dimensions[\u5e8f\u53f7].height\u548ccolumn_dimensions[\u6807\u53f7].width\u6765\u8bbe\u7f6e # \u8bbe\u7f6e\u884c\u9ad8 sheet.row_dimensions[1].height = 25 # \u8bbe\u7f6e\u5217\u5bbd sheet.column_dimensions['D'].width = 15.5 3.5 \u5408\u5e76\u548c\u62c6\u5206\u5355\u5143\u683c \u00b6 \u5bf9\u5355\u5143\u683c\u7684\u5408\u5e76\u4e0e\u62c6\u5206\uff0c\u4e3b\u8981\u662f\u901a\u8fc7sheet\u7684merge_cells(args1:args2)\u548cunmerge_cells(args1:args2)\u4e24\u4e2a\u65b9\u6cd5\u6765\u5b9e\u73b0\u7684 # \u5408\u5e76\u5355\u5143\u683c sheet.merge_cells('A1:B2') # \u62c6\u5206\u5355\u5143\u683c sheet.unmerge_cells('A1:B2') \u5f53\u7136\uff0c\u9664\u4e86\u5bf9\u89d2\u77e9\u5f62\u533a\u57df\u5316\u5408\u5e76\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u4e00\u884c\u6216\u4e00\u5217\u8fdb\u884c\u5408\u5e76\uff0c\u53ea\u9700\u76f8\u5e94\u4fee\u6539\u53c2\u6570\u5373\u53ef\u3002\u4e0d\u8fc7\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5408\u5e76\u540e\u5355\u5143\u683c\u663e\u793a\u7684\u6587\u672c\u5185\u5bb9\u662f\u5408\u5e76\u524d\u6700\u5de6\u4e0a\u89d2\u5355\u5143\u683c\u7684\u5185\u5bb9\uff0c\u800c\u5176\u4ed6\u5355\u5143\u683c\u5185\u5bb9\u5219\u4f1a\u81ea\u52a8\u6e05\u9664\u3002 \u591a\u5173\u4e8eopenpyxl\u7684\u4ecb\u7ecd\uff0c \u53ef\u4ee5\u53c2\u9605readthedocs\u76f8\u5173\u6587\u6863","title":"2. openpyxl"},{"location":"python/lib/execel/2.openpyxl/#openpyxl","text":"openpyxl\u6a21\u5757\u662f\u4e00\u4e2a\u8bfb\u5199Excel 2010\u6587\u6863\u7684Python\u5e93\uff0c\u5982\u679c\u8981\u5904\u7406\u66f4\u65e9\u683c\u5f0f\u7684Excel\u6587\u6863\uff0c\u9700\u8981\u7528\u5230\u989d\u5916\u7684\u5e93\uff0c openpyxl\u662f\u4e00\u4e2a\u6bd4\u8f83\u7efc\u5408\u7684\u5de5\u5177\uff0c\u80fd\u591f\u540c\u65f6\u8bfb\u53d6\u548c\u4fee\u6539Excel\u6587\u6863\u3002\u5176\u4ed6\u5f88\u591a\u7684\u4e0eExcel\u76f8\u5173\u7684\u9879\u76ee\u57fa\u672c\u53ea\u652f\u6301\u8bfb\u6216\u8005\u5199Excel\u4e00\u79cd\u529f\u80fd\u3002","title":"openpyxl\u6a21\u5757\u4ecb\u7ecd"},{"location":"python/lib/execel/2.openpyxl/#excel","text":"openpyxl\u4e2d\u5b9a\u4e49\u4e86\u591a\u79cd\u6570\u636e\u683c\u5f0f\uff0c\u6211\u53ea\u6d89\u53ca\u5230\u4e86\u5176\u4e2d\u6700\u91cd\u8981\u7684\u4e09\u79cd\uff1a - NULL\uff1a \u7a7a\u503c\uff0c\u5bf9\u5e94\u4e8epython\u4e2d\u7684None\uff0c\u8868\u793a\u8fd9\u4e2acell\u91cc\u9762\u6ca1\u6709\u6570\u636e\u3002 - numberic\uff1a \u6570\u5b57\u578b\uff0c\u7edf\u4e00\u6309\u7167\u6d6e\u70b9\u6570\u6765\u8fdb\u884c\u5904\u7406\u3002\u5bf9\u5e94\u4e8epython\u4e2d\u7684float\u3002 - string\uff1a \u5b57\u7b26\u4e32\u578b\uff0c\u5bf9\u5e94\u4e8epython\u4e2d\u7684unicode\u3002 \u6bcf\u4e00\u4e2aExcel\u6570\u636e\u6587\u4ef6\u4ece\u4e0a\u81f3\u4e0b\u5206\u4e3a\u4e09\u4e2a\u5c42\u7ea7\u7684\u5bf9\u8c61\uff1a - workbook\uff1a \u6bcf\u4e00\u4e2aExcel\u6587\u4ef6\u5c31\u662f\u4e00\u4e2aworkbook\u3002 - sheet\uff1a \u6bcf\u4e00\u4e2aworkbook\u4e2d\u53ef\u4ee5\u5305\u542b\u591a\u4e2asheet\uff0c\u5177\u4f53\u5c31\u5bf9\u5e94Excel\u4e2d\u6211\u4eec\u5728\u5de6\u4e0b\u811a\u6240\u770b\u5230\u7684\u201csheet1\u201d,\u201csheet2\u201d\u7b49\u3002 - cell\uff1a \u6bcf\u4e00\u4e2asheet\u5c31\u662f\u6211\u4eec\u901a\u5e38\u6240\u770b\u5230\u7684\u4e00\u4e2a\u8868\u683c\uff0c\u53ef\u4ee5\u542b\u6709m\u884c\uff0cn\u5217\uff0c\u6bcf\u4e2a\u786e\u5b9a\u7684\u884c\u53f7\uff0c\u5217\u53f7\u6240\u5bf9\u5e94\u7684\u4e00\u4e2a\u683c\u5b50\u5c31\u662f\u4e00\u4e2acell\u3002","title":"Excel\u6570\u636e\u7684\u7c7b\u578b\u53ca\u7ec4\u7ec7\u65b9\u5f0f"},{"location":"python/lib/execel/2.openpyxl/#openpyxl_1","text":"pip3 install openpyxl","title":"\u5b89\u88c5openpyxl\u6a21\u5757"},{"location":"python/lib/execel/2.openpyxl/#openpyxl_2","text":"\u60f3\u8981\u64cd\u4f5cExcel\u9996\u5148\u8981\u4e86\u89e3Excel\u57fa\u672c\u6982\u5ff5\uff0cExcel\u4e2d\u5217\u4ee5\u5b57\u5e55\u547d\u540d\uff0c\u884c\u4ee5\u6570\u5b57\u547d\u540d\uff0c\u6bd4\u5982\u5de6\u4e0a\u89d2\u7b2c\u4e00\u4e2a\u5355\u5143\u683c\u7684\u5750\u6807\u4e3aA1\uff0c\u4e0b\u9762\u7684\u4e3aA2\uff0c\u53f3\u8fb9\u7684B1\u3002 openpyxl\u4e2d\u6709\u4e09\u4e2a\u4e0d\u540c\u5c42\u6b21\u7684\u7c7b\uff0cWorkbook\u662f\u5bf9\u5de5\u4f5c\u7c3f\u7684\u62bd\u8c61\uff0cWorksheet\u662f\u5bf9\u8868\u683c\u7684\u62bd\u8c61\uff0c Cell\u662f\u5bf9\u5355\u5143\u683c\u7684\u62bd\u8c61\uff0c\u6bcf\u4e00\u4e2a\u7c7b\u90fd\u5305\u542b\u4e86\u8bb8\u591a\u5c5e\u6027\u548c\u65b9\u6cd5\u3002","title":"openpyxl\u57fa\u672c\u7528\u6cd5"},{"location":"python/lib/execel/2.openpyxl/#excel_1","text":"\u6253\u5f00\u6216\u8005\u521b\u5efa\u4e00\u4e2aExcel\u9700\u8981\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61 \u83b7\u53d6\u4e00\u4e2a\u8868\u5219\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61\uff0c\u7136\u540e\u4f7f\u7528\u8be5\u5bf9\u8c61\u7684\u65b9\u6cd5\u6765\u5f97\u5230\u4e00\u4e2aWorksheet\u5bf9\u8c61 \u5982\u679c\u8981\u83b7\u53d6\u8868\u4e2d\u7684\u6570\u636e\uff0c\u90a3\u4e48\u5f97\u5230Worksheet\u5bf9\u8c61\u4ee5\u540e\u518d\u4ece\u4e2d\u83b7\u53d6\u4ee3\u8868\u5355\u5143\u683c\u7684Cell\u5bf9\u8c61 Workbook\u5bf9\u8c61\u4e00\u4e2aWorkbook\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2aExcel\u6587\u6863\uff0c\u56e0\u6b64\u5728\u64cd\u4f5cExcel\u4e4b\u524d\uff0c\u90fd\u5e94\u8be5\u5148\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61\u3002 \u5bf9\u4e8e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Excel\u6587\u6863\uff0c\u76f4\u63a5\u8fdb\u884cWorkbook\u7c7b\u7684\u8c03\u7528\u5373\u53ef\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684Excel\u6587\u6863\uff0c \u53ef\u4ee5\u4f7f\u7528openpyxl\u6a21\u5757\u7684load_workbook\u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\uff0c\u8be5\u51fd\u6570\u5305\u6db5\u591a\u4e2a\u53c2\u6570\uff0c\u4f46\u53ea\u6709filename\u53c2\u6570\u4e3a\u5fc5\u4f20\u53c2\u6570\u3002filename \u662f\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u5bf9\u8c61\u3002","title":"\u64cd\u4f5cExcel\u7684\u4e00\u822c\u573a\u666f:"},{"location":"python/lib/execel/2.openpyxl/#workbook","text":"\u4e00\u4e2aWorkbook\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2aExcel\u6587\u6863\uff0c\u56e0\u6b64\u5728\u64cd\u4f5cExcel\u4e4b\u524d\uff0c\u90fd\u5e94\u8be5\u5148\u521b\u5efa\u4e00\u4e2aWorkbook\u5bf9\u8c61\u3002 \u5bf9\u4e8e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Excel\u6587\u6863\uff0c\u76f4\u63a5\u8fdb\u884cWorkbook\u7c7b\u7684\u8c03\u7528\u5373\u53ef\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684Excel\u6587\u6863\uff0c \u53ef\u4ee5\u4f7f\u7528openpyxl\u6a21\u5757\u7684load_workbook\u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\uff0c\u8be5\u51fd\u6570\u5305\u6db5\u591a\u4e2a\u53c2\u6570\uff0c\u4f46\u53ea\u6709filename\u53c2\u6570\u4e3a\u5fc5\u4f20\u53c2\u6570\u3002 filename \u662f\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u5bf9\u8c61\u3002 PS\uff1aWorkbook\u548cload_workbook\u76f8\u540c\uff0c\u8fd4\u56de\u7684\u90fd\u662f\u4e00\u4e2aWorkbook\u5bf9\u8c61 Workbook\u5bf9\u8c61\u63d0\u4f9b\u4e86\u5f88\u591a\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u5176\u4e2d\uff0c\u5927\u90e8\u5206\u65b9\u6cd5\u90fd\u4e0esheet\u6709\u5173\uff0c\u90e8\u5206\u5c5e\u6027\u5982\u4e0b\uff1a active\uff1a \u83b7\u53d6\u5f53\u524d\u6d3b\u8dc3\u7684Worksheet worksheets\uff1a\u4ee5\u5217\u8868\u7684\u5f62\u5f0f\u8fd4\u56de\u6240\u6709\u7684Worksheet(\u8868\u683c) read_only\uff1a \u5224\u65ad\u662f\u5426\u4ee5read_only\u6a21\u5f0f\u6253\u5f00Excel\u6587\u6863 encoding\uff1a \u83b7\u53d6\u6587\u6863\u7684\u5b57\u7b26\u96c6\u7f16\u7801 properties\uff1a\u83b7\u53d6\u6587\u6863\u7684\u5143\u6570\u636e\uff0c\u5982\u6807\u9898\uff0c\u521b\u5efa\u8005\uff0c\u521b\u5efa\u65e5\u671f\u7b49 sheetnames\uff1a\u83b7\u53d6\u5de5\u4f5c\u7c3f\u4e2d\u7684\u8868\uff08\u5217\u8868\uff09 - \u4f8b\u5b50 import openpyxl excel2 = openpyxl.load_workbook(\"example.xlsx\") excel2.active print(\"excel2 = \", excel2) print(\"excel2.read_only = \",excel2.read_only) print(\"excel2.worksheets = \",excel2.worksheets) print(\"excel2.properties = \",excel2.properties) print(\"excel2.encoding = \",excel2.encoding) \u8fd0\u884c\u7ed3\u679c excel2 = <openpyxl.workbook.workbook.Workbook object at 0x000001B072D2D7F0> excel2.read_only = False excel2.worksheets = [<Worksheet \"Sheet1\">, <Worksheet \"Sheet2\">, <Worksheet \"Sheet3\">] excel2.properties = <openpyxl.packaging.core.DocumentProperties object> Parameters: creator='cmz', title=None, description=None, subject=None, identifier=None, language=None, created=datetime.datetime(2019, 1, 23, 7, 26), modified=datetime.datetime(2019, 1, 23, 7, 26, 46), lastModifiedBy='\u7231\u4e00\u76f4\u5728\u7ebf1409537494', category=None, contentStatus=None, version=None, revision=None, keywords=None, lastPrinted=None excel2.encoding = utf-8 Workbook\u63d0\u4f9b\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a get_sheet_names\uff1a\u83b7\u53d6\u6240\u6709\u8868\u683c\u7684\u540d\u79f0(\u65b0\u7248\u5df2\u7ecf\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u901a\u8fc7Workbook\u7684sheetnames\u5c5e\u6027\u5373\u53ef\u83b7\u53d6) get_sheet_by_name\uff1a\u901a\u8fc7\u8868\u683c\u540d\u79f0\u83b7\u53d6Worksheet\u5bf9\u8c61(\u65b0\u7248\u4e5f\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u901a\u8fc7Worksheet[\u2018\u8868\u540d\u2018]\u83b7\u53d6) get_active_sheet\uff1a\u83b7\u53d6\u6d3b\u8dc3\u7684\u8868\u683c(\u65b0\u7248\u5efa\u8bae\u901a\u8fc7active\u5c5e\u6027\u83b7\u53d6) remove_sheet\uff1a\u5220\u9664\u4e00\u4e2a\u8868\u683c create_sheet\uff1a\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u8868\u683c copy_worksheet\uff1a\u5728Workbook\u5185\u62f7\u8d1d\u8868\u683c Worksheet\u5bf9\u8c61 \u6709\u4e86Worksheet\u5bf9\u8c61\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2aWorksheet\u5bf9\u8c61\u83b7\u53d6\u8868\u683c\u7684\u5c5e\u6027\uff0c\u5f97\u5230\u5355\u5143\u683c\u4e2d\u7684\u6570\u636e\uff0c\u4fee\u6539\u8868\u683c\u4e2d\u7684\u5185\u5bb9\u3002openpyxl\u63d0\u4f9b\u4e86\u975e\u5e38\u7075\u6d3b\u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u8868\u683c\u4e2d\u7684\u5355\u5143\u683c\u548c\u6570\u636e\uff0c\u5e38\u7528\u7684Worksheet\u5c5e\u6027\u5982\u4e0b\uff1a title \uff1a\u8868\u683c\u7684\u6807\u9898 dimensions \uff1a\u8868\u683c\u7684\u5927\u5c0f\uff0c\u8fd9\u91cc\u7684\u5927\u5c0f\u662f\u6307\u542b\u6709\u6570\u636e\u7684\u8868\u683c\u7684\u5927\u5c0f\uff0c\u5373\uff1a\u5de6\u4e0a\u89d2\u7684\u5750\u6807:\u53f3\u4e0b\u89d2\u7684\u5750\u6807 max_row \uff1a\u8868\u683c\u7684\u6700\u5927\u884c min_row \uff1a\u8868\u683c\u7684\u6700\u5c0f\u884c max_column \uff1a\u8868\u683c\u7684\u6700\u5927\u5217 min_column \uff1a\u8868\u683c\u7684\u6700\u5c0f\u5217 rows \uff1a\u6309\u884c\u83b7\u53d6\u5355\u5143\u683c(Cell\u5bf9\u8c61) - \u751f\u6210\u5668 columns \uff1a\u6309\u5217\u83b7\u53d6\u5355\u5143\u683c(Cell\u5bf9\u8c61) - \u751f\u6210\u5668 freeze_panes \uff1a\u51bb\u7ed3\u7a97\u683c values \uff1a\u6309\u884c\u83b7\u53d6\u8868\u683c\u7684\u5185\u5bb9(\u6570\u636e) - \u751f\u6210\u5668 Cell\u5bf9\u8c61 Cell\u5bf9\u8c61\u6bd4\u8f83\u7b80\u5355\uff0c\u5e38\u7528\u7684\u5c5e\u6027\u5982\u4e0b: row \uff1a\u5355\u5143\u683c\u6240\u5728\u7684\u884c column \uff1a\u5355\u5143\u683c\u5750\u5728\u7684\u5217 value \uff1a\u5355\u5143\u683c\u7684\u503c coordinate\uff1a\u5355\u5143\u683c\u7684\u5750\u6807 print(excel2['Sheet1'].cell(row=1,column=2).row) print(excel2['Sheet1'].cell(row=1,column=2).column) print(excel2['Sheet1'].cell(row=1,column=2).value) print(excel2['Sheet1'].cell(row=1,column=2).coordinate) \u7ed3\u679c 1 B \u5e74\u9f84 B1","title":"Workbook\u5bf9\u8c61"},{"location":"python/lib/execel/2.openpyxl/#1-excel","text":"\u901a\u8fc7\u8c03\u7528\u65b9\u6cd5load_workbook(filename)\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6\uff0c\u8be5\u65b9\u6cd5\u4e2d\u8fd8\u6709\u4e00\u4e2aread_only\u53c2\u6570\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u6253\u5f00\u65b9\u5f0f\uff0c \u9ed8\u8ba4\u4e3a\u53ef\u8bfb\u53ef\u5199\uff0c\u8be5\u65b9\u6cd5\u6700\u7ec8\u5c06\u8fd4\u56de\u4e00\u4e2aworkbook\u7684\u6570\u636e\u5bf9\u8c61 # \u6587\u4ef6\u5fc5\u987b\u662fxlsx\u683c\u5f0f\uff0c\u5982\u679c\u662f\u5176\u4ed6\u683c\u5f0f\u5728\u6267\u884c\u524d\u53ef\u5229\u7528win32\u8f85\u52a9\u8f6c\u5316 wb = openpyxl.load_workbook('example.xlsx')","title":"1. \u8bfb\u53d6Excel\u6587\u6863"},{"location":"python/lib/execel/2.openpyxl/#11","text":"\u6bcf\u4e00\u4e2aExcel\u8868\u683c\u4e2d\u90fd\u4f1a\u6709\u5f88\u591a\u5f20sheet\u5de5\u4f5c\u8868\uff0c\u5728\u5bf9\u8868\u683c\u64cd\u4f5c\u524d\u9700\u8981\u5148\u9009\u5b9a\u4e00\u5f20\u5de5\u4f5c\u8868 # \u83b7\u53d6\u6240\u6709\u5de5\u4f5c\u8868\u540d(\u8fd4\u56de\u4e00\u4e2a\u5217\u8868) sheets = wb.get_sheet_names() # \u83b7\u53d6\u67d0\u4e00\u7279\u5b9a\u7684\u5de5\u4f5c\u8868 sheet = wb.get_sheet_by_name('Sheet2') # \u8fc7\u65f6\u5199\u6cd5 sheet = wb['Sheet1'] # \u73b0\u5728\u5199\u6cd5 # \u83b7\u53d6\u5de5\u4f5c\u8868\u7684\u8868\u540d sheet_name = sheet.title # \u4e00\u822c\u6765\u8bf4\uff0c\u8868\u683c\u5927\u591a\u6570\u7528\u5230\u7684\u662f\u6253\u5f00\u65f6\u663e\u793a\u7684\u5de5\u4f5c\u8868\uff0c\u8fd9\u65f6\u53ef\u4ee5\u7528active\u6765\u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u8868 sheet = wb.active","title":"1.1 \u83b7\u53d6\u5de5\u4f5c\u8868"},{"location":"python/lib/execel/2.openpyxl/#12","text":"\u5bf9Excel\u8868\u683c\u7684\u64cd\u4f5c\u6700\u7ec8\u90fd\u843d\u4e8e\u5bf9\u5355\u5143\u683c\u7684\u64cd\u4f5c\uff0c\u83b7\u53d6\u5355\u5143\u683c\u6709\u4e24\u79cd\u83b7\u53d6\u65b9\u6cd5\uff1asheet[\u5217\u884c\u540d]\u548csheet.cell(row,column) # \u901a\u8fc7sheet[\u5217\u884c\u540d]\u83b7\u53d6 a = sheet['A2'] # \u901a\u8fc7sheet.cell(row,column)\u83b7\u53d6 b = sheet.cell(1, 2) # \u5373sheet['B1'] # \u83b7\u53d6\u5355\u5143\u683c\u5185\u5bb9 print(a.value) # \u83b7\u53d6\u5355\u5143\u683c\u6240\u5728\u5217\u548c\u884c print('a is '+str((a.column,a.row))) \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0csheet.cell(row,column)\u4e2d\u53c2\u6570\u5206\u522b\u662f\u884c\u548c\u5217\uff0c\u4e14\u5fc5\u987b\u4e3a\u6574\u6570\uff0c\u5982\u679c\u5217\u4e3a\u82f1\u6587\u5b57\u6bcd\uff0c\u53ef\u4ee5\u5229\u7528 openpyxl.utils \u4e2d\u7684 column_index_from_string(char)\u8fdb\u884c\u5b57\u6bcd\u6570\u5b57\u7684\u8f6c\u5316\u3002\u987a\u4fbf\u4e00\u8bf4\uff0c\u540c\u7406\u4e5f\u53ef\u4ee5\u5229\u7528get_column_letter(number)\u8fdb\u884c\u6570\u5b57\u5b57\u6bcd\u95f4\u7684\u8f6c\u5316 from openpyxl.utils import get_column_letter, column_index_from_string # \u5bf9\u5217\u8fdb\u884c\u5b57\u6bcd/\u6570\u5b57\u8f6c\u5316 c_num = column_index_from_string('B') # c_num = 2 c_char = get_column_letter(5) # c_char = 'E\u2018","title":"1.2 \u83b7\u53d6\u5355\u5143\u683c"},{"location":"python/lib/execel/2.openpyxl/#13","text":"\u5728\u5904\u7406Excel\u8868\u683c\u6709\u65f6\u53ef\u80fd\u9700\u8981\u5bf9\u8868\u683c\u8fdb\u884c\u904d\u5386\u67e5\u627e\uff0copenpyxl\u4e2d\u4fbf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u884c\u548c\u5217\u7684\u751f\u6210\u5668(sheet.rows\u548csheet.columns),\u8fd9\u4e24\u4e2a\u751f\u6210\u5668\u91cc\u9762\u662f\u6bcf\u4e00\u884c\uff08\u6216\u5217\uff09\u7684\u6570\u636e\uff0c\u6bcf\u4e00\u884c\uff08\u6216\u5217\uff09\u53c8\u7531\u4e00\u4e2atuple\u5305\u88f9\uff0c\u501f\u6b64\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5b8c\u6210\u5bf9\u884c\u548c\u5217\u7684\u904d\u5386 # \u5bf9\u884c\u8fdb\u884c\u904d\u5386,\u8f93\u51faA1,B1,C1 for row in sheet.rows: for cell in row: print(cell.value) # \u5bf9\u5217\u8fdb\u884c\u904d\u5386,\u8f93\u51faA1,A2,A3 for column in sheet.columns: for cell in column: print(cell.value) tip \u5b66\u4e60\u65f6\u8fd8\u53d1\u73b0\u4e5f\u53ef\u4ee5\u901a\u8fc7list(sheet.rows)[index](\u6216list(sheet.columns)[index])\u5bf9\u67d0\u4e00\u884c\u6216\u5217\u8fdb\u884c\u904d\u5386\uff0c\u800c\u5728\u6b64\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8esheet.rows(\u6216sheet.columns)\u662f\u751f\u6210\u5668\u7c7b\u578b\uff0c\u662f\u4e0d\u80fd\u76f4\u63a5\u8c03\u7528\u7684\uff0c\u9700\u5c06\u5176\u8f6c\u5316\u4e3a\u4e00\u4e2alist\u7c7b\u578b\uff0c\u7136\u540e\u518d\u901a\u8fc7\u7d22\u5f15\u904d\u5386 # \u5bf9\u67d0\u4e00\u7279\u5b9a\u7684\u884c\u8fdb\u884c\u904d\u5386 for cell in list(sheet.rows)[0]: # \u7b2c0\u884c print(cell.value) # \u5bf9\u67d0\u4e00\u7279\u5b9a\u7684\u5217\u8fdb\u884c\u904d\u5386 for cell in list(sheet.columns)[0]: # \u7b2c0\u5217 print(cell.value) \u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528sheet[\u884c\u5217\u503c:\u884c\u5217\u503c]\u6765\u5bf9\u7ed9\u5b9a\u5355\u5143\u683c\u8303\u56f4\u8fdb\u884c\u904d\u5386 # \u5bf9\u67d0\u4e00\u5355\u5143\u683c\u8303\u56f4\u8fdb\u884c\u904d\u5386 for spaces in sheet['A1':'B2']: for cell in spaces: print(cell.value) \u53e6\u5916\uff0c\u6709\u65f6\u5019\u6211\u4eec\u8fd8\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8868\u683c\u7684\u5927\u5c0f\uff0c\u5373\u83b7\u53d6\u8868\u683c\u884c\u548c\u5217\u7684\u6700\u5927\u503c\uff0c\u53ef\u4ee5\u7528max_row\u548cmax_column\u6765\u83b7\u53d6 # \u83b7\u5f97\u6700\u5927\u5217\u548c\u6700\u5927\u884c print(sheet.max_row) print(sheet.max_column)","title":"1.3 \u83b7\u53d6\u884c\u548c\u5217"},{"location":"python/lib/execel/2.openpyxl/#2-excel","text":"\u5728\u5f00\u5934\u8bfb\u53d6\u65f6\u5df2\u7ecf\u4ecb\u7ecd\uff0c\u9ed8\u8ba4\u7684\u6253\u5f00\u65b9\u5f0f\u4e3a\u53ef\u8bfb\u53ef\u5199\uff0c\u90a3\u4e48\u4f7f\u7528load_workbook(filename)\u8bfb\u53d6Excel\u6587\u6863\u540e\u4e5f\u5c31\u53ef\u4ee5\u76f4\u63a5\u5199\u5165\u4e86\u3002\u53e6\u5916\uff0c\u5982\u679c\u9700\u8981\u65b0\u5efa\u4e00\u4e2aExcel\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528Workbook()\u65b9\u6cd5\uff0c\u540c\u65f6\u5b83\u4f1a\u81ea\u52a8\u63d0\u4f9b\u4e00\u4e2asheet\u5de5\u4f5c\u8868\u3002\u5bf9\u4e8e\u5220\u9664\u4e00\u4e2a\u5de5\u4f5c\u8868\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528workbook\u5bf9\u8c61\u7684remove(sheet)\u65b9\u6cd5\u5220\u9664 # \u65b0\u5efa\u4e00\u4e2aExcel\u6587\u6863 wb = openpyxl.Workbook() # \u5220\u9664\u67d0\u4e2a\u5de5\u4f5c\u8868 wb.remove(sheet)","title":"2. \u6863\u5199\u5165Excel\u6587\u6863"},{"location":"python/lib/execel/2.openpyxl/#21","text":"\u83b7\u53d6\u5de5\u4f5c\u8868\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u5982\u679c\u4f7f\u7528load_workbook(filename)\u8bfb\u53d6\uff0c\u90a3\u4e48\u83b7\u53d6\u5de5\u4f5c\u8868\u540e\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7sheet[\u884c\u5217\u503c]\u5199\u5165\u5355\u5143\u683c\u3002\u5b66\u4e60\u65f6\uff0c\u6709\u8d44\u6599\u4ecb\u7ecd\u8fd8\u53ef\u4ee5\u4f20\u5165Excel\u4e2d\u7684\u516c\u5f0f\u8fdb\u884c\u8d4b\u503c\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\uff0c\u5728\u8bfb\u53d6\u6587\u4ef6\u65f6\u9700\u8981\u52a0\u4e0a\u53c2\u6570data_only=True\uff0c\u8fd9\u6837\u624d\u80fd\u8fd4\u56de\u6570\u5b57\uff0c\u5426\u5219\u5c06\u8fd4\u56de\u5b57\u7b26\u4e32\uff0c\u5373\u516c\u5f0f\u672c\u8eab # \u76f4\u63a5\u8d4b\u503c sheet['A1'].value = 2 # \u516c\u5f0f\u8d4b\u503c sheet['A6'].value = '=SUM(A1:A5)' \u53e6\u5916\uff0c\u4e5f\u53ef\u4f7f\u7528sheet.append(parameters)\u4e00\u884c\u6216\u591a\u884c\u5199\u5165 # \u5199\u5165\u4e00\u884c row = [1 ,2, 3, 4, 5] sheet.append(row) # \u5199\u5165\u591a\u884c rows = [ ['ID', 'Name', 'Department'], ['001', 'Lee','CS'], ['002', 'John','MA'], ['003', 'Amy','IS'] ] sheet.append(rows)","title":"2.1 \u5199\u5165\u5355\u5143\u683c"},{"location":"python/lib/execel/2.openpyxl/#22","text":"\u5199\u5b8c\u6587\u4ef6\u540e\uff0c\u4f7f\u7528workbook.save(path+filename)\u8fdb\u884c\u4fdd\u5b58\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\u6587\u4ef6\u6269\u5c55\u540d\u4e00\u5b9a\u8981\u662fxlsx\u683c\u5f0f # \u4fdd\u5b58\u6587\u4ef6\u81f3\u5f53\u524d\u76ee\u5f55 wb.save('new_file.xlsx')","title":"2.2 \u64cd\u4f5c\u6587\u4ef6"},{"location":"python/lib/execel/2.openpyxl/#3","text":"\u5355\u5143\u683c\u6837\u5f0f\u4e3b\u8981\u5305\u62ec\u5b57\u4f53\u3001\u8fb9\u6846\u3001\u989c\u8272\u4ee5\u53ca\u5bf9\u9f50\u65b9\u5f0f\u7b49\uff0c\u8fd9\u4e9b\u5747\u4f4d\u4e8eopenpyxl.styles\u5e93\u4e2d # \u5bfc\u5165\u5b57\u4f53\u3001\u8fb9\u6846\u3001\u989c\u8272\u4ee5\u53ca\u5bf9\u9f50\u65b9\u5f0f\u76f8\u5173\u5e93 from openpyxl.styles import Font, Border, Side, PatternFill, colors, Alignment","title":"3. \u8bbe\u7f6e\u5355\u5143\u683c\u6837\u5f0f"},{"location":"python/lib/execel/2.openpyxl/#31","text":"\u901a\u8fc7sheet\u5355\u5143\u683cfont\u5c5e\u6027\u8bbe\u7f6e\u5b57\u4f53\u98ce\u683c # \u8bbe\u7f6e\u5b57\u4f53\u98ce\u683c\u4e3aTimes New Roman\uff0c\u5927\u5c0f\u4e3a16\uff0c\u7c97\u4f53\u3001\u659c\u4f53\uff0c\u989c\u8272\u84dd\u8272 sheet['A1'].font = Font(name='Times New Roman', size=16, bold=True, italic=True, color=colors.BLUE)","title":"3.1 \u5b57\u4f53"},{"location":"python/lib/execel/2.openpyxl/#32","text":"\u901a\u8fc7sheet\u5355\u5143\u683calignment\u5c5e\u6027\u8bbe\u7f6e\u6587\u672c\u5bf9\u9f50\u98ce\u683c # \u901a\u8fc7\u53c2\u6570horizontal\u548cvertical\u6765\u8bbe\u7f6e\u6587\u5b57\u5728\u5355\u5143\u683c\u91cc\u7684\u5bf9\u9f50\u65b9\u5f0f\uff0c\u6b64\u5916\u8bbe\u7f6e\u503c\u8fd8\u53ef\u4e3aleft\u548cright sheet['B1'].alignment = Alignment(horizontal='center',vertical='center')","title":"3.2 \u5bf9\u9f50\u65b9\u5f0f"},{"location":"python/lib/execel/2.openpyxl/#33","text":"\u901a\u8fc7sheet\u5355\u5143\u683cborder\u5c5e\u6027\u8bbe\u7f6e\u5b57\u4f53\u98ce\u683c # \u9996\u5148\u8bbe\u7f6e\u8fb9\u6846\u56db\u4e2a\u65b9\u5411\u7684\u7ebf\u6761\u79cd\u7c7b left, right, top, bottom = [Side(style='thin', color='000000')] * 4 # \u518d\u5c06\u5404\u65b9\u5411\u7ebf\u6761\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165Border\u65b9\u6cd5 sheet['C1'].border = Border(left=left, right=right, top=top, bottom=bottom)","title":"3.3 \u8fb9\u6846"},{"location":"python/lib/execel/2.openpyxl/#34","text":"\u884c\u548c\u5217\u7684\u957f\u5ea6\u5927\u5c0f\u53ef\u4ee5\u901a\u8fc7row_dimensions[\u5e8f\u53f7].height\u548ccolumn_dimensions[\u6807\u53f7].width\u6765\u8bbe\u7f6e # \u8bbe\u7f6e\u884c\u9ad8 sheet.row_dimensions[1].height = 25 # \u8bbe\u7f6e\u5217\u5bbd sheet.column_dimensions['D'].width = 15.5","title":"3.4 \u8bbe\u7f6e\u884c\u9ad8\u548c\u5217\u5bbd"},{"location":"python/lib/execel/2.openpyxl/#35","text":"\u5bf9\u5355\u5143\u683c\u7684\u5408\u5e76\u4e0e\u62c6\u5206\uff0c\u4e3b\u8981\u662f\u901a\u8fc7sheet\u7684merge_cells(args1:args2)\u548cunmerge_cells(args1:args2)\u4e24\u4e2a\u65b9\u6cd5\u6765\u5b9e\u73b0\u7684 # \u5408\u5e76\u5355\u5143\u683c sheet.merge_cells('A1:B2') # \u62c6\u5206\u5355\u5143\u683c sheet.unmerge_cells('A1:B2') \u5f53\u7136\uff0c\u9664\u4e86\u5bf9\u89d2\u77e9\u5f62\u533a\u57df\u5316\u5408\u5e76\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u4e00\u884c\u6216\u4e00\u5217\u8fdb\u884c\u5408\u5e76\uff0c\u53ea\u9700\u76f8\u5e94\u4fee\u6539\u53c2\u6570\u5373\u53ef\u3002\u4e0d\u8fc7\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5408\u5e76\u540e\u5355\u5143\u683c\u663e\u793a\u7684\u6587\u672c\u5185\u5bb9\u662f\u5408\u5e76\u524d\u6700\u5de6\u4e0a\u89d2\u5355\u5143\u683c\u7684\u5185\u5bb9\uff0c\u800c\u5176\u4ed6\u5355\u5143\u683c\u5185\u5bb9\u5219\u4f1a\u81ea\u52a8\u6e05\u9664\u3002 \u591a\u5173\u4e8eopenpyxl\u7684\u4ecb\u7ecd\uff0c \u53ef\u4ee5\u53c2\u9605readthedocs\u76f8\u5173\u6587\u6863","title":"3.5 \u5408\u5e76\u548c\u62c6\u5206\u5355\u5143\u683c"},{"location":"python/lib/nosql/memcached/memcached.index/","text":"1. \u4ecb\u7ecd \u00b6 \u8fd9\u4e2a\u6a21\u5757\u662f\u4e00\u4e2aPython\u64cd\u4f5cmemcached\u7684\u4e00\u4e2aAPI\u63a5\u53e3\u3002 Memcached\u5b98\u7f51\uff1a http://memcached.org/ \u6a21\u5757\u5b98\u7f51\uff1a https://pypi.python.org/pypi/python-memcached/ 1.1 \u4ec0\u4e48\u662fMemcached\uff1f \u00b6 \u514d\u8d39\u548c\u5f00\u6e90\uff0c\u9ad8\u6027\u80fd\uff0c\u5206\u5e03\u5f0f\u5185\u5b58\u5bf9\u8c61\u7f13\u5b58\u7cfb\u7edf\uff0c\u672c\u8d28\u4e0a\u662f\u901a\u7528\u7684\uff0c\u4f46\u65e8\u5728\u901a\u8fc7\u51cf\u8f7b\u6570\u636e\u5e93\u8d1f\u8f7d\u6765\u52a0\u901f\u52a8\u6001Web\u5e94\u7528\u7a0b\u5e8f\u3002 Memcached\u662f\u4e00\u4e2a\u5185\u5b58\u4e2d\u7684\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4e8e\u4ece\u6570\u636e\u5e93\u8c03\u7528\uff0cAPI\u8c03\u7528\u6216\u9875\u9762\u5448\u73b0\u7684\u7ed3\u679c\u4e2d\u83b7\u53d6\u4efb\u610f\u6570\u636e\uff08\u5b57\u7b26\u4e32\uff0c\u5bf9\u8c61\uff09\u7684\u5c0f\u5757\u3002 Memcached\u7b80\u5355\u800c\u5f3a\u5927\u3002\u5176\u7b80\u5355\u7684\u8bbe\u8ba1\u4fc3\u8fdb\u4e86\u5feb\u901f\u90e8\u7f72\uff0c\u6613\u4e8e\u5f00\u53d1\uff0c\u5e76\u89e3\u51b3\u4e86\u5927\u578b\u6570\u636e\u7f13\u5b58\u9762\u4e34\u7684\u8bb8\u591a\u95ee\u9898\u3002\u5176API\u9002\u7528\u4e8e\u5927\u591a\u6570\u6d41\u884c\u8bed\u8a00\u3002 \u4ee5\u4e0a\u5185\u5bb9\u6458\u81ea\u5b98\u7f51\u7684\u4ecb\u7ecd\u7684\u7ffb\u8bd1\uff0c\u5177\u4f53\u4fe1\u606f\u8bbf\u95ee\u5b98\u7f51 1.2 \u5b89\u88c5 \u00b6 1.2.1 \u5728\u7ebf\u5b89\u88c5 \u00b6 ubuntu apt-get install memcached centos yum install memcached 1.2.2 \u79bb\u7ebf\u5b89\u88c5 \u00b6 Memcached\u6e90\u7801\u5305\u5b89\u88c5\u7684\u65f6\u5019\u9700\u8981\u4f9d\u8d56\u4e8elibevent \u5b89\u88c5\u4f9d\u8d56\u5e93 # Ubuntu apt-get install libevent-dev # CentOS yum install libevent-devel \u4e0d\u5b89\u88c5\u5e93\u7684\u65f6\u5019\uff0c\u7f16\u8bd1\u65f6\u5019\u62a5\u9519\u5982\u4e0b checking for libevent directory... configure: error: libevent is required. You can get it from http://www.monkey.org/~provos/libevent/ If it's already installed, specify its path using --with-libevent=/dir/ \u7f16\u8bd1\u5b89\u88c5memcached wget https://memcached.org/latest tar -zxf memcached-1.x.x.tar.gz cd memcached-1.x.x ./configure --prefix=/usr/local/memcached make && make test && sudo make install \u5177\u4f53\u53c2\u6570\u89c1./configure --help\u5168\u9009\u9879\uff0cSASL\u652f\u6301\u9700\u8981\u4e00\u4e9b\u53ef\u9009\u9644\u52a0\u5e93\u3002 \u64cd\u4f5c\u8fc7\u7a0b root@leco:/usr/local/src# wget http://www.memcached.org/files/memcached-1.5.12.tar.gz --2019-02-20 09:55:44-- http://www.memcached.org/files/memcached-1.5.12.tar.gz \u6b63\u5728\u89e3\u6790\u4e3b\u673a www.memcached.org (www.memcached.org)... 107.170.231.145 \u6b63\u5728\u8fde\u63a5 www.memcached.org (www.memcached.org)|107.170.231.145|:80... \u5df2\u8fde\u63a5\u3002 \u7701\u7565\u3002\u3002\u3002 root@leco:/usr/local/src# ls memcached-1.5.12.tar.gz memcached-1.5.12.tar.gz root@leco:/usr/local/src# tar xf memcached-1.5.12.tar.gz root@leco:/usr/local/src# cd memcached-1.5.12 root@leco:/usr/local/src/memcached-1.5.12# ./configure --prefix=/usr/local/memcached root@leco:/usr/local/src/memcached-1.5.12# make && sudo make install root@leco:/usr/local/src/memcached-1.5.12# echo $? 0 # \u6dfb\u52a0\u73af\u5883\u53d8\u91cf root@leco:/usr/local/src/memcached-1.5.12# vim /etc/profile root@leco:/usr/local/src/memcached-1.5.12# tail -1 /etc/profile export PATH=$PATH:/usr/local/memcached/bin root@leco:/usr/local/src/memcached-1.5.12# source /etc/profile \u4ee5\u4e0a\u662f\u6e90\u7801\u5305\u5b89\u88c5\uff0c\u53ef\u4ee5\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684\uff0c\u8981\u662f\u5728\u7ebf\u5b89\u88c5\uff0c\u90fd\u662f\u57fa\u4e8e\u7cfb\u7edf\u6e90\u5b89\u88c5\u7684\u3002\u63a8\u8350\u6e90\u7801\u5b89\u88c5 1.2.3 \u542f\u52a8 \u00b6 root@leco:~# memcached -d -m 10 -u root -l 0.0.0.0 -p 11211 -c 256 -P /tmp/memcached.pid root@leco:~# netstat -lnp|grep 11211 tcp 0 0 0.0.0.0:11211 0.0.0.0:* LISTEN 7862/memcached unix 2 [ ACC ] \u6d41 LISTENING 100911211 11507/unity-files-d @leco-com.canonical.Unity.Scope.files.T5294429510698002 root@leco:~# telnet localhost 11211 Trying 127.0.0.1... Connected to localhost. Escape character is '^]'. \u5982\u679c\u51fa\u73b0\u4ee5\u4e0a\u5185\u5bb9\u5c31\u4ee3\u8868\u542f\u52a8\u6210\u529f\uff01 \u53c2\u6570\u8bf4\u660e \u53c2\u6570 \u63cf\u8ff0 -d \u662f\u542f\u52a8\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b -m \u662f\u5206\u914d\u7ed9Memcache\u4f7f\u7528\u7684\u5185\u5b58\u6570\u91cf\uff0c\u5355\u4f4d\u662fMB -u \u662f\u8fd0\u884cMemcache\u7684\u7528\u6237 -l \u662f\u76d1\u542c\u7684\u670d\u52a1\u5668IP\u5730\u5740 -p \u662f\u8bbe\u7f6eMemcache\u76d1\u542c\u7684\u7aef\u53e3,\u6700\u597d\u662f1024\u4ee5\u4e0a\u7684\u7aef\u53e3 -c \u9009\u9879\u662f\u6700\u5927\u8fd0\u884c\u7684\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u9ed8\u8ba4\u662f1024\uff0c\u6309\u7167\u4f60\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u91cf\u6765\u8bbe\u5b9a -P \u662f\u8bbe\u7f6e\u4fdd\u5b58Memcache\u7684pid\u6587\u4ef6 1.2.4 \u8bbe\u7f6e\u5f00\u673a\u542f\u52a8 \u00b6 echo 'memcached -d -m 10 -u root -l 0.0.0.0 -p 11211 -c 256 -P /tmp/memcached.pid' >> /etc/rc.local 1.2.5 \u505c\u6b62 \u00b6 pkill `cat /tmp/memcached.pid` 2. memcached\u5e93 \u00b6 2.1 \u5b89\u88c5 \u00b6 root@leco:/home/leco# pip install python3-memcached Collecting python3-memcached Downloading https://files.pythonhosted.org/packages/14/fa/cd0d93c30722db0cfa777ec9cd0203fa7da2771a5c70c9908f471944b6e2/python3-memcached-1.51.tar.gz Building wheels for collected packages: python3-memcached Running setup.py bdist_wheel for python3-memcached ... done Stored in directory: /root/.cache/pip/wheels/6b/50/29/888c59a274ac0e5d3831987eec3a6f6c4562e021c2fc0311b0 Successfully built python3-memcached Installing collected packages: python3-memcached Successfully installed python3-memcached-1.51 root@leco:~/book# pip -V pip 9.0.1 from /usr/local/lib/python3.6/site-packages (python 3.6) root@leco:~/book# python3.6 Python 3.6.1 (default, Mar 21 2018, 13:46:25) [GCC 5.4.0 20160609] on linux Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. >>> import memcache >>> \u5bfc\u5165\u6ca1\u6709\u62a5\u9519\u5c31\u8868\u793a\u5b89\u88c5\u6210\u529f\u3002 2.2 \u6d4b\u8bd5 \u00b6 root@leco:~/book# ipython Python 3.6.1 (default, Mar 21 2018, 13:46:25) Type 'copyright', 'credits' or 'license' for more information IPython 6.2.1 -- An enhanced Interactive Python. Type '?' for help. # \u5bfc\u5165\u6a21\u5757 In [1]: import memcache # \u94fe\u63a5\uff0cip\uff1aport In [2]: conn = memcache.Client(['127.0.0.1:11211']) # \u8bbe\u7f6e key:value In [3]: conn.set('k1', 'v1') Out[3]: True # \u53d6\u503c In [4]: conn.get('k1') Out[4]: 'v1 2.3 \u5176\u4ed6\u547d\u4ee4\u6d4b\u8bd5 \u00b6 \u7528nc\u547d\u4ee4\u64cd\u4f5cmemcached \u529f\u80fd \u547d\u4ee4 \u5b58\u50a8\u6570\u636e printf \"set key 0 10 6\\r\\nresult\\r\\n\" \u83b7\u53d6\u6570\u636e printf \"get key\\r\\n\" \u5220\u9664\u6570\u636e printf \"delete key\\r\\n\" \u67e5\u770b\u72b6\u6001 printf \"stats\\r\\n\" \u6a21\u62dftop\u547d\u4ee4\u67e5\u770b\u72b6\u6001 watch \"echo stats\" \u6e05\u7a7a\u7f13\u5b58 printf \"flush_all\\r\\n\" 2.3 \u96c6\u7fa4 \u00b6 python-memcached\u6a21\u5757\u539f\u751f\u652f\u6301\u96c6\u7fa4\u64cd\u4f5c\uff0c\u5176\u539f\u7406\u662f\u5728\u5185\u5b58\u4e2d\u7ef4\u62a4\u4e00\u4e2a\u4e3b\u673a\u5217\u8868\uff0c\u4e14\u96c6\u7fa4\u4e2d\u4e3b\u673a\u7684\u6743\u91cd\u503c\u548c\u4e3b\u673a\u5728\u5217\u8868\u4e2d\u91cd\u590d\u51fa\u73b0\u7684\u6b21\u6570\u6210\u6b63\u6bd4\u3002 \u4e3b\u673a \u6743\u91cd 1.1.1.1 1 1.1.1.2 2 1.1.1.3 1 \u90a3\u4e48\u5728\u5185\u5b58\u4e2d\u4e3b\u673a\u5217\u8868\u4e3a\uff1a host_list = [\"1.1.1.1\", \"1.1.1.2\", \"1.1.1.2\", \"1.1.1.3\", ] \u7528\u6237\u5982\u679c\u8981\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a\u952e\u503c\u5bf9\uff08\u5982\uff1ak1 = \"value1\"\uff09\uff0c\u90a3\u4e48\u8981\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u6839\u636e\u7b97\u6cd5\u5c06k1\u8f6c\u6362\u6210\u4e00\u4e2a\u6570\u5b57 \u5c06\u6570\u5b57\u548c\u4e3b\u673a\u5217\u8868\u957f\u5ea6\u6c42\u4f59\u6570\uff0c\u5f97\u5230\u4e00\u4e2a\u503cN\uff080 <= N < \u957f\u5ea6\uff09 \u5728\u4e3b\u673a\u5217\u8868\u4e2d\u6839\u636e\u7b2c\u4e8c\u6b65\u5f97\u5230\u7684\u503c\u4e3a\u7d22\u5f15\u83b7\u53d6\u4e3b\u673a\uff0c\u4f8b\u5982: host_list[N] \u8fde\u63a5\u5c06\u7b2c\u4e09\u6b65\u4e2d\u83b7\u53d6\u7684\u4e3b\u673a\uff0c\u5c06k1 = \"value1\" \u653e\u7f6e\u5728\u8be5\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e2d \u53e6\u5916\u5728\u542f\u52a8\u4e24\u4e2a\u670d\u52a1 memcached -d -m 10 -u root -l 0.0.0.0 -p 11212 -c 256 -P /tmp/memcached2.pid memcached -d -m 10 -u root -l 0.0.0.0 -p 11213 -c 256 -P /tmp/memcached3.pid \u64cd\u4f5c\u8fc7\u7a0b root@leco:~# memcached -d -m 10 -u root -l 0.0.0.0 -p 11212 -c 256 -P /tmp/memcached2.pid root@leco:~# memcached -d -m 10 -u root -l 0.0.0.0 -p 11213 -c 256 -P /tmp/memcached3.pid root@leco:~# netstat -lnp|grep memcached tcp 0 0 0.0.0.0:11211 0.0.0.0:* LISTEN 7862/memcached tcp 0 0 0.0.0.0:11212 0.0.0.0:* LISTEN 11748/memcached tcp 0 0 0.0.0.0:11213 0.0.0.0:* LISTEN 11759/memcached root@leco:~/code/memcached# cat test1.py #!/usr/bin/env python3 #coding:utf8 import memcache mc = memcache.Client([('127.0.0.1:11211', 1), ('127.0.0.1:11212', 2),('127.0.0.1:11213',3)]) mc.set('k1','value1') ret = mc.get('k1') print (ret) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3.6 test1.py value1 2.4 \u5b58\u50a8\u64cd\u4f5c \u00b6 2.4.1 set/set_multi \u00b6 set : \u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u5982\u679cKey\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\uff0c\u5982\u679ckey\u5b58\u5728\uff0c\u5219\u4fee\u6539\u3002 set_multi : \u8bbe\u7f6e\u591a\u4e2a\u952e\u503c\u5bf9\uff0c\u5982\u679ckey\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\uff0c\u5982\u679ckey\u5b58\u5728\uff0c\u5219\u4fee\u6539\u3002 root@leco:~/code/memcached# cat set.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name','jack') re = mc.get('name') print('set\u7528\u6cd5',re) #\u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9 dic = {'name':'jack','age':'19','job':'IT'} mc.set_multi(dic) #\u8bbe\u7f6e\u591a\u4e2a\u952e\u503c\u5bf9 #\u6216\u8005mc.set_multi({'name':'jack','age':'19','job':'IT'}) name = mc.get('name') age = mc.get('age') job = mc.get('job') print('set_multi\u7528\u6cd5:',name,age,job) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3 set.py set\u7528\u6cd5 jack set_multi\u7528\u6cd5: jack 19 IT 2.4.2 add \u00b6 \u6dfb\u52a0\u4e00\u6761\u952e\u503c\u5bf9\uff0c\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u7684key\uff0c\u91cd\u590d\u6267\u884cadd\u64cd\u4f5c\u8fd4\u56de\u503c\u4e3aflase\u3002 root@leco:~/code/memcached# cat add.py #!/usr/bin/env python3 #coding:utf8 import memcache mc = memcache.Client([('127.0.0.1:11211', 1)]) ret1 = mc.add('add','v1') ret2 = mc.add('add','v2') ret = mc.get('add') print(ret1) print(ret2) print(ret) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python2 add.py True # \u7b2c\u4e00\u6dfb\u52a0add \u8fd9\u4e2a\u952e\u65f6\u5019\uff0c\u4e4b\u524d\u662f\u6ca1\u6709\u7684\uff0c\u6240\u6709\u53ef\u4ee5\u521b\u5efa\u3002 False # \u7b2c\u4e8c\u6b21\u518d\u6b21\u6dfb\u52a0add\u8fd9\u4e2a\u952e\u65f6\u5019\uff0c\u4e4b\u524d\u6709\u4e86add\u8fd9\u4e2a\u952e\uff0c\u6240\u4ee5\u521b\u5efa\u5931\u8d25 v1 2.4.3 replace \u00b6 replace\u4fee\u6539\u67d0\u4e2akey\u7684\u503c\uff0c\u5982\u679ckey\u4e0d\u5b58\u5728\uff0c\u8fd4\u56deFalse root@leco:~/code/memcached# cat replace.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name','\u5f20\u4e09') re = mc.get('name') print(re) ret_name = mc.replace('name','\u674e\u56db') ret1 = mc.get('name') rereplace = mc.replace('name10','hahaha') ret2 = mc.get('name10') print(\"ret_name = \",ret_name) print(\"ret1 = \",ret1) print(\"rereplace = \",rereplace) print(\"ret2 = \",ret2) root@leco:~/code/memcached# python3 replace.py \u5f20\u4e09 ret_name = True # key\u5b58\u5728\u66ff\u6362\u6210\u529f ret1 = \u674e\u56db # \u4fee\u6539\u540e\u7684\u503c rereplace = False # key\u4e0d\u5b58\u5728\uff0c\u66ff\u6362\u5931\u8d25 ret2 = None # \u4e0d\u5b58\u5728\u7684key\uff0c\u8fd4\u56deFalse 2.4.4 append/prepend \u00b6 append : \u4fee\u6539\u6307\u5b9akey\u7684\u503c\uff0c\u5728\u8be5\u503c\u540e\u9762\u8ffd\u52a0\u5185\u5bb9\u3002 prepend : \u4fee\u6539\u6307\u5b9akey\u7684\u503c\uff0c\u5728\u8be5\u503c\u524d\u9762\u63d2\u5165\u5185\u5bb9\u3002 root@leco:~/code/memcached# cat append.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('num','\u6211\u662f\u4e2d\u95f4\u90e8\u5206') re = mc.get('num') print(re) mc.append('num','\u6211\u662f\u540e\u9762\u90e8\u5206') # \u5728\u6211\u662f\u4e2d\u95f4\u90e8\u5206\u540e\u8ffd\u52a0 re = mc.get('num') print(re) mc.prepend('num','\u6211\u662f\u5f00\u5934\u90e8\u5206') # \u5728\u6211\u662f\u4e2d\u95f4\u90e8\u5206\u524d\u8ffd\u52a0 re = mc.get('num') print(re) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3 append.py \u6211\u662f\u4e2d\u95f4\u90e8\u5206 \u6211\u662f\u4e2d\u95f4\u90e8\u5206\u6211\u662f\u540e\u9762\u90e8\u5206 \u6211\u662f\u5f00\u5934\u90e8\u5206\u6211\u662f\u4e2d\u95f4\u90e8\u5206\u6211\u662f\u540e\u9762\u90e8\u5206 2.4.5 gets/cas \u00b6 \u4f7f\u7528\u7f13\u5b58\u7cfb\u7edf\u5171\u4eab\u6570\u636e\u8d44\u6e90\u5c31\u5fc5\u7136\u7ed5\u4e0d\u5f00\u6570\u636e\u4e89\u593a\u548c\u810f\u6570\u636e\uff08\u6570\u636e\u6df7\u4e71\uff09\u7684\u95ee\u9898\u3002 \u5047\u8bbe\u53bb\u5f80\u5f90\u5dde\u7684\u9ad8\u94c1G88\u5217\u8f66\u5269\u4f59\u7968\u6570\u4fdd\u5b58\u5728memcache\u4e2d\uff0cticket_count = 88 A\u7528\u6237\u5237\u65b0\u9875\u9762\u4ecememecache\u4e2d\u8bfb\u53d6\u5230ticket_count = 88 B\u7528\u6237\u5237\u65b0\u9875\u9762\u4ecememecache\u4e2d\u8bfb\u53d6\u5230ticket_count = 88 A,B\u7528\u6237\u5747\u8d2d\u4e70\u8be5\u8d9f\u5217\u8f66\u7684\u7968\uff0c\u5e76\u4fee\u6539ticket_count\u7684\u503c A\u4fee\u6539\u540e\uff0cticket_count = 87 B\u4fee\u6539\u540e\uff0cticket_count = 87 \u7136\u800c\u6b63\u786e\u6570\u5b57\u5e94\u8be5\u662f86\uff0c\u6570\u636e\u5c31\u6df7\u4e71\u4e86\u3002 \u5982\u679c\u60f3\u8981\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 gets\u3000\u548c\u3000cas root@leco:~/code/memcached# cat gets.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('ticket','88') reget = mc.get('ticket') print('\u5269\u4f59\u7968\u6570',reget) ret = mc.gets('ticket') print(ret) # \u5982\u679c\u6709\u4eba\u5728gets\u4e4b\u540e\u548ccas\u4e4b\u524d\u4fee\u6539\u4e86product_count\uff0c\u90a3\u4e48\uff0c # \u4e0b\u9762\u7684\u8bbe\u7f6e\u5c06\u4f1a\u6267\u884c\u5931\u8d25\uff0c\u5256\u51fa\u5f02\u5e38\uff0c\u4ece\u800c\u907f\u514d\u975e\u6b63\u5e38\u6570\u636e\u7684\u4ea7\u751f recas = mc.cas('ticket','88') print(recas) ret = mc.gets('ticket') print('\u5269\u4f59\u7968\u6570',ret) root@leco:~/code/memcached# python3 gets.py \u5269\u4f59\u7968\u6570 88 88 True \u5269\u4f59\u7968\u6570 88 \u672c\u8d28\u4e0a\u6bcf\u6b21\u6267\u884cgets\u65f6\uff0c\u4f1a\u4ecememcache\u4e2d\u83b7\u53d6\u4e00\u4e2a\u81ea\u589e\u7684\u6570\u5b57\uff0c\u901a\u8fc7cas\u53bb\u4fee\u6539gets\u7684\u503c\u65f6\uff0c\u4f1a\u643a\u5e26\u4e4b\u524d\u83b7\u53d6\u7684\u81ea\u589e\u548cmemcache\u4e2d\u7684\u81ea\u589e\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u53ef\u4ee5\u63d0\u4ea4\uff0c\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u90a3\u4e48\u8868\u793a\u5728gets\u548ccas\u6267\u884c\u4e4b\u95f4\uff0c\u53c8\u6709\u5176\u4ed6\u4eba\u6267\u884c\u4e86gets\uff0c\u5219\u4e0d\u5141\u8bb8\u4fee\u6539\u3002 2.5 \u67e5\u627e\u64cd\u4f5c \u00b6 2.5.1 get,get_multi \u00b6 get : \u83b7\u53d6\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 get_multi : \u83b7\u53d6\u591a\u4e2a\u952e\u503c\u5bf9\u3002 root@leco:~/code/memcached# cat get.py #!/usr/bin/env python3 #coding:utf8 import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name','jack') re = mc.get('name') print('get',re) # \u83b7\u53d6\u4e00\u4e2a\u952e\u503c\u5bf9 dic = {'name':'jack','age':'20','job':'IT'} mc.set_multi(dic) regetmu=mc.get_multi(['name','age','job']) print('get_multi',re) # \u83b7\u53d6\u591a\u4e2a\u952e\u503c\u5bf9\u7684\u503c root@leco:~/code/memcached# python3 get.py get jack get_multi jack \u82e5\u662fget\u7684key\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u8fd4\u56de\u4e3a\u7a7a\u3002 2.5.2 delete/delete_multi \u00b6 delete : \u5728Memcached\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 delete_multi : \u5728Memcached\u4e2d\u5220\u9664\u6307\u5b9a\u591a\u4e2a\u952e\u503c\u5bf9\u3002 root@leco:~/code/memcached# cat del.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name1','JACK1') mc.set('name2','JACK2') mc.set('name3','JACK3') name1,name2,name3 = mc.get('name1'),mc.get('name2'),mc.get('name3') print('name1 = %s, name2=%s, name3=%s' %(name1,name2,name3)) mc.delete('name1') re = mc.get('name') print('\u5220\u9664',re) #\u5220\u9664\u4e00\u4e2a\u952e\u503c\u5bf9 mc.delete_multi(['name2','name3']) name1,name2,name3 = mc.get('name1'),mc.get('name2'),mc.get('name3') print('name1 = %s, name2=%s, name3=%s' %(name1,name2,name3)) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3 del.py name1 = JACK1, name2=JACK2, name3=JACK3 \u5220\u9664 jack name1 = None, name2=None, name3=None 2.5.4 incre/decr \u00b6 decr : \u81ea\u51cf\uff0c\u5c06Memcached\u4e2d\u7684\u4e00\u4e2a\u503c\u589e\u52a0N\uff08N\u9ed8\u8ba4\u4e3a1\uff09 incr : \u81ea\u589e\uff0c\u5c06Memcached\u4e2d\u7684\u4e00\u4e2a\u503c\u51cf\u5c11N\uff08N\u9ed8\u8ba4\u4e3a1\uff09 root@leco:~/code/memcached# cat decr.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('num',1) ret = mc.get('num') print('\u539f\u59cb\u503c',ret) mc.incr('num',9) ret = mc.get('num') print('\u52a0\u503c\u540e\u7ed3\u679c = ',ret) mc.decr('num',5) ret = mc.get('num') print('\u51cf\u503c\u540e\u7ed3\u679c = ',ret) root@leco:~/code/memcached# python3 decr.py \u539f\u59cb\u503c 1 \u52a0\u503c\u540e\u7ed3\u679c = 10 \u51cf\u503c\u540e\u7ed3\u679c = 5 2.6 \u7edf\u8ba1\u64cd\u4f5c \u00b6 2.6.1 stats \u00b6 Memcached stats\u547d\u4ee4\u7528\u4e8e\u8fd4\u56de\u7edf\u8ba1\u4fe1\u606f\u4f8b\u5982PID\uff08\u8fdb\u7a0b\u53f7\uff09\uff0c\u7248\u672c\u53f7\uff0c\u8fde\u63a5\u6570\u7b49\u3002 root@leco:~/code/memcached# cat stats.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) ret = mc.get_stats() print(ret) root@leco:~/code/memcached# python3 stats.py [(b'127.0.0.1:11211 (1)', {b'pid': b'7862', b'uptime': b'6680', b'time': b'1550635332', b'version': b'1.5.12', b'libevent': b'2.0.21-stable', b'pointer_size': b'64', b'rusage_user': b'0.537668', b'rusage_system': b'0.414349', b'max_connections': b'256', b'curr_connections': b'2', b'total_connections': b'31', b'rejected_connections': b'0', b'connection_structures': b'4', b'reserved_fds': b'20', b'cmd_get': b'77', b'cmd_set': b'65', b'cmd_flush': b'0', b'cmd_touch': b'0', b'get_hits': b'67', b'get_misses': b'10', b'get_expired': b'0', b'get_flushed': b'0', b'delete_misses': b'4', b'delete_hits': b'6', b'incr_misses': b'0', b'incr_hits': b'2', b'decr_misses': b'0', b'decr_hits': b'1', b'cas_misses': b'0', b'cas_hits': b'0', b'cas_badval': b'0', b'touch_hits': b'0', b'touch_misses': b'0', b'auth_cmds': b'0', b'auth_errors': b'0', b'bytes_read': b'2630', b'bytes_written': b'4681', b'limit_maxbytes': b'10485760', b'accepting_conns': b'1', b'listen_disabled_num': b'0', b'time_in_listen_disabled_us': b'0', b'threads': b'4', b'conn_yields': b'0', b'hash_power_level': b'16', b'hash_bytes': b'524288', b'hash_is_expanding': b'0', b'slab_reassign_rescues': b'0', b'slab_reassign_chunk_rescues': b'0', b'slab_reassign_evictions_nomem': b'0', b'slab_reassign_inline_reclaim': b'0', b'slab_reassign_busy_items': b'0', b'slab_reassign_busy_deletes': b'0', b'slab_reassign_running': b'0', b'slabs_moved': b'0', b'lru_crawler_running': b'0', b'lru_crawler_starts':b'3825', b'lru_maintainer_juggles': b'14452', b'malloc_fails': b'0', b'log_worker_dropped': b'0', b'log_worker_written': b'0', b'log_watcher_skipped': b'0', b'log_watcher_sent': b'0', b'bytes': b'520', b'curr_items': b'8', b'total_items': b'56', b'slab_global_page_pool': b'0', b'expired_unfetched': b'0', b'evicted_unfetched': b'0', b'evicted_active': b'0', b'evictions': b'0', b'reclaimed': b'0', b'crawler_reclaimed': b'0', b'crawler_items_checked': b'41', b'lrutail_reflocked': b'4', b'moves_to_cold': b'24', b'moves_to_warm': b'8', b'moves_within_lru': b'1', b'direct_reclaims': b'0', b'lru_bumps_dropped': b'0'})] 2.6.2 slabs \u00b6 Memcached stats slabs \u547d\u4ee4\u7528\u4e8e\u663e\u793a\u5404\u4e2aslab\u7684\u4fe1\u606f\uff0c\u5305\u62ecchunk\u7684\u5927\u5c0f\u3001\u6570\u76ee\u3001\u4f7f\u7528\u60c5\u51b5\u7b49\u3002","title":"1. memcached"},{"location":"python/lib/nosql/memcached/memcached.index/#1","text":"\u8fd9\u4e2a\u6a21\u5757\u662f\u4e00\u4e2aPython\u64cd\u4f5cmemcached\u7684\u4e00\u4e2aAPI\u63a5\u53e3\u3002 Memcached\u5b98\u7f51\uff1a http://memcached.org/ \u6a21\u5757\u5b98\u7f51\uff1a https://pypi.python.org/pypi/python-memcached/","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/nosql/memcached/memcached.index/#11-memcached","text":"\u514d\u8d39\u548c\u5f00\u6e90\uff0c\u9ad8\u6027\u80fd\uff0c\u5206\u5e03\u5f0f\u5185\u5b58\u5bf9\u8c61\u7f13\u5b58\u7cfb\u7edf\uff0c\u672c\u8d28\u4e0a\u662f\u901a\u7528\u7684\uff0c\u4f46\u65e8\u5728\u901a\u8fc7\u51cf\u8f7b\u6570\u636e\u5e93\u8d1f\u8f7d\u6765\u52a0\u901f\u52a8\u6001Web\u5e94\u7528\u7a0b\u5e8f\u3002 Memcached\u662f\u4e00\u4e2a\u5185\u5b58\u4e2d\u7684\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4e8e\u4ece\u6570\u636e\u5e93\u8c03\u7528\uff0cAPI\u8c03\u7528\u6216\u9875\u9762\u5448\u73b0\u7684\u7ed3\u679c\u4e2d\u83b7\u53d6\u4efb\u610f\u6570\u636e\uff08\u5b57\u7b26\u4e32\uff0c\u5bf9\u8c61\uff09\u7684\u5c0f\u5757\u3002 Memcached\u7b80\u5355\u800c\u5f3a\u5927\u3002\u5176\u7b80\u5355\u7684\u8bbe\u8ba1\u4fc3\u8fdb\u4e86\u5feb\u901f\u90e8\u7f72\uff0c\u6613\u4e8e\u5f00\u53d1\uff0c\u5e76\u89e3\u51b3\u4e86\u5927\u578b\u6570\u636e\u7f13\u5b58\u9762\u4e34\u7684\u8bb8\u591a\u95ee\u9898\u3002\u5176API\u9002\u7528\u4e8e\u5927\u591a\u6570\u6d41\u884c\u8bed\u8a00\u3002 \u4ee5\u4e0a\u5185\u5bb9\u6458\u81ea\u5b98\u7f51\u7684\u4ecb\u7ecd\u7684\u7ffb\u8bd1\uff0c\u5177\u4f53\u4fe1\u606f\u8bbf\u95ee\u5b98\u7f51","title":"1.1 \u4ec0\u4e48\u662fMemcached\uff1f"},{"location":"python/lib/nosql/memcached/memcached.index/#12","text":"","title":"1.2 \u5b89\u88c5"},{"location":"python/lib/nosql/memcached/memcached.index/#121","text":"ubuntu apt-get install memcached centos yum install memcached","title":"1.2.1 \u5728\u7ebf\u5b89\u88c5"},{"location":"python/lib/nosql/memcached/memcached.index/#122","text":"Memcached\u6e90\u7801\u5305\u5b89\u88c5\u7684\u65f6\u5019\u9700\u8981\u4f9d\u8d56\u4e8elibevent \u5b89\u88c5\u4f9d\u8d56\u5e93 # Ubuntu apt-get install libevent-dev # CentOS yum install libevent-devel \u4e0d\u5b89\u88c5\u5e93\u7684\u65f6\u5019\uff0c\u7f16\u8bd1\u65f6\u5019\u62a5\u9519\u5982\u4e0b checking for libevent directory... configure: error: libevent is required. You can get it from http://www.monkey.org/~provos/libevent/ If it's already installed, specify its path using --with-libevent=/dir/ \u7f16\u8bd1\u5b89\u88c5memcached wget https://memcached.org/latest tar -zxf memcached-1.x.x.tar.gz cd memcached-1.x.x ./configure --prefix=/usr/local/memcached make && make test && sudo make install \u5177\u4f53\u53c2\u6570\u89c1./configure --help\u5168\u9009\u9879\uff0cSASL\u652f\u6301\u9700\u8981\u4e00\u4e9b\u53ef\u9009\u9644\u52a0\u5e93\u3002 \u64cd\u4f5c\u8fc7\u7a0b root@leco:/usr/local/src# wget http://www.memcached.org/files/memcached-1.5.12.tar.gz --2019-02-20 09:55:44-- http://www.memcached.org/files/memcached-1.5.12.tar.gz \u6b63\u5728\u89e3\u6790\u4e3b\u673a www.memcached.org (www.memcached.org)... 107.170.231.145 \u6b63\u5728\u8fde\u63a5 www.memcached.org (www.memcached.org)|107.170.231.145|:80... \u5df2\u8fde\u63a5\u3002 \u7701\u7565\u3002\u3002\u3002 root@leco:/usr/local/src# ls memcached-1.5.12.tar.gz memcached-1.5.12.tar.gz root@leco:/usr/local/src# tar xf memcached-1.5.12.tar.gz root@leco:/usr/local/src# cd memcached-1.5.12 root@leco:/usr/local/src/memcached-1.5.12# ./configure --prefix=/usr/local/memcached root@leco:/usr/local/src/memcached-1.5.12# make && sudo make install root@leco:/usr/local/src/memcached-1.5.12# echo $? 0 # \u6dfb\u52a0\u73af\u5883\u53d8\u91cf root@leco:/usr/local/src/memcached-1.5.12# vim /etc/profile root@leco:/usr/local/src/memcached-1.5.12# tail -1 /etc/profile export PATH=$PATH:/usr/local/memcached/bin root@leco:/usr/local/src/memcached-1.5.12# source /etc/profile \u4ee5\u4e0a\u662f\u6e90\u7801\u5305\u5b89\u88c5\uff0c\u53ef\u4ee5\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684\uff0c\u8981\u662f\u5728\u7ebf\u5b89\u88c5\uff0c\u90fd\u662f\u57fa\u4e8e\u7cfb\u7edf\u6e90\u5b89\u88c5\u7684\u3002\u63a8\u8350\u6e90\u7801\u5b89\u88c5","title":"1.2.2 \u79bb\u7ebf\u5b89\u88c5"},{"location":"python/lib/nosql/memcached/memcached.index/#123","text":"root@leco:~# memcached -d -m 10 -u root -l 0.0.0.0 -p 11211 -c 256 -P /tmp/memcached.pid root@leco:~# netstat -lnp|grep 11211 tcp 0 0 0.0.0.0:11211 0.0.0.0:* LISTEN 7862/memcached unix 2 [ ACC ] \u6d41 LISTENING 100911211 11507/unity-files-d @leco-com.canonical.Unity.Scope.files.T5294429510698002 root@leco:~# telnet localhost 11211 Trying 127.0.0.1... Connected to localhost. Escape character is '^]'. \u5982\u679c\u51fa\u73b0\u4ee5\u4e0a\u5185\u5bb9\u5c31\u4ee3\u8868\u542f\u52a8\u6210\u529f\uff01 \u53c2\u6570\u8bf4\u660e \u53c2\u6570 \u63cf\u8ff0 -d \u662f\u542f\u52a8\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b -m \u662f\u5206\u914d\u7ed9Memcache\u4f7f\u7528\u7684\u5185\u5b58\u6570\u91cf\uff0c\u5355\u4f4d\u662fMB -u \u662f\u8fd0\u884cMemcache\u7684\u7528\u6237 -l \u662f\u76d1\u542c\u7684\u670d\u52a1\u5668IP\u5730\u5740 -p \u662f\u8bbe\u7f6eMemcache\u76d1\u542c\u7684\u7aef\u53e3,\u6700\u597d\u662f1024\u4ee5\u4e0a\u7684\u7aef\u53e3 -c \u9009\u9879\u662f\u6700\u5927\u8fd0\u884c\u7684\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u9ed8\u8ba4\u662f1024\uff0c\u6309\u7167\u4f60\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u91cf\u6765\u8bbe\u5b9a -P \u662f\u8bbe\u7f6e\u4fdd\u5b58Memcache\u7684pid\u6587\u4ef6","title":"1.2.3 \u542f\u52a8"},{"location":"python/lib/nosql/memcached/memcached.index/#124","text":"echo 'memcached -d -m 10 -u root -l 0.0.0.0 -p 11211 -c 256 -P /tmp/memcached.pid' >> /etc/rc.local","title":"1.2.4 \u8bbe\u7f6e\u5f00\u673a\u542f\u52a8"},{"location":"python/lib/nosql/memcached/memcached.index/#125","text":"pkill `cat /tmp/memcached.pid`","title":"1.2.5 \u505c\u6b62"},{"location":"python/lib/nosql/memcached/memcached.index/#2-memcached","text":"","title":"2. memcached\u5e93"},{"location":"python/lib/nosql/memcached/memcached.index/#21","text":"root@leco:/home/leco# pip install python3-memcached Collecting python3-memcached Downloading https://files.pythonhosted.org/packages/14/fa/cd0d93c30722db0cfa777ec9cd0203fa7da2771a5c70c9908f471944b6e2/python3-memcached-1.51.tar.gz Building wheels for collected packages: python3-memcached Running setup.py bdist_wheel for python3-memcached ... done Stored in directory: /root/.cache/pip/wheels/6b/50/29/888c59a274ac0e5d3831987eec3a6f6c4562e021c2fc0311b0 Successfully built python3-memcached Installing collected packages: python3-memcached Successfully installed python3-memcached-1.51 root@leco:~/book# pip -V pip 9.0.1 from /usr/local/lib/python3.6/site-packages (python 3.6) root@leco:~/book# python3.6 Python 3.6.1 (default, Mar 21 2018, 13:46:25) [GCC 5.4.0 20160609] on linux Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. >>> import memcache >>> \u5bfc\u5165\u6ca1\u6709\u62a5\u9519\u5c31\u8868\u793a\u5b89\u88c5\u6210\u529f\u3002","title":"2.1 \u5b89\u88c5"},{"location":"python/lib/nosql/memcached/memcached.index/#22","text":"root@leco:~/book# ipython Python 3.6.1 (default, Mar 21 2018, 13:46:25) Type 'copyright', 'credits' or 'license' for more information IPython 6.2.1 -- An enhanced Interactive Python. Type '?' for help. # \u5bfc\u5165\u6a21\u5757 In [1]: import memcache # \u94fe\u63a5\uff0cip\uff1aport In [2]: conn = memcache.Client(['127.0.0.1:11211']) # \u8bbe\u7f6e key:value In [3]: conn.set('k1', 'v1') Out[3]: True # \u53d6\u503c In [4]: conn.get('k1') Out[4]: 'v1","title":"2.2 \u6d4b\u8bd5"},{"location":"python/lib/nosql/memcached/memcached.index/#23","text":"\u7528nc\u547d\u4ee4\u64cd\u4f5cmemcached \u529f\u80fd \u547d\u4ee4 \u5b58\u50a8\u6570\u636e printf \"set key 0 10 6\\r\\nresult\\r\\n\" \u83b7\u53d6\u6570\u636e printf \"get key\\r\\n\" \u5220\u9664\u6570\u636e printf \"delete key\\r\\n\" \u67e5\u770b\u72b6\u6001 printf \"stats\\r\\n\" \u6a21\u62dftop\u547d\u4ee4\u67e5\u770b\u72b6\u6001 watch \"echo stats\" \u6e05\u7a7a\u7f13\u5b58 printf \"flush_all\\r\\n\"","title":"2.3 \u5176\u4ed6\u547d\u4ee4\u6d4b\u8bd5"},{"location":"python/lib/nosql/memcached/memcached.index/#23_1","text":"python-memcached\u6a21\u5757\u539f\u751f\u652f\u6301\u96c6\u7fa4\u64cd\u4f5c\uff0c\u5176\u539f\u7406\u662f\u5728\u5185\u5b58\u4e2d\u7ef4\u62a4\u4e00\u4e2a\u4e3b\u673a\u5217\u8868\uff0c\u4e14\u96c6\u7fa4\u4e2d\u4e3b\u673a\u7684\u6743\u91cd\u503c\u548c\u4e3b\u673a\u5728\u5217\u8868\u4e2d\u91cd\u590d\u51fa\u73b0\u7684\u6b21\u6570\u6210\u6b63\u6bd4\u3002 \u4e3b\u673a \u6743\u91cd 1.1.1.1 1 1.1.1.2 2 1.1.1.3 1 \u90a3\u4e48\u5728\u5185\u5b58\u4e2d\u4e3b\u673a\u5217\u8868\u4e3a\uff1a host_list = [\"1.1.1.1\", \"1.1.1.2\", \"1.1.1.2\", \"1.1.1.3\", ] \u7528\u6237\u5982\u679c\u8981\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a\u952e\u503c\u5bf9\uff08\u5982\uff1ak1 = \"value1\"\uff09\uff0c\u90a3\u4e48\u8981\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u6839\u636e\u7b97\u6cd5\u5c06k1\u8f6c\u6362\u6210\u4e00\u4e2a\u6570\u5b57 \u5c06\u6570\u5b57\u548c\u4e3b\u673a\u5217\u8868\u957f\u5ea6\u6c42\u4f59\u6570\uff0c\u5f97\u5230\u4e00\u4e2a\u503cN\uff080 <= N < \u957f\u5ea6\uff09 \u5728\u4e3b\u673a\u5217\u8868\u4e2d\u6839\u636e\u7b2c\u4e8c\u6b65\u5f97\u5230\u7684\u503c\u4e3a\u7d22\u5f15\u83b7\u53d6\u4e3b\u673a\uff0c\u4f8b\u5982: host_list[N] \u8fde\u63a5\u5c06\u7b2c\u4e09\u6b65\u4e2d\u83b7\u53d6\u7684\u4e3b\u673a\uff0c\u5c06k1 = \"value1\" \u653e\u7f6e\u5728\u8be5\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e2d \u53e6\u5916\u5728\u542f\u52a8\u4e24\u4e2a\u670d\u52a1 memcached -d -m 10 -u root -l 0.0.0.0 -p 11212 -c 256 -P /tmp/memcached2.pid memcached -d -m 10 -u root -l 0.0.0.0 -p 11213 -c 256 -P /tmp/memcached3.pid \u64cd\u4f5c\u8fc7\u7a0b root@leco:~# memcached -d -m 10 -u root -l 0.0.0.0 -p 11212 -c 256 -P /tmp/memcached2.pid root@leco:~# memcached -d -m 10 -u root -l 0.0.0.0 -p 11213 -c 256 -P /tmp/memcached3.pid root@leco:~# netstat -lnp|grep memcached tcp 0 0 0.0.0.0:11211 0.0.0.0:* LISTEN 7862/memcached tcp 0 0 0.0.0.0:11212 0.0.0.0:* LISTEN 11748/memcached tcp 0 0 0.0.0.0:11213 0.0.0.0:* LISTEN 11759/memcached root@leco:~/code/memcached# cat test1.py #!/usr/bin/env python3 #coding:utf8 import memcache mc = memcache.Client([('127.0.0.1:11211', 1), ('127.0.0.1:11212', 2),('127.0.0.1:11213',3)]) mc.set('k1','value1') ret = mc.get('k1') print (ret) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3.6 test1.py value1","title":"2.3 \u96c6\u7fa4"},{"location":"python/lib/nosql/memcached/memcached.index/#24","text":"","title":"2.4 \u5b58\u50a8\u64cd\u4f5c"},{"location":"python/lib/nosql/memcached/memcached.index/#241-setset_multi","text":"set : \u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u5982\u679cKey\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\uff0c\u5982\u679ckey\u5b58\u5728\uff0c\u5219\u4fee\u6539\u3002 set_multi : \u8bbe\u7f6e\u591a\u4e2a\u952e\u503c\u5bf9\uff0c\u5982\u679ckey\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\uff0c\u5982\u679ckey\u5b58\u5728\uff0c\u5219\u4fee\u6539\u3002 root@leco:~/code/memcached# cat set.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name','jack') re = mc.get('name') print('set\u7528\u6cd5',re) #\u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9 dic = {'name':'jack','age':'19','job':'IT'} mc.set_multi(dic) #\u8bbe\u7f6e\u591a\u4e2a\u952e\u503c\u5bf9 #\u6216\u8005mc.set_multi({'name':'jack','age':'19','job':'IT'}) name = mc.get('name') age = mc.get('age') job = mc.get('job') print('set_multi\u7528\u6cd5:',name,age,job) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3 set.py set\u7528\u6cd5 jack set_multi\u7528\u6cd5: jack 19 IT","title":"2.4.1 set/set_multi"},{"location":"python/lib/nosql/memcached/memcached.index/#242-add","text":"\u6dfb\u52a0\u4e00\u6761\u952e\u503c\u5bf9\uff0c\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u7684key\uff0c\u91cd\u590d\u6267\u884cadd\u64cd\u4f5c\u8fd4\u56de\u503c\u4e3aflase\u3002 root@leco:~/code/memcached# cat add.py #!/usr/bin/env python3 #coding:utf8 import memcache mc = memcache.Client([('127.0.0.1:11211', 1)]) ret1 = mc.add('add','v1') ret2 = mc.add('add','v2') ret = mc.get('add') print(ret1) print(ret2) print(ret) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python2 add.py True # \u7b2c\u4e00\u6dfb\u52a0add \u8fd9\u4e2a\u952e\u65f6\u5019\uff0c\u4e4b\u524d\u662f\u6ca1\u6709\u7684\uff0c\u6240\u6709\u53ef\u4ee5\u521b\u5efa\u3002 False # \u7b2c\u4e8c\u6b21\u518d\u6b21\u6dfb\u52a0add\u8fd9\u4e2a\u952e\u65f6\u5019\uff0c\u4e4b\u524d\u6709\u4e86add\u8fd9\u4e2a\u952e\uff0c\u6240\u4ee5\u521b\u5efa\u5931\u8d25 v1","title":"2.4.2 add"},{"location":"python/lib/nosql/memcached/memcached.index/#243-replace","text":"replace\u4fee\u6539\u67d0\u4e2akey\u7684\u503c\uff0c\u5982\u679ckey\u4e0d\u5b58\u5728\uff0c\u8fd4\u56deFalse root@leco:~/code/memcached# cat replace.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name','\u5f20\u4e09') re = mc.get('name') print(re) ret_name = mc.replace('name','\u674e\u56db') ret1 = mc.get('name') rereplace = mc.replace('name10','hahaha') ret2 = mc.get('name10') print(\"ret_name = \",ret_name) print(\"ret1 = \",ret1) print(\"rereplace = \",rereplace) print(\"ret2 = \",ret2) root@leco:~/code/memcached# python3 replace.py \u5f20\u4e09 ret_name = True # key\u5b58\u5728\u66ff\u6362\u6210\u529f ret1 = \u674e\u56db # \u4fee\u6539\u540e\u7684\u503c rereplace = False # key\u4e0d\u5b58\u5728\uff0c\u66ff\u6362\u5931\u8d25 ret2 = None # \u4e0d\u5b58\u5728\u7684key\uff0c\u8fd4\u56deFalse","title":"2.4.3 replace"},{"location":"python/lib/nosql/memcached/memcached.index/#244-appendprepend","text":"append : \u4fee\u6539\u6307\u5b9akey\u7684\u503c\uff0c\u5728\u8be5\u503c\u540e\u9762\u8ffd\u52a0\u5185\u5bb9\u3002 prepend : \u4fee\u6539\u6307\u5b9akey\u7684\u503c\uff0c\u5728\u8be5\u503c\u524d\u9762\u63d2\u5165\u5185\u5bb9\u3002 root@leco:~/code/memcached# cat append.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('num','\u6211\u662f\u4e2d\u95f4\u90e8\u5206') re = mc.get('num') print(re) mc.append('num','\u6211\u662f\u540e\u9762\u90e8\u5206') # \u5728\u6211\u662f\u4e2d\u95f4\u90e8\u5206\u540e\u8ffd\u52a0 re = mc.get('num') print(re) mc.prepend('num','\u6211\u662f\u5f00\u5934\u90e8\u5206') # \u5728\u6211\u662f\u4e2d\u95f4\u90e8\u5206\u524d\u8ffd\u52a0 re = mc.get('num') print(re) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3 append.py \u6211\u662f\u4e2d\u95f4\u90e8\u5206 \u6211\u662f\u4e2d\u95f4\u90e8\u5206\u6211\u662f\u540e\u9762\u90e8\u5206 \u6211\u662f\u5f00\u5934\u90e8\u5206\u6211\u662f\u4e2d\u95f4\u90e8\u5206\u6211\u662f\u540e\u9762\u90e8\u5206","title":"2.4.4 append/prepend"},{"location":"python/lib/nosql/memcached/memcached.index/#245-getscas","text":"\u4f7f\u7528\u7f13\u5b58\u7cfb\u7edf\u5171\u4eab\u6570\u636e\u8d44\u6e90\u5c31\u5fc5\u7136\u7ed5\u4e0d\u5f00\u6570\u636e\u4e89\u593a\u548c\u810f\u6570\u636e\uff08\u6570\u636e\u6df7\u4e71\uff09\u7684\u95ee\u9898\u3002 \u5047\u8bbe\u53bb\u5f80\u5f90\u5dde\u7684\u9ad8\u94c1G88\u5217\u8f66\u5269\u4f59\u7968\u6570\u4fdd\u5b58\u5728memcache\u4e2d\uff0cticket_count = 88 A\u7528\u6237\u5237\u65b0\u9875\u9762\u4ecememecache\u4e2d\u8bfb\u53d6\u5230ticket_count = 88 B\u7528\u6237\u5237\u65b0\u9875\u9762\u4ecememecache\u4e2d\u8bfb\u53d6\u5230ticket_count = 88 A,B\u7528\u6237\u5747\u8d2d\u4e70\u8be5\u8d9f\u5217\u8f66\u7684\u7968\uff0c\u5e76\u4fee\u6539ticket_count\u7684\u503c A\u4fee\u6539\u540e\uff0cticket_count = 87 B\u4fee\u6539\u540e\uff0cticket_count = 87 \u7136\u800c\u6b63\u786e\u6570\u5b57\u5e94\u8be5\u662f86\uff0c\u6570\u636e\u5c31\u6df7\u4e71\u4e86\u3002 \u5982\u679c\u60f3\u8981\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 gets\u3000\u548c\u3000cas root@leco:~/code/memcached# cat gets.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('ticket','88') reget = mc.get('ticket') print('\u5269\u4f59\u7968\u6570',reget) ret = mc.gets('ticket') print(ret) # \u5982\u679c\u6709\u4eba\u5728gets\u4e4b\u540e\u548ccas\u4e4b\u524d\u4fee\u6539\u4e86product_count\uff0c\u90a3\u4e48\uff0c # \u4e0b\u9762\u7684\u8bbe\u7f6e\u5c06\u4f1a\u6267\u884c\u5931\u8d25\uff0c\u5256\u51fa\u5f02\u5e38\uff0c\u4ece\u800c\u907f\u514d\u975e\u6b63\u5e38\u6570\u636e\u7684\u4ea7\u751f recas = mc.cas('ticket','88') print(recas) ret = mc.gets('ticket') print('\u5269\u4f59\u7968\u6570',ret) root@leco:~/code/memcached# python3 gets.py \u5269\u4f59\u7968\u6570 88 88 True \u5269\u4f59\u7968\u6570 88 \u672c\u8d28\u4e0a\u6bcf\u6b21\u6267\u884cgets\u65f6\uff0c\u4f1a\u4ecememcache\u4e2d\u83b7\u53d6\u4e00\u4e2a\u81ea\u589e\u7684\u6570\u5b57\uff0c\u901a\u8fc7cas\u53bb\u4fee\u6539gets\u7684\u503c\u65f6\uff0c\u4f1a\u643a\u5e26\u4e4b\u524d\u83b7\u53d6\u7684\u81ea\u589e\u548cmemcache\u4e2d\u7684\u81ea\u589e\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u53ef\u4ee5\u63d0\u4ea4\uff0c\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u90a3\u4e48\u8868\u793a\u5728gets\u548ccas\u6267\u884c\u4e4b\u95f4\uff0c\u53c8\u6709\u5176\u4ed6\u4eba\u6267\u884c\u4e86gets\uff0c\u5219\u4e0d\u5141\u8bb8\u4fee\u6539\u3002","title":"2.4.5 gets/cas"},{"location":"python/lib/nosql/memcached/memcached.index/#25","text":"","title":"2.5 \u67e5\u627e\u64cd\u4f5c"},{"location":"python/lib/nosql/memcached/memcached.index/#251-getget_multi","text":"get : \u83b7\u53d6\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 get_multi : \u83b7\u53d6\u591a\u4e2a\u952e\u503c\u5bf9\u3002 root@leco:~/code/memcached# cat get.py #!/usr/bin/env python3 #coding:utf8 import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name','jack') re = mc.get('name') print('get',re) # \u83b7\u53d6\u4e00\u4e2a\u952e\u503c\u5bf9 dic = {'name':'jack','age':'20','job':'IT'} mc.set_multi(dic) regetmu=mc.get_multi(['name','age','job']) print('get_multi',re) # \u83b7\u53d6\u591a\u4e2a\u952e\u503c\u5bf9\u7684\u503c root@leco:~/code/memcached# python3 get.py get jack get_multi jack \u82e5\u662fget\u7684key\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u8fd4\u56de\u4e3a\u7a7a\u3002","title":"2.5.1 get,get_multi"},{"location":"python/lib/nosql/memcached/memcached.index/#252-deletedelete_multi","text":"delete : \u5728Memcached\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 delete_multi : \u5728Memcached\u4e2d\u5220\u9664\u6307\u5b9a\u591a\u4e2a\u952e\u503c\u5bf9\u3002 root@leco:~/code/memcached# cat del.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('name1','JACK1') mc.set('name2','JACK2') mc.set('name3','JACK3') name1,name2,name3 = mc.get('name1'),mc.get('name2'),mc.get('name3') print('name1 = %s, name2=%s, name3=%s' %(name1,name2,name3)) mc.delete('name1') re = mc.get('name') print('\u5220\u9664',re) #\u5220\u9664\u4e00\u4e2a\u952e\u503c\u5bf9 mc.delete_multi(['name2','name3']) name1,name2,name3 = mc.get('name1'),mc.get('name2'),mc.get('name3') print('name1 = %s, name2=%s, name3=%s' %(name1,name2,name3)) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/memcached# python3 del.py name1 = JACK1, name2=JACK2, name3=JACK3 \u5220\u9664 jack name1 = None, name2=None, name3=None","title":"2.5.2 delete/delete_multi"},{"location":"python/lib/nosql/memcached/memcached.index/#254-incredecr","text":"decr : \u81ea\u51cf\uff0c\u5c06Memcached\u4e2d\u7684\u4e00\u4e2a\u503c\u589e\u52a0N\uff08N\u9ed8\u8ba4\u4e3a1\uff09 incr : \u81ea\u589e\uff0c\u5c06Memcached\u4e2d\u7684\u4e00\u4e2a\u503c\u51cf\u5c11N\uff08N\u9ed8\u8ba4\u4e3a1\uff09 root@leco:~/code/memcached# cat decr.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) mc.set('num',1) ret = mc.get('num') print('\u539f\u59cb\u503c',ret) mc.incr('num',9) ret = mc.get('num') print('\u52a0\u503c\u540e\u7ed3\u679c = ',ret) mc.decr('num',5) ret = mc.get('num') print('\u51cf\u503c\u540e\u7ed3\u679c = ',ret) root@leco:~/code/memcached# python3 decr.py \u539f\u59cb\u503c 1 \u52a0\u503c\u540e\u7ed3\u679c = 10 \u51cf\u503c\u540e\u7ed3\u679c = 5","title":"2.5.4 incre/decr"},{"location":"python/lib/nosql/memcached/memcached.index/#26","text":"","title":"2.6 \u7edf\u8ba1\u64cd\u4f5c"},{"location":"python/lib/nosql/memcached/memcached.index/#261-stats","text":"Memcached stats\u547d\u4ee4\u7528\u4e8e\u8fd4\u56de\u7edf\u8ba1\u4fe1\u606f\u4f8b\u5982PID\uff08\u8fdb\u7a0b\u53f7\uff09\uff0c\u7248\u672c\u53f7\uff0c\u8fde\u63a5\u6570\u7b49\u3002 root@leco:~/code/memcached# cat stats.py #!/usr/bin/env python # -*- coding:utf-8 -*- import memcache mc = memcache.Client(['127.0.0.1:11211']) ret = mc.get_stats() print(ret) root@leco:~/code/memcached# python3 stats.py [(b'127.0.0.1:11211 (1)', {b'pid': b'7862', b'uptime': b'6680', b'time': b'1550635332', b'version': b'1.5.12', b'libevent': b'2.0.21-stable', b'pointer_size': b'64', b'rusage_user': b'0.537668', b'rusage_system': b'0.414349', b'max_connections': b'256', b'curr_connections': b'2', b'total_connections': b'31', b'rejected_connections': b'0', b'connection_structures': b'4', b'reserved_fds': b'20', b'cmd_get': b'77', b'cmd_set': b'65', b'cmd_flush': b'0', b'cmd_touch': b'0', b'get_hits': b'67', b'get_misses': b'10', b'get_expired': b'0', b'get_flushed': b'0', b'delete_misses': b'4', b'delete_hits': b'6', b'incr_misses': b'0', b'incr_hits': b'2', b'decr_misses': b'0', b'decr_hits': b'1', b'cas_misses': b'0', b'cas_hits': b'0', b'cas_badval': b'0', b'touch_hits': b'0', b'touch_misses': b'0', b'auth_cmds': b'0', b'auth_errors': b'0', b'bytes_read': b'2630', b'bytes_written': b'4681', b'limit_maxbytes': b'10485760', b'accepting_conns': b'1', b'listen_disabled_num': b'0', b'time_in_listen_disabled_us': b'0', b'threads': b'4', b'conn_yields': b'0', b'hash_power_level': b'16', b'hash_bytes': b'524288', b'hash_is_expanding': b'0', b'slab_reassign_rescues': b'0', b'slab_reassign_chunk_rescues': b'0', b'slab_reassign_evictions_nomem': b'0', b'slab_reassign_inline_reclaim': b'0', b'slab_reassign_busy_items': b'0', b'slab_reassign_busy_deletes': b'0', b'slab_reassign_running': b'0', b'slabs_moved': b'0', b'lru_crawler_running': b'0', b'lru_crawler_starts':b'3825', b'lru_maintainer_juggles': b'14452', b'malloc_fails': b'0', b'log_worker_dropped': b'0', b'log_worker_written': b'0', b'log_watcher_skipped': b'0', b'log_watcher_sent': b'0', b'bytes': b'520', b'curr_items': b'8', b'total_items': b'56', b'slab_global_page_pool': b'0', b'expired_unfetched': b'0', b'evicted_unfetched': b'0', b'evicted_active': b'0', b'evictions': b'0', b'reclaimed': b'0', b'crawler_reclaimed': b'0', b'crawler_items_checked': b'41', b'lrutail_reflocked': b'4', b'moves_to_cold': b'24', b'moves_to_warm': b'8', b'moves_within_lru': b'1', b'direct_reclaims': b'0', b'lru_bumps_dropped': b'0'})]","title":"2.6.1 stats"},{"location":"python/lib/nosql/memcached/memcached.index/#262-slabs","text":"Memcached stats slabs \u547d\u4ee4\u7528\u4e8e\u663e\u793a\u5404\u4e2aslab\u7684\u4fe1\u606f\uff0c\u5305\u62ecchunk\u7684\u5927\u5c0f\u3001\u6570\u76ee\u3001\u4f7f\u7528\u60c5\u51b5\u7b49\u3002","title":"2.6.2 slabs"},{"location":"python/lib/nosql/mongo/mongo.index/","text":"1. \u4ecb\u7ecd \u00b6 MongoDB \u662f\u76ee\u524d\u6700\u6d41\u884c\u7684 NoSQL \u6570\u636e\u5e93\u4e4b\u4e00\uff0c\u4f7f\u7528\u7684\u6570\u636e\u7c7b\u578b BSON\uff08\u7c7b\u4f3c JSON\uff09\u3002 Python \u8981\u8fde\u63a5 MongoDB \u9700\u8981 MongoDB \u9a71\u52a8\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 PyMongo \u9a71\u52a8\u6765\u8fde\u63a5\u3002 1.1 \u5b89\u88c5 \u00b6 pip \u662f\u4e00\u4e2a\u901a\u7528\u7684 Python \u5305\u7ba1\u7406\u5de5\u5177\uff0c\u63d0\u4f9b\u4e86\u5bf9 Python \u5305\u7684\u67e5\u627e\u3001\u4e0b\u8f7d\u3001\u5b89\u88c5\u3001\u5378\u8f7d\u7684\u529f\u80fd\u3002 python3 -m pip3 install pymongo \u4e5f\u53ef\u4ee5\u6307\u5b9a\u5b89\u88c5\u7684\u7248\u672c: python3 -m pip3 install pymongo==3.5.1 \u66f4\u65b0 pymongo \u547d\u4ee4\uff1a python3 -m pip3 install --upgrade pymongo \u65e7\u7248\u7684 Python \u53ef\u4ee5\u4f7f\u7528 easy_install \u6765\u5b89\u88c5\uff0ceasy_install \u4e5f\u662f Python \u5305\u7ba1\u7406\u5de5\u5177\u3002 python -m easy_install pymongo \u66f4\u65b0 pymongo \u547d\u4ee4\uff1a python -m easy_install -U pymongo 1.2 \u6d4b\u8bd5pymongo \u00b6 \u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6 test_mongodb.py\uff0c\u4ee3\u7801\u5982\u4e0b root@leco:/home/leco# cat test_mongodb.py #!/usr/bin/python3 import pymongo root@leco:/home/leco# python3 test_mongodb.py root@leco:/home/leco# echo $? 0 \u6267\u884c\u4ee5\u4e0a\u4ee3\u7801\u6587\u4ef6\uff0c\u5982\u679c\u6ca1\u6709\u51fa\u73b0\u9519\u8bef\uff0c\u8868\u793a\u5b89\u88c5\u6210\u529f\u3002 2. \u8be6\u7ec6 \u00b6 2.1 \u8fde\u63a5MongoDB \u00b6 \u8fde\u63a5MongoDB\u6211\u4eec\u9700\u8981\u4f7f\u7528PyMongo\u5e93\u91cc\u9762\u7684MongoClient\uff0c\u4e00\u822c\u6765\u8bf4\u4f20\u5165MongoDB\u7684IP\u53ca\u7aef\u53e3\u5373\u53ef\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5730\u5740host\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u7aef\u53e3port\uff0c\u7aef\u53e3\u5982\u679c\u4e0d\u4f20\u9ed8\u8ba4\u662f27017\u3002 import pymongo client = pymongo.MongoClient(host='localhost', port=27017) \u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aMongoDB\u7684\u8fde\u63a5\u5bf9\u8c61\u4e86\u3002 \u53e6\u5916MongoClient\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570host\u8fd8\u53ef\u4ee5\u76f4\u63a5\u4f20MongoDB\u7684\u8fde\u63a5\u5b57\u7b26\u4e32\uff0c\u4ee5mongodb\u5f00\u5934\uff0c\u4f8b\u5982\uff1a client = MongoClient('mongodb://localhost:27017/') \u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u8fde\u63a5\u6548\u679c\u3002 2.2 \u6307\u5b9a\u6570\u636e\u5e93 \u00b6 MongoDB\u4e2d\u8fd8\u5206\u4e3a\u4e00\u4e2a\u4e2a\u6570\u636e\u5e93\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u7684\u4e00\u6b65\u5c31\u662f\u6307\u5b9a\u8981\u64cd\u4f5c\u54ea\u4e2a\u6570\u636e\u5e93\uff0c\u5728\u8fd9\u91cc\u6211\u4ee5test_mongo_db\u6570\u636e\u5e93\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\uff0c\u6240\u4ee5\u4e0b\u4e00\u6b65\u6211\u4eec\u9700\u8981\u5728\u7a0b\u5e8f\u4e2d\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u6570\u636e\u5e93\u3002\u8c03\u7528client\u7684test_mongo_db\u5c5e\u6027\u5373\u53ef\u8fd4\u56detest_mongo_db\u6570\u636e\u5e93\u3002 db = client.test_mongo_db \u6216\u8005 db = client['test_mongo_db'] 2.3 \u6307\u5b9a\u96c6\u5408 \u00b6 MongoDB\u7684\u6bcf\u4e2a\u6570\u636e\u5e93\u53c8\u5305\u542b\u4e86\u8bb8\u591a\u96c6\u5408Collection\uff0c\u4e5f\u5c31\u7c7b\u4f3c\u4e0e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684\u8868\uff0c\u4e0b\u4e00\u6b65\u6211\u4eec\u9700\u8981\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u96c6\u5408\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u6307\u5b9a\u4e00\u4e2a\u96c6\u5408\u540d\u79f0\u4e3ainformations\uff0cinformations\u96c6\u5408\u3002\u8fd8\u662f\u548c\u6307\u5b9a\u6570\u636e\u5e93\u7c7b\u4f3c\uff0c\u6307\u5b9a\u96c6\u5408\u4e5f\u6709\u4e24\u79cd\u65b9\u5f0f: collection = db.informations \u6216\u8005 collection = db['informations'] 2.4 \u63d2\u5165\u6570\u636e \u00b6 2.4.1 \u5355\u6761\u63d2\u5165 \u00b6 \u63a5\u4e0b\u6765\u6211\u4eec\u4fbf\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u63d2\u5165\u4e86\uff0c\u5bf9\u4e8einformations\u8fd9\u4e2aCollection\uff0c\u6211\u4eec\u65b0\u5efa\u4e00\u6761\u6570\u636e\uff0c\u4ee5\u5b57\u5178\u7684\u5f62\u5f0f\u8868\u793a\uff1a information = {\"name\": \"\u5f20\u4e09\", \"age\": \"25\"} \u5728\u8fd9\u91cc\u6211\u4eec\u6307\u5b9a\u4e86\u59d3\u540d\u3001\u5e74\u9f84\u7136\u540e\u63a5\u4e0b\u6765\u76f4\u63a5\u8c03\u7528collection\u7684insert()\u65b9\u6cd5\u5373\u53ef\u63d2\u5165\u6570\u636e\u3002 result = collection.insert(information) print(result) \u5728MongoDB\u4e2d\uff0c\u6bcf\u6761\u6570\u636e\u5176\u5b9e\u90fd\u6709\u4e00\u4e2a_id\u5c5e\u6027\u6765\u552f\u4e00\u6807\u8bc6\uff0c\u5982\u679c\u6ca1\u6709\u663e\u5f0f\u6307\u660e_id\uff0cMongoDB\u4f1a\u81ea\u52a8\u4ea7\u751f\u4e00\u4e2aObjectId\u7c7b\u578b\u7684_id\u5c5e\u6027\u3002insert()\u65b9\u6cd5\u4f1a\u5728\u6267\u884c\u540e\u8fd4\u56de\u7684_id\u503c\u3002\u8fd0\u884c\u7ed3\u679c\uff1a 5c6b659b1607c47f8abe6ab7 2.4.2 \u591a\u6761\u63d2\u5165 \u00b6 \u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u540c\u65f6\u63d2\u5165\u591a\u6761\u6570\u636e\uff0c\u53ea\u9700\u8981\u4ee5\u5217\u8868\u5f62\u5f0f\u4f20\u9012\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a information = [{\"name\": \"\u5c0f\u660e\", \"age\": \"25\"}, {\"name\": \"\u5c0f\u5f3a\", \"age\": \"24\"}] information_id = collection.insert(information) print(information_id) \u6216\u8005 xiaoming={\"name\": \"\u5c0f\u660e\", \"age\": \"25\"} xiaoqiang= {\"name\": \"\u5c0f\u5f3a\", \"age\": \"24\"} information_id = collection.insert([xiaoming,xiaoqiang]) print(information_id) \u8fd4\u56de\u7684\u7ed3\u679c\u662f\u5bf9\u5e94\u7684_id\u7684\u96c6\u5408\uff0c\u8fd0\u884c\u7ed3\u679c\uff1a [ObjectId('5c6b65c01607c47f8abe6ab8'), ObjectId('5c6b65c01607c47f8abe6ab9')] 2.4.3 \u65b0\u5355\u6761\u63d2\u5165 \u00b6 \u5b9e\u9645\u4e0a\u5728PyMongo 3.X\u7248\u672c\u4e2d\uff0cinsert()\u65b9\u6cd5\u5b98\u65b9\u5df2\u7ecf\u4e0d\u63a8\u8350\u4f7f\u7528\u4e86\uff0c\u5f53\u7136\u7ee7\u7eed\u4f7f\u7528\u4e5f\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528insert_one()\u548cinsert_many()\u65b9\u6cd5\u5c06\u63d2\u5165\u5355\u6761\u548c\u591a\u6761\u8bb0\u5f55\u5206\u5f00\u3002 lisi = {\"name\": \"\u674e\u56db\", \"age\": \"25\"} result = collection.insert_one(lisi) print(result.inserted_id) \u8fd4\u56de\u7ed3\u679c\u548cinsert()\u65b9\u6cd5\u4e0d\u540c\uff0c\u8fd9\u6b21\u8fd4\u56de\u7684\u662fInsertOneResult\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u5176inserted_id\u5c5e\u6027\u83b7\u53d6_id\u3002\u7ed3\u679c\u662f 5c6b65df1607c47f8abe6aba 2.4.4 \u65b0\u591a\u6761\u63d2\u5165 \u00b6 \u5bf9\u4e8einsert_many()\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u636e\u4ee5\u5217\u8868\u5f62\u5f0f\u4f20\u9012\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a wangwu={\"name\": \"\u738b\u4e94\", \"age\": \"25\"} zhaoliu= {\"name\": \"\u8d75\u516d\", \"age\": \"24\"} result = collection.insert_many([wangwu,zhaoliu]) print(result) print(result.inserted_ids) \u7ed3\u679c\u662f: <pymongo.results.InsertManyResult object at 0x7f3cf2dc68c8> [ObjectId('5c6b66081607c47f8abe6abb'), ObjectId('5c6b66081607c47f8abe6abc')] insert_many()\u65b9\u6cd5\u8fd4\u56de\u7684\u7c7b\u578b\u662fInsertManyResult\uff0c\u8c03\u7528inserted_ids\u5c5e\u6027\u53ef\u4ee5\u83b7\u53d6\u63d2\u5165\u6570\u636e\u7684_id\u5217\u8868. 2.5 \u67e5\u8be2\u6570\u636e \u00b6 2.5.1 find_one() \u00b6 \u63d2\u5165\u6570\u636e\u540e\u6211\u4eec\u53ef\u4ee5\u5229\u7528find_one(),find_one()\u67e5\u8be2\u5f97\u5230\u662f\u5355\u4e2a\u7ed3\u679c\u3002 result = collection.find_one({'name': '\u5f20\u4e09'}) print(type(result)) print(result) \u7ed3\u679c\u662f: <class 'dict'> {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} \u53ef\u4ee5\u53d1\u73b0\u5b83\u591a\u4e86\u4e00\u4e2a_id\u5c5e\u6027\uff0c\u8fd9\u5c31\u662fMongoDB\u5728\u63d2\u5165\u7684\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u6dfb\u52a0\u7684\u3002 \u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6839\u636eObjectId\u6765\u67e5\u8be2\uff0c\u8fd9\u91cc\u9700\u8981\u4f7f\u7528bson\u5e93\u91cc\u9762\u7684ObjectId\u3002 In [27]: from bson.objectid import ObjectId In [28]: result = collection.find_one({'_id':ObjectId('5c6b659b1607c47f8abe6ab7')}) In [29]: print(result) {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} \u5176\u67e5\u8be2\u7ed3\u679c\u4f9d\u7136\u662f\u5b57\u5178\u7c7b\u578b\uff0c\u8fd0\u884c\u7ed3\u679c\uff1a {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} \u5f53\u7136\u5982\u679c\u67e5\u8be2\u7ed3\u679c\u4e0d\u5b58\u5728\u5219\u4f1a\u8fd4\u56deNone. 2.5.2 find() \u00b6 find()\u5219\u8fd4\u56de\u591a\u4e2a\u7ed3\u679c\u3002\u5bf9\u4e8e\u591a\u6761\u6570\u636e\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528find()\u65b9\u6cd5\uff0c\u4f8b\u5982\u5728\u8fd9\u91cc\u67e5\u627e\u5e74\u9f84\u4e3a25\u7684\u6570\u636e\uff0c results = collection.find({'age': '25'}) print(results) for result in results: print(result) \u7ed3\u679c\u662f: {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} {'_id': ObjectId('5c6b65c01607c47f8abe6ab8'), 'name': '\u5c0f\u660e', 'age': '25'} {'_id': ObjectId('5c6b65df1607c47f8abe6aba'), 'name': '\u674e\u56db', 'age': '25'} {'_id': ObjectId('5c6b66081607c47f8abe6abb'), 'name': '\u738b\u4e94', 'age': '25'} \u8fd4\u56de\u7ed3\u679c\u662fCursor\u7c7b\u578b\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u751f\u6210\u5668\uff0c\u6211\u4eec\u9700\u8981\u904d\u5386\u53d6\u5230\u6240\u6709\u7684\u7ed3\u679c\uff0c\u6bcf\u4e00\u4e2a\u7ed3\u679c\u90fd\u662f\u5b57\u5178\u7c7b\u578b\u3002 \u5982\u679c\u8981\u67e5\u8be2\u5e74\u9f84\u5927\u4e8e20\u7684\u6570\u636e\uff0c\u5219\u5199\u6cd5\u5982\u4e0b\uff1a results = collection.find({'age': {'$gt': '20'}}) \u6d4b\u8bd5 In [38]: results = collection.find({'age': {'$gt': '20'}}) In [39]: for data in results: ...: print(data) ...: {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} {'_id': ObjectId('5c6b65c01607c47f8abe6ab8'), 'name': '\u5c0f\u660e', 'age': '25'} {'_id': ObjectId('5c6b65c01607c47f8abe6ab9'), 'name': '\u5c0f\u5f3a', 'age': '24'} {'_id': ObjectId('5c6b65df1607c47f8abe6aba'), 'name': '\u674e\u56db', 'age': '25'} {'_id': ObjectId('5c6b66081607c47f8abe6abb'), 'name': '\u738b\u4e94', 'age': '25'} {'_id': ObjectId('5c6b66081607c47f8abe6abc'), 'name': '\u8d75\u516d', 'age': '24'} \u5728\u8fd9\u91cc\u67e5\u8be2\u7684\u6761\u4ef6\u952e\u503c\u5df2\u7ecf\u4e0d\u662f\u5355\u7eaf\u7684\u6570\u5b57\u4e86\uff0c\u800c\u662f\u4e00\u4e2a\u5b57\u5178\uff0c\u5176\u952e\u540d\u4e3a\u6bd4\u8f83\u7b26\u53f7$gt\uff0c\u610f\u601d\u662f\u5927\u4e8e\uff0c\u952e\u503c\u4e3a20\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u67e5\u8be2\u51fa\u6240\u6709\u5e74\u9f84\u5927\u4e8e20\u7684\u6570\u636e\u3002 2.5.3 \u6bd4\u8f83\u7b26\u53f7 \u00b6 \u5728\u8fd9\u91cc\u5c06\u6bd4\u8f83\u7b26\u53f7\u5f52\u7eb3\u5982\u4e0b\u8868\uff1a \u7b26\u53f7 \u542b\u4e49 \u4f8b\u5b50 $lt \u5c0f\u4e8e {'age': {'$lt': 20}} $gt \u5927\u4e8e {'age': {'$gt': 20}} $lte \u5c0f\u4e8e\u7b49\u4e8e {'age': {'$lte': 20}} $gte \u5927\u4e8e\u7b49\u4e8e {'age': {'$gte': 20}} $ne \u4e0d\u7b49\u4e8e {'age': {'$ne': 20}} $in \u5728\u8303\u56f4\u5185 {'age': {'$in': [20, 23]}} $nin \u4e0d\u5728\u8303\u56f4\u5185 {'age': {'$nin': [20, 23]}} \u53e6\u5916\u8fd8\u53ef\u4ee5\u8fdb\u884c\u6b63\u5219\u5339\u914d\u67e5\u8be2\uff0c\u4f8b\u5982\u67e5\u8be2\u540d\u5b57\u4ee5M\u5f00\u5934\u7684\u5b66\u751f\u6570\u636e\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a results = collection.find({'name': {'$regex': '^M.*'}}) \u5728\u8fd9\u91cc\u4f7f\u7528\u4e86$regex\u6765\u6307\u5b9a\u6b63\u5219\u5339\u914d\uff0c^M.*\u4ee3\u8868\u4ee5M\u5f00\u5934\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u67e5\u8be2\u6240\u6709\u7b26\u5408\u8be5\u6b63\u5219\u7684\u7ed3\u679c\u3002 2.5.4 \u529f\u80fd\u7b26\u53f7 \u00b6 \u5728\u8fd9\u91cc\u5c06\u4e00\u4e9b\u529f\u80fd\u7b26\u53f7\u518d\u5f52\u7c7b\u5982\u4e0b\uff1a \u7b26\u53f7 \u542b\u4e49 \u4f8b\u5b50 \u4f8b\u5b50\u542b\u4e49 $regex \u5339\u914d\u6b63\u5219 {'name': {'$regex': '^M.*'}} name\u4ee5M\u5f00\u5934 $exists \u5c5e\u6027\u662f\u5426\u5b58\u5728 {'name': {'$exists': True}} name\u5c5e\u6027\u5b58\u5728 $type \u7c7b\u578b\u5224\u65ad {'age': {'$type': 'int'}} age\u7684\u7c7b\u578b\u4e3aint $mod \u6570\u5b57\u6a21\u64cd\u4f5c {'age': {'$mod': [5, 0]}} \u5e74\u9f84\u6a215\u4f590 $text \u6587\u672c\u67e5\u8be2 {' text': {' text': {' search': 'Mike'}} text\u7c7b\u578b\u7684\u5c5e\u6027\u4e2d\u5305\u542bMike\u5b57\u7b26\u4e32 $where \u9ad8\u7ea7\u6761\u4ef6\u67e5\u8be2 {'$where': 'obj.fans_count == obj.follows_count'} \u81ea\u8eab\u7c89\u4e1d\u6570\u7b49\u4e8e\u5173\u6ce8\u6570 \u8fd9\u4e9b\u64cd\u4f5c\u7684\u66f4\u8be6\u7ec6\u7528\u6cd5\u5728\u53ef\u4ee5\u5728MongoDB\u5b98\u65b9\u6587\u6863\u627e\u5230\uff1a https://docs.mongodb.com/manual/reference/operator/query/ 2.5 \u8ba1\u6570 \u00b6 \u8981\u7edf\u8ba1\u67e5\u8be2\u7ed3\u679c\u6709\u591a\u5c11\u6761\u6570\u636e\uff0c\u53ef\u4ee5\u8c03\u7528count()\u65b9\u6cd5\uff0c\u5982\u7edf\u8ba1\u6240\u6709\u6570\u636e\u6761\u6570\uff1a In [40]: count = collection.find().count() In [41]: print(count) 6 \u6216\u8005\u7edf\u8ba1\u7b26\u5408\u67d0\u4e2a\u6761\u4ef6\u7684\u6570\u636e\uff1a In [43]: count = collection.find({'age': '25'}).count() In [44]: print(count) 4 2.6 \u6392\u5e8f \u00b6 \u53ef\u4ee5\u8c03\u7528sort\u65b9\u6cd5\uff0c\u4f20\u5165\u6392\u5e8f\u7684\u5b57\u6bb5\u53ca\u5347\u964d\u5e8f\u6807\u5fd7\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a In [45]: results = collection.find().sort('name', pymongo.ASCENDING) In [46]: print([result['name'] for result in results]) ['\u5c0f\u5f3a', '\u5c0f\u660e', '\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d'] 2.7 \u504f\u79fb \u00b6 \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u80fd\u60f3\u53ea\u53d6\u67d0\u51e0\u4e2a\u5143\u7d20\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528skip()\u65b9\u6cd5\u504f\u79fb\u51e0\u4e2a\u4f4d\u7f6e\uff0c\u6bd4\u5982\u504f\u79fb2\uff0c\u5c31\u5ffd\u7565\u524d2\u4e2a\u5143\u7d20\uff0c\u5f97\u5230\u7b2c\u4e09\u4e2a\u53ca\u4ee5\u540e\u7684\u5143\u7d20\u3002 In [47]: results = collection.find().sort('name', pymongo.ASCENDING).skip(2) In [48]: print([result['name'] for result in results]) ['\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d'] 2.8 limit \u00b6 \u53ef\u4ee5\u7528limit()\u65b9\u6cd5\u6307\u5b9a\u8981\u53d6\u7684\u7ed3\u679c\u4e2a\u6570\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a In [49]: results = collection.find().sort('name', pymongo.ASCENDING).skip(2).limit(2) In [50]: print([result['name'] for result in results]) ['\u5f20\u4e09', '\u674e\u56db'] \u5982\u679c\u4e0d\u52a0limit()\u539f\u672c\u4f1a\u8fd4\u56de\u4e09\u4e2a\u7ed3\u679c\uff0c\u52a0\u4e86\u9650\u5236\u4e4b\u540e\uff0c\u4f1a\u622a\u53d62\u4e2a\u7ed3\u679c\u8fd4\u56de\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728\u6570\u636e\u5e93\u6570\u91cf\u975e\u5e38\u5e9e\u5927\u7684\u65f6\u5019\uff0c\u5982\u5343\u4e07\u3001\u4ebf\u7ea7\u522b\uff0c\u6700\u597d\u4e0d\u8981\u4f7f\u7528\u5927\u7684\u504f\u79fb\u91cf\u6765\u67e5\u8be2\u6570\u636e\uff0c\u5f88\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3cfind({'_id': {'$gt': ObjectId('593278c815c2602678bb2b8d')}}) \u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u67e5\u8be2\uff0c\u8bb0\u5f55\u597d\u4e0a\u6b21\u67e5\u8be2\u7684_id\u3002 2.9 \u66f4\u65b0 \u00b6 2.9.1 update \u00b6 \u5bf9\u4e8e\u6570\u636e\u66f4\u65b0\u53ef\u4ee5\u4f7f\u7528update()\u65b9\u6cd5\uff0c\u6307\u5b9a\u66f4\u65b0\u7684\u6761\u4ef6\u548c\u66f4\u65b0\u540e\u7684\u6570\u636e\u5373\u53ef\uff0c\u4f8b\u5982\uff1a \u6ca1\u4fee\u6539\u4e4b\u524d > db.informations.find() { \"_id\" : ObjectId(\"5c6b659b1607c47f8abe6ab7\"), \"name\" : \"\u5f20\u4e09\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab8\"), \"name\" : \"\u5c0f\u660e\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab9\"), \"name\" : \"\u5c0f\u5f3a\", \"age\" : \"24\" } { \"_id\" : ObjectId(\"5c6b65df1607c47f8abe6aba\"), \"name\" : \"\u674e\u56db\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abb\"), \"name\" : \"\u738b\u4e94\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abc\"), \"name\" : \"\u8d75\u516d\", \"age\" : \"24\" } In [51]: condition = {'name': '\u5f20\u4e09'} In [52]: user = collection.find_one(condition) In [53]: user['age']=20 In [54]: result = collection.update(condition, user) /usr/local/bin/ipython:1: DeprecationWarning: update is deprecated. Use replace_one, update_one or update_many instead. #!/usr/local/bin/python3.6 In [55]: print(result) {'ok': 1, 'nModified': 1, 'n': 1, 'updatedExisting': True} \u4fee\u6539\u4e4b\u540e > db.informations.find() { \"_id\" : ObjectId(\"5c6b659b1607c47f8abe6ab7\"), \"name\" : \"\u5f20\u4e09\", \"age\" : 20 } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab8\"), \"name\" : \"\u5c0f\u660e\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab9\"), \"name\" : \"\u5c0f\u5f3a\", \"age\" : \"24\" } { \"_id\" : ObjectId(\"5c6b65df1607c47f8abe6aba\"), \"name\" : \"\u674e\u56db\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abb\"), \"name\" : \"\u738b\u4e94\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abc\"), \"name\" : \"\u8d75\u516d\", \"age\" : \"24\" } \u8fd4\u56de\u7ed3\u679c\u662f\u5b57\u5178\u5f62\u5f0f\uff0cok\u5373\u4ee3\u8868\u6267\u884c\u6210\u529f\uff0cnModified\u4ee3\u8868\u5f71\u54cd\u7684\u6570\u636e\u6761\u6570\u3002 \u53e6\u5916update()\u65b9\u6cd5\u5176\u5b9e\u4e5f\u662f\u5b98\u65b9\u4e0d\u63a8\u8350\u4f7f\u7528\u7684\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u4e5f\u5206\u4e86update_one()\u65b9\u6cd5\u548cupdate_many()\u65b9\u6cd5\uff0c\u7528\u6cd5\u66f4\u52a0\u4e25\u683c\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u9700\u8981\u4f7f\u7528$\u7c7b\u578b\u64cd\u4f5c\u7b26\u4f5c\u4e3a\u5b57\u5178\u7684\u952e\u540d\uff0c\u6211\u4eec\u7528\u793a\u4f8b\u611f\u53d7\u4e00\u4e0b\u3002 2.9.2 update_one \u00b6 condition = {'name': '\u674e\u56db'} user = collection.find_one(condition) user['age'] = 26 result = collection.update_one(condition, {'$set': user}) print(result) print(result.matched_count, result.modified_count) \u5728\u8fd9\u91cc\u8c03\u7528\u4e86update_one\u65b9\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e0d\u80fd\u518d\u76f4\u63a5\u4f20\u5165\u4fee\u6539\u540e\u7684\u5b57\u5178\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528{'$set': user}\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u5176\u8fd4\u56de\u7ed3\u679c\u662fUpdateResult\u7c7b\u578b\uff0c\u7136\u540e\u8c03\u7528matched_count\u548cmodified_count\u5c5e\u6027\u5206\u522b\u53ef\u4ee5\u83b7\u5f97\u5339\u914d\u7684\u6570\u636e\u6761\u6570\u548c\u5f71\u54cd\u7684\u6570\u636e\u6761\u6570\u3002 \u518d\u770b\u4e00\u4e2a\u4f8b\u5b50 condition = {'age': {'$gt': 20}} result = collection.update_one(condition, {'$inc': {'age': 1}}) print(result) print(result.matched_count, result.modified_count) \u5728\u8fd9\u91cc\u6211\u4eec\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6\u4e3a\u5e74\u9f84\u5927\u4e8e20\uff0c\u7136\u540e\u66f4\u65b0\u6761\u4ef6\u4e3a{'$inc': {'age': 1}} \uff0c\u4e5f\u5c31\u662f\u5e74\u9f84\u52a01\uff0c\u6267\u884c\u4e4b\u540e\u4f1a\u8bb2\u7b2c\u4e00\u6761\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\u5e74\u9f84\u52a01\u3002 2.9.3 update_many \u00b6 \u5982\u679c\u8c03\u7528update_many()\u65b9\u6cd5\uff0c\u5219\u4f1a\u5c06\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\u90fd\u66f4\u65b0\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a condition = {'age': {'$gt': 20}} result = collection.update_many(condition, {'$inc': {'age': 1}}) print(result) print(result.matched_count, result.modified_count) 2.10 \u5220\u9664 \u00b6 2.10.1 remove \u00b6 \u5220\u9664\u64cd\u4f5c\u6bd4\u8f83\u7b80\u5355\uff0c\u76f4\u63a5\u8c03\u7528remove()\u65b9\u6cd5\u6307\u5b9a\u5220\u9664\u7684\u6761\u4ef6\u5373\u53ef\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u6240\u6709\u6570\u636e\u5747\u4f1a\u88ab\u5220\u9664\uff0c\u793a\u4f8b\u5982\u4e0b result = collection.remove({'name': '\u738b\u4e94'}) print(result) \u8fd0\u884c n [66]: result = collection.remove({'name': '\u738b\u4e94'}) /usr/local/bin/ipython:1: DeprecationWarning: remove is deprecated. Use delete_one or delete_many instead. #!/usr/local/bin/python3.6 In [67]: print(result) {'ok': 1, 'n': 1} \u53e6\u5916\u4f9d\u7136\u5b58\u5728\u4e24\u4e2a\u65b0\u7684\u63a8\u8350\u65b9\u6cd5\uff0cdelete_one()\u548cdelete_many()\u65b9\u6cd5. 2.10.2 delete_one \u00b6 result = collection.delete_one({'name': '\u8d75\u516d'}) print(result) print(result.deleted_count) \u8fc7\u7a0b In [68]: result = collection.delete_one({'name': '\u8d75\u516d'}) In [69]: print(result) <pymongo.results.DeleteResult object at 0x7f3d00039188> In [70]: print(result.deleted_count) 1 2.10.3 delete_many \u00b6 result = collection.delete_many({'age': {'$lt': 10}}) print(result.deleted_count) delete_one()\u5373\u5220\u9664\u7b2c\u4e00\u6761\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\uff0cdelete_many()\u5373\u5220\u9664\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\uff0c\u8fd4\u56de\u7ed3\u679c\u662fDeleteResult\u7c7b\u578b\uff0c\u53ef\u4ee5\u8c03\u7528deleted_count\u5c5e\u6027\u83b7\u53d6\u5220\u9664\u7684\u6570\u636e\u6761\u6570\u3002 2.10.4 \u66f4\u591a \u00b6 \u53e6\u5916PyMongo\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7ec4\u5408\u65b9\u6cd5\uff0c\u5982find_one_and_delete() \u3001find_one_and_replace() \u3001find_one_and_update() \uff0c\u5c31\u662f\u67e5\u627e\u540e\u5220\u9664\u3001\u66ff\u6362\u3001\u66f4\u65b0\u64cd\u4f5c\uff0c\u7528\u6cd5\u4e0e\u4e0a\u8ff0\u65b9\u6cd5\u57fa\u672c\u4e00\u81f4\u3002 \u53e6\u5916\u8fd8\u53ef\u4ee5\u5bf9\u7d22\u5f15\u8fdb\u884c\u64cd\u4f5c\uff0c\u5982create_index() \u3001create_indexes() \u3001drop_index()\u7b49\u3002 \u8be6\u7ec6\u7528\u6cd5\u53ef\u4ee5\u53c2\u89c1\u5b98\u65b9\u6587\u6863\uff1a http://api.mongodb.com/python/current/api/pymongo/collection.html \u53e6\u5916\u8fd8\u6709\u5bf9\u6570\u636e\u5e93\u3001\u96c6\u5408\u672c\u8eab\u4ee5\u53ca\u5176\u4ed6\u7684\u4e00\u4e9b\u64cd\u4f5c\uff0c\u5728\u8fd9\u4e0d\u518d\u4e00\u4e00\u8bb2\u89e3\uff0c\u53ef\u4ee5\u53c2\u89c1\u5b98\u65b9\u6587\u6863\uff1a http://api.mongodb.com/python/current/api/pymongo/ 2.11 code \u00b6 #!/usr/bin/env python # -*- coding: utf-8 -*- import pymongo import datetime def get_db(): # \u5efa\u7acb\u8fde\u63a5 client = pymongo.MongoClient(host=\"127.0.0.1\", port=27017) # host \u6307\u5b9a\u8981\u94fe\u63a5\u7684mongo server\u7684\u4e3b\u673a\u3002port\u662f\u7aef\u53e3 db = client['test_mongo_db'] #\u6216\u8005 db = client.test_mongo_db return db def get_collection(db): # \u9009\u62e9\u96c6\u5408(mongo\u4e2dcollection\u548cdatabase\u90fd\u662f\u5ef6\u65f6\u521b\u5efa\u7684) coll = db['informations'] print (db.collection_names()) return coll def insert_one_doc(db): # \u63d2\u5165\u4e00\u4e2adocument coll = db['informations'] information = {\"name\": \"summer\", \"age\": \"25\"} information_id = coll.insert(information) print(information_id) def insert_multi_docs(db): # \u6279\u91cf\u63d2\u5165documents,\u63d2\u5165\u4e00\u4e2a\u6570\u7ec4 coll = db['informations'] information = [{\"name\": \"\u5c0f\u660e\", \"age\": \"25\"}, {\"name\": \"\u5c0f\u5f3a\", \"age\": \"24\"}] information_id = coll.insert(information) print(information_id) def get_one_doc(db): # \u6709\u5c31\u8fd4\u56de\u4e00\u4e2a\uff0c\u6ca1\u6709\u5c31\u8fd4\u56deNone coll = db['informations'] print(coll.find_one()) # \u8fd4\u56de\u7b2c\u4e00\u6761\u8bb0\u5f55 print(coll.find_one({\"name\": \"summer\"})) print(coll.find_one({\"name\": \"none\"})) def get_one_by_id(db): # \u901a\u8fc7objectid\u6765\u67e5\u627e\u4e00\u4e2adoc coll = db['informations'] obj = coll.find_one() obj_id = obj[\"_id\"] print(\"_id \u4e3aObjectId\u7c7b\u578b\uff0cobj_id:\" + str(obj_id)) print(coll.find_one({\"_id\": obj_id})) # \u9700\u8981\u6ce8\u610f\u8fd9\u91cc\u7684obj_id\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e0d\u662f\u4e00\u4e2astr\uff0c\u4f7f\u7528str\u7c7b\u578b\u4f5c\u4e3a_id\u7684\u503c\u65e0\u6cd5\u627e\u5230\u8bb0\u5f55 print(\"_id \u4e3astr\u7c7b\u578b \") print(coll.find_one({\"_id\": str(obj_id)})) # \u53ef\u4ee5\u901a\u8fc7ObjectId\u65b9\u6cd5\u628astr\u8f6c\u6210ObjectId\u7c7b\u578b from bson.objectid import ObjectId print (\"_id \u8f6c\u6362\u6210ObjectId\u7c7b\u578b\") print (coll.find_one({\"_id\": ObjectId(str(obj_id))})) def get_many_docs(db): # mongo\u4e2d\u63d0\u4f9b\u4e86\u8fc7\u6ee4\u67e5\u627e\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u6761\u4ef6\u7b5b\u9009\u6765\u83b7\u53d6\u6570\u636e\u96c6\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u8ba1\u6570\uff0c\u6392\u5e8f\u7b49\u5904\u7406 coll = db['informations'] # ASCENDING = 1 \u5347\u5e8f;DESCENDING = -1\u964d\u5e8f;default is ASCENDING for item in coll.find().sort(\"age\", pymongo.DESCENDING): print(item) count = coll.count() print (\"\u96c6\u5408\u4e2d\u6240\u6709\u6570\u636e %s\u4e2a\" % int(count)) # \u6761\u4ef6\u67e5\u8be2 count = coll.find({\"name\":\"summer\"}).count() print (\"summer: %s\"%count) def clear_all_datas(db): # \u6e05\u7a7a\u4e00\u4e2a\u96c6\u5408\u4e2d\u7684\u6240\u6709\u6570\u636e db[\"informations\"].remove() if __name__ == '__main__': db = get_db() my_collection = get_collection(db) post = {\"author\": \"Mike\", \"text\": \"My first blog post!\", \"tags\": [\"mongodb\", \"python\", \"pymongo\"], \"date\": datetime.datetime.utcnow()} # \u63d2\u5165\u8bb0\u5f55 my_collection.insert(post) insert_one_doc(db) # \u6761\u4ef6\u67e5\u8be2 print (my_collection.find_one({\"x\": \"10\"})) # \u67e5\u8be2\u8868\u4e2d\u6240\u6709\u7684\u6570\u636e for data in my_collection.find(): print(data) print (my_collection.count()) my_collection.update({\"author\": \"Mike\"}, {\"author\": \"summer\", \"text\": \"My first blog post!\", \"tags\": [\"mongodb\", \"python\", \"pymongo\"], \"date\": datetime.datetime.utcnow()}) for data in my_collection.find(): print (data) get_one_doc(db) get_one_by_id(db) get_many_docs(db) # clear_all_datas(db)","title":"1. mongo"},{"location":"python/lib/nosql/mongo/mongo.index/#1","text":"MongoDB \u662f\u76ee\u524d\u6700\u6d41\u884c\u7684 NoSQL \u6570\u636e\u5e93\u4e4b\u4e00\uff0c\u4f7f\u7528\u7684\u6570\u636e\u7c7b\u578b BSON\uff08\u7c7b\u4f3c JSON\uff09\u3002 Python \u8981\u8fde\u63a5 MongoDB \u9700\u8981 MongoDB \u9a71\u52a8\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 PyMongo \u9a71\u52a8\u6765\u8fde\u63a5\u3002","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/nosql/mongo/mongo.index/#11","text":"pip \u662f\u4e00\u4e2a\u901a\u7528\u7684 Python \u5305\u7ba1\u7406\u5de5\u5177\uff0c\u63d0\u4f9b\u4e86\u5bf9 Python \u5305\u7684\u67e5\u627e\u3001\u4e0b\u8f7d\u3001\u5b89\u88c5\u3001\u5378\u8f7d\u7684\u529f\u80fd\u3002 python3 -m pip3 install pymongo \u4e5f\u53ef\u4ee5\u6307\u5b9a\u5b89\u88c5\u7684\u7248\u672c: python3 -m pip3 install pymongo==3.5.1 \u66f4\u65b0 pymongo \u547d\u4ee4\uff1a python3 -m pip3 install --upgrade pymongo \u65e7\u7248\u7684 Python \u53ef\u4ee5\u4f7f\u7528 easy_install \u6765\u5b89\u88c5\uff0ceasy_install \u4e5f\u662f Python \u5305\u7ba1\u7406\u5de5\u5177\u3002 python -m easy_install pymongo \u66f4\u65b0 pymongo \u547d\u4ee4\uff1a python -m easy_install -U pymongo","title":"1.1 \u5b89\u88c5"},{"location":"python/lib/nosql/mongo/mongo.index/#12-pymongo","text":"\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6 test_mongodb.py\uff0c\u4ee3\u7801\u5982\u4e0b root@leco:/home/leco# cat test_mongodb.py #!/usr/bin/python3 import pymongo root@leco:/home/leco# python3 test_mongodb.py root@leco:/home/leco# echo $? 0 \u6267\u884c\u4ee5\u4e0a\u4ee3\u7801\u6587\u4ef6\uff0c\u5982\u679c\u6ca1\u6709\u51fa\u73b0\u9519\u8bef\uff0c\u8868\u793a\u5b89\u88c5\u6210\u529f\u3002","title":"1.2 \u6d4b\u8bd5pymongo"},{"location":"python/lib/nosql/mongo/mongo.index/#2","text":"","title":"2. \u8be6\u7ec6"},{"location":"python/lib/nosql/mongo/mongo.index/#21-mongodb","text":"\u8fde\u63a5MongoDB\u6211\u4eec\u9700\u8981\u4f7f\u7528PyMongo\u5e93\u91cc\u9762\u7684MongoClient\uff0c\u4e00\u822c\u6765\u8bf4\u4f20\u5165MongoDB\u7684IP\u53ca\u7aef\u53e3\u5373\u53ef\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5730\u5740host\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u7aef\u53e3port\uff0c\u7aef\u53e3\u5982\u679c\u4e0d\u4f20\u9ed8\u8ba4\u662f27017\u3002 import pymongo client = pymongo.MongoClient(host='localhost', port=27017) \u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aMongoDB\u7684\u8fde\u63a5\u5bf9\u8c61\u4e86\u3002 \u53e6\u5916MongoClient\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570host\u8fd8\u53ef\u4ee5\u76f4\u63a5\u4f20MongoDB\u7684\u8fde\u63a5\u5b57\u7b26\u4e32\uff0c\u4ee5mongodb\u5f00\u5934\uff0c\u4f8b\u5982\uff1a client = MongoClient('mongodb://localhost:27017/') \u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u8fde\u63a5\u6548\u679c\u3002","title":"2.1 \u8fde\u63a5MongoDB"},{"location":"python/lib/nosql/mongo/mongo.index/#22","text":"MongoDB\u4e2d\u8fd8\u5206\u4e3a\u4e00\u4e2a\u4e2a\u6570\u636e\u5e93\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u7684\u4e00\u6b65\u5c31\u662f\u6307\u5b9a\u8981\u64cd\u4f5c\u54ea\u4e2a\u6570\u636e\u5e93\uff0c\u5728\u8fd9\u91cc\u6211\u4ee5test_mongo_db\u6570\u636e\u5e93\u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\uff0c\u6240\u4ee5\u4e0b\u4e00\u6b65\u6211\u4eec\u9700\u8981\u5728\u7a0b\u5e8f\u4e2d\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u6570\u636e\u5e93\u3002\u8c03\u7528client\u7684test_mongo_db\u5c5e\u6027\u5373\u53ef\u8fd4\u56detest_mongo_db\u6570\u636e\u5e93\u3002 db = client.test_mongo_db \u6216\u8005 db = client['test_mongo_db']","title":"2.2 \u6307\u5b9a\u6570\u636e\u5e93"},{"location":"python/lib/nosql/mongo/mongo.index/#23","text":"MongoDB\u7684\u6bcf\u4e2a\u6570\u636e\u5e93\u53c8\u5305\u542b\u4e86\u8bb8\u591a\u96c6\u5408Collection\uff0c\u4e5f\u5c31\u7c7b\u4f3c\u4e0e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684\u8868\uff0c\u4e0b\u4e00\u6b65\u6211\u4eec\u9700\u8981\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u96c6\u5408\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u6307\u5b9a\u4e00\u4e2a\u96c6\u5408\u540d\u79f0\u4e3ainformations\uff0cinformations\u96c6\u5408\u3002\u8fd8\u662f\u548c\u6307\u5b9a\u6570\u636e\u5e93\u7c7b\u4f3c\uff0c\u6307\u5b9a\u96c6\u5408\u4e5f\u6709\u4e24\u79cd\u65b9\u5f0f: collection = db.informations \u6216\u8005 collection = db['informations']","title":"2.3 \u6307\u5b9a\u96c6\u5408"},{"location":"python/lib/nosql/mongo/mongo.index/#24","text":"","title":"2.4 \u63d2\u5165\u6570\u636e"},{"location":"python/lib/nosql/mongo/mongo.index/#241","text":"\u63a5\u4e0b\u6765\u6211\u4eec\u4fbf\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u63d2\u5165\u4e86\uff0c\u5bf9\u4e8einformations\u8fd9\u4e2aCollection\uff0c\u6211\u4eec\u65b0\u5efa\u4e00\u6761\u6570\u636e\uff0c\u4ee5\u5b57\u5178\u7684\u5f62\u5f0f\u8868\u793a\uff1a information = {\"name\": \"\u5f20\u4e09\", \"age\": \"25\"} \u5728\u8fd9\u91cc\u6211\u4eec\u6307\u5b9a\u4e86\u59d3\u540d\u3001\u5e74\u9f84\u7136\u540e\u63a5\u4e0b\u6765\u76f4\u63a5\u8c03\u7528collection\u7684insert()\u65b9\u6cd5\u5373\u53ef\u63d2\u5165\u6570\u636e\u3002 result = collection.insert(information) print(result) \u5728MongoDB\u4e2d\uff0c\u6bcf\u6761\u6570\u636e\u5176\u5b9e\u90fd\u6709\u4e00\u4e2a_id\u5c5e\u6027\u6765\u552f\u4e00\u6807\u8bc6\uff0c\u5982\u679c\u6ca1\u6709\u663e\u5f0f\u6307\u660e_id\uff0cMongoDB\u4f1a\u81ea\u52a8\u4ea7\u751f\u4e00\u4e2aObjectId\u7c7b\u578b\u7684_id\u5c5e\u6027\u3002insert()\u65b9\u6cd5\u4f1a\u5728\u6267\u884c\u540e\u8fd4\u56de\u7684_id\u503c\u3002\u8fd0\u884c\u7ed3\u679c\uff1a 5c6b659b1607c47f8abe6ab7","title":"2.4.1 \u5355\u6761\u63d2\u5165"},{"location":"python/lib/nosql/mongo/mongo.index/#242","text":"\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u540c\u65f6\u63d2\u5165\u591a\u6761\u6570\u636e\uff0c\u53ea\u9700\u8981\u4ee5\u5217\u8868\u5f62\u5f0f\u4f20\u9012\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a information = [{\"name\": \"\u5c0f\u660e\", \"age\": \"25\"}, {\"name\": \"\u5c0f\u5f3a\", \"age\": \"24\"}] information_id = collection.insert(information) print(information_id) \u6216\u8005 xiaoming={\"name\": \"\u5c0f\u660e\", \"age\": \"25\"} xiaoqiang= {\"name\": \"\u5c0f\u5f3a\", \"age\": \"24\"} information_id = collection.insert([xiaoming,xiaoqiang]) print(information_id) \u8fd4\u56de\u7684\u7ed3\u679c\u662f\u5bf9\u5e94\u7684_id\u7684\u96c6\u5408\uff0c\u8fd0\u884c\u7ed3\u679c\uff1a [ObjectId('5c6b65c01607c47f8abe6ab8'), ObjectId('5c6b65c01607c47f8abe6ab9')]","title":"2.4.2 \u591a\u6761\u63d2\u5165"},{"location":"python/lib/nosql/mongo/mongo.index/#243","text":"\u5b9e\u9645\u4e0a\u5728PyMongo 3.X\u7248\u672c\u4e2d\uff0cinsert()\u65b9\u6cd5\u5b98\u65b9\u5df2\u7ecf\u4e0d\u63a8\u8350\u4f7f\u7528\u4e86\uff0c\u5f53\u7136\u7ee7\u7eed\u4f7f\u7528\u4e5f\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528insert_one()\u548cinsert_many()\u65b9\u6cd5\u5c06\u63d2\u5165\u5355\u6761\u548c\u591a\u6761\u8bb0\u5f55\u5206\u5f00\u3002 lisi = {\"name\": \"\u674e\u56db\", \"age\": \"25\"} result = collection.insert_one(lisi) print(result.inserted_id) \u8fd4\u56de\u7ed3\u679c\u548cinsert()\u65b9\u6cd5\u4e0d\u540c\uff0c\u8fd9\u6b21\u8fd4\u56de\u7684\u662fInsertOneResult\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u5176inserted_id\u5c5e\u6027\u83b7\u53d6_id\u3002\u7ed3\u679c\u662f 5c6b65df1607c47f8abe6aba","title":"2.4.3 \u65b0\u5355\u6761\u63d2\u5165"},{"location":"python/lib/nosql/mongo/mongo.index/#244","text":"\u5bf9\u4e8einsert_many()\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u636e\u4ee5\u5217\u8868\u5f62\u5f0f\u4f20\u9012\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a wangwu={\"name\": \"\u738b\u4e94\", \"age\": \"25\"} zhaoliu= {\"name\": \"\u8d75\u516d\", \"age\": \"24\"} result = collection.insert_many([wangwu,zhaoliu]) print(result) print(result.inserted_ids) \u7ed3\u679c\u662f: <pymongo.results.InsertManyResult object at 0x7f3cf2dc68c8> [ObjectId('5c6b66081607c47f8abe6abb'), ObjectId('5c6b66081607c47f8abe6abc')] insert_many()\u65b9\u6cd5\u8fd4\u56de\u7684\u7c7b\u578b\u662fInsertManyResult\uff0c\u8c03\u7528inserted_ids\u5c5e\u6027\u53ef\u4ee5\u83b7\u53d6\u63d2\u5165\u6570\u636e\u7684_id\u5217\u8868.","title":"2.4.4 \u65b0\u591a\u6761\u63d2\u5165"},{"location":"python/lib/nosql/mongo/mongo.index/#25","text":"","title":"2.5 \u67e5\u8be2\u6570\u636e"},{"location":"python/lib/nosql/mongo/mongo.index/#251-find_one","text":"\u63d2\u5165\u6570\u636e\u540e\u6211\u4eec\u53ef\u4ee5\u5229\u7528find_one(),find_one()\u67e5\u8be2\u5f97\u5230\u662f\u5355\u4e2a\u7ed3\u679c\u3002 result = collection.find_one({'name': '\u5f20\u4e09'}) print(type(result)) print(result) \u7ed3\u679c\u662f: <class 'dict'> {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} \u53ef\u4ee5\u53d1\u73b0\u5b83\u591a\u4e86\u4e00\u4e2a_id\u5c5e\u6027\uff0c\u8fd9\u5c31\u662fMongoDB\u5728\u63d2\u5165\u7684\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u6dfb\u52a0\u7684\u3002 \u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6839\u636eObjectId\u6765\u67e5\u8be2\uff0c\u8fd9\u91cc\u9700\u8981\u4f7f\u7528bson\u5e93\u91cc\u9762\u7684ObjectId\u3002 In [27]: from bson.objectid import ObjectId In [28]: result = collection.find_one({'_id':ObjectId('5c6b659b1607c47f8abe6ab7')}) In [29]: print(result) {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} \u5176\u67e5\u8be2\u7ed3\u679c\u4f9d\u7136\u662f\u5b57\u5178\u7c7b\u578b\uff0c\u8fd0\u884c\u7ed3\u679c\uff1a {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} \u5f53\u7136\u5982\u679c\u67e5\u8be2\u7ed3\u679c\u4e0d\u5b58\u5728\u5219\u4f1a\u8fd4\u56deNone.","title":"2.5.1 find_one()"},{"location":"python/lib/nosql/mongo/mongo.index/#252-find","text":"find()\u5219\u8fd4\u56de\u591a\u4e2a\u7ed3\u679c\u3002\u5bf9\u4e8e\u591a\u6761\u6570\u636e\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528find()\u65b9\u6cd5\uff0c\u4f8b\u5982\u5728\u8fd9\u91cc\u67e5\u627e\u5e74\u9f84\u4e3a25\u7684\u6570\u636e\uff0c results = collection.find({'age': '25'}) print(results) for result in results: print(result) \u7ed3\u679c\u662f: {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} {'_id': ObjectId('5c6b65c01607c47f8abe6ab8'), 'name': '\u5c0f\u660e', 'age': '25'} {'_id': ObjectId('5c6b65df1607c47f8abe6aba'), 'name': '\u674e\u56db', 'age': '25'} {'_id': ObjectId('5c6b66081607c47f8abe6abb'), 'name': '\u738b\u4e94', 'age': '25'} \u8fd4\u56de\u7ed3\u679c\u662fCursor\u7c7b\u578b\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u751f\u6210\u5668\uff0c\u6211\u4eec\u9700\u8981\u904d\u5386\u53d6\u5230\u6240\u6709\u7684\u7ed3\u679c\uff0c\u6bcf\u4e00\u4e2a\u7ed3\u679c\u90fd\u662f\u5b57\u5178\u7c7b\u578b\u3002 \u5982\u679c\u8981\u67e5\u8be2\u5e74\u9f84\u5927\u4e8e20\u7684\u6570\u636e\uff0c\u5219\u5199\u6cd5\u5982\u4e0b\uff1a results = collection.find({'age': {'$gt': '20'}}) \u6d4b\u8bd5 In [38]: results = collection.find({'age': {'$gt': '20'}}) In [39]: for data in results: ...: print(data) ...: {'_id': ObjectId('5c6b659b1607c47f8abe6ab7'), 'name': '\u5f20\u4e09', 'age': '25'} {'_id': ObjectId('5c6b65c01607c47f8abe6ab8'), 'name': '\u5c0f\u660e', 'age': '25'} {'_id': ObjectId('5c6b65c01607c47f8abe6ab9'), 'name': '\u5c0f\u5f3a', 'age': '24'} {'_id': ObjectId('5c6b65df1607c47f8abe6aba'), 'name': '\u674e\u56db', 'age': '25'} {'_id': ObjectId('5c6b66081607c47f8abe6abb'), 'name': '\u738b\u4e94', 'age': '25'} {'_id': ObjectId('5c6b66081607c47f8abe6abc'), 'name': '\u8d75\u516d', 'age': '24'} \u5728\u8fd9\u91cc\u67e5\u8be2\u7684\u6761\u4ef6\u952e\u503c\u5df2\u7ecf\u4e0d\u662f\u5355\u7eaf\u7684\u6570\u5b57\u4e86\uff0c\u800c\u662f\u4e00\u4e2a\u5b57\u5178\uff0c\u5176\u952e\u540d\u4e3a\u6bd4\u8f83\u7b26\u53f7$gt\uff0c\u610f\u601d\u662f\u5927\u4e8e\uff0c\u952e\u503c\u4e3a20\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u67e5\u8be2\u51fa\u6240\u6709\u5e74\u9f84\u5927\u4e8e20\u7684\u6570\u636e\u3002","title":"2.5.2 find()"},{"location":"python/lib/nosql/mongo/mongo.index/#253","text":"\u5728\u8fd9\u91cc\u5c06\u6bd4\u8f83\u7b26\u53f7\u5f52\u7eb3\u5982\u4e0b\u8868\uff1a \u7b26\u53f7 \u542b\u4e49 \u4f8b\u5b50 $lt \u5c0f\u4e8e {'age': {'$lt': 20}} $gt \u5927\u4e8e {'age': {'$gt': 20}} $lte \u5c0f\u4e8e\u7b49\u4e8e {'age': {'$lte': 20}} $gte \u5927\u4e8e\u7b49\u4e8e {'age': {'$gte': 20}} $ne \u4e0d\u7b49\u4e8e {'age': {'$ne': 20}} $in \u5728\u8303\u56f4\u5185 {'age': {'$in': [20, 23]}} $nin \u4e0d\u5728\u8303\u56f4\u5185 {'age': {'$nin': [20, 23]}} \u53e6\u5916\u8fd8\u53ef\u4ee5\u8fdb\u884c\u6b63\u5219\u5339\u914d\u67e5\u8be2\uff0c\u4f8b\u5982\u67e5\u8be2\u540d\u5b57\u4ee5M\u5f00\u5934\u7684\u5b66\u751f\u6570\u636e\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a results = collection.find({'name': {'$regex': '^M.*'}}) \u5728\u8fd9\u91cc\u4f7f\u7528\u4e86$regex\u6765\u6307\u5b9a\u6b63\u5219\u5339\u914d\uff0c^M.*\u4ee3\u8868\u4ee5M\u5f00\u5934\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u67e5\u8be2\u6240\u6709\u7b26\u5408\u8be5\u6b63\u5219\u7684\u7ed3\u679c\u3002","title":"2.5.3 \u6bd4\u8f83\u7b26\u53f7"},{"location":"python/lib/nosql/mongo/mongo.index/#254","text":"\u5728\u8fd9\u91cc\u5c06\u4e00\u4e9b\u529f\u80fd\u7b26\u53f7\u518d\u5f52\u7c7b\u5982\u4e0b\uff1a \u7b26\u53f7 \u542b\u4e49 \u4f8b\u5b50 \u4f8b\u5b50\u542b\u4e49 $regex \u5339\u914d\u6b63\u5219 {'name': {'$regex': '^M.*'}} name\u4ee5M\u5f00\u5934 $exists \u5c5e\u6027\u662f\u5426\u5b58\u5728 {'name': {'$exists': True}} name\u5c5e\u6027\u5b58\u5728 $type \u7c7b\u578b\u5224\u65ad {'age': {'$type': 'int'}} age\u7684\u7c7b\u578b\u4e3aint $mod \u6570\u5b57\u6a21\u64cd\u4f5c {'age': {'$mod': [5, 0]}} \u5e74\u9f84\u6a215\u4f590 $text \u6587\u672c\u67e5\u8be2 {' text': {' text': {' search': 'Mike'}} text\u7c7b\u578b\u7684\u5c5e\u6027\u4e2d\u5305\u542bMike\u5b57\u7b26\u4e32 $where \u9ad8\u7ea7\u6761\u4ef6\u67e5\u8be2 {'$where': 'obj.fans_count == obj.follows_count'} \u81ea\u8eab\u7c89\u4e1d\u6570\u7b49\u4e8e\u5173\u6ce8\u6570 \u8fd9\u4e9b\u64cd\u4f5c\u7684\u66f4\u8be6\u7ec6\u7528\u6cd5\u5728\u53ef\u4ee5\u5728MongoDB\u5b98\u65b9\u6587\u6863\u627e\u5230\uff1a https://docs.mongodb.com/manual/reference/operator/query/","title":"2.5.4 \u529f\u80fd\u7b26\u53f7"},{"location":"python/lib/nosql/mongo/mongo.index/#25_1","text":"\u8981\u7edf\u8ba1\u67e5\u8be2\u7ed3\u679c\u6709\u591a\u5c11\u6761\u6570\u636e\uff0c\u53ef\u4ee5\u8c03\u7528count()\u65b9\u6cd5\uff0c\u5982\u7edf\u8ba1\u6240\u6709\u6570\u636e\u6761\u6570\uff1a In [40]: count = collection.find().count() In [41]: print(count) 6 \u6216\u8005\u7edf\u8ba1\u7b26\u5408\u67d0\u4e2a\u6761\u4ef6\u7684\u6570\u636e\uff1a In [43]: count = collection.find({'age': '25'}).count() In [44]: print(count) 4","title":"2.5 \u8ba1\u6570"},{"location":"python/lib/nosql/mongo/mongo.index/#26","text":"\u53ef\u4ee5\u8c03\u7528sort\u65b9\u6cd5\uff0c\u4f20\u5165\u6392\u5e8f\u7684\u5b57\u6bb5\u53ca\u5347\u964d\u5e8f\u6807\u5fd7\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a In [45]: results = collection.find().sort('name', pymongo.ASCENDING) In [46]: print([result['name'] for result in results]) ['\u5c0f\u5f3a', '\u5c0f\u660e', '\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d']","title":"2.6 \u6392\u5e8f"},{"location":"python/lib/nosql/mongo/mongo.index/#27","text":"\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u80fd\u60f3\u53ea\u53d6\u67d0\u51e0\u4e2a\u5143\u7d20\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528skip()\u65b9\u6cd5\u504f\u79fb\u51e0\u4e2a\u4f4d\u7f6e\uff0c\u6bd4\u5982\u504f\u79fb2\uff0c\u5c31\u5ffd\u7565\u524d2\u4e2a\u5143\u7d20\uff0c\u5f97\u5230\u7b2c\u4e09\u4e2a\u53ca\u4ee5\u540e\u7684\u5143\u7d20\u3002 In [47]: results = collection.find().sort('name', pymongo.ASCENDING).skip(2) In [48]: print([result['name'] for result in results]) ['\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d']","title":"2.7 \u504f\u79fb"},{"location":"python/lib/nosql/mongo/mongo.index/#28-limit","text":"\u53ef\u4ee5\u7528limit()\u65b9\u6cd5\u6307\u5b9a\u8981\u53d6\u7684\u7ed3\u679c\u4e2a\u6570\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a In [49]: results = collection.find().sort('name', pymongo.ASCENDING).skip(2).limit(2) In [50]: print([result['name'] for result in results]) ['\u5f20\u4e09', '\u674e\u56db'] \u5982\u679c\u4e0d\u52a0limit()\u539f\u672c\u4f1a\u8fd4\u56de\u4e09\u4e2a\u7ed3\u679c\uff0c\u52a0\u4e86\u9650\u5236\u4e4b\u540e\uff0c\u4f1a\u622a\u53d62\u4e2a\u7ed3\u679c\u8fd4\u56de\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728\u6570\u636e\u5e93\u6570\u91cf\u975e\u5e38\u5e9e\u5927\u7684\u65f6\u5019\uff0c\u5982\u5343\u4e07\u3001\u4ebf\u7ea7\u522b\uff0c\u6700\u597d\u4e0d\u8981\u4f7f\u7528\u5927\u7684\u504f\u79fb\u91cf\u6765\u67e5\u8be2\u6570\u636e\uff0c\u5f88\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3cfind({'_id': {'$gt': ObjectId('593278c815c2602678bb2b8d')}}) \u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u67e5\u8be2\uff0c\u8bb0\u5f55\u597d\u4e0a\u6b21\u67e5\u8be2\u7684_id\u3002","title":"2.8 limit"},{"location":"python/lib/nosql/mongo/mongo.index/#29","text":"","title":"2.9 \u66f4\u65b0"},{"location":"python/lib/nosql/mongo/mongo.index/#291-update","text":"\u5bf9\u4e8e\u6570\u636e\u66f4\u65b0\u53ef\u4ee5\u4f7f\u7528update()\u65b9\u6cd5\uff0c\u6307\u5b9a\u66f4\u65b0\u7684\u6761\u4ef6\u548c\u66f4\u65b0\u540e\u7684\u6570\u636e\u5373\u53ef\uff0c\u4f8b\u5982\uff1a \u6ca1\u4fee\u6539\u4e4b\u524d > db.informations.find() { \"_id\" : ObjectId(\"5c6b659b1607c47f8abe6ab7\"), \"name\" : \"\u5f20\u4e09\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab8\"), \"name\" : \"\u5c0f\u660e\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab9\"), \"name\" : \"\u5c0f\u5f3a\", \"age\" : \"24\" } { \"_id\" : ObjectId(\"5c6b65df1607c47f8abe6aba\"), \"name\" : \"\u674e\u56db\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abb\"), \"name\" : \"\u738b\u4e94\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abc\"), \"name\" : \"\u8d75\u516d\", \"age\" : \"24\" } In [51]: condition = {'name': '\u5f20\u4e09'} In [52]: user = collection.find_one(condition) In [53]: user['age']=20 In [54]: result = collection.update(condition, user) /usr/local/bin/ipython:1: DeprecationWarning: update is deprecated. Use replace_one, update_one or update_many instead. #!/usr/local/bin/python3.6 In [55]: print(result) {'ok': 1, 'nModified': 1, 'n': 1, 'updatedExisting': True} \u4fee\u6539\u4e4b\u540e > db.informations.find() { \"_id\" : ObjectId(\"5c6b659b1607c47f8abe6ab7\"), \"name\" : \"\u5f20\u4e09\", \"age\" : 20 } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab8\"), \"name\" : \"\u5c0f\u660e\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b65c01607c47f8abe6ab9\"), \"name\" : \"\u5c0f\u5f3a\", \"age\" : \"24\" } { \"_id\" : ObjectId(\"5c6b65df1607c47f8abe6aba\"), \"name\" : \"\u674e\u56db\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abb\"), \"name\" : \"\u738b\u4e94\", \"age\" : \"25\" } { \"_id\" : ObjectId(\"5c6b66081607c47f8abe6abc\"), \"name\" : \"\u8d75\u516d\", \"age\" : \"24\" } \u8fd4\u56de\u7ed3\u679c\u662f\u5b57\u5178\u5f62\u5f0f\uff0cok\u5373\u4ee3\u8868\u6267\u884c\u6210\u529f\uff0cnModified\u4ee3\u8868\u5f71\u54cd\u7684\u6570\u636e\u6761\u6570\u3002 \u53e6\u5916update()\u65b9\u6cd5\u5176\u5b9e\u4e5f\u662f\u5b98\u65b9\u4e0d\u63a8\u8350\u4f7f\u7528\u7684\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u4e5f\u5206\u4e86update_one()\u65b9\u6cd5\u548cupdate_many()\u65b9\u6cd5\uff0c\u7528\u6cd5\u66f4\u52a0\u4e25\u683c\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u9700\u8981\u4f7f\u7528$\u7c7b\u578b\u64cd\u4f5c\u7b26\u4f5c\u4e3a\u5b57\u5178\u7684\u952e\u540d\uff0c\u6211\u4eec\u7528\u793a\u4f8b\u611f\u53d7\u4e00\u4e0b\u3002","title":"2.9.1 update"},{"location":"python/lib/nosql/mongo/mongo.index/#292-update_one","text":"condition = {'name': '\u674e\u56db'} user = collection.find_one(condition) user['age'] = 26 result = collection.update_one(condition, {'$set': user}) print(result) print(result.matched_count, result.modified_count) \u5728\u8fd9\u91cc\u8c03\u7528\u4e86update_one\u65b9\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e0d\u80fd\u518d\u76f4\u63a5\u4f20\u5165\u4fee\u6539\u540e\u7684\u5b57\u5178\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528{'$set': user}\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u5176\u8fd4\u56de\u7ed3\u679c\u662fUpdateResult\u7c7b\u578b\uff0c\u7136\u540e\u8c03\u7528matched_count\u548cmodified_count\u5c5e\u6027\u5206\u522b\u53ef\u4ee5\u83b7\u5f97\u5339\u914d\u7684\u6570\u636e\u6761\u6570\u548c\u5f71\u54cd\u7684\u6570\u636e\u6761\u6570\u3002 \u518d\u770b\u4e00\u4e2a\u4f8b\u5b50 condition = {'age': {'$gt': 20}} result = collection.update_one(condition, {'$inc': {'age': 1}}) print(result) print(result.matched_count, result.modified_count) \u5728\u8fd9\u91cc\u6211\u4eec\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6\u4e3a\u5e74\u9f84\u5927\u4e8e20\uff0c\u7136\u540e\u66f4\u65b0\u6761\u4ef6\u4e3a{'$inc': {'age': 1}} \uff0c\u4e5f\u5c31\u662f\u5e74\u9f84\u52a01\uff0c\u6267\u884c\u4e4b\u540e\u4f1a\u8bb2\u7b2c\u4e00\u6761\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\u5e74\u9f84\u52a01\u3002","title":"2.9.2 update_one"},{"location":"python/lib/nosql/mongo/mongo.index/#293-update_many","text":"\u5982\u679c\u8c03\u7528update_many()\u65b9\u6cd5\uff0c\u5219\u4f1a\u5c06\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\u90fd\u66f4\u65b0\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a condition = {'age': {'$gt': 20}} result = collection.update_many(condition, {'$inc': {'age': 1}}) print(result) print(result.matched_count, result.modified_count)","title":"2.9.3 update_many"},{"location":"python/lib/nosql/mongo/mongo.index/#210","text":"","title":"2.10 \u5220\u9664"},{"location":"python/lib/nosql/mongo/mongo.index/#2101-remove","text":"\u5220\u9664\u64cd\u4f5c\u6bd4\u8f83\u7b80\u5355\uff0c\u76f4\u63a5\u8c03\u7528remove()\u65b9\u6cd5\u6307\u5b9a\u5220\u9664\u7684\u6761\u4ef6\u5373\u53ef\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u6240\u6709\u6570\u636e\u5747\u4f1a\u88ab\u5220\u9664\uff0c\u793a\u4f8b\u5982\u4e0b result = collection.remove({'name': '\u738b\u4e94'}) print(result) \u8fd0\u884c n [66]: result = collection.remove({'name': '\u738b\u4e94'}) /usr/local/bin/ipython:1: DeprecationWarning: remove is deprecated. Use delete_one or delete_many instead. #!/usr/local/bin/python3.6 In [67]: print(result) {'ok': 1, 'n': 1} \u53e6\u5916\u4f9d\u7136\u5b58\u5728\u4e24\u4e2a\u65b0\u7684\u63a8\u8350\u65b9\u6cd5\uff0cdelete_one()\u548cdelete_many()\u65b9\u6cd5.","title":"2.10.1 remove"},{"location":"python/lib/nosql/mongo/mongo.index/#2102-delete_one","text":"result = collection.delete_one({'name': '\u8d75\u516d'}) print(result) print(result.deleted_count) \u8fc7\u7a0b In [68]: result = collection.delete_one({'name': '\u8d75\u516d'}) In [69]: print(result) <pymongo.results.DeleteResult object at 0x7f3d00039188> In [70]: print(result.deleted_count) 1","title":"2.10.2 delete_one"},{"location":"python/lib/nosql/mongo/mongo.index/#2103-delete_many","text":"result = collection.delete_many({'age': {'$lt': 10}}) print(result.deleted_count) delete_one()\u5373\u5220\u9664\u7b2c\u4e00\u6761\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\uff0cdelete_many()\u5373\u5220\u9664\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\uff0c\u8fd4\u56de\u7ed3\u679c\u662fDeleteResult\u7c7b\u578b\uff0c\u53ef\u4ee5\u8c03\u7528deleted_count\u5c5e\u6027\u83b7\u53d6\u5220\u9664\u7684\u6570\u636e\u6761\u6570\u3002","title":"2.10.3 delete_many"},{"location":"python/lib/nosql/mongo/mongo.index/#2104","text":"\u53e6\u5916PyMongo\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7ec4\u5408\u65b9\u6cd5\uff0c\u5982find_one_and_delete() \u3001find_one_and_replace() \u3001find_one_and_update() \uff0c\u5c31\u662f\u67e5\u627e\u540e\u5220\u9664\u3001\u66ff\u6362\u3001\u66f4\u65b0\u64cd\u4f5c\uff0c\u7528\u6cd5\u4e0e\u4e0a\u8ff0\u65b9\u6cd5\u57fa\u672c\u4e00\u81f4\u3002 \u53e6\u5916\u8fd8\u53ef\u4ee5\u5bf9\u7d22\u5f15\u8fdb\u884c\u64cd\u4f5c\uff0c\u5982create_index() \u3001create_indexes() \u3001drop_index()\u7b49\u3002 \u8be6\u7ec6\u7528\u6cd5\u53ef\u4ee5\u53c2\u89c1\u5b98\u65b9\u6587\u6863\uff1a http://api.mongodb.com/python/current/api/pymongo/collection.html \u53e6\u5916\u8fd8\u6709\u5bf9\u6570\u636e\u5e93\u3001\u96c6\u5408\u672c\u8eab\u4ee5\u53ca\u5176\u4ed6\u7684\u4e00\u4e9b\u64cd\u4f5c\uff0c\u5728\u8fd9\u4e0d\u518d\u4e00\u4e00\u8bb2\u89e3\uff0c\u53ef\u4ee5\u53c2\u89c1\u5b98\u65b9\u6587\u6863\uff1a http://api.mongodb.com/python/current/api/pymongo/","title":"2.10.4 \u66f4\u591a"},{"location":"python/lib/nosql/mongo/mongo.index/#211-code","text":"#!/usr/bin/env python # -*- coding: utf-8 -*- import pymongo import datetime def get_db(): # \u5efa\u7acb\u8fde\u63a5 client = pymongo.MongoClient(host=\"127.0.0.1\", port=27017) # host \u6307\u5b9a\u8981\u94fe\u63a5\u7684mongo server\u7684\u4e3b\u673a\u3002port\u662f\u7aef\u53e3 db = client['test_mongo_db'] #\u6216\u8005 db = client.test_mongo_db return db def get_collection(db): # \u9009\u62e9\u96c6\u5408(mongo\u4e2dcollection\u548cdatabase\u90fd\u662f\u5ef6\u65f6\u521b\u5efa\u7684) coll = db['informations'] print (db.collection_names()) return coll def insert_one_doc(db): # \u63d2\u5165\u4e00\u4e2adocument coll = db['informations'] information = {\"name\": \"summer\", \"age\": \"25\"} information_id = coll.insert(information) print(information_id) def insert_multi_docs(db): # \u6279\u91cf\u63d2\u5165documents,\u63d2\u5165\u4e00\u4e2a\u6570\u7ec4 coll = db['informations'] information = [{\"name\": \"\u5c0f\u660e\", \"age\": \"25\"}, {\"name\": \"\u5c0f\u5f3a\", \"age\": \"24\"}] information_id = coll.insert(information) print(information_id) def get_one_doc(db): # \u6709\u5c31\u8fd4\u56de\u4e00\u4e2a\uff0c\u6ca1\u6709\u5c31\u8fd4\u56deNone coll = db['informations'] print(coll.find_one()) # \u8fd4\u56de\u7b2c\u4e00\u6761\u8bb0\u5f55 print(coll.find_one({\"name\": \"summer\"})) print(coll.find_one({\"name\": \"none\"})) def get_one_by_id(db): # \u901a\u8fc7objectid\u6765\u67e5\u627e\u4e00\u4e2adoc coll = db['informations'] obj = coll.find_one() obj_id = obj[\"_id\"] print(\"_id \u4e3aObjectId\u7c7b\u578b\uff0cobj_id:\" + str(obj_id)) print(coll.find_one({\"_id\": obj_id})) # \u9700\u8981\u6ce8\u610f\u8fd9\u91cc\u7684obj_id\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e0d\u662f\u4e00\u4e2astr\uff0c\u4f7f\u7528str\u7c7b\u578b\u4f5c\u4e3a_id\u7684\u503c\u65e0\u6cd5\u627e\u5230\u8bb0\u5f55 print(\"_id \u4e3astr\u7c7b\u578b \") print(coll.find_one({\"_id\": str(obj_id)})) # \u53ef\u4ee5\u901a\u8fc7ObjectId\u65b9\u6cd5\u628astr\u8f6c\u6210ObjectId\u7c7b\u578b from bson.objectid import ObjectId print (\"_id \u8f6c\u6362\u6210ObjectId\u7c7b\u578b\") print (coll.find_one({\"_id\": ObjectId(str(obj_id))})) def get_many_docs(db): # mongo\u4e2d\u63d0\u4f9b\u4e86\u8fc7\u6ee4\u67e5\u627e\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u6761\u4ef6\u7b5b\u9009\u6765\u83b7\u53d6\u6570\u636e\u96c6\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u8ba1\u6570\uff0c\u6392\u5e8f\u7b49\u5904\u7406 coll = db['informations'] # ASCENDING = 1 \u5347\u5e8f;DESCENDING = -1\u964d\u5e8f;default is ASCENDING for item in coll.find().sort(\"age\", pymongo.DESCENDING): print(item) count = coll.count() print (\"\u96c6\u5408\u4e2d\u6240\u6709\u6570\u636e %s\u4e2a\" % int(count)) # \u6761\u4ef6\u67e5\u8be2 count = coll.find({\"name\":\"summer\"}).count() print (\"summer: %s\"%count) def clear_all_datas(db): # \u6e05\u7a7a\u4e00\u4e2a\u96c6\u5408\u4e2d\u7684\u6240\u6709\u6570\u636e db[\"informations\"].remove() if __name__ == '__main__': db = get_db() my_collection = get_collection(db) post = {\"author\": \"Mike\", \"text\": \"My first blog post!\", \"tags\": [\"mongodb\", \"python\", \"pymongo\"], \"date\": datetime.datetime.utcnow()} # \u63d2\u5165\u8bb0\u5f55 my_collection.insert(post) insert_one_doc(db) # \u6761\u4ef6\u67e5\u8be2 print (my_collection.find_one({\"x\": \"10\"})) # \u67e5\u8be2\u8868\u4e2d\u6240\u6709\u7684\u6570\u636e for data in my_collection.find(): print(data) print (my_collection.count()) my_collection.update({\"author\": \"Mike\"}, {\"author\": \"summer\", \"text\": \"My first blog post!\", \"tags\": [\"mongodb\", \"python\", \"pymongo\"], \"date\": datetime.datetime.utcnow()}) for data in my_collection.find(): print (data) get_one_doc(db) get_one_by_id(db) get_many_docs(db) # clear_all_datas(db)","title":"2.11 code"},{"location":"python/lib/nosql/redis/redis.index/","text":"1. \u4ecb\u7ecd \u00b6 Redis\u662f\u4e00\u4e2a\u57fa\u4e8e\u5185\u5b58\u7684\u9ad8\u6548\u7684\u952e\u503c\u578b\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u5b58\u53d6\u6548\u7387\u6781\u9ad8\uff0c\u800c\u4e14\u652f\u6301\u591a\u79cd\u5b58\u50a8\u6570\u636e\u7ed3\u6784\uff0c\u4f7f\u7528\u4e5f\u975e\u5e38\u7b80\u5355\u3002\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c31\u6765\u4ecb\u7ecd\u4e00\u4e0bPython\u7684Redis\u64cd\u4f5c\uff0c\u4e3b\u8981\u4ecb\u7ecdRedisPy\u8fd9\u4e2a\u5e93\u7684\u7528\u6cd5\u3002 1.1 \u51c6\u5907\u5de5\u4f5c \u00b6 \u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5\u597d\u4e86Redis\u53caRedisPy\u5e93\u3002\u5982\u679c\u8981\u505a\u6570\u636e\u5bfc\u5165/\u5bfc\u51fa\u64cd\u4f5c\u7684\u8bdd\uff0c\u8fd8\u9700\u8981\u5b89\u88c5RedisDump\u3002 1.2 Redis StrictRedis \u00b6 RedisPy\u5e93\u63d0\u4f9b\u4e24\u4e2a\u7c7bRedis\u548cStrictRedis\u6765\u5b9e\u73b0Redis\u7684\u547d\u4ee4\u64cd\u4f5c\u3002 StrictRedis\u5b9e\u73b0\u4e86\u7edd\u5927\u90e8\u5206\u5b98\u65b9\u7684\u547d\u4ee4\uff0c\u53c2\u6570\u4e5f\u4e00\u4e00\u5bf9\u5e94\uff0c\u6bd4\u5982set()\u65b9\u6cd5\u5c31\u5bf9\u5e94Redis\u547d\u4ee4\u7684set\u65b9\u6cd5\u3002\u800cRedis\u662fStrictRedis\u7684\u5b50\u7c7b\uff0c\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u7528\u4e8e\u5411\u540e\u517c\u5bb9\u65e7\u7248\u672c\u5e93\u91cc\u7684\u51e0\u4e2a\u65b9\u6cd5\u3002\u4e3a\u4e86\u505a\u517c\u5bb9\uff0c\u5b83\u5c06\u65b9\u6cd5\u505a\u4e86\u6539\u5199\uff0c\u6bd4\u5982lrem()\u65b9\u6cd5\u5c31\u5c06value\u548cnum\u53c2\u6570\u7684\u4f4d\u7f6e\u4e92\u6362\uff0c\u8fd9\u548cRedis\u547d\u4ee4\u884c\u7684\u547d\u4ee4\u53c2\u6570\u4e0d\u4e00\u81f4\u3002\u5b98\u65b9\u63a8\u8350\u4f7f\u7528StrictRedis 1.3 \u5b89\u88c5 \u00b6 Redis \u548c python\u64cd\u4f5c\u6a21\u5757 \u5b89\u88c5 \u53ca \u542f\u52a8 - ubuntu\u7cfb\u7edf apt-get install redis-server pip3 install Redis /etc/init.d/redis-server restart centos\u7cfb\u7edf yum install redis-server pip3 install Redis /etc/init.d/redis-server restart \u67e5\u770b\u7248\u672c\uff1a redis-cli info # redis\u8be6\u7ec6\u4fe1\u606f redis-cli --version | redis-cli -v redis-server --version | redis-server -v - \u7b80\u5355\u4f7f\u7528\uff1a 127.0.0.1:6379> set name 'keke' # \u8bbe\u7f6e \u952e\u4e3aname \u5bf9\u5e94\u7684\u503c\u4e3akeke OK 127.0.0.1:6379> set age '3' OK 127.0.0.1:6379> keys * # \u67e5\u770b\u6240\u6709\u7684\u952e 1) \"age\" 2) \"name\" 127.0.0.1:6379> get name # \u67e5\u770b\u952e\u4e3aname\u5bf9\u5e94\u7684\u503c \"keke\" 127.0.0.1:6379> get age \"3\" 127.0.0.1:6379> set sex female ex 2 # \u8bbe\u7f6e\u503c\uff0c\u53ea\u5b58\u6d3b2\u79d2 OK 127.0.0.1:6379> keys * 1) \"age\" 2) \"name\" 127.0.0.1:6379> set sex female ex 10 OK 127.0.0.1:6379> keys * 1) \"age\" 2) \"sex\" 3) \"name\" 127.0.0.1:6379> get sex \"female\" 127.0.0.1:6379> keys * 1) \"age\" 2) \"name\" 127.0.0.1:6379> flushdb # \u6e05\u7a7a\u5f53\u524ddb\u4e0b\u7684\u6240\u6709\u952e\u503c\uff0c\u8c28\u614e\u64cd\u4f5c OK 127.0.0.1:6379> keys * (empty list or set) 127.0.0.1:6379> 127.0.0.1:6379> flushall # \u6e05\u7a7a\u6240\u6709db\u4e0b\u7684\u952e\u503c OK 2. \u57fa\u672c\u547d\u4ee4 \u00b6 2.1 redis key\u547d\u4ee4 \u00b6 Redis keys \u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 DEL key \u8be5\u547d\u4ee4\u7528\u4e8e\u5728 key \u5b58\u5728\u65f6\u5220\u9664 key\u3002 DUMP key \u5e8f\u5217\u5316\u7ed9\u5b9a key \uff0c\u5e76\u8fd4\u56de\u88ab\u5e8f\u5217\u5316\u7684\u503c\u3002 EXISTS key \u68c0\u67e5\u7ed9\u5b9a key \u662f\u5426\u5b58\u5728\u3002 EXPIRE key seconds \u4e3a\u7ed9\u5b9a key \u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4ee5\u79d2\u8ba1\u3002 EXPIREAT key timestamp EXPIREAT \u7684\u4f5c\u7528\u548c EXPIRE \u7c7b\u4f3c\uff0c\u90fd\u7528\u4e8e\u4e3a key \u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002 \u4e0d\u540c\u5728\u4e8e EXPIREAT \u547d\u4ee4\u63a5\u53d7\u7684\u65f6\u95f4\u53c2\u6570\u662f UNIX \u65f6\u95f4\u6233(unix timestamp)\u3002 PEXPIRE key milliseconds \u8bbe\u7f6e key \u7684\u8fc7\u671f\u65f6\u95f4\u4ee5\u6beb\u79d2\u8ba1\u3002 PEXPIREAT key milliseconds-timestamp \u8bbe\u7f6e key \u8fc7\u671f\u65f6\u95f4\u7684\u65f6\u95f4\u6233(unix timestamp) \u4ee5\u6beb\u79d2\u8ba1 KEYS pattern \u67e5\u627e\u6240\u6709\u7b26\u5408\u7ed9\u5b9a\u6a21\u5f0f( pattern)\u7684 key \u3002 MOVE key db \u5c06\u5f53\u524d\u6570\u636e\u5e93\u7684 key \u79fb\u52a8\u5230\u7ed9\u5b9a\u7684\u6570\u636e\u5e93 db \u5f53\u4e2d\u3002 PERSIST key \u79fb\u9664 key \u7684\u8fc7\u671f\u65f6\u95f4\uff0ckey \u5c06\u6301\u4e45\u4fdd\u6301\u3002 PTTL key \u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u8fd4\u56de key \u7684\u5269\u4f59\u7684\u8fc7\u671f\u65f6\u95f4\u3002 TTL key \u4ee5\u79d2\u4e3a\u5355\u4f4d\uff0c\u8fd4\u56de\u7ed9\u5b9a key \u7684\u5269\u4f59\u751f\u5b58\u65f6\u95f4(TTL, time to live)\u3002 RANDOMKEY \u4ece\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u968f\u673a\u8fd4\u56de\u4e00\u4e2a key \u3002 RENAME key newkey \u4fee\u6539 key \u7684\u540d\u79f0 RENAMENX key newkey \u4ec5\u5f53 newkey \u4e0d\u5b58\u5728\u65f6\uff0c\u5c06 key \u6539\u540d\u4e3a newkey \u3002 TYPE key \u8fd4\u56de key \u6240\u50a8\u5b58\u7684\u503c\u7684\u7c7b\u578b\u3002 2.2 redis \u5b57\u7b26\u4e32\u547d\u4ee4 \u00b6 Redis \u5b57\u7b26\u4e32\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 SET key value \u8bbe\u7f6e\u6307\u5b9a key \u7684\u503c GET key \u83b7\u53d6\u6307\u5b9a key \u7684\u503c\u3002 GETRANGE key start end \u8fd4\u56de key \u4e2d\u5b57\u7b26\u4e32\u503c\u7684\u5b50\u5b57\u7b26 GETSET key value \u5c06\u7ed9\u5b9a key \u7684\u503c\u8bbe\u4e3a value \uff0c\u5e76\u8fd4\u56de key \u7684\u65e7\u503c(old value)\u3002 GETBIT key offset \u5bf9 key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u83b7\u53d6\u6307\u5b9a\u504f\u79fb\u91cf\u4e0a\u7684\u4f4d(bit)\u3002 MGET key1 [key2..] \u83b7\u53d6\u6240\u6709(\u4e00\u4e2a\u6216\u591a\u4e2a)\u7ed9\u5b9a key \u7684\u503c\u3002 SETBIT key offset value \u5bf9 key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u8bbe\u7f6e\u6216\u6e05\u9664\u6307\u5b9a\u504f\u79fb\u91cf\u4e0a\u7684\u4f4d(bit)\u3002 SETEX key seconds value \u5c06\u503c value \u5173\u8054\u5230 key \uff0c\u5e76\u5c06 key \u7684\u8fc7\u671f\u65f6\u95f4\u8bbe\u4e3a seconds (\u4ee5\u79d2\u4e3a\u5355\u4f4d)\u3002 SETNX key value \u53ea\u6709\u5728 key \u4e0d\u5b58\u5728\u65f6\u8bbe\u7f6e key \u7684\u503c\u3002 SETRANGE key offset value \u7528 value \u53c2\u6570\u8986\u5199\u7ed9\u5b9a key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u4ece\u504f\u79fb\u91cf offset \u5f00\u59cb\u3002 STRLEN key \u8fd4\u56de key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\u7684\u957f\u5ea6\u3002 MSET key value [key value ...] \u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2a key-value \u5bf9\u3002 MSETNX key value [key value ...] \u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2a key-value \u5bf9\uff0c\u5f53\u4e14\u4ec5\u5f53\u6240\u6709\u7ed9\u5b9a key \u90fd\u4e0d\u5b58\u5728\u3002 PSETEX key milliseconds value \u8fd9\u4e2a\u547d\u4ee4\u548c SETEX \u547d\u4ee4\u76f8\u4f3c\uff0c\u4f46\u5b83\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u8bbe\u7f6e key \u7684\u751f\u5b58\u65f6\u95f4\uff0c\u800c\u4e0d\u662f\u50cf SETEX \u547d\u4ee4\u90a3\u6837\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\u3002 INCR key \u5c06 key \u4e2d\u50a8\u5b58\u7684\u6570\u5b57\u503c\u589e\u4e00\u3002 INCRBY key increment \u5c06 key \u6240\u50a8\u5b58\u7684\u503c\u52a0\u4e0a\u7ed9\u5b9a\u7684\u589e\u91cf\u503c\uff08increment\uff09 \u3002 INCRBYFLOAT key increment \u5c06 key \u6240\u50a8\u5b58\u7684\u503c\u52a0\u4e0a\u7ed9\u5b9a\u7684\u6d6e\u70b9\u589e\u91cf\u503c\uff08increment\uff09 \u3002 DECR key \u5c06 key \u4e2d\u50a8\u5b58\u7684\u6570\u5b57\u503c\u51cf\u4e00\u3002 DECRBY key decrement key \u6240\u50a8\u5b58\u7684\u503c\u51cf\u53bb\u7ed9\u5b9a\u7684\u51cf\u91cf\u503c\uff08decrement\uff09 \u3002 APPEND key value \u5982\u679c key \u5df2\u7ecf\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c APPEND \u547d\u4ee4\u5c06\u6307\u5b9a\u7684 value \u8ffd\u52a0\u5230\u8be5 key \u539f\u6765\u503c\uff08value\uff09\u7684\u672b\u5c3e\u3002 2.3 redis hash\u4e32\u547d\u4ee4 \u00b6 Redis hash \u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 HDEL key field1 [field2] \u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u54c8\u5e0c\u8868\u5b57\u6bb5 HEXISTS key field \u67e5\u770b\u54c8\u5e0c\u8868 key \u4e2d\uff0c\u6307\u5b9a\u7684\u5b57\u6bb5\u662f\u5426\u5b58\u5728\u3002 HGET key field \u83b7\u53d6\u5b58\u50a8\u5728\u54c8\u5e0c\u8868\u4e2d\u6307\u5b9a\u5b57\u6bb5\u7684\u503c\u3002 HGETALL key \u83b7\u53d6\u5728\u54c8\u5e0c\u8868\u4e2d\u6307\u5b9a key \u7684\u6240\u6709\u5b57\u6bb5\u548c\u503c HINCRBY key field increment \u4e3a\u54c8\u5e0c\u8868 key \u4e2d\u7684\u6307\u5b9a\u5b57\u6bb5\u7684\u6574\u6570\u503c\u52a0\u4e0a\u589e\u91cf increment \u3002 HINCRBYFLOAT key field increment \u4e3a\u54c8\u5e0c\u8868 key \u4e2d\u7684\u6307\u5b9a\u5b57\u6bb5\u7684\u6d6e\u70b9\u6570\u503c\u52a0\u4e0a\u589e\u91cf increment \u3002 HKEYS key \u83b7\u53d6\u6240\u6709\u54c8\u5e0c\u8868\u4e2d\u7684\u5b57\u6bb5 HLEN key \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u5b57\u6bb5\u7684\u6570\u91cf HMGET key field1 [field2] \u83b7\u53d6\u6240\u6709\u7ed9\u5b9a\u5b57\u6bb5\u7684\u503c HMSET key field1 value1 [field2 value2 ] \u540c\u65f6\u5c06\u591a\u4e2a field-value (\u57df-\u503c)\u5bf9\u8bbe\u7f6e\u5230\u54c8\u5e0c\u8868 key \u4e2d\u3002 HSET key field value \u5c06\u54c8\u5e0c\u8868 key \u4e2d\u7684\u5b57\u6bb5 field \u7684\u503c\u8bbe\u4e3a value \u3002 HSETNX key field value \u53ea\u6709\u5728\u5b57\u6bb5 field \u4e0d\u5b58\u5728\u65f6\uff0c\u8bbe\u7f6e\u54c8\u5e0c\u8868\u5b57\u6bb5\u7684\u503c\u3002 HVALS key \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u6240\u6709\u503c HSCAN key cursor [MATCH pattern] [COUNT count] \u8fed\u4ee3\u54c8\u5e0c\u8868\u4e2d\u7684\u952e\u503c\u5bf9\u3002 2.4 redis \u5217\u8868\u547d\u4ee4 \u00b6 Redis \u5217\u8868\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 BLPOP key1 [key2 ] timeout \u79fb\u51fa\u5e76\u83b7\u53d6\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c \u5982\u679c\u5217\u8868\u6ca1\u6709\u5143\u7d20\u4f1a\u963b\u585e\u5217\u8868\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u6216\u53d1\u73b0\u53ef\u5f39\u51fa\u5143\u7d20\u4e3a\u6b62\u3002 BRPOP key1 [key2 ] timeout \u79fb\u51fa\u5e76\u83b7\u53d6\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c \u5982\u679c\u5217\u8868\u6ca1\u6709\u5143\u7d20\u4f1a\u963b\u585e\u5217\u8868\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u6216\u53d1\u73b0\u53ef\u5f39\u51fa\u5143\u7d20\u4e3a\u6b62\u3002 BRPOPLPUSH source destination timeout \u4ece\u5217\u8868\u4e2d\u5f39\u51fa\u4e00\u4e2a\u503c\uff0c\u5c06\u5f39\u51fa\u7684\u5143\u7d20\u63d2\u5165\u5230\u53e6\u5916\u4e00\u4e2a\u5217\u8868\u4e2d\u5e76\u8fd4\u56de\u5b83\uff1b \u5982\u679c\u5217\u8868\u6ca1\u6709\u5143\u7d20\u4f1a\u963b\u585e\u5217\u8868\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u6216\u53d1\u73b0\u53ef\u5f39\u51fa\u5143\u7d20\u4e3a\u6b62\u3002 LINDEX key index \u901a\u8fc7\u7d22\u5f15\u83b7\u53d6\u5217\u8868\u4e2d\u7684\u5143\u7d20 LINSERT key BEFORE AFTER pivot value LLEN key \u83b7\u53d6\u5217\u8868\u957f\u5ea6 LPOP key \u79fb\u51fa\u5e76\u83b7\u53d6\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 LPUSH key value1 [value2] \u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u503c\u63d2\u5165\u5230\u5217\u8868\u5934\u90e8 LPUSHX key value \u5c06\u4e00\u4e2a\u503c\u63d2\u5165\u5230\u5df2\u5b58\u5728\u7684\u5217\u8868\u5934\u90e8 LRANGE key start stop \u83b7\u53d6\u5217\u8868\u6307\u5b9a\u8303\u56f4\u5185\u7684\u5143\u7d20 LREM key count value \u79fb\u9664\u5217\u8868\u5143\u7d20 LSET key index value \u901a\u8fc7\u7d22\u5f15\u8bbe\u7f6e\u5217\u8868\u5143\u7d20\u7684\u503c LTRIM key start stop \u5bf9\u4e00\u4e2a\u5217\u8868\u8fdb\u884c\u4fee\u526a(trim)\uff0c\u5c31\u662f\u8bf4\uff0c\u8ba9\u5217\u8868\u53ea\u4fdd\u7559\u6307\u5b9a\u533a\u95f4\u5185\u7684\u5143\u7d20\uff0c\u4e0d\u5728\u6307\u5b9a\u533a\u95f4\u4e4b\u5185\u7684\u5143\u7d20\u90fd\u5c06\u88ab\u5220\u9664\u3002 RPOP key \u79fb\u9664\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u8fd4\u56de\u503c\u4e3a\u79fb\u9664\u7684\u5143\u7d20\u3002 RPOPLPUSH source destination \u79fb\u9664\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u5c06\u8be5\u5143\u7d20\u6dfb\u52a0\u5230\u53e6\u4e00\u4e2a\u5217\u8868\u5e76\u8fd4\u56de RPUSH key value1 [value2] \u5728\u5217\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a\u503c RPUSHX key value \u4e3a\u5df2\u5b58\u5728\u7684\u5217\u8868\u6dfb\u52a0\u503c 2.5 redis \u5217\u8868\u96c6\u5408\u547d\u4ee4 \u00b6 Redis \u96c6\u5408\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 SADD key member1 [member2] \u5411\u96c6\u5408\u6dfb\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458 SCARD key \u83b7\u53d6\u96c6\u5408\u7684\u6210\u5458\u6570 SDIFF key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u5dee\u96c6 SDIFFSTORE destination key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u5dee\u96c6\u5e76\u5b58\u50a8\u5728 destination \u4e2d SINTER key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u4ea4\u96c6 SINTERSTORE destination key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u4ea4\u96c6\u5e76\u5b58\u50a8\u5728 destination \u4e2d SISMEMBER key member \u5224\u65ad member \u5143\u7d20\u662f\u5426\u662f\u96c6\u5408 key \u7684\u6210\u5458 SMEMBERS key \u8fd4\u56de\u96c6\u5408\u4e2d\u7684\u6240\u6709\u6210\u5458 SMOVE source destination member \u5c06 member \u5143\u7d20\u4ece source \u96c6\u5408\u79fb\u52a8\u5230 destination \u96c6\u5408 SPOP key \u79fb\u9664\u5e76\u8fd4\u56de\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\u968f\u673a\u5143\u7d20 SRANDMEMBER key [count] \u8fd4\u56de\u96c6\u5408\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u968f\u673a\u6570 SREM key member1 [member2] \u79fb\u9664\u96c6\u5408\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458 SUNION key1 [key2] \u8fd4\u56de\u6240\u6709\u7ed9\u5b9a\u96c6\u5408\u7684\u5e76\u96c6 SUNIONSTORE destination key1 [key2] \u6240\u6709\u7ed9\u5b9a\u96c6\u5408\u7684\u5e76\u96c6\u5b58\u50a8\u5728 destination \u96c6\u5408\u4e2d SSCAN key cursor [MATCH pattern] [COUNT count] \u8fed\u4ee3\u96c6\u5408\u4e2d\u7684\u5143\u7d20 2.6 redis \u5217\u6709\u5e8f\u96c6\u5408\u547d\u4ee4 \u00b6 Redis \u6709\u5e8f\u96c6\u5408\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 ZADD key score1 member1 [score2 member2] \u5411\u6709\u5e8f\u96c6\u5408\u6dfb\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458\uff0c\u6216\u8005\u66f4\u65b0\u5df2\u5b58\u5728\u6210\u5458\u7684\u5206\u6570 ZCARD key \u83b7\u53d6\u6709\u5e8f\u96c6\u5408\u7684\u6210\u5458\u6570 ZCOUNT key min max \u8ba1\u7b97\u5728\u6709\u5e8f\u96c6\u5408\u4e2d\u6307\u5b9a\u533a\u95f4\u5206\u6570\u7684\u6210\u5458\u6570 ZINCRBY key increment member \u6709\u5e8f\u96c6\u5408\u4e2d\u5bf9\u6307\u5b9a\u6210\u5458\u7684\u5206\u6570\u52a0\u4e0a\u589e\u91cf increment ZINTERSTORE destination numkeys key [key ...] \u8ba1\u7b97\u7ed9\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6709\u5e8f\u96c6\u7684\u4ea4\u96c6\u5e76\u5c06\u7ed3\u679c\u96c6\u5b58\u50a8\u5728\u65b0\u7684\u6709\u5e8f\u96c6\u5408 key \u4e2d ZLEXCOUNT key min max \u5728\u6709\u5e8f\u96c6\u5408\u4e2d\u8ba1\u7b97\u6307\u5b9a\u5b57\u5178\u533a\u95f4\u5185\u6210\u5458\u6570\u91cf ZRANGE key start stop [WITHSCORES] \u901a\u8fc7\u7d22\u5f15\u533a\u95f4\u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u6210\u6307\u5b9a\u533a\u95f4\u5185\u7684\u6210\u5458 ZRANGEBYLEX key min max [LIMIT offset count] \u901a\u8fc7\u5b57\u5178\u533a\u95f4\u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u7684\u6210\u5458 ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT] \u901a\u8fc7\u5206\u6570\u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u6307\u5b9a\u533a\u95f4\u5185\u7684\u6210\u5458 ZRANK key member \u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u4e2d\u6307\u5b9a\u6210\u5458\u7684\u7d22\u5f15 ZREM key member [member ...] \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458 ZREMRANGEBYLEX key min max \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7ed9\u5b9a\u7684\u5b57\u5178\u533a\u95f4\u7684\u6240\u6709\u6210\u5458 ZREMRANGEBYRANK key start stop \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7ed9\u5b9a\u7684\u6392\u540d\u533a\u95f4\u7684\u6240\u6709\u6210\u5458 ZREMRANGEBYSCORE key min max \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7ed9\u5b9a\u7684\u5206\u6570\u533a\u95f4\u7684\u6240\u6709\u6210\u5458 ZREVRANGE key start stop [WITHSCORES] \u8fd4\u56de\u6709\u5e8f\u96c6\u4e2d\u6307\u5b9a\u533a\u95f4\u5185\u7684\u6210\u5458\uff0c\u901a\u8fc7\u7d22\u5f15\uff0c\u5206\u6570\u4ece\u9ad8\u5230\u5e95 ZREVRANGEBYSCORE key max min [WITHSCORES] \u8fd4\u56de\u6709\u5e8f\u96c6\u4e2d\u6307\u5b9a\u5206\u6570\u533a\u95f4\u5185\u7684\u6210\u5458\uff0c\u5206\u6570\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f ZREVRANK key member \u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u4e2d\u6307\u5b9a\u6210\u5458\u7684\u6392\u540d\uff0c\u6709\u5e8f\u96c6\u6210\u5458\u6309\u5206\u6570\u503c\u9012\u51cf(\u4ece\u5927\u5230\u5c0f)\u6392\u5e8f ZSCORE key member \u8fd4\u56de\u6709\u5e8f\u96c6\u4e2d\uff0c\u6210\u5458\u7684\u5206\u6570\u503c ZUNIONSTORE destination numkeys key [key ...] \u8ba1\u7b97\u7ed9\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6709\u5e8f\u96c6\u7684\u5e76\u96c6\uff0c\u5e76\u5b58\u50a8\u5728\u65b0\u7684 key \u4e2d ZSCAN key cursor [MATCH pattern] [COUNT count] \u8fed\u4ee3\u6709\u5e8f\u96c6\u5408\u4e2d\u7684\u5143\u7d20\uff08\u5305\u62ec\u5143\u7d20\u6210\u5458\u548c\u5143\u7d20\u5206\u503c\uff09 2.7 redis HyperLogLog\u547d\u4ee4 \u00b6 Redis HyperLogLog \u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 PFADD key element [element ...] \u6dfb\u52a0\u6307\u5b9a\u5143\u7d20\u5230 HyperLogLog \u4e2d\u3002 PFCOUNT key [key ...] \u8fd4\u56de\u7ed9\u5b9a HyperLogLog \u7684\u57fa\u6570\u4f30\u7b97\u503c\u3002 PFMERGE destkey sourcekey [sourcekey ...] \u5c06\u591a\u4e2a HyperLogLog \u5408\u5e76\u4e3a\u4e00\u4e2a HyperLogLog 2.8 redis \u53d1\u5e03\u8ba2\u9605\u547d\u4ee4 \u00b6 Redis \u53d1\u5e03\u8ba2\u9605\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 PSUBSCRIBE pattern [pattern ...] \u8ba2\u9605\u4e00\u4e2a\u6216\u591a\u4e2a\u7b26\u5408\u7ed9\u5b9a\u6a21\u5f0f\u7684\u9891\u9053\u3002 PUBSUB subcommand [argument [argument ...]] \u67e5\u770b\u8ba2\u9605\u4e0e\u53d1\u5e03\u7cfb\u7edf\u72b6\u6001\u3002 PUBLISH channel message \u5c06\u4fe1\u606f\u53d1\u9001\u5230\u6307\u5b9a\u7684\u9891\u9053\u3002 PUNSUBSCRIBE [pattern [pattern ...]] \u9000\u8ba2\u6240\u6709\u7ed9\u5b9a\u6a21\u5f0f\u7684\u9891\u9053\u3002 SUBSCRIBE channel [channel ...] \u8ba2\u9605\u7ed9\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u9891\u9053\u7684\u4fe1\u606f\u3002 UNSUBSCRIBE [channel [channel ...]] \u6307\u9000\u8ba2\u7ed9\u5b9a\u7684\u9891\u9053\u3002 2.9 redis \u4e8b\u52a1\u547d\u4ee4 \u00b6 Redis \u4e8b\u52a1\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 DISCARD \u53d6\u6d88\u4e8b\u52a1\uff0c\u653e\u5f03\u6267\u884c\u4e8b\u52a1\u5757\u5185\u7684\u6240\u6709\u547d\u4ee4\u3002 EXEC \u6267\u884c\u6240\u6709\u4e8b\u52a1\u5757\u5185\u7684\u547d\u4ee4\u3002 MULTI \u6807\u8bb0\u4e00\u4e2a\u4e8b\u52a1\u5757\u7684\u5f00\u59cb\u3002 UNWATCH \u53d6\u6d88 WATCH \u547d\u4ee4\u5bf9\u6240\u6709 key \u7684\u76d1\u89c6\u3002 WATCH key [key ...] \u76d1\u89c6\u4e00\u4e2a(\u6216\u591a\u4e2a) key \uff0c\u5982\u679c\u5728\u4e8b\u52a1\u6267\u884c\u4e4b\u524d\u8fd9\u4e2a(\u6216\u8fd9\u4e9b) key \u88ab\u5176\u4ed6\u547d\u4ee4\u6240\u6539\u52a8\uff0c\u90a3\u4e48\u4e8b\u52a1\u5c06\u88ab\u6253\u65ad 2.10 redis \u811a\u672c\u547d\u4ee4 \u00b6 Redis \u811a\u672c\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 EVAL script numkeys key [key ...] arg [arg ...] \u6267\u884c Lua \u811a\u672c\u3002 EVALSHA sha1 numkeys key [key ...] arg [arg ...] \u6267\u884c Lua \u811a\u672c\u3002 SCRIPT EXISTS script [script ...] \u67e5\u770b\u6307\u5b9a\u7684\u811a\u672c\u662f\u5426\u5df2\u7ecf\u88ab\u4fdd\u5b58\u5728\u7f13\u5b58\u5f53\u4e2d\u3002 SCRIPT FLUSH \u4ece\u811a\u672c\u7f13\u5b58\u4e2d\u79fb\u9664\u6240\u6709\u811a\u672c\u3002 SCRIPT KILL \u6740\u6b7b\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684 Lua \u811a\u672c\u3002 SCRIPT LOAD script \u5c06\u811a\u672c script \u6dfb\u52a0\u5230\u811a\u672c\u7f13\u5b58\u4e2d\uff0c\u4f46\u5e76\u4e0d\u7acb\u5373\u6267\u884c\u8fd9\u4e2a\u811a\u672c\u3002 2.11 redis \u94fe\u63a5\u547d\u4ee4 \u00b6 Redis \u8fde\u63a5\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 AUTH password \u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u6b63\u786e ECHO message \u6253\u5370\u5b57\u7b26\u4e32 PING \u67e5\u770b\u670d\u52a1\u662f\u5426\u8fd0\u884c QUIT \u5173\u95ed\u5f53\u524d\u8fde\u63a5 SELECT index \u5207\u6362\u5230\u6307\u5b9a\u7684\u6570\u636e\u5e93 2.12 redis \u670d\u52a1\u5668\u547d\u4ee4 \u00b6 Redis \u670d\u52a1\u5668\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 BGREWRITEAOF \u5f02\u6b65\u6267\u884c\u4e00\u4e2a AOF\uff08AppendOnly File\uff09 \u6587\u4ef6\u91cd\u5199\u64cd\u4f5c BGSAVE \u5728\u540e\u53f0\u5f02\u6b65\u4fdd\u5b58\u5f53\u524d\u6570\u636e\u5e93\u7684\u6570\u636e\u5230\u78c1\u76d8 CLIENT KILL [ip:port] [ID client-id] \u5173\u95ed\u5ba2\u6237\u7aef\u8fde\u63a5 CLIENT LIST \u83b7\u53d6\u8fde\u63a5\u5230\u670d\u52a1\u5668\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5217\u8868 CLIENT GETNAME \u83b7\u53d6\u8fde\u63a5\u7684\u540d\u79f0 CLIENT PAUSE timeout \u5728\u6307\u5b9a\u65f6\u95f4\u5185\u7ec8\u6b62\u8fd0\u884c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u547d\u4ee4 CLIENT SETNAME connection-name \u8bbe\u7f6e\u5f53\u524d\u8fde\u63a5\u7684\u540d\u79f0 CLUSTER SLOTS \u83b7\u53d6\u96c6\u7fa4\u8282\u70b9\u7684\u6620\u5c04\u6570\u7ec4 COMMAND \u83b7\u53d6 Redis \u547d\u4ee4\u8be6\u60c5\u6570\u7ec4 COMMAND COUNT \u83b7\u53d6 Redis \u547d\u4ee4\u603b\u6570 COMMAND GETKEYS \u83b7\u53d6\u7ed9\u5b9a\u547d\u4ee4\u7684\u6240\u6709\u952e TIME \u8fd4\u56de\u5f53\u524d\u670d\u52a1\u5668\u65f6\u95f4 COMMAND INFO command-name [command-name ...] \u83b7\u53d6\u6307\u5b9a Redis \u547d\u4ee4\u63cf\u8ff0\u7684\u6570\u7ec4 CONFIG GET parameter \u83b7\u53d6\u6307\u5b9a\u914d\u7f6e\u53c2\u6570\u7684\u503c CONFIG REWRITE \u5bf9\u542f\u52a8 Redis \u670d\u52a1\u5668\u65f6\u6240\u6307\u5b9a\u7684 redis.conf \u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6539\u5199 CONFIG SET parameter value \u4fee\u6539 redis \u914d\u7f6e\u53c2\u6570\uff0c\u65e0\u9700\u91cd\u542f CONFIG RESETSTAT \u91cd\u7f6e INFO \u547d\u4ee4\u4e2d\u7684\u67d0\u4e9b\u7edf\u8ba1\u6570\u636e DBSIZE \u8fd4\u56de\u5f53\u524d\u6570\u636e\u5e93\u7684 key \u7684\u6570\u91cf DEBUG OBJECT key \u83b7\u53d6 key \u7684\u8c03\u8bd5\u4fe1\u606f DEBUG SEGFAULT \u8ba9 Redis \u670d\u52a1\u5d29\u6e83 FLUSHALL \u5220\u9664\u6240\u6709\u6570\u636e\u5e93\u7684\u6240\u6709key FLUSHDB \u5220\u9664\u5f53\u524d\u6570\u636e\u5e93\u7684\u6240\u6709key INFO [section] \u83b7\u53d6 Redis \u670d\u52a1\u5668\u7684\u5404\u79cd\u4fe1\u606f\u548c\u7edf\u8ba1\u6570\u503c LASTSAVE \u8fd4\u56de\u6700\u8fd1\u4e00\u6b21 Redis \u6210\u529f\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u78c1\u76d8\u4e0a\u7684\u65f6\u95f4\uff0c\u4ee5 UNIX \u65f6\u95f4\u6233\u683c\u5f0f\u8868\u793a MONITOR \u5b9e\u65f6\u6253\u5370\u51fa Redis \u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u547d\u4ee4\uff0c\u8c03\u8bd5\u7528 ROLE \u8fd4\u56de\u4e3b\u4ece\u5b9e\u4f8b\u6240\u5c5e\u7684\u89d2\u8272 SAVE \u540c\u6b65\u4fdd\u5b58\u6570\u636e\u5230\u786c\u76d8 SHUTDOWN [NOSAVE] [SAVE] \u5f02\u6b65\u4fdd\u5b58\u6570\u636e\u5230\u786c\u76d8\uff0c\u5e76\u5173\u95ed\u670d\u52a1\u5668 SLAVEOF host port \u5c06\u5f53\u524d\u670d\u52a1\u5668\u8f6c\u53d8\u4e3a\u6307\u5b9a\u670d\u52a1\u5668\u7684\u4ece\u5c5e\u670d\u52a1\u5668(slave server) SLOWLOG subcommand [argument] \u7ba1\u7406 redis \u7684\u6162\u65e5\u5fd7 SYNC \u7528\u4e8e\u590d\u5236\u529f\u80fd(replication)\u7684\u5185\u90e8\u547d\u4ee4 3. \u8be6\u7ec6 \u00b6 3.1 \u5b89\u88c5redis\u5e93 \u00b6 pip install redis 3.2 Python\u64cd\u4f5cRedis \u00b6 \u8fde\u63a5 redis-py\u63d0\u4f9b\u4e24\u4e2a\u7c7bRedis\u548cStrictRedis\u7528\u4e8e\u5b9e\u73b0Redis\u7684\u547d\u4ee4\uff0cStrictRedis\u7528\u4e8e\u5b9e\u73b0\u5927\u90e8\u5206\u5b98\u65b9\u7684\u547d\u4ee4\uff0c\u5e76\u4f7f\u7528\u5b98\u65b9\u7684\u8bed\u6cd5\u548c\u547d\u4ee4\uff0cRedis\u662fStrictRedis\u7684\u5b50\u7c7b\uff0c\u7528\u4e8e\u5411\u540e\u517c\u5bb9\u65e7\u7248\u672c\u7684redis-py\u3002 import redis r = redis.Redis(host='127.0.0.1', port=6379) r.set('name', 'Jack') print (r.get('name')) - \u8fde\u63a5\u6c60 redis-py\u4f7f\u7528connection pool\u6765\u7ba1\u7406\u5bf9\u4e00\u4e2aredis server\u7684\u6240\u6709\u8fde\u63a5\uff0c\u907f\u514d\u6bcf\u6b21\u5efa\u7acb\u3001\u91ca\u653e\u8fde\u63a5\u7684\u5f00\u9500\u3002\u9ed8\u8ba4\uff0c\u6bcf\u4e2aRedis\u5b9e\u4f8b\u90fd\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u81ea\u5df1\u7684\u8fde\u63a5\u6c60\u3002\u53ef\u4ee5\u76f4\u63a5\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\u6c60\uff0c\u7136\u540e\u4f5c\u4e3a\u53c2\u6570Redis\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u591a\u4e2aRedis\u5b9e\u4f8b\u5171\u4eab\u4e00\u4e2a\u8fde\u63a5\u6c60\u3002 import redis pool = redis.ConnectionPool(host='127.0.0.1', port=6379) r = redis.Redis(connection_pool=pool) r.set('name', 'Jack') print r.get('name') 3.2 string \u00b6 3.2.1 set \u00b6 set setnx setnx(name, value) setex setex(name, value, time) psetex psetex(name, time_ms, value) set(name, value, ex=None, px=None, nx=False, xx=False) help set \u5728Redis\u4e2d\u8bbe\u7f6e\u503c\uff0c\u9ed8\u8ba4\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\uff0c\u5b58\u5728\u5219\u4fee\u6539 \u53c2\u6570\uff1a - ex\uff0c\u8fc7\u671f\u65f6\u95f4\uff08\u79d2\uff09 - px\uff0c\u8fc7\u671f\u65f6\u95f4\uff08\u6beb\u79d2\uff09 - nx\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3aTrue\uff0c\u5219\u53ea\u6709name\u4e0d\u5b58\u5728\u65f6\uff0c\u5f53\u524dset\u64cd\u4f5c\u624d\u6267\u884c - xx\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3aTrue\uff0c\u5219\u53ea\u6709name\u5b58\u5728\u65f6\uff0c\u5f53\u524dset\u64cd\u4f5c\u624d\u6267\u884c setex(name, value, time) #\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff08\u79d2\uff09 psetex(name, time_ms, value) #\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff08\u8c6a\u79d2\uff09 \u64cd\u4f5c\u8fc7\u7a0b In [5]: r.set('k1','v1') Out[5]: True In [6]: r.get('key1') In [7]: r.get('k1') Out[7]: b'v1' 3.2.3 mset \u00b6 mset(*args, **kwargs) #\u6279\u91cf\u8bbe\u7f6e\u503c r.mset(name1='zhangsan', name2='lisi') #\u6216 r.mget({\"name1\":'zhangsan', \"name2\":'lisi'}) \u64cd\u4f5c\u8fc7\u7a0b In [14]: r.mset(name1='zhangsan', name2='lisi') Out[14]: True In [15]: r.mget({\"name1\":'zhangsan', \"name2\":'lisi'}) Out[15]: [b'zhangsan', b'lisi'] 3.2.4 mget \u00b6 mget(keys, *args) #\u6279\u91cf\u83b7\u53d6 print(r.mget(\"name1\",\"name2\")) #\u6216 li=[\"name1\",\"name2\"] print(r.mget(li)) \u64cd\u4f5c\u8fc7\u7a0b In [16]: r.mget(\"name1\",\"name2\") Out[16]: [b'zhangsan', b'lisi'] In [17]: name=[\"name1\",\"name2\"] In [18]: r.mget(name) Out[18]: [b'zhangsan', b'lisi'] 3.2.5 getset \u00b6 getset(name, value) #\u8bbe\u7f6e\u65b0\u503c\uff0c\u6253\u5370\u539f\u503c print(r.getset(\"name1\",\"wangwu\")) #\u8f93\u51fa:zhangsan print(r.get(\"name1\")) #\u8f93\u51fa:wangwu \u64cd\u4f5c\u8fc7\u7a0b In [26]: r.get(\"name1\") Out[26]: b'zhangsan' In [27]: r.getset(\"name1\",\"wangwu\") Out[27]: b'zhangsan' In [28]: r.get(\"name1\") Out[28]: b'wangwu' 3.2.6 getrange \u00b6 getrange(key, start, end) #\u6839\u636e\u5b57\u8282\u83b7\u53d6\u5b50\u5e8f\u5217 r.set(\"name\",\"zhangsan\") print(r.getrange(\"name\",0,4))#\u8f93\u51fa:zhang \u64cd\u4f5c\u8fc7\u7a0b In [29]: r.set(\"name\",\"zhangsan\") Out[29]: True In [30]: r.getrange('name',0,4) Out[30]: b'zhang' 3.2.7 setrange \u00b6 setrange(name, offset, value) #\u4fee\u6539\u5b57\u7b26\u4e32\u5185\u5bb9\uff0c\u4ece\u6307\u5b9a\u5b57\u7b26\u4e32\u7d22\u5f15\u5f00\u59cb\u5411\u540e\u66ff\u6362\uff0c\u5982\u679c\u65b0\u503c\u592a\u957f\u65f6\uff0c\u5219\u5411\u540e\u6dfb\u52a0 r.set(\"name\",\"zhangsan\") r.setrange(\"name\",1,\"ww\") print(r.get(\"name\")) #\u8f93\u51fa:zwwngsan r.set(\"name\",\"zhangsan\") r.setrange(\"name\",6,\"wwww\") print(r.get(\"name\")) #\u8f93\u51fa:zwwwwsan r.set(\"name\",\"zhangsan\") r.setrange(\"name\",6,\"wwwwwwwwwww\") print(r.get(\"name\")) #\u8f93\u51fa:zwwwwwwwwwww \u64cd\u4f5c\u8fc7\u7a0b In [31]: r.set(\"name\",\"zhangsan\") Out[31]: True In [32]: r.setrange(\"name\",1,\"ww\") Out[32]: 8 In [33]: r.get(\"name\") Out[33]: b'zwwngsan' In [34]: r.set(\"name\",\"zhangsan\") Out[34]: True In [35]: r.setrange(\"name\",1,\"wwww\") Out[35]: 8 In [36]: r.get(\"name\") Out[36]: b'zwwwwsan' In [37]: r.set(\"name\",\"zhangsan\") Out[37]: True In [38]: r.setrange(\"name\",1,\"wwwwwwwwwww\") Out[38]: 12 In [39]: r.get(\"name\") Out[39]: b'zwwwwwwwwwww' 3.2.8 setbit \u00b6 setbit(name, offset, value) #\u5bf9\u4e8c\u8fdb\u5236\u8868\u793a\u4f4d\u8fdb\u884c\u64cd\u4f5c ''' name:redis\u7684name offset\uff0c\u4f4d\u7684\u7d22\u5f15\uff08\u5c06\u503c\u5bf9\u5e94\u7684ASCII\u7801\u53d8\u6362\u6210\u4e8c\u8fdb\u5236\u540e\u518d\u8fdb\u884c\u7d22\u5f15\uff09 value\uff0c\u503c\u53ea\u80fd\u662f 1 \u6216 0 ''' str=\"345\" r.set(\"name\",str) for i in str: print(i,ord(i),bin(ord(i)))#\u8f93\u51fa \u503c\u3001ASCII\u7801\u4e2d\u5bf9\u5e94\u7684\u503c\u3001\u5bf9\u5e94\u503c\u8f6c\u6362\u7684\u4e8c\u8fdb\u5236 ''' \u8f93\u51fa: 51 0b110011 52 0b110100 53 0b110101''' r.setbit(\"name\",6,0)#\u628a\u7b2c7\u4f4d\u6539\u4e3a0\uff0c\u4e5f\u5c31\u662f3\u5bf9\u5e94\u7684\u53d8\u6210\u4e860b110001 print(r.get(\"name\"))#\u8f93\u51fa\uff1a145 \u64cd\u4f5c\u8fc7\u7a0b In [45]: str=\"345\" In [46]: r.set(\"name\",str) Out[46]: True In [47]: r.setbit(\"name\",6,0) Out[47]: 1 In [48]: r.get(\"name\") Out[48]: b'145' 3.2.9 getbit \u00b6 getbit(name, offset) #\u83b7\u53d6name\u5bf9\u5e94\u503c\u7684\u4e8c\u8fdb\u5236\u4e2d\u67d0\u4f4d\u7684\u503c(0\u62161) r.set(\"name\",\"3\") # \u5bf9\u5e94\u7684\u4e8c\u8fdb\u52360b110011 print(r.getbit(\"name\",5)) #\u8f93\u51fa:0 print(r.getbit(\"name\",6)) #\u8f93\u51fa:1 \u64cd\u4f5c\u8fc7\u7a0b In [49]: r.set(\"name\",\"3\") Out[49]: True In [50]: r.get('name') Out[50]: b'3' In [51]: r.getbit(\"name\",5) Out[51]: 0 In [52]: r.getbit(\"name\",6) Out[52]: 1 3.2.10 bitcount \u00b6 bitcount(key, start=None, end=None) #\u83b7\u53d6\u5bf9\u5e94\u4e8c\u8fdb\u5236\u4e2d1\u7684\u4e2a\u6570 r.set(\"name\",\"345\")#0b110011 0b110100 0b110101 print(r.bitcount(\"name\",start=0,end=1)) #\u8f93\u51fa:7 ''' key:Redis\u7684name start:\u5b57\u8282\u8d77\u59cb\u4f4d\u7f6e end:\u5b57\u8282\u7ed3\u675f\u4f4d\u7f6e''' \u64cd\u4f5c\u8fc7\u7a0b In [56]: r.set(\"name\",\"345\") Out[56]: True In [57]: ...: r.bitcount(\"name\",start=0,end=1) Out[57]: 7 3.2.11 strlen \u00b6 strlen(name) #\u8fd4\u56dename\u5bf9\u5e94\u503c\u7684\u5b57\u8282\u957f\u5ea6\uff08\u4e00\u4e2a\u6c49\u5b573\u4e2a\u5b57\u8282\uff09 r.set(\"name\",\"zhangsan\") print(r.strlen(\"name\")) #\u8f93\u51fa:8 \u64cd\u4f5c\u8fc7\u7a0b In [58]: r.set(\"name\",\"zhangsan\") Out[58]: True In [59]: r.strlen(\"name\") Out[59]: 8 In [60]: r.set(\"name\",\"\u5f20\u4e09\") Out[60]: True In [61]: r.strlen(\"name\") Out[61]: 6 3.2.12 incr \u00b6 incr(self, name, amount=1) #\u81ea\u589emount\u5bf9\u5e94\u7684\u503c\uff0c\u5f53mount\u4e0d\u5b58\u5728\u65f6\uff0c\u5219\u521b\u5efamount\uff1damount\uff0c\u5426\u5219\uff0c\u5219\u81ea\u589e,amount\u4e3a\u81ea\u589e\u6570(\u6574\u6570) print(r.incr(\"mount\",amount=2))#\u8f93\u51fa:2 print(r.incr(\"mount\"))#\u8f93\u51fa:3 print(r.incr(\"mount\",amount=3))#\u8f93\u51fa:6 print(r.incr(\"mount\",amount=6))#\u8f93\u51fa:12 print(r.get(\"mount\")) #\u8f93\u51fa:12 \u64cd\u4f5c\u8fc7\u7a0b In [66]: r.incr(\"num\",amount=2) Out[66]: 2 in [67]: r.incr(\"num\",amount=10) Out[67]: 12 In [68]: r.incr(\"num\") Out[68]: 13 In [69]: r.get('num') Out[69]: b'13' In [70]: r.incr(\"num\",amount=20) Out[70]: 33 In [71]: r.incr(\"num\",amount=30) Out[71]: 63 In [72]: r.get('num') Out[72]: b'63' 3.2.13 incrbyfloat \u00b6 incrbyfloat(self, name, amount=1.0) \u7c7b\u4f3c incr() \u81ea\u589e,amount\u4e3a\u81ea\u589e\u6570(\u6d6e\u70b9\u6570) 3.2.14 decr \u00b6 decr(self, name, amount=1) \u81ea\u51cfname\u5bf9\u5e94\u7684\u503c,\u5f53name\u4e0d\u5b58\u5728\u65f6,\u5219\u521b\u5efaname\uff1damount\uff0c\u5426\u5219\uff0c\u5219\u81ea\u51cf\uff0camount\u4e3a\u81ea\u589e\u6570(\u6574\u6570) 3.2.15 append \u00b6 append(name, value) #\u5728name\u5bf9\u5e94\u7684\u503c\u540e\u9762\u8ffd\u52a0\u5185\u5bb9 r.set(\"name\",\"zhangsan\") print(r.get(\"name\")) #\u8f93\u51fa:'zhangsan r.append(\"name\",\"lisi\") print(r.get(\"name\")) #\u8f93\u51fa:zhangsanlisi \u64cd\u4f5c\u8fc7\u7a0b In [73]: r.set(\"name\",\"zhangsan\") Out[73]: True In [74]: r.get('name') Out[74]: b'zhangsan' In [75]: r.append('name','lisi') Out[75]: 12 In [76]: r.get('name') Out[76]: b'zhangsanlisi' 3.3 Hash \u00b6 redis\u4e2d\u7684Hash \u5728\u5185\u5b58\u4e2d\u7c7b\u4f3c\u4e8e\u4e00\u4e2aname\u5bf9\u5e94\u4e00\u4e2adic\u6765\u5b58\u50a8 3.3.1 hset \u00b6 hset(name, key, value) name\u5bf9\u5e94\u7684hash\u4e2d\u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9\uff08\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\uff0c\u5426\u5219\uff0c\u4fee\u6539\uff09 r.hset(\"hash_name\",\"key1\",\"values1\") \u64cd\u4f5c\u8fc7\u7a0b In [12]: r.hset('hash_name','key1','values1') Out[12]: 1 127.0.0.1:6379> TYPE hash_name hash 127.0.0.1:6379> HGETALL hash_name 1) \"key1\" 2) \"values1\" 127.0.0.1:6379> HGET hash_name key1 \"values1\" 3.3.2 hget \u00b6 hget(name,key) \u53d6\u5355\u4e2akey\u503c r.hset(\"hash_name\",\"key1\",\"values1\") #\u5728hash_name\u5bf9\u5e94\u7684hash\u4e2d\u6839\u636ekey\u83b7\u53d6value print(r.hget(\"hash_name\",\"key1\"))#\u8f93\u51fa:aa \u64cd\u4f5c\u8fc7\u7a0b In [13]: r.hset(\"hash_name\",\"key1\",\"values1\") Out[13]: 0 In [14]: r.hget(\"hash_name\",\"key1\") Out[14]: b'values1' 3.3.3 hgetall \u00b6 hgetall(name) \u83b7\u53d6name\u5bf9\u5e94hash\u7684\u6240\u6709\u952e\u503c In [22]: r.hset(\"hash_name\",\"key1\",\"values1\") Out[22]: 1 In [23]: r.hset(\"hash_name\",\"key2\",\"values2\") Out[23]: 1 In [24]: r.hset(\"hash_name\",\"key3\",\"values3\") Out[24]: 1 In [25]: r.hget('hash_name','key1') Out[25]: b'values1' In [26]: r.hget('hash_name','key') In [27]: r.hget('hash_name','key2') Out[27]: b'values2' In [28]: r.hget('hash_name','key3') Out[28]: b'values3' In [29]: r.hgetall('hash_name') Out[29]: {b'key1': b'values1', b'key2': b'values2', b'key3': b'values3'} 3.3.4 hmset \u00b6 hmset(name, mapping) \u5728name\u5bf9\u5e94\u7684hash\u4e2d\u6279\u91cf\u8bbe\u7f6e\u952e\u503c\u5bf9,mapping:\u5b57\u5178 In [33]: dic={\"name\":\"summer\",\"job\":\"IT\"} In [34]: r.hmset('dic_name',dic) Out[34]: True 127.0.0.1:6379> HGETALL dic_name 1) \"name\" 2) \"summer\" 3) \"job\" 4) \"IT\" 3.3.5 hmget/hmgetall \u00b6 hmget(name, keys, *args) \u5728name\u5bf9\u5e94\u7684hash\u4e2d\u83b7\u53d6\u591a\u4e2akey\u7684\u503c In [36]: r.hmget('dic_name','name') Out[36]: [b'summer'] In [37]: r.hmget('dic_name','job') Out[37]: [b'IT'] 3.3.6 hlen/hkeys/hvals \u00b6 hlen(name)\u3001hkeys(name)\u3001hvals(name) dic={\"name\":\"summer\",\"job\":\"IT\",'age':30} r.hmset(\"dic_name\",dic) #hlen(name) \u83b7\u53d6hash\u4e2d\u952e\u503c\u5bf9\u7684\u4e2a\u6570 print(r.hlen(\"dic_name\")) #hkeys(name) \u83b7\u53d6hash\u4e2d\u6240\u6709\u7684key\u7684\u503c print(r.hkeys(\"dic_name\")) #hvals(name) \u83b7\u53d6hash\u4e2d\u6240\u6709\u7684value\u7684\u503c print(r.hvals(\"dic_name\")) \u64cd\u4f5c\u8fc7\u7a0b In [40]: dic={\"name\":\"summer\",\"job\":\"IT\",'age':30} In [41]: r.hmset('dic_name',dic) Out[41]: True In [42]: r.hlen('dic_name') Out[42]: 3 In [43]: r.hkeys('dic_name') Out[43]: [b'name', b'job', b'age'] In [44]: r.hvals('dic_name') Out[44]: [b'summer', b'IT', b'30'] 3.3.7 hexists \u00b6 hexists(name, key) \u68c0\u67e5name\u5bf9\u5e94\u7684hash\u662f\u5426\u5b58\u5728\u5f53\u524d\u4f20\u5165\u7684key In [45]: r.hexists(\"dic_name\",\"a1\") Out[45]: False In [46]: r.hexists(\"dic_name\",\"name\") Out[46]: True 3.3.8 hdel \u00b6 hdel(name,*keys) \u5220\u9664\u6307\u5b9aname\u5bf9\u5e94\u7684key\u6240\u5728\u7684\u952e\u503c\u5bf9 In [46]: r.hexists(\"dic_name\",\"name\") Out[46]: True In [47]: r.hkeys('dic_name') Out[47]: [b'name', b'job', b'age'] In [48]: r.hvals('dic_name') Out[48]: [b'summer', b'IT', b'30'] In [49]: r.hdel('dic_name','job') Out[49]: 1 In [50]: r.hkeys('dic_name') Out[50]: [b'name', b'age'] 127.0.0.1:6379> HGETALL dic_name 1) \"name\" 2) \"summer\" 3) \"age\" 4) \"30\" 3.3.9 hincrby \u00b6 hincrby(name, key, amount=1) \u81ea\u589ehash\u4e2dkey\u5bf9\u5e94\u7684\u503c\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efakey=amount(amount\u4e3a\u6574\u6570) In [52]: r.hincrby(\"num\",\"data\",amount=2) Out[52]: 2 127.0.0.1:6379> keys * 1) \"num\" 2) \"hash_name\" 3) \"dic_name\" 127.0.0.1:6379> type num hash 127.0.0.1:6379> HGETALL num 1) \"data\" 2) \"2\" 3.3.10 hincrbyfloat \u00b6 hincrbyfloat(name, key, amount=1.0) \u81ea\u589ehash\u4e2dkey\u5bf9\u5e94\u7684\u503c\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efakey=amount(amount\u4e3a\u6d6e\u70b9\u6570) In [54]: r.hincrby(\"floatnum\",\"float1\",amount=2) Out[54]: 2 127.0.0.1:6379> keys * 1) \"floatnum\" 2) \"num\" 3) \"hash_name\" 4) \"dic_name\" 127.0.0.1:6379> type floatnum hash 127.0.0.1:6379> HGETALL floatnum 1) \"float1\" 2) \"2\" 127.0.0.1:6379> HGET floatnum float1 \"2\" 3.3.11 hscan \u00b6 hscan(name, cursor=0, match=None, count=None) 3.3.12 hscan_iter \u00b6 hscan_iter(name, match=None, count=None) 3.4 List \u00b6 redis\u4e2d\u7684List\u5728\u5728\u5185\u5b58\u4e2d\u6309\u7167\u4e00\u4e2aname\u5bf9\u5e94\u4e00\u4e2aList\u6765\u5b58\u50a8 3.4.1 lpush \u00b6 lpush(name,values) \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u6bcf\u4e2a\u65b0\u7684\u5143\u7d20\u90fd\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u5de6\u8fb9 # \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u6bcf\u4e2a\u65b0\u7684\u5143\u7d20\u90fd\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u5de6\u8fb9 r.lpush('list',5) r.lpush('list',2,3,4) # \u4fdd\u5b58\u5728\u5217\u8868\u4e2d\u7684\u987a\u5e8f\u4e3a5\uff0c4\uff0c3\uff0c2 \u64cd\u4f5c\u8fc7\u7a0b In [58]: r.lpush('list',2) Out[58]: 1 In [59]: r.lpush('list',3,4,5) Out[59]: 4 127.0.0.1:6379> LRANGE list 0 6 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 3.4.2 rpush \u00b6 rpush(name,values) \u540clpush\uff0c\u4f46\u6bcf\u4e2a\u65b0\u7684\u5143\u7d20\u90fd\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u53f3\u8fb9 In [61]: r.rpush('rlist',2) Out[61]: 1 In [62]: r.rpush('rlist',3,4,5) Out[62]: 4 127.0.0.1:6379> keys * 1) \"rlist\" 2) \"list\" 127.0.0.1:6379> LRANGE rlist 0 6 1) \"2\" 2) \"3\" 3) \"4\" 4) \"5\" 3.4.3 lpushx \u00b6 lpushx(name,value) \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u53ea\u6709name\u5df2\u7ecf\u5b58\u5728\u65f6\uff0c\u503c\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u5de6\u8fb9 3.4.4 rpushx \u00b6 rpushx(name,value) \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u53ea\u6709name\u5df2\u7ecf\u5b58\u5728\u65f6\uff0c\u503c\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u53f3\u8fb9 3.4.5 llen \u00b6 llen(name) name\u5bf9\u5e94\u7684list\u5143\u7d20\u7684\u4e2a\u6570 In [63]: r.llen('rlist') Out[63]: 4 3.4.6 linsert \u00b6 linsert(name, where, refvalue, value)) # \u5728name\u5bf9\u5e94\u7684\u5217\u8868\u7684\u67d0\u4e00\u4e2a\u503c\u524d\u6216\u540e\u63d2\u5165\u4e00\u4e2a\u65b0\u503c r.linsert(\"rlist\",\"BEFORE\",\"2\",\"before\")#\u5728\u5217\u8868\u5185\u627e\u5230\u7b2c\u4e00\u4e2a\u5143\u7d202\uff0c\u5728\u5b83\u524d\u9762\u63d2\u5165SS '''\u53c2\u6570\uff1a name: redis\u7684name where: BEFORE\uff08\u524d\uff09\u6216AFTER\uff08\u540e\uff09 refvalue: \u5217\u8868\u5185\u7684\u503c value: \u8981\u63d2\u5165\u7684\u6570\u636e''' \u64cd\u4f5c \u63d2\u5165\u4e4b\u524d 127.0.0.1:6379> LRANGE rlist 0 6 1) \"2\" 2) \"3\" 3) \"4\" 4) \"5\" In [64]: r.linsert(\"rlist\",\"BEFORE\",\"2\",\"before\") Out[64]: 5 \u63d2\u5165\u4e4b\u540e 127.0.0.1:6379> LRANGE rlist 0 6 1) \"before\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"5\" 3.4.7 lset \u00b6 r.lset(name, index, value) #\u5bf9list\u4e2d\u7684\u67d0\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u91cd\u65b0\u8d4b\u503c r.lset(\"rlist\",0,\"bbb\") \u64cd\u4f5c\u8fc7\u7a0b \u4fee\u6539\u4e4b\u524d 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"before\" 2) \"2\" 3) \"3\" 4) \"4_before\" 5) \"4\" 6) \"4_after\" 7) \"4_before\" 8) \"5\" # \u4fee\u6539\u7b2c0\u4f4d\u662f0 In [68]: r.lset('rlist',0,0) Out[68]: True \u4fee\u6539\u4e4b\u540e 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4_before\" 5) \"4\" 6) \"4_after\" 7) \"4_before\" 8) \"5\" 3.4.8 lrem \u00b6 r.lrem(name, value, num) \u5220\u9664name\u5bf9\u5e94\u7684list\u4e2d\u7684\u6307\u5b9a\u503c r.lrem(\"rlist\",\"data\",num=0) ''' \u53c2\u6570\uff1a name: redis\u7684name value: \u8981\u5220\u9664\u7684\u503c num: num=0 \u5220\u9664\u5217\u8868\u4e2d\u6240\u6709\u7684\u6307\u5b9a\u503c\uff1b num=2 \u4ece\u524d\u5230\u540e\uff0c\u5220\u96642\u4e2a\uff1b num=-2 \u4ece\u540e\u5411\u524d\uff0c\u5220\u96642\u4e2a \u64cd\u4f5c\u8fc7\u7a0b \u5220\u9664\u4e4b\u524d 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4_before\" 5) \"4\" 6) \"4_after\" 7) \"4_before\" 8) \"5\" In [69]: r.lrem('rlist','4_before',3) Out[69]: 2 \u5220\u9664\u4e4b\u540e 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"4_after\" 6) \"5\" 3.4.9 lpop \u00b6 lpop(name) \u79fb\u9664\u5217\u8868\u7684\u5de6\u4fa7\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u8fd4\u56de\u503c\u5219\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20 \u64cd\u4f5c\u8fc7\u7a0b 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"4_after\" 6) \"5\" In [70]: r.lpop(\"rlist\") Out[70]: b'0' 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" 3.4.10 lindex \u00b6 lindex(name, index) \u6839\u636e\u7d22\u5f15\u83b7\u53d6\u5217\u8868\u5185\u5143\u7d20 \u64cd\u4f5c\u8fc7\u7a0b 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" In [72]: r.lindex('rlist','2') Out[72]: b'4' In [73]: r.lindex('rlist','3') Out[73]: b'4_after 3.4.11 lrange \u00b6 lrange(name, start, end) \u5206\u7247\u83b7\u53d6\u5143\u7d20 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" In [74]: r.lrange('rlist',0,3) Out[74]: [b'2', b'3', b'4', b'4_after'] In [75]: r.lrange('rlist',0,-1) Out[75]: [b'2', b'3', b'4', b'4_after', b'5'] 3.4.12 ltrim \u00b6 ltrim(name, start, end) \u79fb\u9664\u5217\u8868\u5185\u6ca1\u6709\u5728\u8be5\u7d22\u5f15\u4e4b\u5185\u7684\u503c 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" In [76]: r.ltrim('rlist',0,2) # \u4fdd\u7559\u7d22\u5f15 0 \u52302\u7684\u503c\uff0c\u5176\u4ed6\u90fd\u5220\u9664 Out[76]: True 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 3.4.13 rpoplpush \u00b6 rpoplpush(src, dst) \u4ece\u4e00\u4e2a\u5217\u8868\u53d6\u51fa\u6700\u53f3\u8fb9\u7684\u5143\u7d20\uff0c\u540c\u65f6\u5c06\u5176\u6dfb\u52a0\u81f3\u53e6\u4e00\u4e2a\u5217\u8868\u7684\u6700\u5de6\u8fb9 - src \u8981\u53d6\u6570\u636e\u7684\u5217\u8868 - dst \u8981\u6dfb\u52a0\u6570\u636e\u7684\u5217\u8868 3.4.14 brpoplpush \u00b6 brpoplpush(src, dst, timeout=0) \u540crpoplpush\uff0c\u591a\u4e86\u4e2atimeout, timeout\uff1a\u53d6\u6570\u636e\u7684\u5217\u8868\u6ca1\u5143\u7d20\u540e\u7684\u963b\u585e\u65f6\u95f4\uff0c0\u4e3a\u4e00\u76f4\u963b\u585e 3.4.15 blpop \u00b6 blpop(keys, timeout) \u5c06\u591a\u4e2a\u5217\u8868\u6392\u5217,\u6309\u7167\u4ece\u5de6\u5230\u53f3\u53bb\u79fb\u9664\u5404\u4e2a\u5217\u8868\u5185\u7684\u5143\u7d20 r.lpush(\"rlist1\",3,4,5) r.lpush(\"rlist2\",3,4,5) while True: print(r.blpop([\"rlist1\",\"rlist2\"],timeout=0)) print(r.lrange(\"rlist1\",0,-1),r.lrange(\"rlist2\",0,-1)) '''keys: redis\u7684name\u7684\u96c6\u5408 timeout: \u8d85\u65f6\u65f6\u95f4\uff0c\u83b7\u53d6\u5b8c\u6240\u6709\u5217\u8868\u7684\u5143\u7d20\u4e4b\u540e\uff0c\u963b\u585e\u7b49\u5f85\u5217\u8868\u5185\u6709\u6570\u636e\u7684\u65f6\u95f4\uff08\u79d2\uff09, 0 \u8868\u793a\u6c38\u8fdc\u963b\u585e''' \u64cd\u4f5c\u8fc7\u7a0b In [86]: r.lpush(\"rlist2\",3,4,5) Out[86]: 3 In [87]: r.lpush(\"rlist1\",3,4,5) Out[87]: 3 127.0.0.1:6379> LRANGE rlist1 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 127.0.0.1:6379> LRANGE rlist2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" In [90]: r.blpop([\"rlist1\",\"rlist2\"],timeout=0) Out[90]: (b'rlist1', b'5') 127.0.0.1:6379> LRANGE rlist1 0 -1 1) \"4\" 2) \"3\" 127.0.0.1:6379> LRANGE rlist2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 3.4.16 brpop \u00b6 r.brpop(keys, timeout) \u540cblpop\uff0c\u5c06\u591a\u4e2a\u5217\u8868\u6392\u5217,\u6309\u7167\u4ece\u53f3\u50cf\u5de6\u53bb\u79fb\u9664\u5404\u4e2a\u5217\u8868\u5185\u7684\u5143\u7d20 \u64cd\u4f5c\u8fc7\u7a0b 127.0.0.1:6379> flushall OK In [5]: r.lpush(\"list1\",1,2,3,4,5) Out[5]: 5 In [6]: r.lpush(\"list2\",1,2,3,4,5) Out[6]: 5 127.0.0.1:6379> LRANGE list1 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 5) \"1\" 127.0.0.1:6379> LRANGE list2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 5) \"1\" In [7]: r.blpop([\"list1\",\"list2\"],timeout=0) Out[7]: (b'list1', b'5') 127.0.0.1:6379> LRANGE list1 0 -1 1) \"4\" 2) \"3\" 3) \"2\" 4) \"1\" 127.0.0.1:6379> LRANGE list2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 5) \"1\" 3.4 Set \u00b6 Set\u96c6\u5408\u5c31\u662f\u4e0d\u5141\u8bb8\u91cd\u590d\u7684\u5217\u8868 3.4.1 sadd \u00b6 sadd(name,values) \u7ed9name\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u6dfb\u52a0\u5143\u7d20 In [8]: r.sadd('set1','aa') Out[8]: 1 In [9]: r.sadd('set1','aa','bb') Out[9]: 1 127.0.0.1:6379> keys * 1) \"set1\" 2) \"list2\" 3) \"list1\" 4) \"list\" 127.0.0.1:6379> type set1 set 127.0.0.1:6379> SMEMBERS set1 1) \"bb\" 2) \"aa\" 3.4.2 smembers \u00b6 smembers(name) \u83b7\u53d6name\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u6240\u6709\u6210\u5458 In [10]: r.smembers('set1') Out[10]: {b'aa', b'bb'} 3.4.3 scard \u00b6 scard(name) \u83b7\u53d6name\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e2a\u6570 In [11]: r.scard('set1') Out[11]: 2 3.4.4 sdiff \u00b6 sdiff(keys, *args) \u5728\u7b2c\u4e00\u4e2aset1\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u4e14\u4e0d\u5728\u5176\u4ed6name\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5143\u7d20\u96c6\u5408 In [13]: r.sadd(\"set1\",\"aa\",\"bb\") Out[13]: 0 In [14]: r.sadd(\"set2\",\"bb\",\"cc\") Out[14]: 2 In [15]: r.sadd(\"set3\",\"bb\",\"cc\",\"dd\") Out[15]: 3 In [16]: r.sdiff(\"set1\",\"set2\",\"set3\") Out[16]: {b'aa'} 3.4.5 sdiffstore \u00b6 sdiffstore(dest, keys, *args) \u76f8\u5f53\u4e8e\u628asdiff\u83b7\u53d6\u7684\u503c\u52a0\u5165\u5230dest\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d In [17]: r.sdiffstore('set_dest',\"set1\",\"set2\",\"set3\") Out[17]: 1 In [18]: r.smembers('set_dest') Out[18]: {b'aa'} 3.4.6 sinter \u00b6 sinter(keys, *args) \u83b7\u53d6\u591a\u4e2aname\u5bf9\u5e94\u96c6\u5408\u7684\u5e76\u96c6 In [19]: r.sinter('set1','set2','set3') Out[19]: {b'bb'} 3.4.7 sinterstore \u00b6 \u83b7\u53d6\u591a\u4e2a\u5bf9\u5e94\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u518d\u8bb2\u5176\u52a0\u5165\u5230dest\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d In [20]: r.sinterstore('sinterstore','set1','set2','set3') Out[20]: 1 In [21]: r.smembers('sinterstore') Out[21]: {b'bb'} 3.4.8 sismember \u00b6 sismember(name, value) \u68c0\u67e5value\u662f\u5426\u662fname\u5bf9\u5e94\u7684\u96c6\u5408\u5185\u7684\u5143\u7d20 In [22]: r.sismember('set1','abc') Out[22]: False In [23]: r.sismember('set1','aa') Out[23]: True In [24]: r.smembers('set1') Out[24]: {b'aa', b'bb'} 3.4.9 smove \u00b6 smove(src, dst, value) \u628asrc \u96c6\u5408\u4e2d\u7684value\u503c\u79fb\u52a8\u5230dst\u96c6\u5408\u4e2d In [25]: r.smembers('set1') Out[25]: {b'aa', b'bb'} In [26]: r.smembers('set2') Out[26]: {b'bb', b'cc'} In [27]: r.smove('set1','set2','aa') Out[27]: True In [28]: r.smembers('set2') Out[28]: {b'aa', b'bb', b'cc'} In [29]: r.smembers('set1') Out[29]: {b'bb'} 3.4.10 spop \u00b6 spop(name) \u4ece\u96c6\u5408\u7684\u5de6\u4fa7\u79fb\u9664\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u5c06\u5176\u8fd4\u56de In [36]: r.smembers('set2') Out[36]: {b'aa', b'bb', b'cc'} In [37]: r.spop('set2') Out[37]: b'aa' In [38]: r.smembers('set2') Out[38]: {b'bb', b'cc'} 3.4.11 srandmember \u00b6 srandmember(name, numbers) \u4ecename\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u968f\u673a\u83b7\u53d6numbers\u4e2a\u5143\u7d20 In [40]: r.sadd(\"set_random\",1,2,3,4,5,6) Out[40]: 6 In [41]: r.smembers('set_random') Out[41]: {b'1', b'2', b'3', b'4', b'5', b'6'} In [42]: r.srandmember('set_random',2) Out[42]: [b'1', b'2'] In [43]: r.srandmember('set_random',2) Out[43]: [b'5', b'2'] 3.4.12 srem \u00b6 srem(name, values) \u5220\u9664name\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u7684\u67d0\u4e9b\u503c In [45]: r.smembers('set') Out[45]: {b'1', b'2', b'3', b'4', b'5', b'6'} In [46]: r.srem('set','3') Out[46]: 1 In [47]: r.smembers('set') Out[47]: {b'1', b'2', b'4', b'5', b'6'} 3.4.14 sunion \u00b6 sunion(keys, *args) \u83b7\u53d6\u591a\u4e2aname\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5e76\u96c6 In [54]: r.sadd(\"set1\",1,2,3,4,5,6) Out[54]: 0 In [55]: r.sadd(\"set2\",4,5,6,7,8.9) Out[55]: 0 In [56]: r.sunion('set1','set2') Out[56]: {b'1', b'2', b'3', b'4', b'5', b'6', b'7', b'8.9', b'bb', b'cc'} 3.4.14 sunionstore \u00b6 sunionstore(dest,keys, *args) \u83b7\u53d6\u591a\u4e2aname\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u5e76\u5c06\u7ed3\u679c\u4fdd\u5b58\u5230dest\u96c6\u5408\u4e2d\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d In [57]: r.sunionstore('union_set','set1','set2') Out[57]: 10 In [58]: r.smembers('union_set') Out[58]: {b'1', b'2', b'3', b'4', b'5', b'6', b'7', b'8.9', b'bb', b'cc'} 3.5 \u6709\u5e8f\u96c6\u5408 \u00b6 \u5728\u96c6\u5408\u7684\u57fa\u7840\u4e0a\uff0c\u4e3a\u6bcf\u5143\u7d20\u6392\u5e8f\uff0c\u5143\u7d20\u7684\u6392\u5e8f\u9700\u8981\u6839\u636e\u53e6\u5916\u4e00\u4e2a\u503c\u6765\u8fdb\u884c\u6bd4\u8f83\uff0c\u6240\u4ee5\uff0c\u5bf9\u4e8e\u6709\u5e8f\u96c6\u5408\uff0c\u6bcf\u4e00\u4e2a\u5143\u7d20\u6709\u4e24\u4e2a\u503c\uff0c\u5373\uff1a\u503c\u548c\u5206\u6570\uff0c\u5206\u6570\u4e13\u95e8\u7528\u6765\u505a\u6392\u5e8f\u3002 3.5.1 zadd \u00b6 zadd(name, *args, **kwargs) \u5728name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u4e2d\u6dfb\u52a0\u5143\u7d20 In [59]: r.zadd(\"zset1\", \"a1\", 2, \"a2\", 3,\"a4\",5) Out[59]: 3 In [63]: r.zadd(\"zset2\",a=10,b=20) Out[63]: 2 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"2\" 3) \"a2\" 4) \"3\" 5) \"a4\" 6) \"5\" 127.0.0.1:6379> ZRANGE zset2 0 -1 WITHSCORES 1) \"a\" 2) \"10\" 3) \"b\" 4) \"20\" 3.5.2 zcard \u00b6 zcard(name) \u83b7\u53d6\u6709\u5e8f\u96c6\u5408\u5185\u5143\u7d20\u7684\u6570\u91cf In [64]: r.zcard('zset1') Out[64]: 3 In [65]: r.zcard('zset2') Out[65]: 2 3.5.3 zcount \u00b6 zcount(name, min, max) \u83b7\u53d6\u6709\u5e8f\u96c6\u5408\u4e2d\u5206\u6570\u5728[min,max]\u4e4b\u95f4\u7684\u4e2a\u6570 In [66]: r.zcount(\"zset1\",1,5) Out[66]: 3 3.5.4 zincrby \u00b6 zincrby(name, value, amount) \u81ea\u589e\u6709\u5e8f\u96c6\u5408\u5185value\u5bf9\u5e94\u7684\u5206\u6570 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"2\" 3) \"a2\" 4) \"3\" 5) \"a4\" 6) \"5\" In [68]: r.zincrby(\"zset1\",\"a1\",amount=2) Out[68]: 4.0 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" \u672c\u6765a1=2 \u7136\u540e\u52a02\u540e\u53d8\u62104\u4e5f\u5c31\u662f a1=4,\u6240\u4ee5\u5411\u540e\u6392\u5217 3.5.5 zrange \u00b6 zrange( name, start, end, desc=False, withscores=False, score_cast_func=float) \u6309\u7167\u7d22\u5f15\u8303\u56f4\u83b7\u53d6name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u7684\u5143\u7d20 aa=r.zrange(\"zset_name\",0,1,desc=False,withscores=True,score_cast_func=int) print(aa) \u53c2\u6570\uff1a name redis\u7684name start \u6709\u5e8f\u96c6\u5408\u7d22\u5f15\u8d77\u59cb\u4f4d\u7f6e end \u6709\u5e8f\u96c6\u5408\u7d22\u5f15\u7ed3\u675f\u4f4d\u7f6e desc \u6392\u5e8f\u89c4\u5219\uff0c\u9ed8\u8ba4\u6309\u7167\u5206\u6570\u4ece\u5c0f\u5230\u5927\u6392\u5e8f withscores \u662f\u5426\u83b7\u53d6\u5143\u7d20\u7684\u5206\u6570\uff0c\u9ed8\u8ba4\u53ea\u83b7\u53d6\u5143\u7d20\u7684\u503c score_cast_func \u5bf9\u5206\u6570\u8fdb\u884c\u6570\u636e\u8f6c\u6362\u7684\u51fd\u6570 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" In [69]: r.zrange('zset1',0,1) Out[69]: [b'a2', b'a1'] In [70]: r.zrange('zset1',0,-1) Out[70]: [b'a2', b'a1', b'a4'] 3.5.6 zrevrange \u00b6 zrevrange(name, start, end, withscores=False, score_cast_func=float) \u540czrange\uff0c\u96c6\u5408\u662f\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u7684 In [71]: r.zrevrange('zset1',0,-1) Out[71]: [b'a4', b'a1', b'a2'] 3.5.7 zrank/zrevrank \u00b6 zrank(name, value)\u3001zrevrank(name, value) \u83b7\u53d6value\u503c\u5728name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u4e2d\u7684\u6392\u884c\u4f4d\u7f6e\uff08\u4ece0\u5f00\u59cb\uff09 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" In [72]: r.zrank('zset1','a1') Out[72]: 1 In [73]: r.zrank('zset1','a2') Out[73]: 0 In [74]: r.zrevrank('zset1','a1') Out[74]: 1 3.5.8 zscore \u00b6 zscore(name, value) \u83b7\u53d6name\u5bf9\u5e94\u6709\u5e8f\u96c6\u5408\u4e2d value \u5bf9\u5e94\u7684\u5206\u6570 In [75]: r.zscore('zset1','a2') Out[75]: 3.0 3.5.9 zrem \u00b6 zrem(name, values) \u5220\u9664name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u4e2d\u503c\u662fvalues\u7684\u6210\u5458 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" In [76]: r.zrem('zset1','a1','a2') Out[76]: 2 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a4\" 2) \"5\" 3.5.10 zremrangebyrank \u00b6 zremrangebyrank(name, min, max) \u6839\u636e\u6392\u884c\u8303\u56f4\u5220\u9664 127.0.0.1:6379> flushall OK In [78]: r.zadd('zset1',a1=10,a2=20,a3=30,a4=40,a5=50) Out[78]: 5 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"10\" 3) \"a2\" 4) \"20\" 5) \"a3\" 6) \"30\" 7) \"a4\" 8) \"40\" 9) \"a5\" 10) \"50\" In [80]: r.zremrangebyrank('zet1', 1, 20) Out[80]: 0 In [81]: r.zremrangebyrank('zset1', 1, 20) Out[81]: 4 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"10\" 3.5.11 zremrangebyscore \u00b6 zremrangebyscore(name, min, max) \u6839\u636e\u5206\u6570\u8303\u56f4\u5220\u9664 127.0.0.1:6379> flushall OK In [82]: r.zadd('zset1',a1=10,a2=20,a3=30,a4=40,a5=50) Out[82]: 5 127.0.0.1:6379> keys * 1) \"zset1\" 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"10\" 3) \"a2\" 4) \"20\" 5) \"a3\" 6) \"30\" 7) \"a4\" 8) \"40\" 9) \"a5\" 10) \"50\" In [83]: r.zremrangebyscore('zset1',1,30) Out[83]: 3 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a4\" 2) \"40\" 3) \"a5\" 4) \"50\" \u5206\u6570\u4ece 1 \u5230 30(include 30) \u7684\u90fd\u88ab\u5220\u9664\u4e86 3.5.12 zinterstore \u00b6 zinterstore(dest, keys, aggregate=None) In [84]: r.zadd(\"zset_name\", \"a1\", 6, \"a2\", 2,\"a3\",5) Out[84]: 3 In [85]: r.zadd('zset_name1', a1=7,b1=10, b2=5) Out[85]: 3 127.0.0.1:6379> ZRANGE zset_name 0 -1 WITHSCORES 1) \"a2\" 2) \"2\" 3) \"a3\" 4) \"5\" 5) \"a1\" 6) \"6\" 127.0.0.1:6379> ZRANGE zset_name1 0 -1 WITHSCORES 1) \"b2\" 2) \"5\" 3) \"a1\" 4) \"7\" 5) \"b1\" 6) \"10\" # \u83b7\u53d6\u4e24\u4e2a\u6709\u5e8f\u96c6\u5408\u7684\u4ea4\u96c6\u5e76\u653e\u5165dest\u96c6\u5408\uff0c\u5982\u679c\u9047\u5230\u76f8\u540c\u503c\u4e0d\u540c\u5206\u6570\uff0c\u5219\u6309\u7167aggregate\u8fdb\u884c\u64cd\u4f5c # aggregate\u7684\u503c\u4e3a: SUM MIN MAX In [86]: r.zinterstore(\"zset_name2\",(\"zset_name1\",\"zset_name\"),aggregate=\"MAX\") Out[86]: 1 127.0.0.1:6379> keys * 1) \"zset_name\" 2) \"zset_name2\" 3) \"zset_name1\" 4) \"zset1\" 127.0.0.1:6379> ZRANGE zset_name2 0 -1 WITHSCORES 1) \"a1\" 2) \"7\" 3.5.14 zunionstore \u00b6 zunionstore(dest, keys, aggregate=None) \u83b7\u53d6\u4e24\u4e2a\u6709\u5e8f\u96c6\u5408\u7684\u5e76\u96c6\u5e76\u653e\u5165dest\u96c6\u5408\uff0c\u5176\u4ed6\u540czinterstore\uff0c In [89]: r.zadd(\"zset_union_name1\", \"a1\", 6, \"a2\", 2,\"a3\",5) Out[89]: 3 In [90]: r.zadd('zset_union_name2', a1=7,b1=10, b2=5) Out[90]: 3 In [91]: r.zunionstore(\"zset_union_name\",(\"zset_union_name1\",\"zset_union_name2\"),aggregate=\"MAX\") Out[91]: 5 In [92]: print(r.zscan(\"zset_union_name\")) (0, [(b'a2', 2.0), (b'a3', 5.0), (b'b2', 5.0), (b'a1', 7.0), (b'b1', 10.0)]) 3.6 \u5176\u4ed6\u64cd\u4f5c \u00b6 3.6.1 delete \u00b6 delete(*names) #\u6839\u636ename\u5220\u9664redis\u4e2d\u7684\u4efb\u610f\u6570\u636e\u7c7b\u578b In [80]: r.exists('name') Out[80]: True In [81]: r.delete('name') Out[81]: 1 In [82]: r.exists('name') Out[82]: False In [83]: r.get('name') 3.6.2 exists \u00b6 exists(name) #\u68c0\u6d4bredis\u7684name\u662f\u5426\u5b58\u5728 In [79]: r.get('name') Out[79]: b'zhangsanlisi' In [80]: r.exists('name') Out[80]: True 3.6.3 keys \u00b6 keys(pattern='*') #\u6839\u636e* \uff1f\u7b49\u901a\u914d\u7b26\u5339\u914d\u83b7\u53d6redis\u7684name In [88]: r.keys(pattern='*') Out[88]: [b'num', b'k1', b'k2', b'mount', b'k3'] 3.6.4 expire \u00b6 expire(name ,time) # \u4e3a\u67d0\u4e2aname\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4 In [92]: r.get('k1') Out[92]: b'v1' In [93]: r.expire('k1',2) # \u914d\u7f6e\u8fc7\u671f\u65f6\u95f4\u4e3a2\u79d2 Out[93]: True In [94]: r.get('k1') 3.6.5 rename \u00b6 rename(src, dst) # \u91cd\u547d\u540d In [97]: r.rename('k2','k22') Out[97]: True In [98]: r.get('k2') In [99]: r.get('k22') Out[99]: b'v2' 3.6.6 move \u00b6 move(name, db)) # \u5c06redis\u7684\u67d0\u4e2a\u503c\u79fb\u52a8\u5230\u6307\u5b9a\u7684db\u4e0b In [105]: r.move('k3',2) Out[105]: True 127.0.0.1:6379> keys * 1) \"num\" 2) \"k22\" 3) \"mount\" 127.0.0.1:6379[3]> select 2 OK 127.0.0.1:6379[2]> keys * 1) \"k3\" 127.0.0.1:6379[2]> 3.6.7 randomkey \u00b6 randomkey() #\u968f\u673a\u83b7\u53d6\u4e00\u4e2aredis\u7684name\uff08\u4e0d\u5220\u9664\uff09 In [100]: r.randomkey() Out[100]: b'mount' In [101]: r.randomkey() Out[101]: b'k3' 3.6.8 type \u00b6 type(name) # \u83b7\u53d6name\u5bf9\u5e94\u503c\u7684\u7c7b\u578b In [102]: r.type('k3') Out[102]: b'string' 3.6.9 dbsize \u00b6 \u6570\u636e\u5e93\u4e2d\u591a\u5c11\u4e2a\u6761\u6570 In [96]: r.dbsize() Out[96]: 1 3.6.10 flushdb/flushall \u00b6 flushdb \u6e05\u7a7a\u6570\u636e\u5e93 flushall \u5220\u9664\u6240\u6709\u73b0\u6709\u7684\u6570\u636e\u5e93 In [97]: r.flushdb() Out[97]: True In [99]: r.flushall() Out[99]: True redis\u64cd\u4f5c 127.0.0.1:6379> SELECT 1 OK 127.0.0.1:6379[1]> set k1 1 OK 127.0.0.1:6379[1]> select 2 OK 127.0.0.1:6379[2]> set k2 2 OK 127.0.0.1:6379[2]> keys * 1) \"k2\" 127.0.0.1:6379[2]> FLUSHDB OK 127.0.0.1:6379[2]> keys * (empty list or set) 127.0.0.1:6379[2]> select 1 OK 127.0.0.1:6379[1]> keys * 1) \"k1\" 127.0.0.1:6379[1]> 127.0.0.1:6379[1]> 127.0.0.1:6379[1]> select 2 OK 127.0.0.1:6379[2]> set k2 2 OK 127.0.0.1:6379[2]> FLUSHALL OK 127.0.0.1:6379[2]> keys * (empty list or set) 127.0.0.1:6379[2]> select 1 OK 127.0.0.1:6379[1]> keys * (empty list or set) 3.6.11 save \u00b6 \u5f3a\u884c\u628a\u6570\u636e\u5e93\u4fdd\u5b58\u5230\u786c\u76d8\u3002\u4fdd\u5b58\u65f6\u963b\u585e In [98]: r.save() Out[98]: True","title":"1. redis"},{"location":"python/lib/nosql/redis/redis.index/#1","text":"Redis\u662f\u4e00\u4e2a\u57fa\u4e8e\u5185\u5b58\u7684\u9ad8\u6548\u7684\u952e\u503c\u578b\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u5b58\u53d6\u6548\u7387\u6781\u9ad8\uff0c\u800c\u4e14\u652f\u6301\u591a\u79cd\u5b58\u50a8\u6570\u636e\u7ed3\u6784\uff0c\u4f7f\u7528\u4e5f\u975e\u5e38\u7b80\u5355\u3002\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c31\u6765\u4ecb\u7ecd\u4e00\u4e0bPython\u7684Redis\u64cd\u4f5c\uff0c\u4e3b\u8981\u4ecb\u7ecdRedisPy\u8fd9\u4e2a\u5e93\u7684\u7528\u6cd5\u3002","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/nosql/redis/redis.index/#11","text":"\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5\u597d\u4e86Redis\u53caRedisPy\u5e93\u3002\u5982\u679c\u8981\u505a\u6570\u636e\u5bfc\u5165/\u5bfc\u51fa\u64cd\u4f5c\u7684\u8bdd\uff0c\u8fd8\u9700\u8981\u5b89\u88c5RedisDump\u3002","title":"1.1 \u51c6\u5907\u5de5\u4f5c"},{"location":"python/lib/nosql/redis/redis.index/#12-redis-strictredis","text":"RedisPy\u5e93\u63d0\u4f9b\u4e24\u4e2a\u7c7bRedis\u548cStrictRedis\u6765\u5b9e\u73b0Redis\u7684\u547d\u4ee4\u64cd\u4f5c\u3002 StrictRedis\u5b9e\u73b0\u4e86\u7edd\u5927\u90e8\u5206\u5b98\u65b9\u7684\u547d\u4ee4\uff0c\u53c2\u6570\u4e5f\u4e00\u4e00\u5bf9\u5e94\uff0c\u6bd4\u5982set()\u65b9\u6cd5\u5c31\u5bf9\u5e94Redis\u547d\u4ee4\u7684set\u65b9\u6cd5\u3002\u800cRedis\u662fStrictRedis\u7684\u5b50\u7c7b\uff0c\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u7528\u4e8e\u5411\u540e\u517c\u5bb9\u65e7\u7248\u672c\u5e93\u91cc\u7684\u51e0\u4e2a\u65b9\u6cd5\u3002\u4e3a\u4e86\u505a\u517c\u5bb9\uff0c\u5b83\u5c06\u65b9\u6cd5\u505a\u4e86\u6539\u5199\uff0c\u6bd4\u5982lrem()\u65b9\u6cd5\u5c31\u5c06value\u548cnum\u53c2\u6570\u7684\u4f4d\u7f6e\u4e92\u6362\uff0c\u8fd9\u548cRedis\u547d\u4ee4\u884c\u7684\u547d\u4ee4\u53c2\u6570\u4e0d\u4e00\u81f4\u3002\u5b98\u65b9\u63a8\u8350\u4f7f\u7528StrictRedis","title":"1.2 Redis StrictRedis"},{"location":"python/lib/nosql/redis/redis.index/#13","text":"Redis \u548c python\u64cd\u4f5c\u6a21\u5757 \u5b89\u88c5 \u53ca \u542f\u52a8 - ubuntu\u7cfb\u7edf apt-get install redis-server pip3 install Redis /etc/init.d/redis-server restart centos\u7cfb\u7edf yum install redis-server pip3 install Redis /etc/init.d/redis-server restart \u67e5\u770b\u7248\u672c\uff1a redis-cli info # redis\u8be6\u7ec6\u4fe1\u606f redis-cli --version | redis-cli -v redis-server --version | redis-server -v - \u7b80\u5355\u4f7f\u7528\uff1a 127.0.0.1:6379> set name 'keke' # \u8bbe\u7f6e \u952e\u4e3aname \u5bf9\u5e94\u7684\u503c\u4e3akeke OK 127.0.0.1:6379> set age '3' OK 127.0.0.1:6379> keys * # \u67e5\u770b\u6240\u6709\u7684\u952e 1) \"age\" 2) \"name\" 127.0.0.1:6379> get name # \u67e5\u770b\u952e\u4e3aname\u5bf9\u5e94\u7684\u503c \"keke\" 127.0.0.1:6379> get age \"3\" 127.0.0.1:6379> set sex female ex 2 # \u8bbe\u7f6e\u503c\uff0c\u53ea\u5b58\u6d3b2\u79d2 OK 127.0.0.1:6379> keys * 1) \"age\" 2) \"name\" 127.0.0.1:6379> set sex female ex 10 OK 127.0.0.1:6379> keys * 1) \"age\" 2) \"sex\" 3) \"name\" 127.0.0.1:6379> get sex \"female\" 127.0.0.1:6379> keys * 1) \"age\" 2) \"name\" 127.0.0.1:6379> flushdb # \u6e05\u7a7a\u5f53\u524ddb\u4e0b\u7684\u6240\u6709\u952e\u503c\uff0c\u8c28\u614e\u64cd\u4f5c OK 127.0.0.1:6379> keys * (empty list or set) 127.0.0.1:6379> 127.0.0.1:6379> flushall # \u6e05\u7a7a\u6240\u6709db\u4e0b\u7684\u952e\u503c OK","title":"1.3 \u5b89\u88c5"},{"location":"python/lib/nosql/redis/redis.index/#2","text":"","title":"2. \u57fa\u672c\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#21-redis-key","text":"Redis keys \u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 DEL key \u8be5\u547d\u4ee4\u7528\u4e8e\u5728 key \u5b58\u5728\u65f6\u5220\u9664 key\u3002 DUMP key \u5e8f\u5217\u5316\u7ed9\u5b9a key \uff0c\u5e76\u8fd4\u56de\u88ab\u5e8f\u5217\u5316\u7684\u503c\u3002 EXISTS key \u68c0\u67e5\u7ed9\u5b9a key \u662f\u5426\u5b58\u5728\u3002 EXPIRE key seconds \u4e3a\u7ed9\u5b9a key \u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4ee5\u79d2\u8ba1\u3002 EXPIREAT key timestamp EXPIREAT \u7684\u4f5c\u7528\u548c EXPIRE \u7c7b\u4f3c\uff0c\u90fd\u7528\u4e8e\u4e3a key \u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002 \u4e0d\u540c\u5728\u4e8e EXPIREAT \u547d\u4ee4\u63a5\u53d7\u7684\u65f6\u95f4\u53c2\u6570\u662f UNIX \u65f6\u95f4\u6233(unix timestamp)\u3002 PEXPIRE key milliseconds \u8bbe\u7f6e key \u7684\u8fc7\u671f\u65f6\u95f4\u4ee5\u6beb\u79d2\u8ba1\u3002 PEXPIREAT key milliseconds-timestamp \u8bbe\u7f6e key \u8fc7\u671f\u65f6\u95f4\u7684\u65f6\u95f4\u6233(unix timestamp) \u4ee5\u6beb\u79d2\u8ba1 KEYS pattern \u67e5\u627e\u6240\u6709\u7b26\u5408\u7ed9\u5b9a\u6a21\u5f0f( pattern)\u7684 key \u3002 MOVE key db \u5c06\u5f53\u524d\u6570\u636e\u5e93\u7684 key \u79fb\u52a8\u5230\u7ed9\u5b9a\u7684\u6570\u636e\u5e93 db \u5f53\u4e2d\u3002 PERSIST key \u79fb\u9664 key \u7684\u8fc7\u671f\u65f6\u95f4\uff0ckey \u5c06\u6301\u4e45\u4fdd\u6301\u3002 PTTL key \u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u8fd4\u56de key \u7684\u5269\u4f59\u7684\u8fc7\u671f\u65f6\u95f4\u3002 TTL key \u4ee5\u79d2\u4e3a\u5355\u4f4d\uff0c\u8fd4\u56de\u7ed9\u5b9a key \u7684\u5269\u4f59\u751f\u5b58\u65f6\u95f4(TTL, time to live)\u3002 RANDOMKEY \u4ece\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u968f\u673a\u8fd4\u56de\u4e00\u4e2a key \u3002 RENAME key newkey \u4fee\u6539 key \u7684\u540d\u79f0 RENAMENX key newkey \u4ec5\u5f53 newkey \u4e0d\u5b58\u5728\u65f6\uff0c\u5c06 key \u6539\u540d\u4e3a newkey \u3002 TYPE key \u8fd4\u56de key \u6240\u50a8\u5b58\u7684\u503c\u7684\u7c7b\u578b\u3002","title":"2.1 redis key\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#22-redis","text":"Redis \u5b57\u7b26\u4e32\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 SET key value \u8bbe\u7f6e\u6307\u5b9a key \u7684\u503c GET key \u83b7\u53d6\u6307\u5b9a key \u7684\u503c\u3002 GETRANGE key start end \u8fd4\u56de key \u4e2d\u5b57\u7b26\u4e32\u503c\u7684\u5b50\u5b57\u7b26 GETSET key value \u5c06\u7ed9\u5b9a key \u7684\u503c\u8bbe\u4e3a value \uff0c\u5e76\u8fd4\u56de key \u7684\u65e7\u503c(old value)\u3002 GETBIT key offset \u5bf9 key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u83b7\u53d6\u6307\u5b9a\u504f\u79fb\u91cf\u4e0a\u7684\u4f4d(bit)\u3002 MGET key1 [key2..] \u83b7\u53d6\u6240\u6709(\u4e00\u4e2a\u6216\u591a\u4e2a)\u7ed9\u5b9a key \u7684\u503c\u3002 SETBIT key offset value \u5bf9 key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u8bbe\u7f6e\u6216\u6e05\u9664\u6307\u5b9a\u504f\u79fb\u91cf\u4e0a\u7684\u4f4d(bit)\u3002 SETEX key seconds value \u5c06\u503c value \u5173\u8054\u5230 key \uff0c\u5e76\u5c06 key \u7684\u8fc7\u671f\u65f6\u95f4\u8bbe\u4e3a seconds (\u4ee5\u79d2\u4e3a\u5355\u4f4d)\u3002 SETNX key value \u53ea\u6709\u5728 key \u4e0d\u5b58\u5728\u65f6\u8bbe\u7f6e key \u7684\u503c\u3002 SETRANGE key offset value \u7528 value \u53c2\u6570\u8986\u5199\u7ed9\u5b9a key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u4ece\u504f\u79fb\u91cf offset \u5f00\u59cb\u3002 STRLEN key \u8fd4\u56de key \u6240\u50a8\u5b58\u7684\u5b57\u7b26\u4e32\u503c\u7684\u957f\u5ea6\u3002 MSET key value [key value ...] \u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2a key-value \u5bf9\u3002 MSETNX key value [key value ...] \u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2a key-value \u5bf9\uff0c\u5f53\u4e14\u4ec5\u5f53\u6240\u6709\u7ed9\u5b9a key \u90fd\u4e0d\u5b58\u5728\u3002 PSETEX key milliseconds value \u8fd9\u4e2a\u547d\u4ee4\u548c SETEX \u547d\u4ee4\u76f8\u4f3c\uff0c\u4f46\u5b83\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u8bbe\u7f6e key \u7684\u751f\u5b58\u65f6\u95f4\uff0c\u800c\u4e0d\u662f\u50cf SETEX \u547d\u4ee4\u90a3\u6837\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\u3002 INCR key \u5c06 key \u4e2d\u50a8\u5b58\u7684\u6570\u5b57\u503c\u589e\u4e00\u3002 INCRBY key increment \u5c06 key \u6240\u50a8\u5b58\u7684\u503c\u52a0\u4e0a\u7ed9\u5b9a\u7684\u589e\u91cf\u503c\uff08increment\uff09 \u3002 INCRBYFLOAT key increment \u5c06 key \u6240\u50a8\u5b58\u7684\u503c\u52a0\u4e0a\u7ed9\u5b9a\u7684\u6d6e\u70b9\u589e\u91cf\u503c\uff08increment\uff09 \u3002 DECR key \u5c06 key \u4e2d\u50a8\u5b58\u7684\u6570\u5b57\u503c\u51cf\u4e00\u3002 DECRBY key decrement key \u6240\u50a8\u5b58\u7684\u503c\u51cf\u53bb\u7ed9\u5b9a\u7684\u51cf\u91cf\u503c\uff08decrement\uff09 \u3002 APPEND key value \u5982\u679c key \u5df2\u7ecf\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c APPEND \u547d\u4ee4\u5c06\u6307\u5b9a\u7684 value \u8ffd\u52a0\u5230\u8be5 key \u539f\u6765\u503c\uff08value\uff09\u7684\u672b\u5c3e\u3002","title":"2.2 redis \u5b57\u7b26\u4e32\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#23-redis-hash","text":"Redis hash \u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 HDEL key field1 [field2] \u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u54c8\u5e0c\u8868\u5b57\u6bb5 HEXISTS key field \u67e5\u770b\u54c8\u5e0c\u8868 key \u4e2d\uff0c\u6307\u5b9a\u7684\u5b57\u6bb5\u662f\u5426\u5b58\u5728\u3002 HGET key field \u83b7\u53d6\u5b58\u50a8\u5728\u54c8\u5e0c\u8868\u4e2d\u6307\u5b9a\u5b57\u6bb5\u7684\u503c\u3002 HGETALL key \u83b7\u53d6\u5728\u54c8\u5e0c\u8868\u4e2d\u6307\u5b9a key \u7684\u6240\u6709\u5b57\u6bb5\u548c\u503c HINCRBY key field increment \u4e3a\u54c8\u5e0c\u8868 key \u4e2d\u7684\u6307\u5b9a\u5b57\u6bb5\u7684\u6574\u6570\u503c\u52a0\u4e0a\u589e\u91cf increment \u3002 HINCRBYFLOAT key field increment \u4e3a\u54c8\u5e0c\u8868 key \u4e2d\u7684\u6307\u5b9a\u5b57\u6bb5\u7684\u6d6e\u70b9\u6570\u503c\u52a0\u4e0a\u589e\u91cf increment \u3002 HKEYS key \u83b7\u53d6\u6240\u6709\u54c8\u5e0c\u8868\u4e2d\u7684\u5b57\u6bb5 HLEN key \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u5b57\u6bb5\u7684\u6570\u91cf HMGET key field1 [field2] \u83b7\u53d6\u6240\u6709\u7ed9\u5b9a\u5b57\u6bb5\u7684\u503c HMSET key field1 value1 [field2 value2 ] \u540c\u65f6\u5c06\u591a\u4e2a field-value (\u57df-\u503c)\u5bf9\u8bbe\u7f6e\u5230\u54c8\u5e0c\u8868 key \u4e2d\u3002 HSET key field value \u5c06\u54c8\u5e0c\u8868 key \u4e2d\u7684\u5b57\u6bb5 field \u7684\u503c\u8bbe\u4e3a value \u3002 HSETNX key field value \u53ea\u6709\u5728\u5b57\u6bb5 field \u4e0d\u5b58\u5728\u65f6\uff0c\u8bbe\u7f6e\u54c8\u5e0c\u8868\u5b57\u6bb5\u7684\u503c\u3002 HVALS key \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u6240\u6709\u503c HSCAN key cursor [MATCH pattern] [COUNT count] \u8fed\u4ee3\u54c8\u5e0c\u8868\u4e2d\u7684\u952e\u503c\u5bf9\u3002","title":"2.3 redis hash\u4e32\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#24-redis","text":"Redis \u5217\u8868\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 BLPOP key1 [key2 ] timeout \u79fb\u51fa\u5e76\u83b7\u53d6\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c \u5982\u679c\u5217\u8868\u6ca1\u6709\u5143\u7d20\u4f1a\u963b\u585e\u5217\u8868\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u6216\u53d1\u73b0\u53ef\u5f39\u51fa\u5143\u7d20\u4e3a\u6b62\u3002 BRPOP key1 [key2 ] timeout \u79fb\u51fa\u5e76\u83b7\u53d6\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c \u5982\u679c\u5217\u8868\u6ca1\u6709\u5143\u7d20\u4f1a\u963b\u585e\u5217\u8868\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u6216\u53d1\u73b0\u53ef\u5f39\u51fa\u5143\u7d20\u4e3a\u6b62\u3002 BRPOPLPUSH source destination timeout \u4ece\u5217\u8868\u4e2d\u5f39\u51fa\u4e00\u4e2a\u503c\uff0c\u5c06\u5f39\u51fa\u7684\u5143\u7d20\u63d2\u5165\u5230\u53e6\u5916\u4e00\u4e2a\u5217\u8868\u4e2d\u5e76\u8fd4\u56de\u5b83\uff1b \u5982\u679c\u5217\u8868\u6ca1\u6709\u5143\u7d20\u4f1a\u963b\u585e\u5217\u8868\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u6216\u53d1\u73b0\u53ef\u5f39\u51fa\u5143\u7d20\u4e3a\u6b62\u3002 LINDEX key index \u901a\u8fc7\u7d22\u5f15\u83b7\u53d6\u5217\u8868\u4e2d\u7684\u5143\u7d20 LINSERT key BEFORE AFTER pivot value LLEN key \u83b7\u53d6\u5217\u8868\u957f\u5ea6 LPOP key \u79fb\u51fa\u5e76\u83b7\u53d6\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 LPUSH key value1 [value2] \u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u503c\u63d2\u5165\u5230\u5217\u8868\u5934\u90e8 LPUSHX key value \u5c06\u4e00\u4e2a\u503c\u63d2\u5165\u5230\u5df2\u5b58\u5728\u7684\u5217\u8868\u5934\u90e8 LRANGE key start stop \u83b7\u53d6\u5217\u8868\u6307\u5b9a\u8303\u56f4\u5185\u7684\u5143\u7d20 LREM key count value \u79fb\u9664\u5217\u8868\u5143\u7d20 LSET key index value \u901a\u8fc7\u7d22\u5f15\u8bbe\u7f6e\u5217\u8868\u5143\u7d20\u7684\u503c LTRIM key start stop \u5bf9\u4e00\u4e2a\u5217\u8868\u8fdb\u884c\u4fee\u526a(trim)\uff0c\u5c31\u662f\u8bf4\uff0c\u8ba9\u5217\u8868\u53ea\u4fdd\u7559\u6307\u5b9a\u533a\u95f4\u5185\u7684\u5143\u7d20\uff0c\u4e0d\u5728\u6307\u5b9a\u533a\u95f4\u4e4b\u5185\u7684\u5143\u7d20\u90fd\u5c06\u88ab\u5220\u9664\u3002 RPOP key \u79fb\u9664\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u8fd4\u56de\u503c\u4e3a\u79fb\u9664\u7684\u5143\u7d20\u3002 RPOPLPUSH source destination \u79fb\u9664\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u5c06\u8be5\u5143\u7d20\u6dfb\u52a0\u5230\u53e6\u4e00\u4e2a\u5217\u8868\u5e76\u8fd4\u56de RPUSH key value1 [value2] \u5728\u5217\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a\u503c RPUSHX key value \u4e3a\u5df2\u5b58\u5728\u7684\u5217\u8868\u6dfb\u52a0\u503c","title":"2.4 redis \u5217\u8868\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#25-redis","text":"Redis \u96c6\u5408\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 SADD key member1 [member2] \u5411\u96c6\u5408\u6dfb\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458 SCARD key \u83b7\u53d6\u96c6\u5408\u7684\u6210\u5458\u6570 SDIFF key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u5dee\u96c6 SDIFFSTORE destination key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u5dee\u96c6\u5e76\u5b58\u50a8\u5728 destination \u4e2d SINTER key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u4ea4\u96c6 SINTERSTORE destination key1 [key2] \u8fd4\u56de\u7ed9\u5b9a\u6240\u6709\u96c6\u5408\u7684\u4ea4\u96c6\u5e76\u5b58\u50a8\u5728 destination \u4e2d SISMEMBER key member \u5224\u65ad member \u5143\u7d20\u662f\u5426\u662f\u96c6\u5408 key \u7684\u6210\u5458 SMEMBERS key \u8fd4\u56de\u96c6\u5408\u4e2d\u7684\u6240\u6709\u6210\u5458 SMOVE source destination member \u5c06 member \u5143\u7d20\u4ece source \u96c6\u5408\u79fb\u52a8\u5230 destination \u96c6\u5408 SPOP key \u79fb\u9664\u5e76\u8fd4\u56de\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\u968f\u673a\u5143\u7d20 SRANDMEMBER key [count] \u8fd4\u56de\u96c6\u5408\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u968f\u673a\u6570 SREM key member1 [member2] \u79fb\u9664\u96c6\u5408\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458 SUNION key1 [key2] \u8fd4\u56de\u6240\u6709\u7ed9\u5b9a\u96c6\u5408\u7684\u5e76\u96c6 SUNIONSTORE destination key1 [key2] \u6240\u6709\u7ed9\u5b9a\u96c6\u5408\u7684\u5e76\u96c6\u5b58\u50a8\u5728 destination \u96c6\u5408\u4e2d SSCAN key cursor [MATCH pattern] [COUNT count] \u8fed\u4ee3\u96c6\u5408\u4e2d\u7684\u5143\u7d20","title":"2.5 redis \u5217\u8868\u96c6\u5408\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#26-redis","text":"Redis \u6709\u5e8f\u96c6\u5408\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 ZADD key score1 member1 [score2 member2] \u5411\u6709\u5e8f\u96c6\u5408\u6dfb\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458\uff0c\u6216\u8005\u66f4\u65b0\u5df2\u5b58\u5728\u6210\u5458\u7684\u5206\u6570 ZCARD key \u83b7\u53d6\u6709\u5e8f\u96c6\u5408\u7684\u6210\u5458\u6570 ZCOUNT key min max \u8ba1\u7b97\u5728\u6709\u5e8f\u96c6\u5408\u4e2d\u6307\u5b9a\u533a\u95f4\u5206\u6570\u7684\u6210\u5458\u6570 ZINCRBY key increment member \u6709\u5e8f\u96c6\u5408\u4e2d\u5bf9\u6307\u5b9a\u6210\u5458\u7684\u5206\u6570\u52a0\u4e0a\u589e\u91cf increment ZINTERSTORE destination numkeys key [key ...] \u8ba1\u7b97\u7ed9\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6709\u5e8f\u96c6\u7684\u4ea4\u96c6\u5e76\u5c06\u7ed3\u679c\u96c6\u5b58\u50a8\u5728\u65b0\u7684\u6709\u5e8f\u96c6\u5408 key \u4e2d ZLEXCOUNT key min max \u5728\u6709\u5e8f\u96c6\u5408\u4e2d\u8ba1\u7b97\u6307\u5b9a\u5b57\u5178\u533a\u95f4\u5185\u6210\u5458\u6570\u91cf ZRANGE key start stop [WITHSCORES] \u901a\u8fc7\u7d22\u5f15\u533a\u95f4\u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u6210\u6307\u5b9a\u533a\u95f4\u5185\u7684\u6210\u5458 ZRANGEBYLEX key min max [LIMIT offset count] \u901a\u8fc7\u5b57\u5178\u533a\u95f4\u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u7684\u6210\u5458 ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT] \u901a\u8fc7\u5206\u6570\u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u6307\u5b9a\u533a\u95f4\u5185\u7684\u6210\u5458 ZRANK key member \u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u4e2d\u6307\u5b9a\u6210\u5458\u7684\u7d22\u5f15 ZREM key member [member ...] \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6210\u5458 ZREMRANGEBYLEX key min max \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7ed9\u5b9a\u7684\u5b57\u5178\u533a\u95f4\u7684\u6240\u6709\u6210\u5458 ZREMRANGEBYRANK key start stop \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7ed9\u5b9a\u7684\u6392\u540d\u533a\u95f4\u7684\u6240\u6709\u6210\u5458 ZREMRANGEBYSCORE key min max \u79fb\u9664\u6709\u5e8f\u96c6\u5408\u4e2d\u7ed9\u5b9a\u7684\u5206\u6570\u533a\u95f4\u7684\u6240\u6709\u6210\u5458 ZREVRANGE key start stop [WITHSCORES] \u8fd4\u56de\u6709\u5e8f\u96c6\u4e2d\u6307\u5b9a\u533a\u95f4\u5185\u7684\u6210\u5458\uff0c\u901a\u8fc7\u7d22\u5f15\uff0c\u5206\u6570\u4ece\u9ad8\u5230\u5e95 ZREVRANGEBYSCORE key max min [WITHSCORES] \u8fd4\u56de\u6709\u5e8f\u96c6\u4e2d\u6307\u5b9a\u5206\u6570\u533a\u95f4\u5185\u7684\u6210\u5458\uff0c\u5206\u6570\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f ZREVRANK key member \u8fd4\u56de\u6709\u5e8f\u96c6\u5408\u4e2d\u6307\u5b9a\u6210\u5458\u7684\u6392\u540d\uff0c\u6709\u5e8f\u96c6\u6210\u5458\u6309\u5206\u6570\u503c\u9012\u51cf(\u4ece\u5927\u5230\u5c0f)\u6392\u5e8f ZSCORE key member \u8fd4\u56de\u6709\u5e8f\u96c6\u4e2d\uff0c\u6210\u5458\u7684\u5206\u6570\u503c ZUNIONSTORE destination numkeys key [key ...] \u8ba1\u7b97\u7ed9\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6709\u5e8f\u96c6\u7684\u5e76\u96c6\uff0c\u5e76\u5b58\u50a8\u5728\u65b0\u7684 key \u4e2d ZSCAN key cursor [MATCH pattern] [COUNT count] \u8fed\u4ee3\u6709\u5e8f\u96c6\u5408\u4e2d\u7684\u5143\u7d20\uff08\u5305\u62ec\u5143\u7d20\u6210\u5458\u548c\u5143\u7d20\u5206\u503c\uff09","title":"2.6 redis \u5217\u6709\u5e8f\u96c6\u5408\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#27-redis-hyperloglog","text":"Redis HyperLogLog \u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 PFADD key element [element ...] \u6dfb\u52a0\u6307\u5b9a\u5143\u7d20\u5230 HyperLogLog \u4e2d\u3002 PFCOUNT key [key ...] \u8fd4\u56de\u7ed9\u5b9a HyperLogLog \u7684\u57fa\u6570\u4f30\u7b97\u503c\u3002 PFMERGE destkey sourcekey [sourcekey ...] \u5c06\u591a\u4e2a HyperLogLog \u5408\u5e76\u4e3a\u4e00\u4e2a HyperLogLog","title":"2.7 redis HyperLogLog\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#28-redis","text":"Redis \u53d1\u5e03\u8ba2\u9605\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 PSUBSCRIBE pattern [pattern ...] \u8ba2\u9605\u4e00\u4e2a\u6216\u591a\u4e2a\u7b26\u5408\u7ed9\u5b9a\u6a21\u5f0f\u7684\u9891\u9053\u3002 PUBSUB subcommand [argument [argument ...]] \u67e5\u770b\u8ba2\u9605\u4e0e\u53d1\u5e03\u7cfb\u7edf\u72b6\u6001\u3002 PUBLISH channel message \u5c06\u4fe1\u606f\u53d1\u9001\u5230\u6307\u5b9a\u7684\u9891\u9053\u3002 PUNSUBSCRIBE [pattern [pattern ...]] \u9000\u8ba2\u6240\u6709\u7ed9\u5b9a\u6a21\u5f0f\u7684\u9891\u9053\u3002 SUBSCRIBE channel [channel ...] \u8ba2\u9605\u7ed9\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u9891\u9053\u7684\u4fe1\u606f\u3002 UNSUBSCRIBE [channel [channel ...]] \u6307\u9000\u8ba2\u7ed9\u5b9a\u7684\u9891\u9053\u3002","title":"2.8 redis \u53d1\u5e03\u8ba2\u9605\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#29-redis","text":"Redis \u4e8b\u52a1\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 DISCARD \u53d6\u6d88\u4e8b\u52a1\uff0c\u653e\u5f03\u6267\u884c\u4e8b\u52a1\u5757\u5185\u7684\u6240\u6709\u547d\u4ee4\u3002 EXEC \u6267\u884c\u6240\u6709\u4e8b\u52a1\u5757\u5185\u7684\u547d\u4ee4\u3002 MULTI \u6807\u8bb0\u4e00\u4e2a\u4e8b\u52a1\u5757\u7684\u5f00\u59cb\u3002 UNWATCH \u53d6\u6d88 WATCH \u547d\u4ee4\u5bf9\u6240\u6709 key \u7684\u76d1\u89c6\u3002 WATCH key [key ...] \u76d1\u89c6\u4e00\u4e2a(\u6216\u591a\u4e2a) key \uff0c\u5982\u679c\u5728\u4e8b\u52a1\u6267\u884c\u4e4b\u524d\u8fd9\u4e2a(\u6216\u8fd9\u4e9b) key \u88ab\u5176\u4ed6\u547d\u4ee4\u6240\u6539\u52a8\uff0c\u90a3\u4e48\u4e8b\u52a1\u5c06\u88ab\u6253\u65ad","title":"2.9 redis \u4e8b\u52a1\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#210-redis","text":"Redis \u811a\u672c\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 EVAL script numkeys key [key ...] arg [arg ...] \u6267\u884c Lua \u811a\u672c\u3002 EVALSHA sha1 numkeys key [key ...] arg [arg ...] \u6267\u884c Lua \u811a\u672c\u3002 SCRIPT EXISTS script [script ...] \u67e5\u770b\u6307\u5b9a\u7684\u811a\u672c\u662f\u5426\u5df2\u7ecf\u88ab\u4fdd\u5b58\u5728\u7f13\u5b58\u5f53\u4e2d\u3002 SCRIPT FLUSH \u4ece\u811a\u672c\u7f13\u5b58\u4e2d\u79fb\u9664\u6240\u6709\u811a\u672c\u3002 SCRIPT KILL \u6740\u6b7b\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684 Lua \u811a\u672c\u3002 SCRIPT LOAD script \u5c06\u811a\u672c script \u6dfb\u52a0\u5230\u811a\u672c\u7f13\u5b58\u4e2d\uff0c\u4f46\u5e76\u4e0d\u7acb\u5373\u6267\u884c\u8fd9\u4e2a\u811a\u672c\u3002","title":"2.10 redis \u811a\u672c\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#211-redis","text":"Redis \u8fde\u63a5\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 AUTH password \u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u6b63\u786e ECHO message \u6253\u5370\u5b57\u7b26\u4e32 PING \u67e5\u770b\u670d\u52a1\u662f\u5426\u8fd0\u884c QUIT \u5173\u95ed\u5f53\u524d\u8fde\u63a5 SELECT index \u5207\u6362\u5230\u6307\u5b9a\u7684\u6570\u636e\u5e93","title":"2.11 redis \u94fe\u63a5\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#212-redis","text":"Redis \u670d\u52a1\u5668\u547d\u4ee4 \u547d\u4ee4\u53ca\u63cf\u8ff0 BGREWRITEAOF \u5f02\u6b65\u6267\u884c\u4e00\u4e2a AOF\uff08AppendOnly File\uff09 \u6587\u4ef6\u91cd\u5199\u64cd\u4f5c BGSAVE \u5728\u540e\u53f0\u5f02\u6b65\u4fdd\u5b58\u5f53\u524d\u6570\u636e\u5e93\u7684\u6570\u636e\u5230\u78c1\u76d8 CLIENT KILL [ip:port] [ID client-id] \u5173\u95ed\u5ba2\u6237\u7aef\u8fde\u63a5 CLIENT LIST \u83b7\u53d6\u8fde\u63a5\u5230\u670d\u52a1\u5668\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5217\u8868 CLIENT GETNAME \u83b7\u53d6\u8fde\u63a5\u7684\u540d\u79f0 CLIENT PAUSE timeout \u5728\u6307\u5b9a\u65f6\u95f4\u5185\u7ec8\u6b62\u8fd0\u884c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u547d\u4ee4 CLIENT SETNAME connection-name \u8bbe\u7f6e\u5f53\u524d\u8fde\u63a5\u7684\u540d\u79f0 CLUSTER SLOTS \u83b7\u53d6\u96c6\u7fa4\u8282\u70b9\u7684\u6620\u5c04\u6570\u7ec4 COMMAND \u83b7\u53d6 Redis \u547d\u4ee4\u8be6\u60c5\u6570\u7ec4 COMMAND COUNT \u83b7\u53d6 Redis \u547d\u4ee4\u603b\u6570 COMMAND GETKEYS \u83b7\u53d6\u7ed9\u5b9a\u547d\u4ee4\u7684\u6240\u6709\u952e TIME \u8fd4\u56de\u5f53\u524d\u670d\u52a1\u5668\u65f6\u95f4 COMMAND INFO command-name [command-name ...] \u83b7\u53d6\u6307\u5b9a Redis \u547d\u4ee4\u63cf\u8ff0\u7684\u6570\u7ec4 CONFIG GET parameter \u83b7\u53d6\u6307\u5b9a\u914d\u7f6e\u53c2\u6570\u7684\u503c CONFIG REWRITE \u5bf9\u542f\u52a8 Redis \u670d\u52a1\u5668\u65f6\u6240\u6307\u5b9a\u7684 redis.conf \u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6539\u5199 CONFIG SET parameter value \u4fee\u6539 redis \u914d\u7f6e\u53c2\u6570\uff0c\u65e0\u9700\u91cd\u542f CONFIG RESETSTAT \u91cd\u7f6e INFO \u547d\u4ee4\u4e2d\u7684\u67d0\u4e9b\u7edf\u8ba1\u6570\u636e DBSIZE \u8fd4\u56de\u5f53\u524d\u6570\u636e\u5e93\u7684 key \u7684\u6570\u91cf DEBUG OBJECT key \u83b7\u53d6 key \u7684\u8c03\u8bd5\u4fe1\u606f DEBUG SEGFAULT \u8ba9 Redis \u670d\u52a1\u5d29\u6e83 FLUSHALL \u5220\u9664\u6240\u6709\u6570\u636e\u5e93\u7684\u6240\u6709key FLUSHDB \u5220\u9664\u5f53\u524d\u6570\u636e\u5e93\u7684\u6240\u6709key INFO [section] \u83b7\u53d6 Redis \u670d\u52a1\u5668\u7684\u5404\u79cd\u4fe1\u606f\u548c\u7edf\u8ba1\u6570\u503c LASTSAVE \u8fd4\u56de\u6700\u8fd1\u4e00\u6b21 Redis \u6210\u529f\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u78c1\u76d8\u4e0a\u7684\u65f6\u95f4\uff0c\u4ee5 UNIX \u65f6\u95f4\u6233\u683c\u5f0f\u8868\u793a MONITOR \u5b9e\u65f6\u6253\u5370\u51fa Redis \u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u547d\u4ee4\uff0c\u8c03\u8bd5\u7528 ROLE \u8fd4\u56de\u4e3b\u4ece\u5b9e\u4f8b\u6240\u5c5e\u7684\u89d2\u8272 SAVE \u540c\u6b65\u4fdd\u5b58\u6570\u636e\u5230\u786c\u76d8 SHUTDOWN [NOSAVE] [SAVE] \u5f02\u6b65\u4fdd\u5b58\u6570\u636e\u5230\u786c\u76d8\uff0c\u5e76\u5173\u95ed\u670d\u52a1\u5668 SLAVEOF host port \u5c06\u5f53\u524d\u670d\u52a1\u5668\u8f6c\u53d8\u4e3a\u6307\u5b9a\u670d\u52a1\u5668\u7684\u4ece\u5c5e\u670d\u52a1\u5668(slave server) SLOWLOG subcommand [argument] \u7ba1\u7406 redis \u7684\u6162\u65e5\u5fd7 SYNC \u7528\u4e8e\u590d\u5236\u529f\u80fd(replication)\u7684\u5185\u90e8\u547d\u4ee4","title":"2.12 redis \u670d\u52a1\u5668\u547d\u4ee4"},{"location":"python/lib/nosql/redis/redis.index/#3","text":"","title":"3. \u8be6\u7ec6"},{"location":"python/lib/nosql/redis/redis.index/#31-redis","text":"pip install redis","title":"3.1 \u5b89\u88c5redis\u5e93"},{"location":"python/lib/nosql/redis/redis.index/#32-pythonredis","text":"\u8fde\u63a5 redis-py\u63d0\u4f9b\u4e24\u4e2a\u7c7bRedis\u548cStrictRedis\u7528\u4e8e\u5b9e\u73b0Redis\u7684\u547d\u4ee4\uff0cStrictRedis\u7528\u4e8e\u5b9e\u73b0\u5927\u90e8\u5206\u5b98\u65b9\u7684\u547d\u4ee4\uff0c\u5e76\u4f7f\u7528\u5b98\u65b9\u7684\u8bed\u6cd5\u548c\u547d\u4ee4\uff0cRedis\u662fStrictRedis\u7684\u5b50\u7c7b\uff0c\u7528\u4e8e\u5411\u540e\u517c\u5bb9\u65e7\u7248\u672c\u7684redis-py\u3002 import redis r = redis.Redis(host='127.0.0.1', port=6379) r.set('name', 'Jack') print (r.get('name')) - \u8fde\u63a5\u6c60 redis-py\u4f7f\u7528connection pool\u6765\u7ba1\u7406\u5bf9\u4e00\u4e2aredis server\u7684\u6240\u6709\u8fde\u63a5\uff0c\u907f\u514d\u6bcf\u6b21\u5efa\u7acb\u3001\u91ca\u653e\u8fde\u63a5\u7684\u5f00\u9500\u3002\u9ed8\u8ba4\uff0c\u6bcf\u4e2aRedis\u5b9e\u4f8b\u90fd\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u81ea\u5df1\u7684\u8fde\u63a5\u6c60\u3002\u53ef\u4ee5\u76f4\u63a5\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\u6c60\uff0c\u7136\u540e\u4f5c\u4e3a\u53c2\u6570Redis\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u591a\u4e2aRedis\u5b9e\u4f8b\u5171\u4eab\u4e00\u4e2a\u8fde\u63a5\u6c60\u3002 import redis pool = redis.ConnectionPool(host='127.0.0.1', port=6379) r = redis.Redis(connection_pool=pool) r.set('name', 'Jack') print r.get('name')","title":"3.2 Python\u64cd\u4f5cRedis"},{"location":"python/lib/nosql/redis/redis.index/#32-string","text":"","title":"3.2 string"},{"location":"python/lib/nosql/redis/redis.index/#321-set","text":"set setnx setnx(name, value) setex setex(name, value, time) psetex psetex(name, time_ms, value) set(name, value, ex=None, px=None, nx=False, xx=False) help set \u5728Redis\u4e2d\u8bbe\u7f6e\u503c\uff0c\u9ed8\u8ba4\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\uff0c\u5b58\u5728\u5219\u4fee\u6539 \u53c2\u6570\uff1a - ex\uff0c\u8fc7\u671f\u65f6\u95f4\uff08\u79d2\uff09 - px\uff0c\u8fc7\u671f\u65f6\u95f4\uff08\u6beb\u79d2\uff09 - nx\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3aTrue\uff0c\u5219\u53ea\u6709name\u4e0d\u5b58\u5728\u65f6\uff0c\u5f53\u524dset\u64cd\u4f5c\u624d\u6267\u884c - xx\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3aTrue\uff0c\u5219\u53ea\u6709name\u5b58\u5728\u65f6\uff0c\u5f53\u524dset\u64cd\u4f5c\u624d\u6267\u884c setex(name, value, time) #\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff08\u79d2\uff09 psetex(name, time_ms, value) #\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff08\u8c6a\u79d2\uff09 \u64cd\u4f5c\u8fc7\u7a0b In [5]: r.set('k1','v1') Out[5]: True In [6]: r.get('key1') In [7]: r.get('k1') Out[7]: b'v1'","title":"3.2.1 set"},{"location":"python/lib/nosql/redis/redis.index/#323-mset","text":"mset(*args, **kwargs) #\u6279\u91cf\u8bbe\u7f6e\u503c r.mset(name1='zhangsan', name2='lisi') #\u6216 r.mget({\"name1\":'zhangsan', \"name2\":'lisi'}) \u64cd\u4f5c\u8fc7\u7a0b In [14]: r.mset(name1='zhangsan', name2='lisi') Out[14]: True In [15]: r.mget({\"name1\":'zhangsan', \"name2\":'lisi'}) Out[15]: [b'zhangsan', b'lisi']","title":"3.2.3 mset"},{"location":"python/lib/nosql/redis/redis.index/#324-mget","text":"mget(keys, *args) #\u6279\u91cf\u83b7\u53d6 print(r.mget(\"name1\",\"name2\")) #\u6216 li=[\"name1\",\"name2\"] print(r.mget(li)) \u64cd\u4f5c\u8fc7\u7a0b In [16]: r.mget(\"name1\",\"name2\") Out[16]: [b'zhangsan', b'lisi'] In [17]: name=[\"name1\",\"name2\"] In [18]: r.mget(name) Out[18]: [b'zhangsan', b'lisi']","title":"3.2.4 mget"},{"location":"python/lib/nosql/redis/redis.index/#325-getset","text":"getset(name, value) #\u8bbe\u7f6e\u65b0\u503c\uff0c\u6253\u5370\u539f\u503c print(r.getset(\"name1\",\"wangwu\")) #\u8f93\u51fa:zhangsan print(r.get(\"name1\")) #\u8f93\u51fa:wangwu \u64cd\u4f5c\u8fc7\u7a0b In [26]: r.get(\"name1\") Out[26]: b'zhangsan' In [27]: r.getset(\"name1\",\"wangwu\") Out[27]: b'zhangsan' In [28]: r.get(\"name1\") Out[28]: b'wangwu'","title":"3.2.5 getset"},{"location":"python/lib/nosql/redis/redis.index/#326-getrange","text":"getrange(key, start, end) #\u6839\u636e\u5b57\u8282\u83b7\u53d6\u5b50\u5e8f\u5217 r.set(\"name\",\"zhangsan\") print(r.getrange(\"name\",0,4))#\u8f93\u51fa:zhang \u64cd\u4f5c\u8fc7\u7a0b In [29]: r.set(\"name\",\"zhangsan\") Out[29]: True In [30]: r.getrange('name',0,4) Out[30]: b'zhang'","title":"3.2.6 getrange"},{"location":"python/lib/nosql/redis/redis.index/#327-setrange","text":"setrange(name, offset, value) #\u4fee\u6539\u5b57\u7b26\u4e32\u5185\u5bb9\uff0c\u4ece\u6307\u5b9a\u5b57\u7b26\u4e32\u7d22\u5f15\u5f00\u59cb\u5411\u540e\u66ff\u6362\uff0c\u5982\u679c\u65b0\u503c\u592a\u957f\u65f6\uff0c\u5219\u5411\u540e\u6dfb\u52a0 r.set(\"name\",\"zhangsan\") r.setrange(\"name\",1,\"ww\") print(r.get(\"name\")) #\u8f93\u51fa:zwwngsan r.set(\"name\",\"zhangsan\") r.setrange(\"name\",6,\"wwww\") print(r.get(\"name\")) #\u8f93\u51fa:zwwwwsan r.set(\"name\",\"zhangsan\") r.setrange(\"name\",6,\"wwwwwwwwwww\") print(r.get(\"name\")) #\u8f93\u51fa:zwwwwwwwwwww \u64cd\u4f5c\u8fc7\u7a0b In [31]: r.set(\"name\",\"zhangsan\") Out[31]: True In [32]: r.setrange(\"name\",1,\"ww\") Out[32]: 8 In [33]: r.get(\"name\") Out[33]: b'zwwngsan' In [34]: r.set(\"name\",\"zhangsan\") Out[34]: True In [35]: r.setrange(\"name\",1,\"wwww\") Out[35]: 8 In [36]: r.get(\"name\") Out[36]: b'zwwwwsan' In [37]: r.set(\"name\",\"zhangsan\") Out[37]: True In [38]: r.setrange(\"name\",1,\"wwwwwwwwwww\") Out[38]: 12 In [39]: r.get(\"name\") Out[39]: b'zwwwwwwwwwww'","title":"3.2.7 setrange"},{"location":"python/lib/nosql/redis/redis.index/#328-setbit","text":"setbit(name, offset, value) #\u5bf9\u4e8c\u8fdb\u5236\u8868\u793a\u4f4d\u8fdb\u884c\u64cd\u4f5c ''' name:redis\u7684name offset\uff0c\u4f4d\u7684\u7d22\u5f15\uff08\u5c06\u503c\u5bf9\u5e94\u7684ASCII\u7801\u53d8\u6362\u6210\u4e8c\u8fdb\u5236\u540e\u518d\u8fdb\u884c\u7d22\u5f15\uff09 value\uff0c\u503c\u53ea\u80fd\u662f 1 \u6216 0 ''' str=\"345\" r.set(\"name\",str) for i in str: print(i,ord(i),bin(ord(i)))#\u8f93\u51fa \u503c\u3001ASCII\u7801\u4e2d\u5bf9\u5e94\u7684\u503c\u3001\u5bf9\u5e94\u503c\u8f6c\u6362\u7684\u4e8c\u8fdb\u5236 ''' \u8f93\u51fa: 51 0b110011 52 0b110100 53 0b110101''' r.setbit(\"name\",6,0)#\u628a\u7b2c7\u4f4d\u6539\u4e3a0\uff0c\u4e5f\u5c31\u662f3\u5bf9\u5e94\u7684\u53d8\u6210\u4e860b110001 print(r.get(\"name\"))#\u8f93\u51fa\uff1a145 \u64cd\u4f5c\u8fc7\u7a0b In [45]: str=\"345\" In [46]: r.set(\"name\",str) Out[46]: True In [47]: r.setbit(\"name\",6,0) Out[47]: 1 In [48]: r.get(\"name\") Out[48]: b'145'","title":"3.2.8 setbit"},{"location":"python/lib/nosql/redis/redis.index/#329-getbit","text":"getbit(name, offset) #\u83b7\u53d6name\u5bf9\u5e94\u503c\u7684\u4e8c\u8fdb\u5236\u4e2d\u67d0\u4f4d\u7684\u503c(0\u62161) r.set(\"name\",\"3\") # \u5bf9\u5e94\u7684\u4e8c\u8fdb\u52360b110011 print(r.getbit(\"name\",5)) #\u8f93\u51fa:0 print(r.getbit(\"name\",6)) #\u8f93\u51fa:1 \u64cd\u4f5c\u8fc7\u7a0b In [49]: r.set(\"name\",\"3\") Out[49]: True In [50]: r.get('name') Out[50]: b'3' In [51]: r.getbit(\"name\",5) Out[51]: 0 In [52]: r.getbit(\"name\",6) Out[52]: 1","title":"3.2.9 getbit"},{"location":"python/lib/nosql/redis/redis.index/#3210-bitcount","text":"bitcount(key, start=None, end=None) #\u83b7\u53d6\u5bf9\u5e94\u4e8c\u8fdb\u5236\u4e2d1\u7684\u4e2a\u6570 r.set(\"name\",\"345\")#0b110011 0b110100 0b110101 print(r.bitcount(\"name\",start=0,end=1)) #\u8f93\u51fa:7 ''' key:Redis\u7684name start:\u5b57\u8282\u8d77\u59cb\u4f4d\u7f6e end:\u5b57\u8282\u7ed3\u675f\u4f4d\u7f6e''' \u64cd\u4f5c\u8fc7\u7a0b In [56]: r.set(\"name\",\"345\") Out[56]: True In [57]: ...: r.bitcount(\"name\",start=0,end=1) Out[57]: 7","title":"3.2.10 bitcount"},{"location":"python/lib/nosql/redis/redis.index/#3211-strlen","text":"strlen(name) #\u8fd4\u56dename\u5bf9\u5e94\u503c\u7684\u5b57\u8282\u957f\u5ea6\uff08\u4e00\u4e2a\u6c49\u5b573\u4e2a\u5b57\u8282\uff09 r.set(\"name\",\"zhangsan\") print(r.strlen(\"name\")) #\u8f93\u51fa:8 \u64cd\u4f5c\u8fc7\u7a0b In [58]: r.set(\"name\",\"zhangsan\") Out[58]: True In [59]: r.strlen(\"name\") Out[59]: 8 In [60]: r.set(\"name\",\"\u5f20\u4e09\") Out[60]: True In [61]: r.strlen(\"name\") Out[61]: 6","title":"3.2.11 strlen"},{"location":"python/lib/nosql/redis/redis.index/#3212-incr","text":"incr(self, name, amount=1) #\u81ea\u589emount\u5bf9\u5e94\u7684\u503c\uff0c\u5f53mount\u4e0d\u5b58\u5728\u65f6\uff0c\u5219\u521b\u5efamount\uff1damount\uff0c\u5426\u5219\uff0c\u5219\u81ea\u589e,amount\u4e3a\u81ea\u589e\u6570(\u6574\u6570) print(r.incr(\"mount\",amount=2))#\u8f93\u51fa:2 print(r.incr(\"mount\"))#\u8f93\u51fa:3 print(r.incr(\"mount\",amount=3))#\u8f93\u51fa:6 print(r.incr(\"mount\",amount=6))#\u8f93\u51fa:12 print(r.get(\"mount\")) #\u8f93\u51fa:12 \u64cd\u4f5c\u8fc7\u7a0b In [66]: r.incr(\"num\",amount=2) Out[66]: 2 in [67]: r.incr(\"num\",amount=10) Out[67]: 12 In [68]: r.incr(\"num\") Out[68]: 13 In [69]: r.get('num') Out[69]: b'13' In [70]: r.incr(\"num\",amount=20) Out[70]: 33 In [71]: r.incr(\"num\",amount=30) Out[71]: 63 In [72]: r.get('num') Out[72]: b'63'","title":"3.2.12 incr"},{"location":"python/lib/nosql/redis/redis.index/#3213-incrbyfloat","text":"incrbyfloat(self, name, amount=1.0) \u7c7b\u4f3c incr() \u81ea\u589e,amount\u4e3a\u81ea\u589e\u6570(\u6d6e\u70b9\u6570)","title":"3.2.13 incrbyfloat"},{"location":"python/lib/nosql/redis/redis.index/#3214-decr","text":"decr(self, name, amount=1) \u81ea\u51cfname\u5bf9\u5e94\u7684\u503c,\u5f53name\u4e0d\u5b58\u5728\u65f6,\u5219\u521b\u5efaname\uff1damount\uff0c\u5426\u5219\uff0c\u5219\u81ea\u51cf\uff0camount\u4e3a\u81ea\u589e\u6570(\u6574\u6570)","title":"3.2.14 decr"},{"location":"python/lib/nosql/redis/redis.index/#3215-append","text":"append(name, value) #\u5728name\u5bf9\u5e94\u7684\u503c\u540e\u9762\u8ffd\u52a0\u5185\u5bb9 r.set(\"name\",\"zhangsan\") print(r.get(\"name\")) #\u8f93\u51fa:'zhangsan r.append(\"name\",\"lisi\") print(r.get(\"name\")) #\u8f93\u51fa:zhangsanlisi \u64cd\u4f5c\u8fc7\u7a0b In [73]: r.set(\"name\",\"zhangsan\") Out[73]: True In [74]: r.get('name') Out[74]: b'zhangsan' In [75]: r.append('name','lisi') Out[75]: 12 In [76]: r.get('name') Out[76]: b'zhangsanlisi'","title":"3.2.15 append"},{"location":"python/lib/nosql/redis/redis.index/#33-hash","text":"redis\u4e2d\u7684Hash \u5728\u5185\u5b58\u4e2d\u7c7b\u4f3c\u4e8e\u4e00\u4e2aname\u5bf9\u5e94\u4e00\u4e2adic\u6765\u5b58\u50a8","title":"3.3 Hash"},{"location":"python/lib/nosql/redis/redis.index/#331-hset","text":"hset(name, key, value) name\u5bf9\u5e94\u7684hash\u4e2d\u8bbe\u7f6e\u4e00\u4e2a\u952e\u503c\u5bf9\uff08\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\uff0c\u5426\u5219\uff0c\u4fee\u6539\uff09 r.hset(\"hash_name\",\"key1\",\"values1\") \u64cd\u4f5c\u8fc7\u7a0b In [12]: r.hset('hash_name','key1','values1') Out[12]: 1 127.0.0.1:6379> TYPE hash_name hash 127.0.0.1:6379> HGETALL hash_name 1) \"key1\" 2) \"values1\" 127.0.0.1:6379> HGET hash_name key1 \"values1\"","title":"3.3.1 hset"},{"location":"python/lib/nosql/redis/redis.index/#332-hget","text":"hget(name,key) \u53d6\u5355\u4e2akey\u503c r.hset(\"hash_name\",\"key1\",\"values1\") #\u5728hash_name\u5bf9\u5e94\u7684hash\u4e2d\u6839\u636ekey\u83b7\u53d6value print(r.hget(\"hash_name\",\"key1\"))#\u8f93\u51fa:aa \u64cd\u4f5c\u8fc7\u7a0b In [13]: r.hset(\"hash_name\",\"key1\",\"values1\") Out[13]: 0 In [14]: r.hget(\"hash_name\",\"key1\") Out[14]: b'values1'","title":"3.3.2 hget"},{"location":"python/lib/nosql/redis/redis.index/#333-hgetall","text":"hgetall(name) \u83b7\u53d6name\u5bf9\u5e94hash\u7684\u6240\u6709\u952e\u503c In [22]: r.hset(\"hash_name\",\"key1\",\"values1\") Out[22]: 1 In [23]: r.hset(\"hash_name\",\"key2\",\"values2\") Out[23]: 1 In [24]: r.hset(\"hash_name\",\"key3\",\"values3\") Out[24]: 1 In [25]: r.hget('hash_name','key1') Out[25]: b'values1' In [26]: r.hget('hash_name','key') In [27]: r.hget('hash_name','key2') Out[27]: b'values2' In [28]: r.hget('hash_name','key3') Out[28]: b'values3' In [29]: r.hgetall('hash_name') Out[29]: {b'key1': b'values1', b'key2': b'values2', b'key3': b'values3'}","title":"3.3.3 hgetall"},{"location":"python/lib/nosql/redis/redis.index/#334-hmset","text":"hmset(name, mapping) \u5728name\u5bf9\u5e94\u7684hash\u4e2d\u6279\u91cf\u8bbe\u7f6e\u952e\u503c\u5bf9,mapping:\u5b57\u5178 In [33]: dic={\"name\":\"summer\",\"job\":\"IT\"} In [34]: r.hmset('dic_name',dic) Out[34]: True 127.0.0.1:6379> HGETALL dic_name 1) \"name\" 2) \"summer\" 3) \"job\" 4) \"IT\"","title":"3.3.4 hmset"},{"location":"python/lib/nosql/redis/redis.index/#335-hmgethmgetall","text":"hmget(name, keys, *args) \u5728name\u5bf9\u5e94\u7684hash\u4e2d\u83b7\u53d6\u591a\u4e2akey\u7684\u503c In [36]: r.hmget('dic_name','name') Out[36]: [b'summer'] In [37]: r.hmget('dic_name','job') Out[37]: [b'IT']","title":"3.3.5 hmget/hmgetall"},{"location":"python/lib/nosql/redis/redis.index/#336-hlenhkeyshvals","text":"hlen(name)\u3001hkeys(name)\u3001hvals(name) dic={\"name\":\"summer\",\"job\":\"IT\",'age':30} r.hmset(\"dic_name\",dic) #hlen(name) \u83b7\u53d6hash\u4e2d\u952e\u503c\u5bf9\u7684\u4e2a\u6570 print(r.hlen(\"dic_name\")) #hkeys(name) \u83b7\u53d6hash\u4e2d\u6240\u6709\u7684key\u7684\u503c print(r.hkeys(\"dic_name\")) #hvals(name) \u83b7\u53d6hash\u4e2d\u6240\u6709\u7684value\u7684\u503c print(r.hvals(\"dic_name\")) \u64cd\u4f5c\u8fc7\u7a0b In [40]: dic={\"name\":\"summer\",\"job\":\"IT\",'age':30} In [41]: r.hmset('dic_name',dic) Out[41]: True In [42]: r.hlen('dic_name') Out[42]: 3 In [43]: r.hkeys('dic_name') Out[43]: [b'name', b'job', b'age'] In [44]: r.hvals('dic_name') Out[44]: [b'summer', b'IT', b'30']","title":"3.3.6 hlen/hkeys/hvals"},{"location":"python/lib/nosql/redis/redis.index/#337-hexists","text":"hexists(name, key) \u68c0\u67e5name\u5bf9\u5e94\u7684hash\u662f\u5426\u5b58\u5728\u5f53\u524d\u4f20\u5165\u7684key In [45]: r.hexists(\"dic_name\",\"a1\") Out[45]: False In [46]: r.hexists(\"dic_name\",\"name\") Out[46]: True","title":"3.3.7 hexists"},{"location":"python/lib/nosql/redis/redis.index/#338-hdel","text":"hdel(name,*keys) \u5220\u9664\u6307\u5b9aname\u5bf9\u5e94\u7684key\u6240\u5728\u7684\u952e\u503c\u5bf9 In [46]: r.hexists(\"dic_name\",\"name\") Out[46]: True In [47]: r.hkeys('dic_name') Out[47]: [b'name', b'job', b'age'] In [48]: r.hvals('dic_name') Out[48]: [b'summer', b'IT', b'30'] In [49]: r.hdel('dic_name','job') Out[49]: 1 In [50]: r.hkeys('dic_name') Out[50]: [b'name', b'age'] 127.0.0.1:6379> HGETALL dic_name 1) \"name\" 2) \"summer\" 3) \"age\" 4) \"30\"","title":"3.3.8 hdel"},{"location":"python/lib/nosql/redis/redis.index/#339-hincrby","text":"hincrby(name, key, amount=1) \u81ea\u589ehash\u4e2dkey\u5bf9\u5e94\u7684\u503c\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efakey=amount(amount\u4e3a\u6574\u6570) In [52]: r.hincrby(\"num\",\"data\",amount=2) Out[52]: 2 127.0.0.1:6379> keys * 1) \"num\" 2) \"hash_name\" 3) \"dic_name\" 127.0.0.1:6379> type num hash 127.0.0.1:6379> HGETALL num 1) \"data\" 2) \"2\"","title":"3.3.9 hincrby"},{"location":"python/lib/nosql/redis/redis.index/#3310-hincrbyfloat","text":"hincrbyfloat(name, key, amount=1.0) \u81ea\u589ehash\u4e2dkey\u5bf9\u5e94\u7684\u503c\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efakey=amount(amount\u4e3a\u6d6e\u70b9\u6570) In [54]: r.hincrby(\"floatnum\",\"float1\",amount=2) Out[54]: 2 127.0.0.1:6379> keys * 1) \"floatnum\" 2) \"num\" 3) \"hash_name\" 4) \"dic_name\" 127.0.0.1:6379> type floatnum hash 127.0.0.1:6379> HGETALL floatnum 1) \"float1\" 2) \"2\" 127.0.0.1:6379> HGET floatnum float1 \"2\"","title":"3.3.10 hincrbyfloat"},{"location":"python/lib/nosql/redis/redis.index/#3311-hscan","text":"hscan(name, cursor=0, match=None, count=None)","title":"3.3.11 hscan"},{"location":"python/lib/nosql/redis/redis.index/#3312-hscan_iter","text":"hscan_iter(name, match=None, count=None)","title":"3.3.12 hscan_iter"},{"location":"python/lib/nosql/redis/redis.index/#34-list","text":"redis\u4e2d\u7684List\u5728\u5728\u5185\u5b58\u4e2d\u6309\u7167\u4e00\u4e2aname\u5bf9\u5e94\u4e00\u4e2aList\u6765\u5b58\u50a8","title":"3.4 List"},{"location":"python/lib/nosql/redis/redis.index/#341-lpush","text":"lpush(name,values) \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u6bcf\u4e2a\u65b0\u7684\u5143\u7d20\u90fd\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u5de6\u8fb9 # \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u6bcf\u4e2a\u65b0\u7684\u5143\u7d20\u90fd\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u5de6\u8fb9 r.lpush('list',5) r.lpush('list',2,3,4) # \u4fdd\u5b58\u5728\u5217\u8868\u4e2d\u7684\u987a\u5e8f\u4e3a5\uff0c4\uff0c3\uff0c2 \u64cd\u4f5c\u8fc7\u7a0b In [58]: r.lpush('list',2) Out[58]: 1 In [59]: r.lpush('list',3,4,5) Out[59]: 4 127.0.0.1:6379> LRANGE list 0 6 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\"","title":"3.4.1 lpush"},{"location":"python/lib/nosql/redis/redis.index/#342-rpush","text":"rpush(name,values) \u540clpush\uff0c\u4f46\u6bcf\u4e2a\u65b0\u7684\u5143\u7d20\u90fd\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u53f3\u8fb9 In [61]: r.rpush('rlist',2) Out[61]: 1 In [62]: r.rpush('rlist',3,4,5) Out[62]: 4 127.0.0.1:6379> keys * 1) \"rlist\" 2) \"list\" 127.0.0.1:6379> LRANGE rlist 0 6 1) \"2\" 2) \"3\" 3) \"4\" 4) \"5\"","title":"3.4.2 rpush"},{"location":"python/lib/nosql/redis/redis.index/#343-lpushx","text":"lpushx(name,value) \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u53ea\u6709name\u5df2\u7ecf\u5b58\u5728\u65f6\uff0c\u503c\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u5de6\u8fb9","title":"3.4.3 lpushx"},{"location":"python/lib/nosql/redis/redis.index/#344-rpushx","text":"rpushx(name,value) \u5728name\u5bf9\u5e94\u7684list\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u53ea\u6709name\u5df2\u7ecf\u5b58\u5728\u65f6\uff0c\u503c\u6dfb\u52a0\u5230\u5217\u8868\u7684\u6700\u53f3\u8fb9","title":"3.4.4 rpushx"},{"location":"python/lib/nosql/redis/redis.index/#345-llen","text":"llen(name) name\u5bf9\u5e94\u7684list\u5143\u7d20\u7684\u4e2a\u6570 In [63]: r.llen('rlist') Out[63]: 4","title":"3.4.5 llen"},{"location":"python/lib/nosql/redis/redis.index/#346-linsert","text":"linsert(name, where, refvalue, value)) # \u5728name\u5bf9\u5e94\u7684\u5217\u8868\u7684\u67d0\u4e00\u4e2a\u503c\u524d\u6216\u540e\u63d2\u5165\u4e00\u4e2a\u65b0\u503c r.linsert(\"rlist\",\"BEFORE\",\"2\",\"before\")#\u5728\u5217\u8868\u5185\u627e\u5230\u7b2c\u4e00\u4e2a\u5143\u7d202\uff0c\u5728\u5b83\u524d\u9762\u63d2\u5165SS '''\u53c2\u6570\uff1a name: redis\u7684name where: BEFORE\uff08\u524d\uff09\u6216AFTER\uff08\u540e\uff09 refvalue: \u5217\u8868\u5185\u7684\u503c value: \u8981\u63d2\u5165\u7684\u6570\u636e''' \u64cd\u4f5c \u63d2\u5165\u4e4b\u524d 127.0.0.1:6379> LRANGE rlist 0 6 1) \"2\" 2) \"3\" 3) \"4\" 4) \"5\" In [64]: r.linsert(\"rlist\",\"BEFORE\",\"2\",\"before\") Out[64]: 5 \u63d2\u5165\u4e4b\u540e 127.0.0.1:6379> LRANGE rlist 0 6 1) \"before\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"5\"","title":"3.4.6 linsert"},{"location":"python/lib/nosql/redis/redis.index/#347-lset","text":"r.lset(name, index, value) #\u5bf9list\u4e2d\u7684\u67d0\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u91cd\u65b0\u8d4b\u503c r.lset(\"rlist\",0,\"bbb\") \u64cd\u4f5c\u8fc7\u7a0b \u4fee\u6539\u4e4b\u524d 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"before\" 2) \"2\" 3) \"3\" 4) \"4_before\" 5) \"4\" 6) \"4_after\" 7) \"4_before\" 8) \"5\" # \u4fee\u6539\u7b2c0\u4f4d\u662f0 In [68]: r.lset('rlist',0,0) Out[68]: True \u4fee\u6539\u4e4b\u540e 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4_before\" 5) \"4\" 6) \"4_after\" 7) \"4_before\" 8) \"5\"","title":"3.4.7 lset"},{"location":"python/lib/nosql/redis/redis.index/#348-lrem","text":"r.lrem(name, value, num) \u5220\u9664name\u5bf9\u5e94\u7684list\u4e2d\u7684\u6307\u5b9a\u503c r.lrem(\"rlist\",\"data\",num=0) ''' \u53c2\u6570\uff1a name: redis\u7684name value: \u8981\u5220\u9664\u7684\u503c num: num=0 \u5220\u9664\u5217\u8868\u4e2d\u6240\u6709\u7684\u6307\u5b9a\u503c\uff1b num=2 \u4ece\u524d\u5230\u540e\uff0c\u5220\u96642\u4e2a\uff1b num=-2 \u4ece\u540e\u5411\u524d\uff0c\u5220\u96642\u4e2a \u64cd\u4f5c\u8fc7\u7a0b \u5220\u9664\u4e4b\u524d 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4_before\" 5) \"4\" 6) \"4_after\" 7) \"4_before\" 8) \"5\" In [69]: r.lrem('rlist','4_before',3) Out[69]: 2 \u5220\u9664\u4e4b\u540e 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"4_after\" 6) \"5\"","title":"3.4.8 lrem"},{"location":"python/lib/nosql/redis/redis.index/#349-lpop","text":"lpop(name) \u79fb\u9664\u5217\u8868\u7684\u5de6\u4fa7\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u8fd4\u56de\u503c\u5219\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20 \u64cd\u4f5c\u8fc7\u7a0b 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"0\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"4_after\" 6) \"5\" In [70]: r.lpop(\"rlist\") Out[70]: b'0' 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\"","title":"3.4.9 lpop"},{"location":"python/lib/nosql/redis/redis.index/#3410-lindex","text":"lindex(name, index) \u6839\u636e\u7d22\u5f15\u83b7\u53d6\u5217\u8868\u5185\u5143\u7d20 \u64cd\u4f5c\u8fc7\u7a0b 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" In [72]: r.lindex('rlist','2') Out[72]: b'4' In [73]: r.lindex('rlist','3') Out[73]: b'4_after","title":"3.4.10 lindex"},{"location":"python/lib/nosql/redis/redis.index/#3411-lrange","text":"lrange(name, start, end) \u5206\u7247\u83b7\u53d6\u5143\u7d20 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" In [74]: r.lrange('rlist',0,3) Out[74]: [b'2', b'3', b'4', b'4_after'] In [75]: r.lrange('rlist',0,-1) Out[75]: [b'2', b'3', b'4', b'4_after', b'5']","title":"3.4.11 lrange"},{"location":"python/lib/nosql/redis/redis.index/#3412-ltrim","text":"ltrim(name, start, end) \u79fb\u9664\u5217\u8868\u5185\u6ca1\u6709\u5728\u8be5\u7d22\u5f15\u4e4b\u5185\u7684\u503c 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\" 4) \"4_after\" 5) \"5\" In [76]: r.ltrim('rlist',0,2) # \u4fdd\u7559\u7d22\u5f15 0 \u52302\u7684\u503c\uff0c\u5176\u4ed6\u90fd\u5220\u9664 Out[76]: True 127.0.0.1:6379> LRANGE rlist 0 -1 1) \"2\" 2) \"3\" 3) \"4\"","title":"3.4.12 ltrim"},{"location":"python/lib/nosql/redis/redis.index/#3413-rpoplpush","text":"rpoplpush(src, dst) \u4ece\u4e00\u4e2a\u5217\u8868\u53d6\u51fa\u6700\u53f3\u8fb9\u7684\u5143\u7d20\uff0c\u540c\u65f6\u5c06\u5176\u6dfb\u52a0\u81f3\u53e6\u4e00\u4e2a\u5217\u8868\u7684\u6700\u5de6\u8fb9 - src \u8981\u53d6\u6570\u636e\u7684\u5217\u8868 - dst \u8981\u6dfb\u52a0\u6570\u636e\u7684\u5217\u8868","title":"3.4.13 rpoplpush"},{"location":"python/lib/nosql/redis/redis.index/#3414-brpoplpush","text":"brpoplpush(src, dst, timeout=0) \u540crpoplpush\uff0c\u591a\u4e86\u4e2atimeout, timeout\uff1a\u53d6\u6570\u636e\u7684\u5217\u8868\u6ca1\u5143\u7d20\u540e\u7684\u963b\u585e\u65f6\u95f4\uff0c0\u4e3a\u4e00\u76f4\u963b\u585e","title":"3.4.14 brpoplpush"},{"location":"python/lib/nosql/redis/redis.index/#3415-blpop","text":"blpop(keys, timeout) \u5c06\u591a\u4e2a\u5217\u8868\u6392\u5217,\u6309\u7167\u4ece\u5de6\u5230\u53f3\u53bb\u79fb\u9664\u5404\u4e2a\u5217\u8868\u5185\u7684\u5143\u7d20 r.lpush(\"rlist1\",3,4,5) r.lpush(\"rlist2\",3,4,5) while True: print(r.blpop([\"rlist1\",\"rlist2\"],timeout=0)) print(r.lrange(\"rlist1\",0,-1),r.lrange(\"rlist2\",0,-1)) '''keys: redis\u7684name\u7684\u96c6\u5408 timeout: \u8d85\u65f6\u65f6\u95f4\uff0c\u83b7\u53d6\u5b8c\u6240\u6709\u5217\u8868\u7684\u5143\u7d20\u4e4b\u540e\uff0c\u963b\u585e\u7b49\u5f85\u5217\u8868\u5185\u6709\u6570\u636e\u7684\u65f6\u95f4\uff08\u79d2\uff09, 0 \u8868\u793a\u6c38\u8fdc\u963b\u585e''' \u64cd\u4f5c\u8fc7\u7a0b In [86]: r.lpush(\"rlist2\",3,4,5) Out[86]: 3 In [87]: r.lpush(\"rlist1\",3,4,5) Out[87]: 3 127.0.0.1:6379> LRANGE rlist1 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 127.0.0.1:6379> LRANGE rlist2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" In [90]: r.blpop([\"rlist1\",\"rlist2\"],timeout=0) Out[90]: (b'rlist1', b'5') 127.0.0.1:6379> LRANGE rlist1 0 -1 1) \"4\" 2) \"3\" 127.0.0.1:6379> LRANGE rlist2 0 -1 1) \"5\" 2) \"4\" 3) \"3\"","title":"3.4.15 blpop"},{"location":"python/lib/nosql/redis/redis.index/#3416-brpop","text":"r.brpop(keys, timeout) \u540cblpop\uff0c\u5c06\u591a\u4e2a\u5217\u8868\u6392\u5217,\u6309\u7167\u4ece\u53f3\u50cf\u5de6\u53bb\u79fb\u9664\u5404\u4e2a\u5217\u8868\u5185\u7684\u5143\u7d20 \u64cd\u4f5c\u8fc7\u7a0b 127.0.0.1:6379> flushall OK In [5]: r.lpush(\"list1\",1,2,3,4,5) Out[5]: 5 In [6]: r.lpush(\"list2\",1,2,3,4,5) Out[6]: 5 127.0.0.1:6379> LRANGE list1 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 5) \"1\" 127.0.0.1:6379> LRANGE list2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 5) \"1\" In [7]: r.blpop([\"list1\",\"list2\"],timeout=0) Out[7]: (b'list1', b'5') 127.0.0.1:6379> LRANGE list1 0 -1 1) \"4\" 2) \"3\" 3) \"2\" 4) \"1\" 127.0.0.1:6379> LRANGE list2 0 -1 1) \"5\" 2) \"4\" 3) \"3\" 4) \"2\" 5) \"1\"","title":"3.4.16 brpop"},{"location":"python/lib/nosql/redis/redis.index/#34-set","text":"Set\u96c6\u5408\u5c31\u662f\u4e0d\u5141\u8bb8\u91cd\u590d\u7684\u5217\u8868","title":"3.4 Set"},{"location":"python/lib/nosql/redis/redis.index/#341-sadd","text":"sadd(name,values) \u7ed9name\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u6dfb\u52a0\u5143\u7d20 In [8]: r.sadd('set1','aa') Out[8]: 1 In [9]: r.sadd('set1','aa','bb') Out[9]: 1 127.0.0.1:6379> keys * 1) \"set1\" 2) \"list2\" 3) \"list1\" 4) \"list\" 127.0.0.1:6379> type set1 set 127.0.0.1:6379> SMEMBERS set1 1) \"bb\" 2) \"aa\"","title":"3.4.1 sadd"},{"location":"python/lib/nosql/redis/redis.index/#342-smembers","text":"smembers(name) \u83b7\u53d6name\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u6240\u6709\u6210\u5458 In [10]: r.smembers('set1') Out[10]: {b'aa', b'bb'}","title":"3.4.2 smembers"},{"location":"python/lib/nosql/redis/redis.index/#343-scard","text":"scard(name) \u83b7\u53d6name\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e2a\u6570 In [11]: r.scard('set1') Out[11]: 2","title":"3.4.3 scard"},{"location":"python/lib/nosql/redis/redis.index/#344-sdiff","text":"sdiff(keys, *args) \u5728\u7b2c\u4e00\u4e2aset1\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u4e14\u4e0d\u5728\u5176\u4ed6name\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5143\u7d20\u96c6\u5408 In [13]: r.sadd(\"set1\",\"aa\",\"bb\") Out[13]: 0 In [14]: r.sadd(\"set2\",\"bb\",\"cc\") Out[14]: 2 In [15]: r.sadd(\"set3\",\"bb\",\"cc\",\"dd\") Out[15]: 3 In [16]: r.sdiff(\"set1\",\"set2\",\"set3\") Out[16]: {b'aa'}","title":"3.4.4 sdiff"},{"location":"python/lib/nosql/redis/redis.index/#345-sdiffstore","text":"sdiffstore(dest, keys, *args) \u76f8\u5f53\u4e8e\u628asdiff\u83b7\u53d6\u7684\u503c\u52a0\u5165\u5230dest\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d In [17]: r.sdiffstore('set_dest',\"set1\",\"set2\",\"set3\") Out[17]: 1 In [18]: r.smembers('set_dest') Out[18]: {b'aa'}","title":"3.4.5 sdiffstore"},{"location":"python/lib/nosql/redis/redis.index/#346-sinter","text":"sinter(keys, *args) \u83b7\u53d6\u591a\u4e2aname\u5bf9\u5e94\u96c6\u5408\u7684\u5e76\u96c6 In [19]: r.sinter('set1','set2','set3') Out[19]: {b'bb'}","title":"3.4.6 sinter"},{"location":"python/lib/nosql/redis/redis.index/#347-sinterstore","text":"\u83b7\u53d6\u591a\u4e2a\u5bf9\u5e94\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u518d\u8bb2\u5176\u52a0\u5165\u5230dest\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d In [20]: r.sinterstore('sinterstore','set1','set2','set3') Out[20]: 1 In [21]: r.smembers('sinterstore') Out[21]: {b'bb'}","title":"3.4.7 sinterstore"},{"location":"python/lib/nosql/redis/redis.index/#348-sismember","text":"sismember(name, value) \u68c0\u67e5value\u662f\u5426\u662fname\u5bf9\u5e94\u7684\u96c6\u5408\u5185\u7684\u5143\u7d20 In [22]: r.sismember('set1','abc') Out[22]: False In [23]: r.sismember('set1','aa') Out[23]: True In [24]: r.smembers('set1') Out[24]: {b'aa', b'bb'}","title":"3.4.8 sismember"},{"location":"python/lib/nosql/redis/redis.index/#349-smove","text":"smove(src, dst, value) \u628asrc \u96c6\u5408\u4e2d\u7684value\u503c\u79fb\u52a8\u5230dst\u96c6\u5408\u4e2d In [25]: r.smembers('set1') Out[25]: {b'aa', b'bb'} In [26]: r.smembers('set2') Out[26]: {b'bb', b'cc'} In [27]: r.smove('set1','set2','aa') Out[27]: True In [28]: r.smembers('set2') Out[28]: {b'aa', b'bb', b'cc'} In [29]: r.smembers('set1') Out[29]: {b'bb'}","title":"3.4.9 smove"},{"location":"python/lib/nosql/redis/redis.index/#3410-spop","text":"spop(name) \u4ece\u96c6\u5408\u7684\u5de6\u4fa7\u79fb\u9664\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u5c06\u5176\u8fd4\u56de In [36]: r.smembers('set2') Out[36]: {b'aa', b'bb', b'cc'} In [37]: r.spop('set2') Out[37]: b'aa' In [38]: r.smembers('set2') Out[38]: {b'bb', b'cc'}","title":"3.4.10 spop"},{"location":"python/lib/nosql/redis/redis.index/#3411-srandmember","text":"srandmember(name, numbers) \u4ecename\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u968f\u673a\u83b7\u53d6numbers\u4e2a\u5143\u7d20 In [40]: r.sadd(\"set_random\",1,2,3,4,5,6) Out[40]: 6 In [41]: r.smembers('set_random') Out[41]: {b'1', b'2', b'3', b'4', b'5', b'6'} In [42]: r.srandmember('set_random',2) Out[42]: [b'1', b'2'] In [43]: r.srandmember('set_random',2) Out[43]: [b'5', b'2']","title":"3.4.11 srandmember"},{"location":"python/lib/nosql/redis/redis.index/#3412-srem","text":"srem(name, values) \u5220\u9664name\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u7684\u67d0\u4e9b\u503c In [45]: r.smembers('set') Out[45]: {b'1', b'2', b'3', b'4', b'5', b'6'} In [46]: r.srem('set','3') Out[46]: 1 In [47]: r.smembers('set') Out[47]: {b'1', b'2', b'4', b'5', b'6'}","title":"3.4.12 srem"},{"location":"python/lib/nosql/redis/redis.index/#3414-sunion","text":"sunion(keys, *args) \u83b7\u53d6\u591a\u4e2aname\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5e76\u96c6 In [54]: r.sadd(\"set1\",1,2,3,4,5,6) Out[54]: 0 In [55]: r.sadd(\"set2\",4,5,6,7,8.9) Out[55]: 0 In [56]: r.sunion('set1','set2') Out[56]: {b'1', b'2', b'3', b'4', b'5', b'6', b'7', b'8.9', b'bb', b'cc'}","title":"3.4.14 sunion"},{"location":"python/lib/nosql/redis/redis.index/#3414-sunionstore","text":"sunionstore(dest,keys, *args) \u83b7\u53d6\u591a\u4e2aname\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u5e76\u5c06\u7ed3\u679c\u4fdd\u5b58\u5230dest\u96c6\u5408\u4e2d\u5bf9\u5e94\u7684\u96c6\u5408\u4e2d In [57]: r.sunionstore('union_set','set1','set2') Out[57]: 10 In [58]: r.smembers('union_set') Out[58]: {b'1', b'2', b'3', b'4', b'5', b'6', b'7', b'8.9', b'bb', b'cc'}","title":"3.4.14 sunionstore"},{"location":"python/lib/nosql/redis/redis.index/#35","text":"\u5728\u96c6\u5408\u7684\u57fa\u7840\u4e0a\uff0c\u4e3a\u6bcf\u5143\u7d20\u6392\u5e8f\uff0c\u5143\u7d20\u7684\u6392\u5e8f\u9700\u8981\u6839\u636e\u53e6\u5916\u4e00\u4e2a\u503c\u6765\u8fdb\u884c\u6bd4\u8f83\uff0c\u6240\u4ee5\uff0c\u5bf9\u4e8e\u6709\u5e8f\u96c6\u5408\uff0c\u6bcf\u4e00\u4e2a\u5143\u7d20\u6709\u4e24\u4e2a\u503c\uff0c\u5373\uff1a\u503c\u548c\u5206\u6570\uff0c\u5206\u6570\u4e13\u95e8\u7528\u6765\u505a\u6392\u5e8f\u3002","title":"3.5 \u6709\u5e8f\u96c6\u5408"},{"location":"python/lib/nosql/redis/redis.index/#351-zadd","text":"zadd(name, *args, **kwargs) \u5728name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u4e2d\u6dfb\u52a0\u5143\u7d20 In [59]: r.zadd(\"zset1\", \"a1\", 2, \"a2\", 3,\"a4\",5) Out[59]: 3 In [63]: r.zadd(\"zset2\",a=10,b=20) Out[63]: 2 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"2\" 3) \"a2\" 4) \"3\" 5) \"a4\" 6) \"5\" 127.0.0.1:6379> ZRANGE zset2 0 -1 WITHSCORES 1) \"a\" 2) \"10\" 3) \"b\" 4) \"20\"","title":"3.5.1 zadd"},{"location":"python/lib/nosql/redis/redis.index/#352-zcard","text":"zcard(name) \u83b7\u53d6\u6709\u5e8f\u96c6\u5408\u5185\u5143\u7d20\u7684\u6570\u91cf In [64]: r.zcard('zset1') Out[64]: 3 In [65]: r.zcard('zset2') Out[65]: 2","title":"3.5.2 zcard"},{"location":"python/lib/nosql/redis/redis.index/#353-zcount","text":"zcount(name, min, max) \u83b7\u53d6\u6709\u5e8f\u96c6\u5408\u4e2d\u5206\u6570\u5728[min,max]\u4e4b\u95f4\u7684\u4e2a\u6570 In [66]: r.zcount(\"zset1\",1,5) Out[66]: 3","title":"3.5.3 zcount"},{"location":"python/lib/nosql/redis/redis.index/#354-zincrby","text":"zincrby(name, value, amount) \u81ea\u589e\u6709\u5e8f\u96c6\u5408\u5185value\u5bf9\u5e94\u7684\u5206\u6570 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"2\" 3) \"a2\" 4) \"3\" 5) \"a4\" 6) \"5\" In [68]: r.zincrby(\"zset1\",\"a1\",amount=2) Out[68]: 4.0 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" \u672c\u6765a1=2 \u7136\u540e\u52a02\u540e\u53d8\u62104\u4e5f\u5c31\u662f a1=4,\u6240\u4ee5\u5411\u540e\u6392\u5217","title":"3.5.4 zincrby"},{"location":"python/lib/nosql/redis/redis.index/#355-zrange","text":"zrange( name, start, end, desc=False, withscores=False, score_cast_func=float) \u6309\u7167\u7d22\u5f15\u8303\u56f4\u83b7\u53d6name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u7684\u5143\u7d20 aa=r.zrange(\"zset_name\",0,1,desc=False,withscores=True,score_cast_func=int) print(aa) \u53c2\u6570\uff1a name redis\u7684name start \u6709\u5e8f\u96c6\u5408\u7d22\u5f15\u8d77\u59cb\u4f4d\u7f6e end \u6709\u5e8f\u96c6\u5408\u7d22\u5f15\u7ed3\u675f\u4f4d\u7f6e desc \u6392\u5e8f\u89c4\u5219\uff0c\u9ed8\u8ba4\u6309\u7167\u5206\u6570\u4ece\u5c0f\u5230\u5927\u6392\u5e8f withscores \u662f\u5426\u83b7\u53d6\u5143\u7d20\u7684\u5206\u6570\uff0c\u9ed8\u8ba4\u53ea\u83b7\u53d6\u5143\u7d20\u7684\u503c score_cast_func \u5bf9\u5206\u6570\u8fdb\u884c\u6570\u636e\u8f6c\u6362\u7684\u51fd\u6570 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" In [69]: r.zrange('zset1',0,1) Out[69]: [b'a2', b'a1'] In [70]: r.zrange('zset1',0,-1) Out[70]: [b'a2', b'a1', b'a4']","title":"3.5.5 zrange"},{"location":"python/lib/nosql/redis/redis.index/#356-zrevrange","text":"zrevrange(name, start, end, withscores=False, score_cast_func=float) \u540czrange\uff0c\u96c6\u5408\u662f\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u7684 In [71]: r.zrevrange('zset1',0,-1) Out[71]: [b'a4', b'a1', b'a2']","title":"3.5.6 zrevrange"},{"location":"python/lib/nosql/redis/redis.index/#357-zrankzrevrank","text":"zrank(name, value)\u3001zrevrank(name, value) \u83b7\u53d6value\u503c\u5728name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u4e2d\u7684\u6392\u884c\u4f4d\u7f6e\uff08\u4ece0\u5f00\u59cb\uff09 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" In [72]: r.zrank('zset1','a1') Out[72]: 1 In [73]: r.zrank('zset1','a2') Out[73]: 0 In [74]: r.zrevrank('zset1','a1') Out[74]: 1","title":"3.5.7 zrank/zrevrank"},{"location":"python/lib/nosql/redis/redis.index/#358-zscore","text":"zscore(name, value) \u83b7\u53d6name\u5bf9\u5e94\u6709\u5e8f\u96c6\u5408\u4e2d value \u5bf9\u5e94\u7684\u5206\u6570 In [75]: r.zscore('zset1','a2') Out[75]: 3.0","title":"3.5.8 zscore"},{"location":"python/lib/nosql/redis/redis.index/#359-zrem","text":"zrem(name, values) \u5220\u9664name\u5bf9\u5e94\u7684\u6709\u5e8f\u96c6\u5408\u4e2d\u503c\u662fvalues\u7684\u6210\u5458 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a2\" 2) \"3\" 3) \"a1\" 4) \"4\" 5) \"a4\" 6) \"5\" In [76]: r.zrem('zset1','a1','a2') Out[76]: 2 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a4\" 2) \"5\"","title":"3.5.9 zrem"},{"location":"python/lib/nosql/redis/redis.index/#3510-zremrangebyrank","text":"zremrangebyrank(name, min, max) \u6839\u636e\u6392\u884c\u8303\u56f4\u5220\u9664 127.0.0.1:6379> flushall OK In [78]: r.zadd('zset1',a1=10,a2=20,a3=30,a4=40,a5=50) Out[78]: 5 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"10\" 3) \"a2\" 4) \"20\" 5) \"a3\" 6) \"30\" 7) \"a4\" 8) \"40\" 9) \"a5\" 10) \"50\" In [80]: r.zremrangebyrank('zet1', 1, 20) Out[80]: 0 In [81]: r.zremrangebyrank('zset1', 1, 20) Out[81]: 4 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"10\"","title":"3.5.10 zremrangebyrank"},{"location":"python/lib/nosql/redis/redis.index/#3511-zremrangebyscore","text":"zremrangebyscore(name, min, max) \u6839\u636e\u5206\u6570\u8303\u56f4\u5220\u9664 127.0.0.1:6379> flushall OK In [82]: r.zadd('zset1',a1=10,a2=20,a3=30,a4=40,a5=50) Out[82]: 5 127.0.0.1:6379> keys * 1) \"zset1\" 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a1\" 2) \"10\" 3) \"a2\" 4) \"20\" 5) \"a3\" 6) \"30\" 7) \"a4\" 8) \"40\" 9) \"a5\" 10) \"50\" In [83]: r.zremrangebyscore('zset1',1,30) Out[83]: 3 127.0.0.1:6379> ZRANGE zset1 0 -1 WITHSCORES 1) \"a4\" 2) \"40\" 3) \"a5\" 4) \"50\" \u5206\u6570\u4ece 1 \u5230 30(include 30) \u7684\u90fd\u88ab\u5220\u9664\u4e86","title":"3.5.11 zremrangebyscore"},{"location":"python/lib/nosql/redis/redis.index/#3512-zinterstore","text":"zinterstore(dest, keys, aggregate=None) In [84]: r.zadd(\"zset_name\", \"a1\", 6, \"a2\", 2,\"a3\",5) Out[84]: 3 In [85]: r.zadd('zset_name1', a1=7,b1=10, b2=5) Out[85]: 3 127.0.0.1:6379> ZRANGE zset_name 0 -1 WITHSCORES 1) \"a2\" 2) \"2\" 3) \"a3\" 4) \"5\" 5) \"a1\" 6) \"6\" 127.0.0.1:6379> ZRANGE zset_name1 0 -1 WITHSCORES 1) \"b2\" 2) \"5\" 3) \"a1\" 4) \"7\" 5) \"b1\" 6) \"10\" # \u83b7\u53d6\u4e24\u4e2a\u6709\u5e8f\u96c6\u5408\u7684\u4ea4\u96c6\u5e76\u653e\u5165dest\u96c6\u5408\uff0c\u5982\u679c\u9047\u5230\u76f8\u540c\u503c\u4e0d\u540c\u5206\u6570\uff0c\u5219\u6309\u7167aggregate\u8fdb\u884c\u64cd\u4f5c # aggregate\u7684\u503c\u4e3a: SUM MIN MAX In [86]: r.zinterstore(\"zset_name2\",(\"zset_name1\",\"zset_name\"),aggregate=\"MAX\") Out[86]: 1 127.0.0.1:6379> keys * 1) \"zset_name\" 2) \"zset_name2\" 3) \"zset_name1\" 4) \"zset1\" 127.0.0.1:6379> ZRANGE zset_name2 0 -1 WITHSCORES 1) \"a1\" 2) \"7\"","title":"3.5.12 zinterstore"},{"location":"python/lib/nosql/redis/redis.index/#3514-zunionstore","text":"zunionstore(dest, keys, aggregate=None) \u83b7\u53d6\u4e24\u4e2a\u6709\u5e8f\u96c6\u5408\u7684\u5e76\u96c6\u5e76\u653e\u5165dest\u96c6\u5408\uff0c\u5176\u4ed6\u540czinterstore\uff0c In [89]: r.zadd(\"zset_union_name1\", \"a1\", 6, \"a2\", 2,\"a3\",5) Out[89]: 3 In [90]: r.zadd('zset_union_name2', a1=7,b1=10, b2=5) Out[90]: 3 In [91]: r.zunionstore(\"zset_union_name\",(\"zset_union_name1\",\"zset_union_name2\"),aggregate=\"MAX\") Out[91]: 5 In [92]: print(r.zscan(\"zset_union_name\")) (0, [(b'a2', 2.0), (b'a3', 5.0), (b'b2', 5.0), (b'a1', 7.0), (b'b1', 10.0)])","title":"3.5.14 zunionstore"},{"location":"python/lib/nosql/redis/redis.index/#36","text":"","title":"3.6 \u5176\u4ed6\u64cd\u4f5c"},{"location":"python/lib/nosql/redis/redis.index/#361-delete","text":"delete(*names) #\u6839\u636ename\u5220\u9664redis\u4e2d\u7684\u4efb\u610f\u6570\u636e\u7c7b\u578b In [80]: r.exists('name') Out[80]: True In [81]: r.delete('name') Out[81]: 1 In [82]: r.exists('name') Out[82]: False In [83]: r.get('name')","title":"3.6.1 delete"},{"location":"python/lib/nosql/redis/redis.index/#362-exists","text":"exists(name) #\u68c0\u6d4bredis\u7684name\u662f\u5426\u5b58\u5728 In [79]: r.get('name') Out[79]: b'zhangsanlisi' In [80]: r.exists('name') Out[80]: True","title":"3.6.2 exists"},{"location":"python/lib/nosql/redis/redis.index/#363-keys","text":"keys(pattern='*') #\u6839\u636e* \uff1f\u7b49\u901a\u914d\u7b26\u5339\u914d\u83b7\u53d6redis\u7684name In [88]: r.keys(pattern='*') Out[88]: [b'num', b'k1', b'k2', b'mount', b'k3']","title":"3.6.3 keys"},{"location":"python/lib/nosql/redis/redis.index/#364-expire","text":"expire(name ,time) # \u4e3a\u67d0\u4e2aname\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4 In [92]: r.get('k1') Out[92]: b'v1' In [93]: r.expire('k1',2) # \u914d\u7f6e\u8fc7\u671f\u65f6\u95f4\u4e3a2\u79d2 Out[93]: True In [94]: r.get('k1')","title":"3.6.4 expire"},{"location":"python/lib/nosql/redis/redis.index/#365-rename","text":"rename(src, dst) # \u91cd\u547d\u540d In [97]: r.rename('k2','k22') Out[97]: True In [98]: r.get('k2') In [99]: r.get('k22') Out[99]: b'v2'","title":"3.6.5 rename"},{"location":"python/lib/nosql/redis/redis.index/#366-move","text":"move(name, db)) # \u5c06redis\u7684\u67d0\u4e2a\u503c\u79fb\u52a8\u5230\u6307\u5b9a\u7684db\u4e0b In [105]: r.move('k3',2) Out[105]: True 127.0.0.1:6379> keys * 1) \"num\" 2) \"k22\" 3) \"mount\" 127.0.0.1:6379[3]> select 2 OK 127.0.0.1:6379[2]> keys * 1) \"k3\" 127.0.0.1:6379[2]>","title":"3.6.6 move"},{"location":"python/lib/nosql/redis/redis.index/#367-randomkey","text":"randomkey() #\u968f\u673a\u83b7\u53d6\u4e00\u4e2aredis\u7684name\uff08\u4e0d\u5220\u9664\uff09 In [100]: r.randomkey() Out[100]: b'mount' In [101]: r.randomkey() Out[101]: b'k3'","title":"3.6.7 randomkey"},{"location":"python/lib/nosql/redis/redis.index/#368-type","text":"type(name) # \u83b7\u53d6name\u5bf9\u5e94\u503c\u7684\u7c7b\u578b In [102]: r.type('k3') Out[102]: b'string'","title":"3.6.8 type"},{"location":"python/lib/nosql/redis/redis.index/#369-dbsize","text":"\u6570\u636e\u5e93\u4e2d\u591a\u5c11\u4e2a\u6761\u6570 In [96]: r.dbsize() Out[96]: 1","title":"3.6.9 dbsize"},{"location":"python/lib/nosql/redis/redis.index/#3610-flushdbflushall","text":"flushdb \u6e05\u7a7a\u6570\u636e\u5e93 flushall \u5220\u9664\u6240\u6709\u73b0\u6709\u7684\u6570\u636e\u5e93 In [97]: r.flushdb() Out[97]: True In [99]: r.flushall() Out[99]: True redis\u64cd\u4f5c 127.0.0.1:6379> SELECT 1 OK 127.0.0.1:6379[1]> set k1 1 OK 127.0.0.1:6379[1]> select 2 OK 127.0.0.1:6379[2]> set k2 2 OK 127.0.0.1:6379[2]> keys * 1) \"k2\" 127.0.0.1:6379[2]> FLUSHDB OK 127.0.0.1:6379[2]> keys * (empty list or set) 127.0.0.1:6379[2]> select 1 OK 127.0.0.1:6379[1]> keys * 1) \"k1\" 127.0.0.1:6379[1]> 127.0.0.1:6379[1]> 127.0.0.1:6379[1]> select 2 OK 127.0.0.1:6379[2]> set k2 2 OK 127.0.0.1:6379[2]> FLUSHALL OK 127.0.0.1:6379[2]> keys * (empty list or set) 127.0.0.1:6379[2]> select 1 OK 127.0.0.1:6379[1]> keys * (empty list or set)","title":"3.6.10 flushdb/flushall"},{"location":"python/lib/nosql/redis/redis.index/#3611-save","text":"\u5f3a\u884c\u628a\u6570\u636e\u5e93\u4fdd\u5b58\u5230\u786c\u76d8\u3002\u4fdd\u5b58\u65f6\u963b\u585e In [98]: r.save() Out[98]: True","title":"3.6.11 save"},{"location":"python/lib/nosql/redis/redis.pipeline/","text":"1. Python Redis pipeline\u4ecb\u7ecd \u00b6 Redis\u662f\u5efa\u7acb\u5728TCP\u534f\u8bae\u57fa\u7840\u4e0a\u7684CS\u67b6\u6784\uff0c\u5ba2\u6237\u7aefclient\u5bf9redis server\u91c7\u53d6\u8bf7\u6c42\u54cd\u5e94\u7684\u65b9\u5f0f\u4ea4\u4e92\u3002 \u4e00\u822c\u6765\u8bf4\u5ba2\u6237\u7aef\u4ece\u63d0\u4ea4\u8bf7\u6c42\u5230\u5f97\u5230\u670d\u52a1\u5668\u76f8\u5e94\uff0c\u9700\u8981\u4f20\u9001\u4e24\u4e2atcp\u62a5\u6587\u3002 Redis\u7684pipeline(\u7ba1\u9053)\u529f\u80fd\u5728\u547d\u4ee4\u884c\u4e2d\u6ca1\u6709\uff0c\u4f46redis\u662f\u652f\u6301pipeline\u7684\uff0c\u800c\u4e14\u5728\u5404\u4e2a\u8bed\u8a00\u7248\u7684client\u4e2d\u90fd\u6709\u76f8\u5e94\u7684\u5b9e\u73b0\u3002 \u7531\u4e8e\u7f51\u7edc\u5f00\u9500\u5ef6\u8fdf\uff0c\u5c31\u7b97redis server\u7aef\u6709\u5f88\u5f3a\u7684\u5904\u7406\u80fd\u529b\uff0c\u4e5f\u4f1a\u7531\u4e8e\u6536\u5230\u7684client\u6d88\u606f\u5c11\uff0c\u800c\u9020\u6210\u541e\u5410\u91cf\u5c0f\u3002\u5f53client \u4f7f\u7528pipelining \u53d1\u9001\u547d\u4ee4\u65f6\uff0credis server\u5fc5\u987b\u5c06\u90e8\u5206\u8bf7\u6c42\u653e\u5230\u961f\u5217\u4e2d\uff08\u4f7f\u7528\u5185\u5b58\uff09\uff0c\u6267\u884c\u5b8c\u6bd5\u540e\u4e00\u6b21\u6027\u53d1\u9001\u7ed3\u679c\uff1b\u5982\u679c\u53d1\u9001\u7684\u547d\u4ee4\u5f88\u591a\u7684\u8bdd\uff0c\u5efa\u8bae\u5bf9\u8fd4\u56de\u7684\u7ed3\u679c\u52a0\u6807\u7b7e\uff0c\u5f53\u7136\u8fd9\u4e5f\u4f1a\u589e\u52a0\u4f7f\u7528\u7684\u5185\u5b58\uff1b Pipeline\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u975e\u5e38\u6709\u7528\uff0c\u6bd4\u5982\u6709\u591a\u4e2acommand\u9700\u8981\u88ab\u201c\u53ca\u65f6\u7684\u201d\u63d0\u4ea4\uff0c\u800c\u4e14\u4ed6\u4eec\u5bf9\u76f8\u5e94\u7ed3\u679c\u6ca1\u6709\u4e92\u76f8\u4f9d\u8d56\uff0c\u5bf9\u7ed3\u679c\u54cd\u5e94\u4e5f\u65e0\u9700\u7acb\u5373\u83b7\u5f97\uff0c\u90a3\u4e48pipeline\u5c31\u53ef\u4ee5\u5145\u5f53\u8fd9\u79cd\u201c\u6279\u5904\u7406\u201d\u7684\u5de5\u5177\uff1b\u800c\u4e14\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\uff0c\u53ef\u4ee5\u8f83\u5927\u7684\u63d0\u5347\u6027\u80fd\uff0c\u6027\u80fd\u63d0\u5347\u7684\u539f\u56e0\u4e3b\u8981\u662fTCP\u8fde\u63a5\u4e2d\u51cf\u5c11\u4e86\u201c\u4ea4\u4e92\u5f80\u8fd4\u201d\u7684\u65f6\u95f4\u3002 \u4e0d\u8fc7\u5728\u7f16\u7801\u65f6\u8bf7\u6ce8\u610f\uff0cpipeline\u671f\u95f4\u5c06\u201c\u72ec\u5360\u201d\u94fe\u63a5\uff0c\u6b64\u671f\u95f4\u5c06\u4e0d\u80fd\u8fdb\u884c\u975e\u201c\u7ba1\u9053\u201d\u7c7b\u578b\u7684\u5176\u4ed6\u64cd\u4f5c\uff0c\u76f4\u5230pipeline\u5173\u95ed\uff1b\u5982\u679c\u4f60\u7684pipeline\u7684\u6307\u4ee4\u96c6\u5f88\u5e9e\u5927\uff0c\u4e3a\u4e86\u4e0d\u5e72\u6270\u94fe\u63a5\u4e2d\u7684\u5176\u4ed6\u64cd\u4f5c\uff0c\u4f60\u53ef\u4ee5\u4e3apipeline\u64cd\u4f5c\u65b0\u5efaClient\u94fe\u63a5\uff0c\u8ba9pipeline\u548c\u5176\u4ed6\u6b63\u5e38\u64cd\u4f5c\u5206\u79bb\u57282\u4e2aclient\u4e2d\u3002\u4e0d\u8fc7pipeline\u4e8b\u5b9e\u4e0a\u6240\u80fd\u5bb9\u5fcd\u7684\u64cd\u4f5c\u4e2a\u6570\uff0c\u548csocket-output\u7f13\u51b2\u533a\u5927\u5c0f/\u8fd4\u56de\u7ed3\u679c\u7684\u6570\u636e\u5c3a\u5bf8\u90fd\u6709\u5f88\u5927\u7684\u5173\u7cfb\uff1b\u540c\u65f6\u4e5f\u610f\u5473\u7740\u6bcf\u4e2aredis-server\u540c\u65f6\u6240\u80fd\u652f\u6491\u7684pipeline\u94fe\u63a5\u7684\u4e2a\u6570\uff0c\u4e5f\u662f\u6709\u9650\u7684\uff0c\u8fd9\u5c06\u53d7\u9650\u4e8eserver\u7684\u7269\u7406\u5185\u5b58\u6216\u7f51\u7edc\u63a5\u53e3\u7684\u7f13\u51b2\u80fd\u529b\u3002 Redis\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\uff08CS\uff09\u6a21\u578b\u548c\u8bf7\u6c42/\u54cd\u5e94\u534f\u8bae\u7684TCP\u670d\u52a1\u5668\u3002\u8fd9\u610f\u5473\u7740\u901a\u5e38\u60c5\u51b5\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u4f1a\u9075\u5faa\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u4e00\u4e2a\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u76d1\u542cSocket\u8fd4\u56de\uff0c\u901a\u5e38\u662f\u4ee5\u963b\u585e\u6a21\u5f0f\uff0c\u7b49\u5f85\u670d\u52a1\u7aef\u54cd\u5e94\u3002 \u670d\u52a1\u7aef\u5904\u7406\u547d\u4ee4\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 Redis\u5ba2\u6237\u7aef\u4e0eRedis\u670d\u52a1\u5668\u4e4b\u95f4\u4f7f\u7528TCP\u534f\u8bae\u8fdb\u884c\u8fde\u63a5\uff0c\u4e00\u4e2a\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2asocket\u8fde\u63a5\u53d1\u8d77\u591a\u4e2a\u8bf7\u6c42\u547d\u4ee4\u3002\u6bcf\u4e2a\u8bf7\u6c42\u547d\u4ee4\u53d1\u51fa\u540eclient\u901a\u5e38\u4f1a\u963b\u585e\u5e76\u7b49\u5f85redis\u670d\u52a1\u5668\u5904\u7406\uff0credis\u5904\u7406\u5b8c\u8bf7\u6c42\u547d\u4ee4\u540e\u4f1a\u5c06\u7ed3\u679c\u901a\u8fc7\u54cd\u5e94\u62a5\u6587\u8fd4\u56de\u7ed9client\uff0c\u56e0\u6b64\u5f53\u6267\u884c\u591a\u6761\u547d\u4ee4\u7684\u65f6\u5019\u90fd\u9700\u8981\u7b49\u5f85\u4e0a\u4e00\u6761\u547d\u4ee4\u6267\u884c\u5b8c\u6bd5\u624d\u80fd\u6267\u884c\u3002\u6bd4\u5982\uff1a 127.0.0.1:6379> get k1 \"v1\" 127.0.0.1:6379> get k2 \"v2\" 127.0.0.1:6379> get k3 \"v3\" \u7531\u4e8e\u901a\u4fe1\u4f1a\u6709\u7f51\u7edc\u5ef6\u8fdf\uff0c\u5047\u5982client\u548cserver\u4e4b\u95f4\u7684\u5305\u4f20\u8f93\u65f6\u95f4\u9700\u89810.125\u79d2\u3002\u90a3\u4e48\u4e0a\u9762\u7684\u4e09\u4e2a\u547d\u4ee46\u4e2a\u62a5\u6587\u81f3\u5c11\u9700\u89810.75\u79d2\u624d\u80fd\u5b8c\u6210\u3002\u8fd9\u6837\u5373\u4f7fredis\u6bcf\u79d2\u80fd\u5904\u7406100\u4e2a\u547d\u4ee4\uff0c\u800c\u6211\u4eec\u7684client\u4e5f\u53ea\u80fd\u4e00\u79d2\u949f\u53d1\u51fa\u56db\u4e2a\u547d\u4ee4\u3002\u8fd9\u663e\u7136\u6ca1\u6709\u5145\u5206\u5229\u7528 redis\u7684\u5904\u7406\u80fd\u529b\u3002 \u800c\u7ba1\u9053\uff08pipeline\uff09\u53ef\u4ee5\u4e00\u6b21\u6027\u53d1\u9001\u591a\u6761\u547d\u4ee4\u5e76\u5728\u6267\u884c\u5b8c\u540e\u4e00\u6b21\u6027\u5c06\u7ed3\u679c\u8fd4\u56de\uff0cpipeline\u901a\u8fc7\u51cf\u5c11\u5ba2\u6237\u7aef\u4e0eredis\u7684\u901a\u4fe1\u6b21\u6570\u6765\u5b9e\u73b0\u964d\u4f4e\u5f80\u8fd4\u5ef6\u65f6\u65f6\u95f4\uff0c\u800c\u4e14Pipeline \u5b9e\u73b0\u7684\u539f\u7406\u662f\u961f\u5217\uff0c\u800c\u961f\u5217\u7684\u539f\u7406\u662f\u65f6\u5148\u8fdb\u5148\u51fa\uff0c\u8fd9\u6837\u5c31\u4fdd\u8bc1\u6570\u636e\u7684\u987a\u5e8f\u6027\u3002 Pipeline \u7684\u9ed8\u8ba4\u7684\u540c\u6b65\u7684\u4e2a\u6570\u4e3a53\u4e2a\uff0c\u4e5f\u5c31\u662f\u8bf4arges\u4e2d\u7d2f\u52a0\u523053\u6761\u6570\u636e\u65f6\u4f1a\u628a\u6570\u636e\u63d0\u4ea4\u3002\u5176\u8fc7\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\uff1aclient\u53ef\u4ee5\u5c06\u4e09\u4e2a\u547d\u4ee4\u653e\u5230\u4e00\u4e2atcp\u62a5\u6587\u4e00\u8d77\u53d1\u9001\uff0cserver\u5219\u53ef\u4ee5\u5c06\u4e09\u6761\u547d\u4ee4\u7684\u5904\u7406\u7ed3\u679c\u653e\u5230\u4e00\u4e2atcp\u62a5\u6587\u8fd4\u56de\u3002 \u6ce8\u610f \u7528 pipeline\u65b9\u5f0f\u6253\u5305\u547d\u4ee4\u53d1\u9001\uff0credis\u5fc5\u987b\u5728\u5904\u7406\u5b8c\u6240\u6709\u547d\u4ee4\u524d\u5148\u7f13\u5b58\u8d77\u6240\u6709\u547d\u4ee4\u7684\u5904\u7406\u7ed3\u679c\u3002\u6253\u5305\u7684\u547d\u4ee4\u8d8a\u591a\uff0c\u7f13\u5b58\u6d88\u8017\u5185\u5b58\u4e5f\u8d8a\u591a\u3002\u6240\u4ee5\u5e76\u4e0d\u662f\u6253\u5305\u7684\u547d\u4ee4\u8d8a\u591a\u8d8a\u597d\u3002\u5177\u4f53\u591a\u5c11\u5408\u9002\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u6d4b\u8bd5\u3002 2. Python Redis pipeline\u64cd\u4f5c \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/2/21 13:25 @File : pipeline_demo.py @Author : summer @Software: PyCharm \"\"\" import redis import time r = redis.Redis(host='127.0.0.1', port=6379, password='') def try_pipeline(): start = time.time() with r.pipeline(transaction=False) as p: p.sadd('set1', 1).sadd('set2', 2).srem('set2', 2).lpush('list1', 1).lrange('list2', 0, -1) p.execute() print(time.time() - start) def without_pipeline(): start = time.time() r.sadd('seta', 1) r.sadd('seta', 2) r.srem('seta', 2) r.lpush('lista', 1 r.lrange('lista', 0, -1) print(time.time() - start) if __name__ == '__main__': try_pipeline() without_pipeline() \u8fd0\u884c\u7ed3\u679c D:\\code\\code-flask\\code-flask\\venv\\Scripts\\python.exe D:/code/code-flask/code-flask/2019-02-20/1.py 0.004987478256225586 0.03494906425476074 try_pipeline\u5e73\u5747\u5904\u7406\u65f6\u95f4\uff1a0.004987478256225586 without_pipeline\u5e73\u5747\u5904\u7406\u65f6\u95f4\uff1a0.03494906425476074 \u6211\u4eec\u7684\u6279\u91cf\u91cc\u67095\u4e2a\u64cd\u4f5c\uff0c\u5728\u5904\u7406\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u6027\u80fd\u63d0\u5347\u4e867\u500d\uff01 pipeline\u6279\u91cf\u64cd\u4f5c\u53ea\u8fdb\u884c\u4e00\u6b21\u7f51\u7edc\u5f80\u8fd4\uff0c\u53ef\u4ee5\u770b\u5230\u8282\u7701\u7684\u65f6\u95f4\u57fa\u672c\u90fd\u662f\u7f51\u8def\u5ef6\u8fdf\u3002 2\u3001pipeline\u4e0etransation pipeline\u4e0d\u4ec5\u4ec5\u7528\u6765\u6279\u91cf\u7684\u63d0\u4ea4\u547d\u4ee4\uff0c\u8fd8\u7528\u6765\u5b9e\u73b0\u4e8b\u52a1transation\u3002 \u4f7f\u7528transaction\u4e0e\u5426\u4e0d\u540c\u4e4b\u5904\u5728\u4e0e\u521b\u5efapipeline\u5b9e\u4f8b\u7684\u65f6\u5019\uff0ctransaction\u662f\u5426\u6253\u5f00\uff0c\u9ed8\u8ba4\u662f\u6253\u5f00\u7684\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/2/21 13:25 @File : pipeline_demo.py @Author : summer @Software: PyCharm \"\"\" # -*- coding:utf-8 -*- import redis from redis import WatchError from concurrent.futures import ProcessPoolExecutor r = redis.Redis(host='127.0.0.1', port=6379) # \u51cf\u5e93\u5b58\u51fd\u6570, \u5faa\u73af\u76f4\u5230\u51cf\u5e93\u5b58\u5b8c\u6210 # \u5e93\u5b58\u5145\u8db3, \u51cf\u5e93\u5b58\u6210\u529f, \u8fd4\u56deTrue # \u5e93\u5b58\u4e0d\u8db3, \u51cf\u5e93\u5b58\u5931\u8d25, \u8fd4\u56deFalse def decr_stock(): # python\u4e2dredis\u4e8b\u52a1\u662f\u901a\u8fc7pipeline\u7684\u5c01\u88c5\u5b9e\u73b0\u7684 with r.pipeline() as pipe: while True: try: # watch\u5e93\u5b58\u952e, multi\u540e\u5982\u679c\u8be5key\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u6539\u53d8, \u4e8b\u52a1\u64cd\u4f5c\u4f1a\u629b\u51faWatchError\u5f02\u5e38 pipe.watch('stock:count') count = int(pipe.get('stock:count')) if count > 0: # \u6709\u5e93\u5b58 # \u4e8b\u52a1\u5f00\u59cb pipe.multi() pipe.decr('stock:count') # \u628a\u547d\u4ee4\u63a8\u9001\u8fc7\u53bb # execute\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u5217\u8868, \u8fd9\u91cc\u53ea\u6709\u4e00\u4e2adecr\u8fd4\u56de\u5f53\u524d\u503c print(pipe.execute()[0]) return True else: return False except WatchError as ex: # \u6253\u5370WatchError\u5f02\u5e38, \u89c2\u5bdf\u88abwatch\u9501\u4f4f\u7684\u60c5\u51b5 print(ex, '\u9501\u4f4f\u4e86') pipe.unwatch() def worker(): while True: # \u6ca1\u6709\u5e93\u5b58\u5c31\u9000\u51fa if not decr_stock(): break # \u5b9e\u9a8c\u5f00\u59cb \u8bbe\u7f6e\u5e93\u5b58\u4e3a20 r.set(\"stock:count\", 20) # \u591a\u8fdb\u7a0b\u6a21\u62df\u591a\u4e2a\u5ba2\u6237\u7aef\u63d0\u4ea4 if __name__ == '__main__': with ProcessPoolExecutor(max_workers=2) as pool: for _ in range(10): pool.submit(worker) \u8fd0\u884c\u7ed3\u679c D:\\code\\code-flask\\code-flask\\venv\\Scripts\\python.exe D:/code/code-flask/code-flask/2019-02-20/1.py 19 18 17 16 19 18 Watched variable changed. \u9501\u4f4f\u4e86 17 Watched variable changed. \u9501\u4f4f\u4e86 16 Watched variable changed. \u9501\u4f4f\u4e86 15 Watched variable changed. \u9501\u4f4f\u4e86 Watched variable changed. \u9501\u4f4f\u4e86 14 13 Watched variable changed. \u9501\u4f4f\u4e86 12 Watched variable changed. \u9501\u4f4f\u4e86 11 Watched variable changed. \u9501\u4f4f\u4e86 10 9 Watched variable changed. \u9501\u4f4f\u4e86 8 7 6 5 Watched variable changed. \u9501\u4f4f\u4e86 4 3 2 1 Watched variable changed. \u9501\u4f4f\u4e86 0 Process finished with exit code 0","title":"2. redis pipeline"},{"location":"python/lib/nosql/redis/redis.pipeline/#1-python-redis-pipeline","text":"Redis\u662f\u5efa\u7acb\u5728TCP\u534f\u8bae\u57fa\u7840\u4e0a\u7684CS\u67b6\u6784\uff0c\u5ba2\u6237\u7aefclient\u5bf9redis server\u91c7\u53d6\u8bf7\u6c42\u54cd\u5e94\u7684\u65b9\u5f0f\u4ea4\u4e92\u3002 \u4e00\u822c\u6765\u8bf4\u5ba2\u6237\u7aef\u4ece\u63d0\u4ea4\u8bf7\u6c42\u5230\u5f97\u5230\u670d\u52a1\u5668\u76f8\u5e94\uff0c\u9700\u8981\u4f20\u9001\u4e24\u4e2atcp\u62a5\u6587\u3002 Redis\u7684pipeline(\u7ba1\u9053)\u529f\u80fd\u5728\u547d\u4ee4\u884c\u4e2d\u6ca1\u6709\uff0c\u4f46redis\u662f\u652f\u6301pipeline\u7684\uff0c\u800c\u4e14\u5728\u5404\u4e2a\u8bed\u8a00\u7248\u7684client\u4e2d\u90fd\u6709\u76f8\u5e94\u7684\u5b9e\u73b0\u3002 \u7531\u4e8e\u7f51\u7edc\u5f00\u9500\u5ef6\u8fdf\uff0c\u5c31\u7b97redis server\u7aef\u6709\u5f88\u5f3a\u7684\u5904\u7406\u80fd\u529b\uff0c\u4e5f\u4f1a\u7531\u4e8e\u6536\u5230\u7684client\u6d88\u606f\u5c11\uff0c\u800c\u9020\u6210\u541e\u5410\u91cf\u5c0f\u3002\u5f53client \u4f7f\u7528pipelining \u53d1\u9001\u547d\u4ee4\u65f6\uff0credis server\u5fc5\u987b\u5c06\u90e8\u5206\u8bf7\u6c42\u653e\u5230\u961f\u5217\u4e2d\uff08\u4f7f\u7528\u5185\u5b58\uff09\uff0c\u6267\u884c\u5b8c\u6bd5\u540e\u4e00\u6b21\u6027\u53d1\u9001\u7ed3\u679c\uff1b\u5982\u679c\u53d1\u9001\u7684\u547d\u4ee4\u5f88\u591a\u7684\u8bdd\uff0c\u5efa\u8bae\u5bf9\u8fd4\u56de\u7684\u7ed3\u679c\u52a0\u6807\u7b7e\uff0c\u5f53\u7136\u8fd9\u4e5f\u4f1a\u589e\u52a0\u4f7f\u7528\u7684\u5185\u5b58\uff1b Pipeline\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u975e\u5e38\u6709\u7528\uff0c\u6bd4\u5982\u6709\u591a\u4e2acommand\u9700\u8981\u88ab\u201c\u53ca\u65f6\u7684\u201d\u63d0\u4ea4\uff0c\u800c\u4e14\u4ed6\u4eec\u5bf9\u76f8\u5e94\u7ed3\u679c\u6ca1\u6709\u4e92\u76f8\u4f9d\u8d56\uff0c\u5bf9\u7ed3\u679c\u54cd\u5e94\u4e5f\u65e0\u9700\u7acb\u5373\u83b7\u5f97\uff0c\u90a3\u4e48pipeline\u5c31\u53ef\u4ee5\u5145\u5f53\u8fd9\u79cd\u201c\u6279\u5904\u7406\u201d\u7684\u5de5\u5177\uff1b\u800c\u4e14\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\uff0c\u53ef\u4ee5\u8f83\u5927\u7684\u63d0\u5347\u6027\u80fd\uff0c\u6027\u80fd\u63d0\u5347\u7684\u539f\u56e0\u4e3b\u8981\u662fTCP\u8fde\u63a5\u4e2d\u51cf\u5c11\u4e86\u201c\u4ea4\u4e92\u5f80\u8fd4\u201d\u7684\u65f6\u95f4\u3002 \u4e0d\u8fc7\u5728\u7f16\u7801\u65f6\u8bf7\u6ce8\u610f\uff0cpipeline\u671f\u95f4\u5c06\u201c\u72ec\u5360\u201d\u94fe\u63a5\uff0c\u6b64\u671f\u95f4\u5c06\u4e0d\u80fd\u8fdb\u884c\u975e\u201c\u7ba1\u9053\u201d\u7c7b\u578b\u7684\u5176\u4ed6\u64cd\u4f5c\uff0c\u76f4\u5230pipeline\u5173\u95ed\uff1b\u5982\u679c\u4f60\u7684pipeline\u7684\u6307\u4ee4\u96c6\u5f88\u5e9e\u5927\uff0c\u4e3a\u4e86\u4e0d\u5e72\u6270\u94fe\u63a5\u4e2d\u7684\u5176\u4ed6\u64cd\u4f5c\uff0c\u4f60\u53ef\u4ee5\u4e3apipeline\u64cd\u4f5c\u65b0\u5efaClient\u94fe\u63a5\uff0c\u8ba9pipeline\u548c\u5176\u4ed6\u6b63\u5e38\u64cd\u4f5c\u5206\u79bb\u57282\u4e2aclient\u4e2d\u3002\u4e0d\u8fc7pipeline\u4e8b\u5b9e\u4e0a\u6240\u80fd\u5bb9\u5fcd\u7684\u64cd\u4f5c\u4e2a\u6570\uff0c\u548csocket-output\u7f13\u51b2\u533a\u5927\u5c0f/\u8fd4\u56de\u7ed3\u679c\u7684\u6570\u636e\u5c3a\u5bf8\u90fd\u6709\u5f88\u5927\u7684\u5173\u7cfb\uff1b\u540c\u65f6\u4e5f\u610f\u5473\u7740\u6bcf\u4e2aredis-server\u540c\u65f6\u6240\u80fd\u652f\u6491\u7684pipeline\u94fe\u63a5\u7684\u4e2a\u6570\uff0c\u4e5f\u662f\u6709\u9650\u7684\uff0c\u8fd9\u5c06\u53d7\u9650\u4e8eserver\u7684\u7269\u7406\u5185\u5b58\u6216\u7f51\u7edc\u63a5\u53e3\u7684\u7f13\u51b2\u80fd\u529b\u3002 Redis\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\uff08CS\uff09\u6a21\u578b\u548c\u8bf7\u6c42/\u54cd\u5e94\u534f\u8bae\u7684TCP\u670d\u52a1\u5668\u3002\u8fd9\u610f\u5473\u7740\u901a\u5e38\u60c5\u51b5\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u4f1a\u9075\u5faa\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u4e00\u4e2a\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u76d1\u542cSocket\u8fd4\u56de\uff0c\u901a\u5e38\u662f\u4ee5\u963b\u585e\u6a21\u5f0f\uff0c\u7b49\u5f85\u670d\u52a1\u7aef\u54cd\u5e94\u3002 \u670d\u52a1\u7aef\u5904\u7406\u547d\u4ee4\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 Redis\u5ba2\u6237\u7aef\u4e0eRedis\u670d\u52a1\u5668\u4e4b\u95f4\u4f7f\u7528TCP\u534f\u8bae\u8fdb\u884c\u8fde\u63a5\uff0c\u4e00\u4e2a\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2asocket\u8fde\u63a5\u53d1\u8d77\u591a\u4e2a\u8bf7\u6c42\u547d\u4ee4\u3002\u6bcf\u4e2a\u8bf7\u6c42\u547d\u4ee4\u53d1\u51fa\u540eclient\u901a\u5e38\u4f1a\u963b\u585e\u5e76\u7b49\u5f85redis\u670d\u52a1\u5668\u5904\u7406\uff0credis\u5904\u7406\u5b8c\u8bf7\u6c42\u547d\u4ee4\u540e\u4f1a\u5c06\u7ed3\u679c\u901a\u8fc7\u54cd\u5e94\u62a5\u6587\u8fd4\u56de\u7ed9client\uff0c\u56e0\u6b64\u5f53\u6267\u884c\u591a\u6761\u547d\u4ee4\u7684\u65f6\u5019\u90fd\u9700\u8981\u7b49\u5f85\u4e0a\u4e00\u6761\u547d\u4ee4\u6267\u884c\u5b8c\u6bd5\u624d\u80fd\u6267\u884c\u3002\u6bd4\u5982\uff1a 127.0.0.1:6379> get k1 \"v1\" 127.0.0.1:6379> get k2 \"v2\" 127.0.0.1:6379> get k3 \"v3\" \u7531\u4e8e\u901a\u4fe1\u4f1a\u6709\u7f51\u7edc\u5ef6\u8fdf\uff0c\u5047\u5982client\u548cserver\u4e4b\u95f4\u7684\u5305\u4f20\u8f93\u65f6\u95f4\u9700\u89810.125\u79d2\u3002\u90a3\u4e48\u4e0a\u9762\u7684\u4e09\u4e2a\u547d\u4ee46\u4e2a\u62a5\u6587\u81f3\u5c11\u9700\u89810.75\u79d2\u624d\u80fd\u5b8c\u6210\u3002\u8fd9\u6837\u5373\u4f7fredis\u6bcf\u79d2\u80fd\u5904\u7406100\u4e2a\u547d\u4ee4\uff0c\u800c\u6211\u4eec\u7684client\u4e5f\u53ea\u80fd\u4e00\u79d2\u949f\u53d1\u51fa\u56db\u4e2a\u547d\u4ee4\u3002\u8fd9\u663e\u7136\u6ca1\u6709\u5145\u5206\u5229\u7528 redis\u7684\u5904\u7406\u80fd\u529b\u3002 \u800c\u7ba1\u9053\uff08pipeline\uff09\u53ef\u4ee5\u4e00\u6b21\u6027\u53d1\u9001\u591a\u6761\u547d\u4ee4\u5e76\u5728\u6267\u884c\u5b8c\u540e\u4e00\u6b21\u6027\u5c06\u7ed3\u679c\u8fd4\u56de\uff0cpipeline\u901a\u8fc7\u51cf\u5c11\u5ba2\u6237\u7aef\u4e0eredis\u7684\u901a\u4fe1\u6b21\u6570\u6765\u5b9e\u73b0\u964d\u4f4e\u5f80\u8fd4\u5ef6\u65f6\u65f6\u95f4\uff0c\u800c\u4e14Pipeline \u5b9e\u73b0\u7684\u539f\u7406\u662f\u961f\u5217\uff0c\u800c\u961f\u5217\u7684\u539f\u7406\u662f\u65f6\u5148\u8fdb\u5148\u51fa\uff0c\u8fd9\u6837\u5c31\u4fdd\u8bc1\u6570\u636e\u7684\u987a\u5e8f\u6027\u3002 Pipeline \u7684\u9ed8\u8ba4\u7684\u540c\u6b65\u7684\u4e2a\u6570\u4e3a53\u4e2a\uff0c\u4e5f\u5c31\u662f\u8bf4arges\u4e2d\u7d2f\u52a0\u523053\u6761\u6570\u636e\u65f6\u4f1a\u628a\u6570\u636e\u63d0\u4ea4\u3002\u5176\u8fc7\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\uff1aclient\u53ef\u4ee5\u5c06\u4e09\u4e2a\u547d\u4ee4\u653e\u5230\u4e00\u4e2atcp\u62a5\u6587\u4e00\u8d77\u53d1\u9001\uff0cserver\u5219\u53ef\u4ee5\u5c06\u4e09\u6761\u547d\u4ee4\u7684\u5904\u7406\u7ed3\u679c\u653e\u5230\u4e00\u4e2atcp\u62a5\u6587\u8fd4\u56de\u3002 \u6ce8\u610f \u7528 pipeline\u65b9\u5f0f\u6253\u5305\u547d\u4ee4\u53d1\u9001\uff0credis\u5fc5\u987b\u5728\u5904\u7406\u5b8c\u6240\u6709\u547d\u4ee4\u524d\u5148\u7f13\u5b58\u8d77\u6240\u6709\u547d\u4ee4\u7684\u5904\u7406\u7ed3\u679c\u3002\u6253\u5305\u7684\u547d\u4ee4\u8d8a\u591a\uff0c\u7f13\u5b58\u6d88\u8017\u5185\u5b58\u4e5f\u8d8a\u591a\u3002\u6240\u4ee5\u5e76\u4e0d\u662f\u6253\u5305\u7684\u547d\u4ee4\u8d8a\u591a\u8d8a\u597d\u3002\u5177\u4f53\u591a\u5c11\u5408\u9002\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u6d4b\u8bd5\u3002","title":"1. Python Redis pipeline\u4ecb\u7ecd"},{"location":"python/lib/nosql/redis/redis.pipeline/#2-python-redis-pipeline","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/2/21 13:25 @File : pipeline_demo.py @Author : summer @Software: PyCharm \"\"\" import redis import time r = redis.Redis(host='127.0.0.1', port=6379, password='') def try_pipeline(): start = time.time() with r.pipeline(transaction=False) as p: p.sadd('set1', 1).sadd('set2', 2).srem('set2', 2).lpush('list1', 1).lrange('list2', 0, -1) p.execute() print(time.time() - start) def without_pipeline(): start = time.time() r.sadd('seta', 1) r.sadd('seta', 2) r.srem('seta', 2) r.lpush('lista', 1 r.lrange('lista', 0, -1) print(time.time() - start) if __name__ == '__main__': try_pipeline() without_pipeline() \u8fd0\u884c\u7ed3\u679c D:\\code\\code-flask\\code-flask\\venv\\Scripts\\python.exe D:/code/code-flask/code-flask/2019-02-20/1.py 0.004987478256225586 0.03494906425476074 try_pipeline\u5e73\u5747\u5904\u7406\u65f6\u95f4\uff1a0.004987478256225586 without_pipeline\u5e73\u5747\u5904\u7406\u65f6\u95f4\uff1a0.03494906425476074 \u6211\u4eec\u7684\u6279\u91cf\u91cc\u67095\u4e2a\u64cd\u4f5c\uff0c\u5728\u5904\u7406\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u6027\u80fd\u63d0\u5347\u4e867\u500d\uff01 pipeline\u6279\u91cf\u64cd\u4f5c\u53ea\u8fdb\u884c\u4e00\u6b21\u7f51\u7edc\u5f80\u8fd4\uff0c\u53ef\u4ee5\u770b\u5230\u8282\u7701\u7684\u65f6\u95f4\u57fa\u672c\u90fd\u662f\u7f51\u8def\u5ef6\u8fdf\u3002 2\u3001pipeline\u4e0etransation pipeline\u4e0d\u4ec5\u4ec5\u7528\u6765\u6279\u91cf\u7684\u63d0\u4ea4\u547d\u4ee4\uff0c\u8fd8\u7528\u6765\u5b9e\u73b0\u4e8b\u52a1transation\u3002 \u4f7f\u7528transaction\u4e0e\u5426\u4e0d\u540c\u4e4b\u5904\u5728\u4e0e\u521b\u5efapipeline\u5b9e\u4f8b\u7684\u65f6\u5019\uff0ctransaction\u662f\u5426\u6253\u5f00\uff0c\u9ed8\u8ba4\u662f\u6253\u5f00\u7684\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/2/21 13:25 @File : pipeline_demo.py @Author : summer @Software: PyCharm \"\"\" # -*- coding:utf-8 -*- import redis from redis import WatchError from concurrent.futures import ProcessPoolExecutor r = redis.Redis(host='127.0.0.1', port=6379) # \u51cf\u5e93\u5b58\u51fd\u6570, \u5faa\u73af\u76f4\u5230\u51cf\u5e93\u5b58\u5b8c\u6210 # \u5e93\u5b58\u5145\u8db3, \u51cf\u5e93\u5b58\u6210\u529f, \u8fd4\u56deTrue # \u5e93\u5b58\u4e0d\u8db3, \u51cf\u5e93\u5b58\u5931\u8d25, \u8fd4\u56deFalse def decr_stock(): # python\u4e2dredis\u4e8b\u52a1\u662f\u901a\u8fc7pipeline\u7684\u5c01\u88c5\u5b9e\u73b0\u7684 with r.pipeline() as pipe: while True: try: # watch\u5e93\u5b58\u952e, multi\u540e\u5982\u679c\u8be5key\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u6539\u53d8, \u4e8b\u52a1\u64cd\u4f5c\u4f1a\u629b\u51faWatchError\u5f02\u5e38 pipe.watch('stock:count') count = int(pipe.get('stock:count')) if count > 0: # \u6709\u5e93\u5b58 # \u4e8b\u52a1\u5f00\u59cb pipe.multi() pipe.decr('stock:count') # \u628a\u547d\u4ee4\u63a8\u9001\u8fc7\u53bb # execute\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u5217\u8868, \u8fd9\u91cc\u53ea\u6709\u4e00\u4e2adecr\u8fd4\u56de\u5f53\u524d\u503c print(pipe.execute()[0]) return True else: return False except WatchError as ex: # \u6253\u5370WatchError\u5f02\u5e38, \u89c2\u5bdf\u88abwatch\u9501\u4f4f\u7684\u60c5\u51b5 print(ex, '\u9501\u4f4f\u4e86') pipe.unwatch() def worker(): while True: # \u6ca1\u6709\u5e93\u5b58\u5c31\u9000\u51fa if not decr_stock(): break # \u5b9e\u9a8c\u5f00\u59cb \u8bbe\u7f6e\u5e93\u5b58\u4e3a20 r.set(\"stock:count\", 20) # \u591a\u8fdb\u7a0b\u6a21\u62df\u591a\u4e2a\u5ba2\u6237\u7aef\u63d0\u4ea4 if __name__ == '__main__': with ProcessPoolExecutor(max_workers=2) as pool: for _ in range(10): pool.submit(worker) \u8fd0\u884c\u7ed3\u679c D:\\code\\code-flask\\code-flask\\venv\\Scripts\\python.exe D:/code/code-flask/code-flask/2019-02-20/1.py 19 18 17 16 19 18 Watched variable changed. \u9501\u4f4f\u4e86 17 Watched variable changed. \u9501\u4f4f\u4e86 16 Watched variable changed. \u9501\u4f4f\u4e86 15 Watched variable changed. \u9501\u4f4f\u4e86 Watched variable changed. \u9501\u4f4f\u4e86 14 13 Watched variable changed. \u9501\u4f4f\u4e86 12 Watched variable changed. \u9501\u4f4f\u4e86 11 Watched variable changed. \u9501\u4f4f\u4e86 10 9 Watched variable changed. \u9501\u4f4f\u4e86 8 7 6 5 Watched variable changed. \u9501\u4f4f\u4e86 4 3 2 1 Watched variable changed. \u9501\u4f4f\u4e86 0 Process finished with exit code 0","title":"2. Python Redis pipeline\u64cd\u4f5c"},{"location":"python/lib/nosql/redis/redis.pub_sub/","text":"1. \u4ecb\u7ecd \u00b6 Redis \u53d1\u5e03\u8ba2\u9605(pub/sub)\u662f\u4e00\u79cd\u6d88\u606f\u901a\u4fe1\u6a21\u5f0f\uff1a\u53d1\u9001\u8005(pub)\u53d1\u9001\u6d88\u606f\uff0c\u8ba2\u9605\u8005(sub)\u63a5\u6536\u6d88\u606f\u3002 Redis \u5ba2\u6237\u7aef\u53ef\u4ee5\u8ba2\u9605\u4efb\u610f\u6570\u91cf\u7684\u9891\u9053\u3002 \u4e0b\u56fe\u5c55\u793a\u4e86\u9891\u9053 channel1 \uff0c \u4ee5\u53ca\u8ba2\u9605\u8fd9\u4e2a\u9891\u9053\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef \u2014\u2014 client2 \u3001 client5 \u548c client1 \u4e4b\u95f4\u7684\u5173\u7cfb\uff1a \u4e0b\u56fe\u5c55\u793a\u4e86\u9891\u9053 channel1 \uff0c \u4ee5\u53ca\u8ba2\u9605\u8fd9\u4e2a\u9891\u9053\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef \u2014\u2014 client2 \u3001 client5 \u548c client1 \u4e4b\u95f4\u7684\u5173\u7cfb\uff1a graph TB client1-->channel1 client2-->channel1 client3-->channel1 \u5f53\u6709\u65b0\u6d88\u606f\u901a\u8fc7 PUBLISH \u547d\u4ee4\u53d1\u9001\u7ed9\u9891\u9053 channel1 \u65f6\uff0c \u8fd9\u4e2a\u6d88\u606f\u5c31\u4f1a\u88ab\u53d1\u9001\u7ed9\u8ba2\u9605\u5b83\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef\uff1a graph TB publish_channel1_message --> channel1 channel1-->client1 channel1-->client2 channel1-->client3 2. \u5b9e\u4f8b \u00b6 \u5728\u6211\u4eec\u5b9e\u4f8b\u4e2d\u6211\u4eec\u521b\u5efa\u4e86\u8ba2\u9605\u9891\u9053\u540d\u4e3a redisChat 2.1 \u53d1\u5e03\u7aef \u00b6 root@leco:~/code/redis# redis-cli 127.0.0.1:6379> PUBLISH redisChat \"Redis is a great caching technique\" (integer) 1 127.0.0.1:6379> PUBLISH redisChat \"Learn redis by summer\" (integer) 1 127.0.0.1:6379> \u53d1\u5e03\u8005\u53d1\u5e03\u4e86\u4e24\u6761\u6d88\u606f 2.2 \u63a5\u6536\u7aef \u00b6 root@leco:~/code/redis# redis-cli 127.0.0.1:6379> SUBSCRIBE redisChat Reading messages... (press Ctrl-C to quit) 1) \"subscribe\" 2) \"redisChat\" 3) (integer) 1 1) \"message\" 2) \"redisChat\" 3) \"Redis is a great caching technique\" 1) \"message\" 2) \"redisChat\" 3) \"Learn redis by summer\" \u63a5\u6536\u5230\u6536\u5230\u4e86\u4e24\u6761\u6d88\u606f python \u5b9e\u73b0 root@leco:~/code/redis# cat p.py import redis r=redis.Redis(host=\"localhost\",port=6379,decode_responses=True) #\u53d1\u5e03\u4f7f\u7528publish(self, channel, message):Publish ``message`` on ``channel``. Flag=True while Flag: msg=input(\"\u4e3b\u64ad\u8bf7\u8bb2\u8bdd>>:\") if len(msg)==0: continue elif msg=='quit': break else: r.publish('cctv0',msg) root@leco:~/code/redis# cat r.py import redis r=redis.Redis(host=\"localhost\",port=6379,decode_responses=True) #\u53d1\u5e03\u4f7f\u7528publish(self, channel, message):Publish ``message`` on ``channel``. Flag=True chan=r.pubsub()#\u8fd4\u56de\u4e00\u4e2a\u53d1\u5e03/\u8ba2\u9605\u5bf9\u8c61 msg_reciver=chan.subscribe('cctv0')#\u8ba2\u9605 msg=chan.parse_response()#\u7b2c\u4e00\u6b21\u4f1a\u8fd4\u56de\u8ba2\u9605\u786e\u8ba4\u4fe1\u606f print(msg) print(\"\u8ba2\u9605\u6210\u529f\uff0c\u5f00\u59cb\u63a5\u6536------\") while Flag: msg=chan.parse_response()#\u63a5\u6536\u6d88\u606f print(\">>:\",msg[2])#\u6b64\u5904\u7684\u4fe1\u606f\u683c\u5f0f['\u6d88\u606f\u7c7b\u578b', '\u9891\u9053', '\u6d88\u606f']\uff0c\u6240\u4ee5\u4f7f\u7528[2]\u6765\u83b7\u53d6 \u6d4b\u8bd5 \u53d1\u5e03\u7aef root@leco:~/code/redis# python3 p.py \u4e3b\u64ad\u8bf7\u8bb2\u8bdd>>:\u6211\u662fredis\u7684\u53d1\u5e03\u5e73\u53f0 \u4e3b\u64ad\u8bf7\u8bb2\u8bdd>>: \u63a5\u53d7\u7aef root@leco:~/code/redis# python3 r.py ['subscribe', 'cctv0', 1] \u8ba2\u9605\u6210\u529f\uff0c\u5f00\u59cb\u63a5\u6536------ >>: \u6211\u662fredis\u7684\u53d1\u5e03\u5e73\u53f0 \u963b\u585e\u5728\u8fd9\uff0c\u7b49\u5f85\u63a5\u53d7\u6570\u636e","title":"4. redis pub_sub"},{"location":"python/lib/nosql/redis/redis.pub_sub/#1","text":"Redis \u53d1\u5e03\u8ba2\u9605(pub/sub)\u662f\u4e00\u79cd\u6d88\u606f\u901a\u4fe1\u6a21\u5f0f\uff1a\u53d1\u9001\u8005(pub)\u53d1\u9001\u6d88\u606f\uff0c\u8ba2\u9605\u8005(sub)\u63a5\u6536\u6d88\u606f\u3002 Redis \u5ba2\u6237\u7aef\u53ef\u4ee5\u8ba2\u9605\u4efb\u610f\u6570\u91cf\u7684\u9891\u9053\u3002 \u4e0b\u56fe\u5c55\u793a\u4e86\u9891\u9053 channel1 \uff0c \u4ee5\u53ca\u8ba2\u9605\u8fd9\u4e2a\u9891\u9053\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef \u2014\u2014 client2 \u3001 client5 \u548c client1 \u4e4b\u95f4\u7684\u5173\u7cfb\uff1a \u4e0b\u56fe\u5c55\u793a\u4e86\u9891\u9053 channel1 \uff0c \u4ee5\u53ca\u8ba2\u9605\u8fd9\u4e2a\u9891\u9053\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef \u2014\u2014 client2 \u3001 client5 \u548c client1 \u4e4b\u95f4\u7684\u5173\u7cfb\uff1a graph TB client1-->channel1 client2-->channel1 client3-->channel1 \u5f53\u6709\u65b0\u6d88\u606f\u901a\u8fc7 PUBLISH \u547d\u4ee4\u53d1\u9001\u7ed9\u9891\u9053 channel1 \u65f6\uff0c \u8fd9\u4e2a\u6d88\u606f\u5c31\u4f1a\u88ab\u53d1\u9001\u7ed9\u8ba2\u9605\u5b83\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef\uff1a graph TB publish_channel1_message --> channel1 channel1-->client1 channel1-->client2 channel1-->client3","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/nosql/redis/redis.pub_sub/#2","text":"\u5728\u6211\u4eec\u5b9e\u4f8b\u4e2d\u6211\u4eec\u521b\u5efa\u4e86\u8ba2\u9605\u9891\u9053\u540d\u4e3a redisChat","title":"2. \u5b9e\u4f8b"},{"location":"python/lib/nosql/redis/redis.pub_sub/#21","text":"root@leco:~/code/redis# redis-cli 127.0.0.1:6379> PUBLISH redisChat \"Redis is a great caching technique\" (integer) 1 127.0.0.1:6379> PUBLISH redisChat \"Learn redis by summer\" (integer) 1 127.0.0.1:6379> \u53d1\u5e03\u8005\u53d1\u5e03\u4e86\u4e24\u6761\u6d88\u606f","title":"2.1 \u53d1\u5e03\u7aef"},{"location":"python/lib/nosql/redis/redis.pub_sub/#22","text":"root@leco:~/code/redis# redis-cli 127.0.0.1:6379> SUBSCRIBE redisChat Reading messages... (press Ctrl-C to quit) 1) \"subscribe\" 2) \"redisChat\" 3) (integer) 1 1) \"message\" 2) \"redisChat\" 3) \"Redis is a great caching technique\" 1) \"message\" 2) \"redisChat\" 3) \"Learn redis by summer\" \u63a5\u6536\u5230\u6536\u5230\u4e86\u4e24\u6761\u6d88\u606f python \u5b9e\u73b0 root@leco:~/code/redis# cat p.py import redis r=redis.Redis(host=\"localhost\",port=6379,decode_responses=True) #\u53d1\u5e03\u4f7f\u7528publish(self, channel, message):Publish ``message`` on ``channel``. Flag=True while Flag: msg=input(\"\u4e3b\u64ad\u8bf7\u8bb2\u8bdd>>:\") if len(msg)==0: continue elif msg=='quit': break else: r.publish('cctv0',msg) root@leco:~/code/redis# cat r.py import redis r=redis.Redis(host=\"localhost\",port=6379,decode_responses=True) #\u53d1\u5e03\u4f7f\u7528publish(self, channel, message):Publish ``message`` on ``channel``. Flag=True chan=r.pubsub()#\u8fd4\u56de\u4e00\u4e2a\u53d1\u5e03/\u8ba2\u9605\u5bf9\u8c61 msg_reciver=chan.subscribe('cctv0')#\u8ba2\u9605 msg=chan.parse_response()#\u7b2c\u4e00\u6b21\u4f1a\u8fd4\u56de\u8ba2\u9605\u786e\u8ba4\u4fe1\u606f print(msg) print(\"\u8ba2\u9605\u6210\u529f\uff0c\u5f00\u59cb\u63a5\u6536------\") while Flag: msg=chan.parse_response()#\u63a5\u6536\u6d88\u606f print(\">>:\",msg[2])#\u6b64\u5904\u7684\u4fe1\u606f\u683c\u5f0f['\u6d88\u606f\u7c7b\u578b', '\u9891\u9053', '\u6d88\u606f']\uff0c\u6240\u4ee5\u4f7f\u7528[2]\u6765\u83b7\u53d6 \u6d4b\u8bd5 \u53d1\u5e03\u7aef root@leco:~/code/redis# python3 p.py \u4e3b\u64ad\u8bf7\u8bb2\u8bdd>>:\u6211\u662fredis\u7684\u53d1\u5e03\u5e73\u53f0 \u4e3b\u64ad\u8bf7\u8bb2\u8bdd>>: \u63a5\u53d7\u7aef root@leco:~/code/redis# python3 r.py ['subscribe', 'cctv0', 1] \u8ba2\u9605\u6210\u529f\uff0c\u5f00\u59cb\u63a5\u6536------ >>: \u6211\u662fredis\u7684\u53d1\u5e03\u5e73\u53f0 \u963b\u585e\u5728\u8fd9\uff0c\u7b49\u5f85\u63a5\u53d7\u6570\u636e","title":"2.2 \u63a5\u6536\u7aef"},{"location":"python/lib/nosql/redis/redis.sentinel/","text":"root@leco:~/code/redis# cat sentinel.py #!/usr/bin/env python # -*- coding:utf-8 -*- # author: summer from redis.sentinel import Sentinel # \u8fde\u63a5\u54e8\u5175\u670d\u52a1\u5668(\u4e3b\u673a\u540d\u4e5f\u53ef\u4ee5\u7528\u57df\u540d) sentinel = Sentinel([('127.0.0.1', 26379), ('127.0.0.1', 26380), ('127.0.0.1', 26381)], socket_timeout=0.5) # \u83b7\u53d6\u4e3b\u670d\u52a1\u5668\u5730\u5740 master = sentinel.discover_master('mymaster') print(\"\u5f53\u524dmaster = \", master) # \u83b7\u53d6\u4ece\u670d\u52a1\u5668\u5730\u5740 slave = sentinel.discover_slaves('mymaster') print(\"\u5f53\u524dslave = \", slave) # \u83b7\u53d6\u4e3b\u670d\u52a1\u5668\u8fdb\u884c\u5199\u5165 master = sentinel.master_for('mymaster') master.set('name','summer') # \u83b7\u53d6\u4ece\u670d\u52a1\u5668\u8fdb\u884c\u8bfb\u53d6\uff08\u9ed8\u8ba4\u662fround-roubin\uff09 #slave = sentinel.slave_for('mymaster', password='redis_auth_pass') slave = sentinel.slave_for('mymaster') data = slave.get('name') print(data) \u8fd0\u884c\u7ed3\u679c root@leco:~/code/redis# python sentinel.py \u5f53\u524dmaster = ('127.0.0.1', 6379) \u5f53\u524dslave = [('127.0.0.1', 10380), ('127.0.0.1', 10381)] b'cmz'","title":"5. redis sentinel"},{"location":"python/lib/nosql/redis/redis.transaction/","text":"1\u3001\u57fa\u672c\u6982\u5ff5 \u00b6 1.1 \u4ec0\u4e48\u662fredis\u7684\u4e8b\u52a1\uff1f \u00b6 \u7b80\u5355\u7406\u89e3\uff0c\u53ef\u4ee5\u8ba4\u4e3aredis\u4e8b\u52a1\u662f\u4e00\u4e9b\u5217redis\u547d\u4ee4\u7684\u96c6\u5408\uff0c\u5e76\u4e14\u6709\u5982\u4e0b\u4e24\u4e2a\u7279\u70b9\uff1a \u4e8b\u52a1\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u9694\u79bb\u64cd\u4f5c\uff1a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u547d\u4ee4\u90fd\u4f1a\u5e8f\u5217\u5316\u3001\u6309\u987a\u5e8f\u5730\u6267\u884c\u3002\u4e8b\u52a1\u5728\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u4f1a\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u53d1\u9001\u6765\u7684\u547d\u4ee4\u8bf7\u6c42\u6240\u6253\u65ad\u3002 \u4e8b\u52a1\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff1a\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u8981\u4e48\u5168\u90e8\u88ab\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u90fd\u4e0d\u6267\u884c\u3002 1.2 \u4e8b\u52a1\u7684\u6027\u8d28ACID \u00b6 \u4e00\u822c\u6765\u8bf4\uff0c\u4e8b\u52a1\u6709\u56db\u4e2a\u6027\u8d28\u79f0\u4e3aACID\uff0c\u5206\u522b\u662f\u539f\u5b50\u6027\uff0c\u4e00\u81f4\u6027\uff0c\u9694\u79bb\u6027\u548c\u6301\u4e45\u6027\u3002 \u539f\u5b50\u6027atomicity\uff1aredis\u4e8b\u52a1\u4fdd\u8bc1\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u8981\u4e48\u5168\u90e8\u6267\u884c\u8981\u4e0d\u5168\u90e8\u4e0d\u6267\u884c\u3002\u6709\u4e9b\u6587\u7ae0\u8ba4\u4e3aredis\u4e8b\u52a1\u5bf9\u4e8e\u6267\u884c\u9519\u8bef\u4e0d\u56de\u6eda\u8fdd\u80cc\u4e86\u539f\u5b50\u6027\uff0c\u662f\u504f\u9887\u7684\u3002 \u4e00\u81f4\u6027consistency\uff1aredis\u4e8b\u52a1\u53ef\u4ee5\u4fdd\u8bc1\u547d\u4ee4\u5931\u8d25\u7684\u60c5\u51b5\u4e0b\u5f97\u4ee5\u56de\u6eda\uff0c\u6570\u636e\u80fd\u6062\u590d\u5230\u6ca1\u6709\u6267\u884c\u4e4b\u524d\u7684\u6837\u5b50\uff0c\u662f\u4fdd\u8bc1\u4e00\u81f4\u6027\u7684\uff0c\u9664\u975eredis\u8fdb\u7a0b\u610f\u5916\u7ec8\u7ed3\u3002 \u9694\u79bb\u6027Isolation\uff1aredis\u4e8b\u52a1\u662f\u4e25\u683c\u9075\u5b88\u9694\u79bb\u6027\u7684\uff0c\u539f\u56e0\u662fredis\u662f\u5355\u8fdb\u7a0b\u5355\u7ebf\u7a0b\u6a21\u5f0f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u547d\u4ee4\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u547d\u4ee4\u6253\u65ad\u3002 \u6301\u4e45\u6027Durability\uff1aredis\u4e8b\u52a1\u662f\u4e0d\u4fdd\u8bc1\u6301\u4e45\u6027\u7684\uff0c\u8fd9\u662f\u56e0\u4e3aredis\u6301\u4e45\u5316\u7b56\u7565\u4e2d\u4e0d\u7ba1\u662fRDB\u8fd8\u662fAOF\u90fd\u662f\u5f02\u6b65\u6267\u884c\u7684\uff0c\u4e0d\u4fdd\u8bc1\u6301\u4e45\u6027\u662f\u51fa\u4e8e\u5bf9\u6027\u80fd\u7684\u8003\u8651\u3002 1.3 redis\u4e8b\u52a1\u7684\u9519\u8bef \u00b6 \u4f7f\u7528\u4e8b\u52a1\u65f6\u53ef\u80fd\u4f1a\u9047\u4e0a\u4ee5\u4e0b\u4e24\u79cd\u9519\u8bef\uff1a \u5165\u961f\u9519\u8bef\uff1a\u4e8b\u52a1\u5728\u6267\u884c EXEC \u4e4b\u524d\uff0c\u5165\u961f\u7684\u547d\u4ee4\u53ef\u80fd\u4f1a\u51fa\u9519\u3002\u6bd4\u5982\u8bf4\uff0c\u547d\u4ee4\u53ef\u80fd\u4f1a\u4ea7\u751f\u8bed\u6cd5\u9519\u8bef\uff08\u53c2\u6570\u6570\u91cf\u9519\u8bef\uff0c\u53c2\u6570\u540d\u9519\u8bef\uff0c\u7b49\u7b49\uff09\uff0c\u6216\u8005\u5176\u4ed6\u66f4\u4e25\u91cd\u7684\u9519\u8bef\uff0c\u6bd4\u5982\u5185\u5b58\u4e0d\u8db3\uff08\u5982\u679c\u670d\u52a1\u5668\u4f7f\u7528 maxmemory \u8bbe\u7f6e\u4e86\u6700\u5927\u5185\u5b58\u9650\u5236\u7684\u8bdd\uff09\u3002 \u6267\u884c\u9519\u8bef\uff1a\u547d\u4ee4\u53ef\u80fd\u5728 EXEC \u8c03\u7528\u4e4b\u540e\u5931\u8d25\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u53ef\u80fd\u5904\u7406\u4e86\u9519\u8bef\u7c7b\u578b\u7684\u952e\uff0c\u6bd4\u5982\u5c06\u5217\u8868\u547d\u4ee4\u7528\u5728\u4e86\u5b57\u7b26\u4e32\u952e\u4e0a\u9762\uff0c\u8bf8\u5982\u6b64\u7c7b\u3002 \u6ce8\u610f \u7b2c\u4e09\u79cd\u9519\u8bef\uff0credis\u8fdb\u7a0b\u7ec8\u7ed3\uff0c\u672c\u6587\u5e76\u6ca1\u6709\u8ba8\u8bba\u8fd9\u79cd\u9519\u8bef\u3002 2. redis\u4e8b\u52a1\u7684\u7528\u6cd5 \u00b6 redis\u4e8b\u52a1\u662f\u901a\u8fc7MULTI\uff0cEXEC\uff0cDISCARD\u548cWATCH\u56db\u4e2a\u539f\u8bed\u5b9e\u73b0\u7684\u3002 MULTI\u547d\u4ee4\u7528\u4e8e\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5b83\u603b\u662f\u8fd4\u56deOK\u3002 MULTI\u6267\u884c\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u7ee7\u7eed\u5411\u670d\u52a1\u5668\u53d1\u9001\u4efb\u610f\u591a\u6761\u547d\u4ee4\uff0c\u8fd9\u4e9b\u547d\u4ee4\u4e0d\u4f1a\u7acb\u5373\u88ab\u6267\u884c\uff0c\u800c\u662f\u88ab\u653e\u5230\u4e00\u4e2a\u961f\u5217\u4e2d\uff0c\u5f53EXEC\u547d\u4ee4\u88ab\u8c03\u7528\u65f6\uff0c\u6240\u6709\u961f\u5217\u4e2d\u7684\u547d\u4ee4\u624d\u4f1a\u88ab\u6267\u884c\u3002 \u53e6\u4e00\u65b9\u9762\uff0c\u901a\u8fc7\u8c03\u7528DISCARD\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u6e05\u7a7a\u4e8b\u52a1\u961f\u5217\uff0c\u5e76\u653e\u5f03\u6267\u884c\u4e8b\u52a1\u3002 Unwatch \u4e4b\u524d\u52a0\u7684\u76d1\u63a7\u9501\u90fd\u4f1a\u88ab\u53d6\u6d88\u6389\u4e86\uff0c\u4e4b\u524d\u6267\u884c\u7684\u5199\u64cd\u4f5c\u547d\u4ee4\u5168\u90e8\u53d6\u6d88 2.1 \u6b63\u5e38\u64cd\u4f5c \u00b6 127.0.0.1:6379> FLUSHALL OK 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key 1 QUEUED 127.0.0.1:6379> set key2 2 QUEUED 127.0.0.1:6379> sadd key3 3 QUEUED 127.0.0.1:6379> exec 1) OK 2) OK 3) (integer) 1 127.0.0.1:6379> keys * 1) \"key2\" 2) \"key3\" 3) \"key\" EXEC \u547d\u4ee4\u7684\u56de\u590d\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u6267\u884c\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u6240\u4ea7\u751f\u7684\u56de\u590d\u3002 \u5176\u4e2d\uff0c\u56de\u590d\u5143\u7d20\u7684\u5148\u540e\u987a\u5e8f\u548c\u547d\u4ee4\u53d1\u9001\u7684\u5148\u540e\u987a\u5e8f\u4e00\u81f4\u3002 \u5f53\u5ba2\u6237\u7aef\u5904\u4e8e\u4e8b\u52a1\u72b6\u6001\u65f6\uff0c\u6240\u6709\u4f20\u5165\u7684\u547d\u4ee4\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5185\u5bb9\u4e3a QUEUED \u7684\u72b6\u6001\u56de\u590d\uff08status reply\uff09\uff0c\u8fd9\u4e9b\u88ab\u5165\u961f\u7684\u547d\u4ee4\u5c06\u5728 EXEC\u547d\u4ee4\u88ab\u8c03\u7528\u65f6\u6267\u884c\u3002 2.2 \u653e\u5f03\u4e8b\u52a1 \u00b6 \u5f53\u6267\u884c DISCARD \u547d\u4ee4\u65f6\uff0c\u4e8b\u52a1\u4f1a\u88ab\u653e\u5f03\uff0c\u4e8b\u52a1\u961f\u5217\u4f1a\u88ab\u6e05\u7a7a\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u4f1a\u4ece\u4e8b\u52a1\u72b6\u6001\u4e2d\u9000\u51fa\uff1a 127.0.0.1:6379> get key \"1\" 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key 10 QUEUED 127.0.0.1:6379> DISCARD OK 127.0.0.1:6379> exec (error) ERR EXEC without MULTI 127.0.0.1:6379> get key \"1\" 2.3 \u5165\u961f\u9519\u8bef\u56de\u6eda \u00b6 127.0.0.1:6379> keys * (empty list or set) 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key 1 QUEUED 127.0.0.1:6379> HSET key2 1 (error) ERR wrong number of arguments for 'hset' command 127.0.0.1:6379> SADD key3 1 QUEUED 127.0.0.1:6379> exec (error) EXECABORT Transaction discarded because of previous errors. 127.0.0.1:6379> keys * (empty list or set) \u5bf9\u4e8e\u5165\u961f\u9519\u8bef\uff0credis 2.6.5\u7248\u672c\u540e\uff0c\u4f1a\u8bb0\u5f55\u8fd9\u79cd\u9519\u8bef\uff0c\u5e76\u4e14\u5728\u6267\u884cEXEC\u7684\u65f6\u5019\uff0c\u62a5\u9519\u5e76\u56de\u6eda\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u547d\u4ee4\uff0c\u5e76\u4e14\u7ec8\u6b62\u4e8b\u52a1 2.4 \u6267\u884c\u9519\u8bef\u653e\u8fc7 \u00b6 127.0.0.1:6379> flushall OK 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set k1 v1 QUEUED 127.0.0.1:6379> set k2 v2 v3 QUEUED 127.0.0.1:6379> exec 1) OK 2) (error) ERR syntax error 127.0.0.1:6379> keys * 1) \"k1\" 127.0.0.1:6379> get k1 \"v1\" \u5f53\u9047\u5230\u6267\u884c\u9519\u8bef\u65f6\uff0credis\u653e\u8fc7\u8fd9\u79cd\u9519\u8bef\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u6267\u884c\u5b8c\u6210\u3002 \u4e0d\u540c\u4e4b\u5904 \u4e0emysql\u4e2d\u4e8b\u52a1\u4e0d\u540c\uff0c\u5728redis\u4e8b\u52a1\u9047\u5230\u6267\u884c\u9519\u8bef\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u8fdb\u884c\u56de\u6eda\uff0c\u800c\u662f\u7b80\u5355\u7684\u653e\u8fc7\u4e86\uff0c\u5e76\u4fdd\u8bc1\u5176\u4ed6\u7684\u547d\u4ee4\u6b63\u5e38\u6267\u884c\u3002\u8fd9\u4e2a\u533a\u522b\u5728\u5b9e\u73b0\u4e1a\u52a1\u7684\u65f6\u5019\uff0c\u9700\u8981\u81ea\u5df1\u4fdd\u8bc1\u903b\u8f91\u7b26\u5408\u9884\u671f\u3002 2.5 watch \u00b6 WATCH \u547d\u4ee4\u53ef\u4ee5\u4e3a Redis \u4e8b\u52a1\u63d0\u4f9b check-and-set \uff08CAS\uff09\u884c\u4e3a\u3002 \u88ab WATCH \u7684\u952e\u4f1a\u88ab\u76d1\u89c6\uff0c\u5e76\u4f1a\u53d1\u89c9\u8fd9\u4e9b\u952e\u662f\u5426\u88ab\u6539\u52a8\u8fc7\u4e86\u3002 \u5982\u679c\u6709\u81f3\u5c11\u4e00\u4e2a\u88ab\u76d1\u89c6\u7684\u952e\u5728 EXEC \u6267\u884c\u4e4b\u524d\u88ab\u4fee\u6539\u4e86\uff0c \u90a3\u4e48\u6574\u4e2a\u4e8b\u52a1\u90fd\u4f1a\u88ab\u53d6\u6d88\uff0c EXEC \u8fd4\u56de\u7a7a\u591a\u6761\u6279\u91cf\u56de\u590d\uff08null multi-bulk reply\uff09\u6765\u8868\u793a\u4e8b\u52a1\u5df2\u7ecf\u5931\u8d25\u3002 127.0.0.1:6379> keys * (empty list or set) 127.0.0.1:6379> watch key1 OK 127.0.0.1:6379> set key1 3 OK 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key1 3 QUEUED 127.0.0.1:6379> set key2 3 QUEUED 127.0.0.1:6379> exec (nil) 127.0.0.1:6379> keys * 1) \"key1\" \u4f7f\u7528\u4e0a\u9762\u7684\u4ee3\u7801\uff0c \u5982\u679c\u5728 WATCH \u6267\u884c\u4e4b\u540e\uff0c EXEC \u6267\u884c\u4e4b\u524d\uff0c \u6709\u5176\u4ed6\u5ba2\u6237\u7aef\u4fee\u6539\u4e86 key1 \u7684\u503c\uff0c \u90a3\u4e48\u5f53\u524d\u5ba2\u6237\u7aef\u7684\u4e8b\u52a1\u5c31\u4f1a\u5931\u8d25\u3002 \u7a0b\u5e8f\u9700\u8981\u505a\u7684\uff0c \u5c31\u662f\u4e0d\u65ad\u91cd\u8bd5\u8fd9\u4e2a\u64cd\u4f5c\uff0c \u76f4\u5230\u6ca1\u6709\u53d1\u751f\u78b0\u649e\u4e3a\u6b62\u3002 \u8fd9\u79cd\u5f62\u5f0f\u7684\u9501\u88ab\u79f0\u4f5c\u4e50\u89c2\u9501\uff0c \u5b83\u662f\u4e00\u79cd\u975e\u5e38\u5f3a\u5927\u7684\u9501\u673a\u5236\u3002 \u5e76\u4e14\u56e0\u4e3a\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c \u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u4f1a\u8bbf\u95ee\u4e0d\u540c\u7684\u952e\uff0c \u78b0\u649e\u7684\u60c5\u51b5\u4e00\u822c\u90fd\u5f88\u5c11\uff0c \u6240\u4ee5\u901a\u5e38\u5e76\u4e0d\u9700\u8981\u8fdb\u884c\u91cd\u8bd5\u3002 3. demo \u00b6 \u8fd9\u91cc\u5c55\u793a\u4e00\u4e2a\u7528python\u5b9e\u73b0\u5bf9key\u8ba1\u6570\u51cf\u4e00\u7684\u539f\u5b50\u64cd\u4f5c\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/2/21 13:25 @File : pipeline_demo.py @Author : summer @Software: PyCharm \"\"\" import redis from redis import WatchError from concurrent.futures import ProcessPoolExecutor r = redis.Redis(host='127.0.0.1', port=6379) # \u51cf\u5e93\u5b58\u51fd\u6570, \u5faa\u73af\u76f4\u5230\u51cf\u5e93\u5b58\u5b8c\u6210 # \u5e93\u5b58\u5145\u8db3, \u51cf\u5e93\u5b58\u6210\u529f, \u8fd4\u56deTrue # \u5e93\u5b58\u4e0d\u8db3, \u51cf\u5e93\u5b58\u5931\u8d25, \u8fd4\u56deFalse def decr_stock(): # python\u4e2dredis\u4e8b\u52a1\u662f\u901a\u8fc7pipeline\u7684\u5c01\u88c5\u5b9e\u73b0\u7684 with r.pipeline() as pipe: while True: try: # watch\u5e93\u5b58\u952e, multi\u540e\u5982\u679c\u8be5key\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u6539\u53d8, \u4e8b\u52a1\u64cd\u4f5c\u4f1a\u629b\u51faWatchError\u5f02\u5e38 pipe.watch('stock:count') count = int(pipe.get('stock:count')) if count > 0: # \u6709\u5e93\u5b58 # \u4e8b\u52a1\u5f00\u59cb pipe.multi() pipe.decr('stock:count') # \u628a\u547d\u4ee4\u63a8\u9001\u8fc7\u53bb # execute\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u5217\u8868, \u8fd9\u91cc\u53ea\u6709\u4e00\u4e2adecr\u8fd4\u56de\u5f53\u524d\u503c print(pipe.execute()[0]) return True else: return False except WatchError as ex: # \u6253\u5370WatchError\u5f02\u5e38, \u89c2\u5bdf\u88abwatch\u9501\u4f4f\u7684\u60c5\u51b5 print(ex, '\u9501\u4f4f\u4e86') pipe.unwatch() def worker(): while True: # \u6ca1\u6709\u5e93\u5b58\u5c31\u9000\u51fa if not decr_stock(): break # \u5b9e\u9a8c\u5f00\u59cb \u8bbe\u7f6e\u5e93\u5b58\u4e3a20 r.set(\"stock:count\", 20) # \u591a\u8fdb\u7a0b\u6a21\u62df\u591a\u4e2a\u5ba2\u6237\u7aef\u63d0\u4ea4 if __name__ == '__main__': with ProcessPoolExecutor(max_workers=2) as pool: for _ in range(10): pool.submit(worker)","title":"3. redis transaction"},{"location":"python/lib/nosql/redis/redis.transaction/#1","text":"","title":"1\u3001\u57fa\u672c\u6982\u5ff5"},{"location":"python/lib/nosql/redis/redis.transaction/#11-redis","text":"\u7b80\u5355\u7406\u89e3\uff0c\u53ef\u4ee5\u8ba4\u4e3aredis\u4e8b\u52a1\u662f\u4e00\u4e9b\u5217redis\u547d\u4ee4\u7684\u96c6\u5408\uff0c\u5e76\u4e14\u6709\u5982\u4e0b\u4e24\u4e2a\u7279\u70b9\uff1a \u4e8b\u52a1\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u9694\u79bb\u64cd\u4f5c\uff1a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u547d\u4ee4\u90fd\u4f1a\u5e8f\u5217\u5316\u3001\u6309\u987a\u5e8f\u5730\u6267\u884c\u3002\u4e8b\u52a1\u5728\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u4f1a\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u53d1\u9001\u6765\u7684\u547d\u4ee4\u8bf7\u6c42\u6240\u6253\u65ad\u3002 \u4e8b\u52a1\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff1a\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u8981\u4e48\u5168\u90e8\u88ab\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u90fd\u4e0d\u6267\u884c\u3002","title":"1.1 \u4ec0\u4e48\u662fredis\u7684\u4e8b\u52a1\uff1f"},{"location":"python/lib/nosql/redis/redis.transaction/#12-acid","text":"\u4e00\u822c\u6765\u8bf4\uff0c\u4e8b\u52a1\u6709\u56db\u4e2a\u6027\u8d28\u79f0\u4e3aACID\uff0c\u5206\u522b\u662f\u539f\u5b50\u6027\uff0c\u4e00\u81f4\u6027\uff0c\u9694\u79bb\u6027\u548c\u6301\u4e45\u6027\u3002 \u539f\u5b50\u6027atomicity\uff1aredis\u4e8b\u52a1\u4fdd\u8bc1\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u8981\u4e48\u5168\u90e8\u6267\u884c\u8981\u4e0d\u5168\u90e8\u4e0d\u6267\u884c\u3002\u6709\u4e9b\u6587\u7ae0\u8ba4\u4e3aredis\u4e8b\u52a1\u5bf9\u4e8e\u6267\u884c\u9519\u8bef\u4e0d\u56de\u6eda\u8fdd\u80cc\u4e86\u539f\u5b50\u6027\uff0c\u662f\u504f\u9887\u7684\u3002 \u4e00\u81f4\u6027consistency\uff1aredis\u4e8b\u52a1\u53ef\u4ee5\u4fdd\u8bc1\u547d\u4ee4\u5931\u8d25\u7684\u60c5\u51b5\u4e0b\u5f97\u4ee5\u56de\u6eda\uff0c\u6570\u636e\u80fd\u6062\u590d\u5230\u6ca1\u6709\u6267\u884c\u4e4b\u524d\u7684\u6837\u5b50\uff0c\u662f\u4fdd\u8bc1\u4e00\u81f4\u6027\u7684\uff0c\u9664\u975eredis\u8fdb\u7a0b\u610f\u5916\u7ec8\u7ed3\u3002 \u9694\u79bb\u6027Isolation\uff1aredis\u4e8b\u52a1\u662f\u4e25\u683c\u9075\u5b88\u9694\u79bb\u6027\u7684\uff0c\u539f\u56e0\u662fredis\u662f\u5355\u8fdb\u7a0b\u5355\u7ebf\u7a0b\u6a21\u5f0f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u547d\u4ee4\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u547d\u4ee4\u6253\u65ad\u3002 \u6301\u4e45\u6027Durability\uff1aredis\u4e8b\u52a1\u662f\u4e0d\u4fdd\u8bc1\u6301\u4e45\u6027\u7684\uff0c\u8fd9\u662f\u56e0\u4e3aredis\u6301\u4e45\u5316\u7b56\u7565\u4e2d\u4e0d\u7ba1\u662fRDB\u8fd8\u662fAOF\u90fd\u662f\u5f02\u6b65\u6267\u884c\u7684\uff0c\u4e0d\u4fdd\u8bc1\u6301\u4e45\u6027\u662f\u51fa\u4e8e\u5bf9\u6027\u80fd\u7684\u8003\u8651\u3002","title":"1.2 \u4e8b\u52a1\u7684\u6027\u8d28ACID"},{"location":"python/lib/nosql/redis/redis.transaction/#13-redis","text":"\u4f7f\u7528\u4e8b\u52a1\u65f6\u53ef\u80fd\u4f1a\u9047\u4e0a\u4ee5\u4e0b\u4e24\u79cd\u9519\u8bef\uff1a \u5165\u961f\u9519\u8bef\uff1a\u4e8b\u52a1\u5728\u6267\u884c EXEC \u4e4b\u524d\uff0c\u5165\u961f\u7684\u547d\u4ee4\u53ef\u80fd\u4f1a\u51fa\u9519\u3002\u6bd4\u5982\u8bf4\uff0c\u547d\u4ee4\u53ef\u80fd\u4f1a\u4ea7\u751f\u8bed\u6cd5\u9519\u8bef\uff08\u53c2\u6570\u6570\u91cf\u9519\u8bef\uff0c\u53c2\u6570\u540d\u9519\u8bef\uff0c\u7b49\u7b49\uff09\uff0c\u6216\u8005\u5176\u4ed6\u66f4\u4e25\u91cd\u7684\u9519\u8bef\uff0c\u6bd4\u5982\u5185\u5b58\u4e0d\u8db3\uff08\u5982\u679c\u670d\u52a1\u5668\u4f7f\u7528 maxmemory \u8bbe\u7f6e\u4e86\u6700\u5927\u5185\u5b58\u9650\u5236\u7684\u8bdd\uff09\u3002 \u6267\u884c\u9519\u8bef\uff1a\u547d\u4ee4\u53ef\u80fd\u5728 EXEC \u8c03\u7528\u4e4b\u540e\u5931\u8d25\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u53ef\u80fd\u5904\u7406\u4e86\u9519\u8bef\u7c7b\u578b\u7684\u952e\uff0c\u6bd4\u5982\u5c06\u5217\u8868\u547d\u4ee4\u7528\u5728\u4e86\u5b57\u7b26\u4e32\u952e\u4e0a\u9762\uff0c\u8bf8\u5982\u6b64\u7c7b\u3002 \u6ce8\u610f \u7b2c\u4e09\u79cd\u9519\u8bef\uff0credis\u8fdb\u7a0b\u7ec8\u7ed3\uff0c\u672c\u6587\u5e76\u6ca1\u6709\u8ba8\u8bba\u8fd9\u79cd\u9519\u8bef\u3002","title":"1.3 redis\u4e8b\u52a1\u7684\u9519\u8bef"},{"location":"python/lib/nosql/redis/redis.transaction/#2-redis","text":"redis\u4e8b\u52a1\u662f\u901a\u8fc7MULTI\uff0cEXEC\uff0cDISCARD\u548cWATCH\u56db\u4e2a\u539f\u8bed\u5b9e\u73b0\u7684\u3002 MULTI\u547d\u4ee4\u7528\u4e8e\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5b83\u603b\u662f\u8fd4\u56deOK\u3002 MULTI\u6267\u884c\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u7ee7\u7eed\u5411\u670d\u52a1\u5668\u53d1\u9001\u4efb\u610f\u591a\u6761\u547d\u4ee4\uff0c\u8fd9\u4e9b\u547d\u4ee4\u4e0d\u4f1a\u7acb\u5373\u88ab\u6267\u884c\uff0c\u800c\u662f\u88ab\u653e\u5230\u4e00\u4e2a\u961f\u5217\u4e2d\uff0c\u5f53EXEC\u547d\u4ee4\u88ab\u8c03\u7528\u65f6\uff0c\u6240\u6709\u961f\u5217\u4e2d\u7684\u547d\u4ee4\u624d\u4f1a\u88ab\u6267\u884c\u3002 \u53e6\u4e00\u65b9\u9762\uff0c\u901a\u8fc7\u8c03\u7528DISCARD\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u6e05\u7a7a\u4e8b\u52a1\u961f\u5217\uff0c\u5e76\u653e\u5f03\u6267\u884c\u4e8b\u52a1\u3002 Unwatch \u4e4b\u524d\u52a0\u7684\u76d1\u63a7\u9501\u90fd\u4f1a\u88ab\u53d6\u6d88\u6389\u4e86\uff0c\u4e4b\u524d\u6267\u884c\u7684\u5199\u64cd\u4f5c\u547d\u4ee4\u5168\u90e8\u53d6\u6d88","title":"2. redis\u4e8b\u52a1\u7684\u7528\u6cd5"},{"location":"python/lib/nosql/redis/redis.transaction/#21","text":"127.0.0.1:6379> FLUSHALL OK 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key 1 QUEUED 127.0.0.1:6379> set key2 2 QUEUED 127.0.0.1:6379> sadd key3 3 QUEUED 127.0.0.1:6379> exec 1) OK 2) OK 3) (integer) 1 127.0.0.1:6379> keys * 1) \"key2\" 2) \"key3\" 3) \"key\" EXEC \u547d\u4ee4\u7684\u56de\u590d\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u6267\u884c\u4e8b\u52a1\u4e2d\u7684\u547d\u4ee4\u6240\u4ea7\u751f\u7684\u56de\u590d\u3002 \u5176\u4e2d\uff0c\u56de\u590d\u5143\u7d20\u7684\u5148\u540e\u987a\u5e8f\u548c\u547d\u4ee4\u53d1\u9001\u7684\u5148\u540e\u987a\u5e8f\u4e00\u81f4\u3002 \u5f53\u5ba2\u6237\u7aef\u5904\u4e8e\u4e8b\u52a1\u72b6\u6001\u65f6\uff0c\u6240\u6709\u4f20\u5165\u7684\u547d\u4ee4\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5185\u5bb9\u4e3a QUEUED \u7684\u72b6\u6001\u56de\u590d\uff08status reply\uff09\uff0c\u8fd9\u4e9b\u88ab\u5165\u961f\u7684\u547d\u4ee4\u5c06\u5728 EXEC\u547d\u4ee4\u88ab\u8c03\u7528\u65f6\u6267\u884c\u3002","title":"2.1 \u6b63\u5e38\u64cd\u4f5c"},{"location":"python/lib/nosql/redis/redis.transaction/#22","text":"\u5f53\u6267\u884c DISCARD \u547d\u4ee4\u65f6\uff0c\u4e8b\u52a1\u4f1a\u88ab\u653e\u5f03\uff0c\u4e8b\u52a1\u961f\u5217\u4f1a\u88ab\u6e05\u7a7a\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u4f1a\u4ece\u4e8b\u52a1\u72b6\u6001\u4e2d\u9000\u51fa\uff1a 127.0.0.1:6379> get key \"1\" 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key 10 QUEUED 127.0.0.1:6379> DISCARD OK 127.0.0.1:6379> exec (error) ERR EXEC without MULTI 127.0.0.1:6379> get key \"1\"","title":"2.2 \u653e\u5f03\u4e8b\u52a1"},{"location":"python/lib/nosql/redis/redis.transaction/#23","text":"127.0.0.1:6379> keys * (empty list or set) 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key 1 QUEUED 127.0.0.1:6379> HSET key2 1 (error) ERR wrong number of arguments for 'hset' command 127.0.0.1:6379> SADD key3 1 QUEUED 127.0.0.1:6379> exec (error) EXECABORT Transaction discarded because of previous errors. 127.0.0.1:6379> keys * (empty list or set) \u5bf9\u4e8e\u5165\u961f\u9519\u8bef\uff0credis 2.6.5\u7248\u672c\u540e\uff0c\u4f1a\u8bb0\u5f55\u8fd9\u79cd\u9519\u8bef\uff0c\u5e76\u4e14\u5728\u6267\u884cEXEC\u7684\u65f6\u5019\uff0c\u62a5\u9519\u5e76\u56de\u6eda\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u547d\u4ee4\uff0c\u5e76\u4e14\u7ec8\u6b62\u4e8b\u52a1","title":"2.3 \u5165\u961f\u9519\u8bef\u56de\u6eda"},{"location":"python/lib/nosql/redis/redis.transaction/#24","text":"127.0.0.1:6379> flushall OK 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set k1 v1 QUEUED 127.0.0.1:6379> set k2 v2 v3 QUEUED 127.0.0.1:6379> exec 1) OK 2) (error) ERR syntax error 127.0.0.1:6379> keys * 1) \"k1\" 127.0.0.1:6379> get k1 \"v1\" \u5f53\u9047\u5230\u6267\u884c\u9519\u8bef\u65f6\uff0credis\u653e\u8fc7\u8fd9\u79cd\u9519\u8bef\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u6267\u884c\u5b8c\u6210\u3002 \u4e0d\u540c\u4e4b\u5904 \u4e0emysql\u4e2d\u4e8b\u52a1\u4e0d\u540c\uff0c\u5728redis\u4e8b\u52a1\u9047\u5230\u6267\u884c\u9519\u8bef\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u8fdb\u884c\u56de\u6eda\uff0c\u800c\u662f\u7b80\u5355\u7684\u653e\u8fc7\u4e86\uff0c\u5e76\u4fdd\u8bc1\u5176\u4ed6\u7684\u547d\u4ee4\u6b63\u5e38\u6267\u884c\u3002\u8fd9\u4e2a\u533a\u522b\u5728\u5b9e\u73b0\u4e1a\u52a1\u7684\u65f6\u5019\uff0c\u9700\u8981\u81ea\u5df1\u4fdd\u8bc1\u903b\u8f91\u7b26\u5408\u9884\u671f\u3002","title":"2.4 \u6267\u884c\u9519\u8bef\u653e\u8fc7"},{"location":"python/lib/nosql/redis/redis.transaction/#25-watch","text":"WATCH \u547d\u4ee4\u53ef\u4ee5\u4e3a Redis \u4e8b\u52a1\u63d0\u4f9b check-and-set \uff08CAS\uff09\u884c\u4e3a\u3002 \u88ab WATCH \u7684\u952e\u4f1a\u88ab\u76d1\u89c6\uff0c\u5e76\u4f1a\u53d1\u89c9\u8fd9\u4e9b\u952e\u662f\u5426\u88ab\u6539\u52a8\u8fc7\u4e86\u3002 \u5982\u679c\u6709\u81f3\u5c11\u4e00\u4e2a\u88ab\u76d1\u89c6\u7684\u952e\u5728 EXEC \u6267\u884c\u4e4b\u524d\u88ab\u4fee\u6539\u4e86\uff0c \u90a3\u4e48\u6574\u4e2a\u4e8b\u52a1\u90fd\u4f1a\u88ab\u53d6\u6d88\uff0c EXEC \u8fd4\u56de\u7a7a\u591a\u6761\u6279\u91cf\u56de\u590d\uff08null multi-bulk reply\uff09\u6765\u8868\u793a\u4e8b\u52a1\u5df2\u7ecf\u5931\u8d25\u3002 127.0.0.1:6379> keys * (empty list or set) 127.0.0.1:6379> watch key1 OK 127.0.0.1:6379> set key1 3 OK 127.0.0.1:6379> MULTI OK 127.0.0.1:6379> set key1 3 QUEUED 127.0.0.1:6379> set key2 3 QUEUED 127.0.0.1:6379> exec (nil) 127.0.0.1:6379> keys * 1) \"key1\" \u4f7f\u7528\u4e0a\u9762\u7684\u4ee3\u7801\uff0c \u5982\u679c\u5728 WATCH \u6267\u884c\u4e4b\u540e\uff0c EXEC \u6267\u884c\u4e4b\u524d\uff0c \u6709\u5176\u4ed6\u5ba2\u6237\u7aef\u4fee\u6539\u4e86 key1 \u7684\u503c\uff0c \u90a3\u4e48\u5f53\u524d\u5ba2\u6237\u7aef\u7684\u4e8b\u52a1\u5c31\u4f1a\u5931\u8d25\u3002 \u7a0b\u5e8f\u9700\u8981\u505a\u7684\uff0c \u5c31\u662f\u4e0d\u65ad\u91cd\u8bd5\u8fd9\u4e2a\u64cd\u4f5c\uff0c \u76f4\u5230\u6ca1\u6709\u53d1\u751f\u78b0\u649e\u4e3a\u6b62\u3002 \u8fd9\u79cd\u5f62\u5f0f\u7684\u9501\u88ab\u79f0\u4f5c\u4e50\u89c2\u9501\uff0c \u5b83\u662f\u4e00\u79cd\u975e\u5e38\u5f3a\u5927\u7684\u9501\u673a\u5236\u3002 \u5e76\u4e14\u56e0\u4e3a\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c \u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u4f1a\u8bbf\u95ee\u4e0d\u540c\u7684\u952e\uff0c \u78b0\u649e\u7684\u60c5\u51b5\u4e00\u822c\u90fd\u5f88\u5c11\uff0c \u6240\u4ee5\u901a\u5e38\u5e76\u4e0d\u9700\u8981\u8fdb\u884c\u91cd\u8bd5\u3002","title":"2.5 watch"},{"location":"python/lib/nosql/redis/redis.transaction/#3-demo","text":"\u8fd9\u91cc\u5c55\u793a\u4e00\u4e2a\u7528python\u5b9e\u73b0\u5bf9key\u8ba1\u6570\u51cf\u4e00\u7684\u539f\u5b50\u64cd\u4f5c\u3002 #!/usr/bin/python # _*_ coding: utf-8 _*_ \"\"\" @Time : 2019/2/21 13:25 @File : pipeline_demo.py @Author : summer @Software: PyCharm \"\"\" import redis from redis import WatchError from concurrent.futures import ProcessPoolExecutor r = redis.Redis(host='127.0.0.1', port=6379) # \u51cf\u5e93\u5b58\u51fd\u6570, \u5faa\u73af\u76f4\u5230\u51cf\u5e93\u5b58\u5b8c\u6210 # \u5e93\u5b58\u5145\u8db3, \u51cf\u5e93\u5b58\u6210\u529f, \u8fd4\u56deTrue # \u5e93\u5b58\u4e0d\u8db3, \u51cf\u5e93\u5b58\u5931\u8d25, \u8fd4\u56deFalse def decr_stock(): # python\u4e2dredis\u4e8b\u52a1\u662f\u901a\u8fc7pipeline\u7684\u5c01\u88c5\u5b9e\u73b0\u7684 with r.pipeline() as pipe: while True: try: # watch\u5e93\u5b58\u952e, multi\u540e\u5982\u679c\u8be5key\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u6539\u53d8, \u4e8b\u52a1\u64cd\u4f5c\u4f1a\u629b\u51faWatchError\u5f02\u5e38 pipe.watch('stock:count') count = int(pipe.get('stock:count')) if count > 0: # \u6709\u5e93\u5b58 # \u4e8b\u52a1\u5f00\u59cb pipe.multi() pipe.decr('stock:count') # \u628a\u547d\u4ee4\u63a8\u9001\u8fc7\u53bb # execute\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u5217\u8868, \u8fd9\u91cc\u53ea\u6709\u4e00\u4e2adecr\u8fd4\u56de\u5f53\u524d\u503c print(pipe.execute()[0]) return True else: return False except WatchError as ex: # \u6253\u5370WatchError\u5f02\u5e38, \u89c2\u5bdf\u88abwatch\u9501\u4f4f\u7684\u60c5\u51b5 print(ex, '\u9501\u4f4f\u4e86') pipe.unwatch() def worker(): while True: # \u6ca1\u6709\u5e93\u5b58\u5c31\u9000\u51fa if not decr_stock(): break # \u5b9e\u9a8c\u5f00\u59cb \u8bbe\u7f6e\u5e93\u5b58\u4e3a20 r.set(\"stock:count\", 20) # \u591a\u8fdb\u7a0b\u6a21\u62df\u591a\u4e2a\u5ba2\u6237\u7aef\u63d0\u4ea4 if __name__ == '__main__': with ProcessPoolExecutor(max_workers=2) as pool: for _ in range(10): pool.submit(worker)","title":"3. demo"},{"location":"python/lib/numPy/1.index/","text":"\u5b66\u4e60\u94fe\u63a5","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/pandas/1.index/","text":"1. \u4ecb\u7ecd \u00b6 pandas \u662f\u57fa\u4e8eNumPy \u7684\u4e00\u79cd\u5de5\u5177\uff0c\u8be5\u5de5\u5177\u662f\u4e3a\u4e86\u89e3\u51b3\u6570\u636e\u5206\u6790\u4efb\u52a1\u800c\u521b\u5efa\u7684\u3002Pandas \u7eb3\u5165\u4e86\u5927\u91cf\u5e93\u548c\u4e00\u4e9b\u6807\u51c6\u7684\u6570\u636e\u6a21\u578b\uff0c\u63d0\u4f9b\u4e86\u9ad8\u6548\u5730\u64cd\u4f5c\u5927\u578b\u6570\u636e\u96c6\u6240\u9700\u7684\u5de5\u5177\u3002pandas\u63d0\u4f9b\u4e86\u5927\u91cf\u80fd\u4f7f\u6211\u4eec\u5feb\u901f\u4fbf\u6377\u5730\u5904\u7406\u6570\u636e\u7684\u51fd\u6570\u548c\u65b9\u6cd5\u3002\u4f60\u5f88\u5feb\u5c31\u4f1a\u53d1\u73b0\uff0c\u5b83\u662f\u4f7fPython\u6210\u4e3a\u5f3a\u5927\u800c\u9ad8\u6548\u7684\u6570\u636e\u5206\u6790\u73af\u5883\u7684\u91cd\u8981\u56e0\u7d20\u4e4b\u4e00\u3002 1.1 python \u652f\u6301\u7248\u672c \u00b6 Python\u7248\u672c\u652f\u6301\u5b98\u65b9 Python 2 Python 3 \u90fd\u652f\u6301 1.2 \u5b89\u88c5 \u00b6 pip install pandas \u6839\u636epip\u7684\u7248\u672c\u6765\u5b89\u88c5 root@leco:~# pip -V pip 9.0.1 from /usr/local/lib/python3.6/site-packages (python 3.6) \u7531\u6b64\u53ef\u89c1\u672c\u5730\u73af\u5883\u662fPython3 1.3 \u5904\u7406\u6570\u636e\u7c7b\u578b \u00b6 Pandas\u5904\u7406\u4ee5\u4e0b\u4e09\u4e2a\u6570\u636e\u7ed3\u6784 \u7cfb\u5217(Series) \u6570\u636e\u5e27(DataFrame) \u9762\u677f(Panel) \u8fd9\u4e9b\u6570\u636e\u7ed3\u6784\u6784\u5efa\u5728Numpy\u6570\u7ec4\u4e4b\u4e0a\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5f88\u5feb\u3002","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/pandas/1.index/#1","text":"pandas \u662f\u57fa\u4e8eNumPy \u7684\u4e00\u79cd\u5de5\u5177\uff0c\u8be5\u5de5\u5177\u662f\u4e3a\u4e86\u89e3\u51b3\u6570\u636e\u5206\u6790\u4efb\u52a1\u800c\u521b\u5efa\u7684\u3002Pandas \u7eb3\u5165\u4e86\u5927\u91cf\u5e93\u548c\u4e00\u4e9b\u6807\u51c6\u7684\u6570\u636e\u6a21\u578b\uff0c\u63d0\u4f9b\u4e86\u9ad8\u6548\u5730\u64cd\u4f5c\u5927\u578b\u6570\u636e\u96c6\u6240\u9700\u7684\u5de5\u5177\u3002pandas\u63d0\u4f9b\u4e86\u5927\u91cf\u80fd\u4f7f\u6211\u4eec\u5feb\u901f\u4fbf\u6377\u5730\u5904\u7406\u6570\u636e\u7684\u51fd\u6570\u548c\u65b9\u6cd5\u3002\u4f60\u5f88\u5feb\u5c31\u4f1a\u53d1\u73b0\uff0c\u5b83\u662f\u4f7fPython\u6210\u4e3a\u5f3a\u5927\u800c\u9ad8\u6548\u7684\u6570\u636e\u5206\u6790\u73af\u5883\u7684\u91cd\u8981\u56e0\u7d20\u4e4b\u4e00\u3002","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/pandas/1.index/#11-python","text":"Python\u7248\u672c\u652f\u6301\u5b98\u65b9 Python 2 Python 3 \u90fd\u652f\u6301","title":"1.1 python \u652f\u6301\u7248\u672c"},{"location":"python/lib/pandas/1.index/#12","text":"pip install pandas \u6839\u636epip\u7684\u7248\u672c\u6765\u5b89\u88c5 root@leco:~# pip -V pip 9.0.1 from /usr/local/lib/python3.6/site-packages (python 3.6) \u7531\u6b64\u53ef\u89c1\u672c\u5730\u73af\u5883\u662fPython3","title":"1.2 \u5b89\u88c5"},{"location":"python/lib/pandas/1.index/#13","text":"Pandas\u5904\u7406\u4ee5\u4e0b\u4e09\u4e2a\u6570\u636e\u7ed3\u6784 \u7cfb\u5217(Series) \u6570\u636e\u5e27(DataFrame) \u9762\u677f(Panel) \u8fd9\u4e9b\u6570\u636e\u7ed3\u6784\u6784\u5efa\u5728Numpy\u6570\u7ec4\u4e4b\u4e0a\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5f88\u5feb\u3002","title":"1.3 \u5904\u7406\u6570\u636e\u7c7b\u578b"},{"location":"python/lib/sh/1.sh/","text":"\u53c2\u8003\u94fe\u63a5 python sh\u5e93 sh is a full-fledged subprocess replacement for Python 2.6 - 3.5, PyPy and PyPy3 that allows you to call any program as if it were a function: \u5b89\u88c5 pip install sh 1. \u67e5\u770b\u7f51\u5361\u4fe1\u606f \u00b6 In [1]: from sh import ifconfig In [2]: print(ifconfig('enp3s0')) enp3s0 Link encap:\u4ee5\u592a\u7f51 \u786c\u4ef6\u5730\u5740 74:27:ea:b0:aa:2c inet \u5730\u5740:192.168.5.110 \u5e7f\u64ad:192.168.5.255 \u63a9\u7801:255.255.255.0 inet6 \u5730\u5740: 2002::10/64 Scope:Global inet6 \u5730\u5740: fe80::7627:eaff:feb0:aa2c/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 \u8dc3\u70b9\u6570:1 \u63a5\u6536\u6570\u636e\u5305:30279078 \u9519\u8bef:0 \u4e22\u5f03:0 \u8fc7\u8f7d:0 \u5e27\u6570:0 \u53d1\u9001\u6570\u636e\u5305:28671072 \u9519\u8bef:0 \u4e22\u5f03:0 \u8fc7\u8f7d:0 \u8f7d\u6ce2:0 \u78b0\u649e:0 \u53d1\u9001\u961f\u5217\u957f\u5ea6:1000 \u63a5\u6536\u5b57\u8282:12743118233 (12.7 GB) \u53d1\u9001\u5b57\u8282:15521623957 (15.5 GB) In [3]: import sh In [5]: sh.ls(\"/tmp/yun\") Out[5]: crawler import stat.tgz 2. \u5f02\u5e38\u6355\u83b7 \u00b6 try: sh.ls(\"/doesnt/exist\") except sh.ErrorReturnCode_2: print(\"directory doesn't exist\") 3. \u8c03\u7528\u7cfb\u7edf\u7a0b\u5e8f \u00b6 In [12]: import sh In [14]: sh.ls('/tmp/yun') Out[14]: crawler import stat.tgz 4. \u8c03\u7528\u81ea\u5df1\u7684\u7a0b\u5e8f \u00b6 5. bake\u547d\u4ee4\u547d\u4ee4\u53c2\u6570 \u00b6 In [24]: import sh In [25]: du=sh.du.bake('-shc') In [26]: print (du('/tmp/yun')) 6.3M /tmp/yun 6.3M \u603b\u7528\u91cf 6. glob\u5217\u51fa\u6587\u4ef6 \u00b6 In [27]: import sh In [28]: list=sh.glob('/tmp/yun*') In [29]: print(list) ['/tmp/yun'] 7. \u7ba1\u9053 \u00b6 In [31]: import sh In [32]: print(sh.sort(sh.du(sh.glob('Python-2.7.8'),'-shc'),'-rn')) 132M \u603b\u7528\u91cf 132M Python-2.7.8 \u7ba1\u9053\u662f\u6709\u5e8f\u7684\uff0c\u9ed8\u8ba4\u7531\u5185\u800c\u5916\uff0c\u4f46\u5982\u679c\u9700\u8981\u5e76\u884c\u5462\uff1f\u52a0\u4e2a_piped=True In [33]: import sh In [34]: for line in sh.tr(sh.tail(\"-f\", \"/var/log/syslog\", _piped=True), \"[:upper:]\", \"[:lower:]\", _iter=True): ...: print(line) ...: jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/52/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/6/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/8/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/856/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/857/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/9/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/98/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/99/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z e! influxdb output error: post http://localhost:8086/write?consistency=any&db=telegraf: dial tcp 127.0.0.1:8086: getsockopt: connection refused jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z e! error writing to output [influxdb]: could not write to any influxdb server in cluster 8. \u540e\u53f0\u8fd0\u884c \u00b6 In [37]: out = sh.find('-name',\"test.sh\",_bg=True) In [38]: out Out[38]: ./test.sh ./py/pachong/node/deps/openssl/openssl/demos/tunala/test.sh","title":"1. sh\u4f7f\u7528"},{"location":"python/lib/sh/1.sh/#1","text":"In [1]: from sh import ifconfig In [2]: print(ifconfig('enp3s0')) enp3s0 Link encap:\u4ee5\u592a\u7f51 \u786c\u4ef6\u5730\u5740 74:27:ea:b0:aa:2c inet \u5730\u5740:192.168.5.110 \u5e7f\u64ad:192.168.5.255 \u63a9\u7801:255.255.255.0 inet6 \u5730\u5740: 2002::10/64 Scope:Global inet6 \u5730\u5740: fe80::7627:eaff:feb0:aa2c/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 \u8dc3\u70b9\u6570:1 \u63a5\u6536\u6570\u636e\u5305:30279078 \u9519\u8bef:0 \u4e22\u5f03:0 \u8fc7\u8f7d:0 \u5e27\u6570:0 \u53d1\u9001\u6570\u636e\u5305:28671072 \u9519\u8bef:0 \u4e22\u5f03:0 \u8fc7\u8f7d:0 \u8f7d\u6ce2:0 \u78b0\u649e:0 \u53d1\u9001\u961f\u5217\u957f\u5ea6:1000 \u63a5\u6536\u5b57\u8282:12743118233 (12.7 GB) \u53d1\u9001\u5b57\u8282:15521623957 (15.5 GB) In [3]: import sh In [5]: sh.ls(\"/tmp/yun\") Out[5]: crawler import stat.tgz","title":"1. \u67e5\u770b\u7f51\u5361\u4fe1\u606f"},{"location":"python/lib/sh/1.sh/#2","text":"try: sh.ls(\"/doesnt/exist\") except sh.ErrorReturnCode_2: print(\"directory doesn't exist\")","title":"2. \u5f02\u5e38\u6355\u83b7"},{"location":"python/lib/sh/1.sh/#3","text":"In [12]: import sh In [14]: sh.ls('/tmp/yun') Out[14]: crawler import stat.tgz","title":"3. \u8c03\u7528\u7cfb\u7edf\u7a0b\u5e8f"},{"location":"python/lib/sh/1.sh/#4","text":"","title":"4. \u8c03\u7528\u81ea\u5df1\u7684\u7a0b\u5e8f"},{"location":"python/lib/sh/1.sh/#5-bake","text":"In [24]: import sh In [25]: du=sh.du.bake('-shc') In [26]: print (du('/tmp/yun')) 6.3M /tmp/yun 6.3M \u603b\u7528\u91cf","title":"5. bake\u547d\u4ee4\u547d\u4ee4\u53c2\u6570"},{"location":"python/lib/sh/1.sh/#6-glob","text":"In [27]: import sh In [28]: list=sh.glob('/tmp/yun*') In [29]: print(list) ['/tmp/yun']","title":"6. glob\u5217\u51fa\u6587\u4ef6"},{"location":"python/lib/sh/1.sh/#7","text":"In [31]: import sh In [32]: print(sh.sort(sh.du(sh.glob('Python-2.7.8'),'-shc'),'-rn')) 132M \u603b\u7528\u91cf 132M Python-2.7.8 \u7ba1\u9053\u662f\u6709\u5e8f\u7684\uff0c\u9ed8\u8ba4\u7531\u5185\u800c\u5916\uff0c\u4f46\u5982\u679c\u9700\u8981\u5e76\u884c\u5462\uff1f\u52a0\u4e2a_piped=True In [33]: import sh In [34]: for line in sh.tr(sh.tail(\"-f\", \"/var/log/syslog\", _piped=True), \"[:upper:]\", \"[:lower:]\", _iter=True): ...: print(line) ...: jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/52/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/6/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/8/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/856/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/857/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/9/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/98/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z i! processes: unknown state [ i ] in file /proc/99/stat jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z e! influxdb output error: post http://localhost:8086/write?consistency=any&db=telegraf: dial tcp 127.0.0.1:8086: getsockopt: connection refused jan 14 09:38:40 localhost telegraf[2077]: 2019-01-14t01:38:40z e! error writing to output [influxdb]: could not write to any influxdb server in cluster","title":"7. \u7ba1\u9053"},{"location":"python/lib/sh/1.sh/#8","text":"In [37]: out = sh.find('-name',\"test.sh\",_bg=True) In [38]: out Out[38]: ./test.sh ./py/pachong/node/deps/openssl/openssl/demos/tunala/test.sh","title":"8. \u540e\u53f0\u8fd0\u884c"},{"location":"python/lib/uuid/uuid.index/","text":"1. \u4ecb\u7ecd \u00b6 uuid\u662f128\u4f4d\u7684\u5168\u5c40\u552f\u4e00\u6807\u8bc6\u7b26\uff08univeral unique identifier\uff09\uff0c\u901a\u5e38\u752832\u4f4d\u7684\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u6765\u8868\u73b0\u3002\u6709\u65f6\u4e5f\u79f0guid(global unique identifier)\u3002python\u4e2d\u81ea\u5e26\u4e86uuid\u6a21\u5757\u6765\u8fdb\u884cuuid\u7684\u751f\u6210\u548c\u7ba1\u7406\u5de5\u4f5c\u3002 python\u4e2d\u7684uuid\u6a21\u5757\u57fa\u4e8e\u4fe1\u606f\u5982MAC\u5730\u5740\u3001\u65f6\u95f4\u6233\u3001\u547d\u540d\u7a7a\u95f4\u3001\u968f\u673a\u6570\u3001\u4f2a\u968f\u673a\u6570\u6765uuid\u3002\u5177\u4f53\u65b9\u6cd5\u6709\u5982\u4e0b\u51e0\u4e2a\u3002 1.1 uuid.uuid1() \u00b6 \u57fa\u4e8eMAC\u5730\u5740\uff0c\u65f6\u95f4\u6233\uff0c\u968f\u673a\u6570\u6765\u751f\u6210\u552f\u4e00\u7684uuid\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u5168\u7403\u8303\u56f4\u5185\u7684\u552f\u4e00\u6027\u3002 1.2 uuid.uuid2() \u00b6 \u7b97\u6cd5\u4e0euuid1\u76f8\u540c\uff0c\u4e0d\u540c\u7684\u662f\u628a\u65f6\u95f4\u6233\u7684\u524d4\u4f4d\u7f6e\u6362\u4e3aPOSIX\u7684UID\u3002\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7684\u662fpython\u4e2d\u6ca1\u6709\u57fa\u4e8eDCE\u7684\u7b97\u6cd5\uff0c\u6240\u4ee5python\u7684uuid\u6a21\u5757\u4e2d\u6ca1\u6709uuid2\u8fd9\u4e2a\u65b9\u6cd5\u3002 1.3 uuid.uuid3(namespace,name) \u00b6 \u901a\u8fc7\u8ba1\u7b97\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u548c\u540d\u5b57\u7684md5\u6563\u5217\u503c\u6765\u7ed9\u51fa\u4e00\u4e2auuid\uff0c\u6240\u4ee5\u53ef\u4ee5\u4fdd\u8bc1\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u4e0d\u540c\u540d\u5b57\u5177\u6709\u4e0d\u540c\u7684uuid\uff0c\u4f46\u662f\u76f8\u540c\u7684\u540d\u5b57\u5c31\u662f\u76f8\u540c\u7684uuid\u4e86\u3002namespace\u5e76\u4e0d\u662f\u4e00\u4e2a\u81ea\u5df1\u624b\u52a8\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u6216\u5176\u4ed6\u91cf\uff0c\u800c\u662f\u5728uuid\u6a21\u5757\u4e2d\u672c\u8eab\u7ed9\u51fa\u7684\u4e00\u4e9b\u503c\u3002\u6bd4\u5982uuid.NAMESPACE_DNS\uff0cuuid.NAMESPACE_OID\uff0cuuid.NAMESPACE_OID\u8fd9\u4e9b\u503c\u3002\u8fd9\u4e9b\u503c\u672c\u8eab\u4e5f\u662fUUID\u5bf9\u8c61\uff0c\u6839\u636e\u4e00\u5b9a\u7684\u89c4\u5219\u8ba1\u7b97\u5f97\u51fa\u3002 1.4 uuid.uuid4() \u00b6 \u901a\u8fc7\u4f2a\u968f\u673a\u6570\u5f97\u5230uuid\uff0c\u662f\u6709\u4e00\u5b9a\u6982\u7387\u91cd\u590d\u7684 1.5 uuid.uuid5(namespace,name) \u00b6 uuid3\u57fa\u672c\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u91c7\u7528\u7684\u6563\u5217\u7b97\u6cd5\u662fsha1\u3002 UUID: \u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26 ( Universally Unique Identifier ), \u5bf9\u4e8e\u6240\u6709\u7684UUID\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u5728\u7a7a\u95f4\u548c\u65f6\u95f4\u4e0a\u7684\u552f\u4e00\u6027. \u5b83\u662f\u901a\u8fc7MAC\u5730\u5740, \u65f6\u95f4\u6233, \u547d\u540d\u7a7a\u95f4, \u968f\u673a\u6570, \u4f2a\u968f\u673a\u6570\u6765\u4fdd\u8bc1\u751f\u6210ID\u7684\u552f\u4e00\u6027, \u6709\u7740\u56fa\u5b9a\u7684\u5927\u5c0f( 128 bit ). \u5b83\u7684\u552f\u4e00\u6027\u548c\u4e00\u81f4\u6027\u7279\u70b9\u4f7f\u5f97\u53ef\u4ee5\u65e0\u9700\u6ce8\u518c\u8fc7\u7a0b\u5c31\u80fd\u591f\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684UUID. UUID\u53ef\u4ee5\u88ab\u7528\u4f5c\u591a\u79cd\u7528\u9014, \u65e2\u53ef\u4ee5\u7528\u6765\u77ed\u65f6\u95f4\u5185\u6807\u8bb0\u4e00\u4e2a\u5bf9\u8c61, \u4e5f\u53ef\u4ee5\u53ef\u9760\u7684\u8fa8\u522b\u7f51\u7edc\u4e2d\u7684\u6301\u4e45\u6027\u5bf9\u8c61. \u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528UUID? \u5f88\u591a\u5e94\u7528\u573a\u666f\u9700\u8981\u4e00\u4e2aid, \u4f46\u662f\u53c8\u4e0d\u8981\u6c42\u8fd9\u4e2aid \u6709\u5177\u4f53\u7684\u610f\u4e49, \u4ec5\u4ec5\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u5bf9\u8c61. \u5e38\u89c1\u7684\u4f8b\u5b50\u6709\u6570\u636e\u5e93\u8868\u7684id \u5b57\u6bb5. \u53e6\u4e00\u4e2a\u4f8b\u5b50\u662f\u524d\u7aef\u7684\u5404\u79cdUI\u5e93, \u56e0\u4e3a\u5b83\u4eec\u901a\u5e38\u9700\u8981\u52a8\u6001\u521b\u5efa\u5404\u79cdUI\u5143\u7d20, \u8fd9\u4e9b\u5143\u7d20\u9700\u8981\u552f\u4e00\u7684id , \u8fd9\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528UUID\u4e86. 2. Python\u7684uuid\u6a21\u5757 \u00b6 python\u7684uuid\u6a21\u5757\u63d0\u4f9bUUID\u7c7b\u548c\u51fd\u6570uuid1(), uuid3(), uuid4(), uuid5() \u6765\u751f\u62101, 3, 4, 5\u5404\u4e2a\u7248\u672c\u7684UUID ( \u9700\u8981\u6ce8\u610f\u7684\u662f: python\u4e2d\u6ca1\u6709uuid2()\u8fd9\u4e2a\u51fd\u6570). \u5bf9uuid\u6a21\u5757\u4e2d\u6700\u5e38\u7528\u7684\u51e0\u4e2a\u51fd\u6570\u603b\u7ed3\u5982\u4e0b: 2.1 uuid.uuid1([node[, clock_seq]]) \u00b6 \u57fa\u4e8e\u65f6\u95f4\u6233 \u4f7f\u7528\u4e3b\u673aID, \u5e8f\u5217\u53f7, \u548c\u5f53\u524d\u65f6\u95f4\u6765\u751f\u6210UUID, \u53ef\u4fdd\u8bc1\u5168\u7403\u8303\u56f4\u7684\u552f\u4e00\u6027. \u4f46\u7531\u4e8e\u4f7f\u7528\u8be5\u65b9\u6cd5\u751f\u6210\u7684UUID\u4e2d\u5305\u542b\u6709\u4e3b\u673a\u7684\u7f51\u7edc\u5730\u5740, \u56e0\u6b64\u53ef\u80fd\u5371\u53ca\u9690\u79c1. \u8be5\u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570, \u5982\u679c node \u53c2\u6570\u672a\u6307\u5b9a, \u7cfb\u7edf\u5c06\u4f1a\u81ea\u52a8\u8c03\u7528 getnode() \u51fd\u6570\u6765\u83b7\u53d6\u4e3b\u673a\u7684\u786c\u4ef6\u5730\u5740. \u5982\u679c clock_seq \u53c2\u6570\u672a\u6307\u5b9a\u7cfb\u7edf\u4f1a\u4f7f\u7528\u4e00\u4e2a\u968f\u673a\u4ea7\u751f\u768414\u4f4d\u5e8f\u5217\u53f7\u6765\u4ee3\u66ff. 2.2 uuid.uuid3(namespace, name) \u00b6 \u57fa\u4e8e\u540d\u5b57\u7684MD5\u6563\u5217\u503c \u901a\u8fc7\u8ba1\u7b97\u547d\u540d\u7a7a\u95f4\u548c\u540d\u5b57\u7684MD5\u6563\u5217\u503c\u6765\u751f\u6210UUID, \u53ef\u4ee5\u4fdd\u8bc1\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u4e2d\u4e0d\u540c\u540d\u5b57\u7684\u552f\u4e00\u6027\u548c\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u7684\u552f\u4e00\u6027, \u4f46\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u7684\u540c\u4e00\u540d\u5b57\u751f\u6210\u7684UUID\u76f8\u540c. 2.3 uuid.uuid4() \u00b6 \u57fa\u4e8e\u968f\u673a\u6570 \u901a\u8fc7\u968f\u673a\u6570\u6765\u751f\u6210UUID. \u4f7f\u7528\u7684\u662f\u4f2a\u968f\u673a\u6570\u6709\u4e00\u5b9a\u7684\u91cd\u590d\u6982\u7387. 2.4 uuid.uuid5(namespace, name) \u00b6 \u57fa\u4e8e\u540d\u5b57\u7684SHA-1\u6563\u5217\u503c \u901a\u8fc7\u8ba1\u7b97\u547d\u540d\u7a7a\u95f4\u548c\u540d\u5b57\u7684SHA-1\u6563\u5217\u503c\u6765\u751f\u6210UUID, \u7b97\u6cd5\u4e0e uuid.uuid3() \u76f8\u540c. In [1]: import uuid # make a UUID based on the host ID and current time In [4]: uuid.uuid1() Out[4]: UUID('4894dae8-35ad-11e9-a653-7427eab0aa2c') # make a UUID using an MD5 hash of a namespace UUID and a name In [5]: uuid.uuid3(uuid.NAMESPACE_DNS, 'python.org') Out[5]: UUID('6fa459ea-ee8a-3ca4-894e-db77e160355e') # make a random UUID In [6]: uuid.uuid4() Out[6]: UUID('c86ad986-498f-4caf-901e-198076f335d6') # make a UUID using a SHA-1 hash of a namespace UUID and a name In [7]: uuid.uuid5(uuid.NAMESPACE_DNS, 'python.org') Out[7]: UUID('886313e1-3b8a-5372-9b90-0c9aee199e5d') # make a UUID from a string of hex digits (braces and hyphens ignored) In [8]: x = uuid.UUID('{00010203-0405-0607-0809-0a0b0c0d0e0f}') # convert a UUID to a string of hex digits in standard form In [9]: str(x) Out[9]: '00010203-0405-0607-0809-0a0b0c0d0e0f' # get the raw 16 bytes of the UUID In [10]: x.bytes Out[10]: b'\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\t\\n\\x0b\\x0c\\r\\x0e\\x0f' # make a UUID from a 16-byte string In [11]: uuid.UUID(bytes=x.bytes) Out[11]: UUID('00010203-0405-0607-0809-0a0b0c0d0e0f')","title":"1. uuid"},{"location":"python/lib/uuid/uuid.index/#1","text":"uuid\u662f128\u4f4d\u7684\u5168\u5c40\u552f\u4e00\u6807\u8bc6\u7b26\uff08univeral unique identifier\uff09\uff0c\u901a\u5e38\u752832\u4f4d\u7684\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u6765\u8868\u73b0\u3002\u6709\u65f6\u4e5f\u79f0guid(global unique identifier)\u3002python\u4e2d\u81ea\u5e26\u4e86uuid\u6a21\u5757\u6765\u8fdb\u884cuuid\u7684\u751f\u6210\u548c\u7ba1\u7406\u5de5\u4f5c\u3002 python\u4e2d\u7684uuid\u6a21\u5757\u57fa\u4e8e\u4fe1\u606f\u5982MAC\u5730\u5740\u3001\u65f6\u95f4\u6233\u3001\u547d\u540d\u7a7a\u95f4\u3001\u968f\u673a\u6570\u3001\u4f2a\u968f\u673a\u6570\u6765uuid\u3002\u5177\u4f53\u65b9\u6cd5\u6709\u5982\u4e0b\u51e0\u4e2a\u3002","title":"1. \u4ecb\u7ecd"},{"location":"python/lib/uuid/uuid.index/#11-uuiduuid1","text":"\u57fa\u4e8eMAC\u5730\u5740\uff0c\u65f6\u95f4\u6233\uff0c\u968f\u673a\u6570\u6765\u751f\u6210\u552f\u4e00\u7684uuid\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u5168\u7403\u8303\u56f4\u5185\u7684\u552f\u4e00\u6027\u3002","title":"1.1 uuid.uuid1()"},{"location":"python/lib/uuid/uuid.index/#12-uuiduuid2","text":"\u7b97\u6cd5\u4e0euuid1\u76f8\u540c\uff0c\u4e0d\u540c\u7684\u662f\u628a\u65f6\u95f4\u6233\u7684\u524d4\u4f4d\u7f6e\u6362\u4e3aPOSIX\u7684UID\u3002\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7684\u662fpython\u4e2d\u6ca1\u6709\u57fa\u4e8eDCE\u7684\u7b97\u6cd5\uff0c\u6240\u4ee5python\u7684uuid\u6a21\u5757\u4e2d\u6ca1\u6709uuid2\u8fd9\u4e2a\u65b9\u6cd5\u3002","title":"1.2 uuid.uuid2()"},{"location":"python/lib/uuid/uuid.index/#13-uuiduuid3namespacename","text":"\u901a\u8fc7\u8ba1\u7b97\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u548c\u540d\u5b57\u7684md5\u6563\u5217\u503c\u6765\u7ed9\u51fa\u4e00\u4e2auuid\uff0c\u6240\u4ee5\u53ef\u4ee5\u4fdd\u8bc1\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u4e0d\u540c\u540d\u5b57\u5177\u6709\u4e0d\u540c\u7684uuid\uff0c\u4f46\u662f\u76f8\u540c\u7684\u540d\u5b57\u5c31\u662f\u76f8\u540c\u7684uuid\u4e86\u3002namespace\u5e76\u4e0d\u662f\u4e00\u4e2a\u81ea\u5df1\u624b\u52a8\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u6216\u5176\u4ed6\u91cf\uff0c\u800c\u662f\u5728uuid\u6a21\u5757\u4e2d\u672c\u8eab\u7ed9\u51fa\u7684\u4e00\u4e9b\u503c\u3002\u6bd4\u5982uuid.NAMESPACE_DNS\uff0cuuid.NAMESPACE_OID\uff0cuuid.NAMESPACE_OID\u8fd9\u4e9b\u503c\u3002\u8fd9\u4e9b\u503c\u672c\u8eab\u4e5f\u662fUUID\u5bf9\u8c61\uff0c\u6839\u636e\u4e00\u5b9a\u7684\u89c4\u5219\u8ba1\u7b97\u5f97\u51fa\u3002","title":"1.3 uuid.uuid3(namespace,name)"},{"location":"python/lib/uuid/uuid.index/#14-uuiduuid4","text":"\u901a\u8fc7\u4f2a\u968f\u673a\u6570\u5f97\u5230uuid\uff0c\u662f\u6709\u4e00\u5b9a\u6982\u7387\u91cd\u590d\u7684","title":"1.4 uuid.uuid4()"},{"location":"python/lib/uuid/uuid.index/#15-uuiduuid5namespacename","text":"uuid3\u57fa\u672c\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u91c7\u7528\u7684\u6563\u5217\u7b97\u6cd5\u662fsha1\u3002 UUID: \u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26 ( Universally Unique Identifier ), \u5bf9\u4e8e\u6240\u6709\u7684UUID\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u5728\u7a7a\u95f4\u548c\u65f6\u95f4\u4e0a\u7684\u552f\u4e00\u6027. \u5b83\u662f\u901a\u8fc7MAC\u5730\u5740, \u65f6\u95f4\u6233, \u547d\u540d\u7a7a\u95f4, \u968f\u673a\u6570, \u4f2a\u968f\u673a\u6570\u6765\u4fdd\u8bc1\u751f\u6210ID\u7684\u552f\u4e00\u6027, \u6709\u7740\u56fa\u5b9a\u7684\u5927\u5c0f( 128 bit ). \u5b83\u7684\u552f\u4e00\u6027\u548c\u4e00\u81f4\u6027\u7279\u70b9\u4f7f\u5f97\u53ef\u4ee5\u65e0\u9700\u6ce8\u518c\u8fc7\u7a0b\u5c31\u80fd\u591f\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684UUID. UUID\u53ef\u4ee5\u88ab\u7528\u4f5c\u591a\u79cd\u7528\u9014, \u65e2\u53ef\u4ee5\u7528\u6765\u77ed\u65f6\u95f4\u5185\u6807\u8bb0\u4e00\u4e2a\u5bf9\u8c61, \u4e5f\u53ef\u4ee5\u53ef\u9760\u7684\u8fa8\u522b\u7f51\u7edc\u4e2d\u7684\u6301\u4e45\u6027\u5bf9\u8c61. \u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528UUID? \u5f88\u591a\u5e94\u7528\u573a\u666f\u9700\u8981\u4e00\u4e2aid, \u4f46\u662f\u53c8\u4e0d\u8981\u6c42\u8fd9\u4e2aid \u6709\u5177\u4f53\u7684\u610f\u4e49, \u4ec5\u4ec5\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u5bf9\u8c61. \u5e38\u89c1\u7684\u4f8b\u5b50\u6709\u6570\u636e\u5e93\u8868\u7684id \u5b57\u6bb5. \u53e6\u4e00\u4e2a\u4f8b\u5b50\u662f\u524d\u7aef\u7684\u5404\u79cdUI\u5e93, \u56e0\u4e3a\u5b83\u4eec\u901a\u5e38\u9700\u8981\u52a8\u6001\u521b\u5efa\u5404\u79cdUI\u5143\u7d20, \u8fd9\u4e9b\u5143\u7d20\u9700\u8981\u552f\u4e00\u7684id , \u8fd9\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528UUID\u4e86.","title":"1.5 uuid.uuid5(namespace,name)"},{"location":"python/lib/uuid/uuid.index/#2-pythonuuid","text":"python\u7684uuid\u6a21\u5757\u63d0\u4f9bUUID\u7c7b\u548c\u51fd\u6570uuid1(), uuid3(), uuid4(), uuid5() \u6765\u751f\u62101, 3, 4, 5\u5404\u4e2a\u7248\u672c\u7684UUID ( \u9700\u8981\u6ce8\u610f\u7684\u662f: python\u4e2d\u6ca1\u6709uuid2()\u8fd9\u4e2a\u51fd\u6570). \u5bf9uuid\u6a21\u5757\u4e2d\u6700\u5e38\u7528\u7684\u51e0\u4e2a\u51fd\u6570\u603b\u7ed3\u5982\u4e0b:","title":"2. Python\u7684uuid\u6a21\u5757"},{"location":"python/lib/uuid/uuid.index/#21-uuiduuid1node-clock_seq","text":"\u57fa\u4e8e\u65f6\u95f4\u6233 \u4f7f\u7528\u4e3b\u673aID, \u5e8f\u5217\u53f7, \u548c\u5f53\u524d\u65f6\u95f4\u6765\u751f\u6210UUID, \u53ef\u4fdd\u8bc1\u5168\u7403\u8303\u56f4\u7684\u552f\u4e00\u6027. \u4f46\u7531\u4e8e\u4f7f\u7528\u8be5\u65b9\u6cd5\u751f\u6210\u7684UUID\u4e2d\u5305\u542b\u6709\u4e3b\u673a\u7684\u7f51\u7edc\u5730\u5740, \u56e0\u6b64\u53ef\u80fd\u5371\u53ca\u9690\u79c1. \u8be5\u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570, \u5982\u679c node \u53c2\u6570\u672a\u6307\u5b9a, \u7cfb\u7edf\u5c06\u4f1a\u81ea\u52a8\u8c03\u7528 getnode() \u51fd\u6570\u6765\u83b7\u53d6\u4e3b\u673a\u7684\u786c\u4ef6\u5730\u5740. \u5982\u679c clock_seq \u53c2\u6570\u672a\u6307\u5b9a\u7cfb\u7edf\u4f1a\u4f7f\u7528\u4e00\u4e2a\u968f\u673a\u4ea7\u751f\u768414\u4f4d\u5e8f\u5217\u53f7\u6765\u4ee3\u66ff.","title":"2.1 uuid.uuid1([node[, clock_seq]])"},{"location":"python/lib/uuid/uuid.index/#22-uuiduuid3namespace-name","text":"\u57fa\u4e8e\u540d\u5b57\u7684MD5\u6563\u5217\u503c \u901a\u8fc7\u8ba1\u7b97\u547d\u540d\u7a7a\u95f4\u548c\u540d\u5b57\u7684MD5\u6563\u5217\u503c\u6765\u751f\u6210UUID, \u53ef\u4ee5\u4fdd\u8bc1\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u4e2d\u4e0d\u540c\u540d\u5b57\u7684\u552f\u4e00\u6027\u548c\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u7684\u552f\u4e00\u6027, \u4f46\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u7684\u540c\u4e00\u540d\u5b57\u751f\u6210\u7684UUID\u76f8\u540c.","title":"2.2 uuid.uuid3(namespace, name)"},{"location":"python/lib/uuid/uuid.index/#23-uuiduuid4","text":"\u57fa\u4e8e\u968f\u673a\u6570 \u901a\u8fc7\u968f\u673a\u6570\u6765\u751f\u6210UUID. \u4f7f\u7528\u7684\u662f\u4f2a\u968f\u673a\u6570\u6709\u4e00\u5b9a\u7684\u91cd\u590d\u6982\u7387.","title":"2.3 uuid.uuid4()"},{"location":"python/lib/uuid/uuid.index/#24-uuiduuid5namespace-name","text":"\u57fa\u4e8e\u540d\u5b57\u7684SHA-1\u6563\u5217\u503c \u901a\u8fc7\u8ba1\u7b97\u547d\u540d\u7a7a\u95f4\u548c\u540d\u5b57\u7684SHA-1\u6563\u5217\u503c\u6765\u751f\u6210UUID, \u7b97\u6cd5\u4e0e uuid.uuid3() \u76f8\u540c. In [1]: import uuid # make a UUID based on the host ID and current time In [4]: uuid.uuid1() Out[4]: UUID('4894dae8-35ad-11e9-a653-7427eab0aa2c') # make a UUID using an MD5 hash of a namespace UUID and a name In [5]: uuid.uuid3(uuid.NAMESPACE_DNS, 'python.org') Out[5]: UUID('6fa459ea-ee8a-3ca4-894e-db77e160355e') # make a random UUID In [6]: uuid.uuid4() Out[6]: UUID('c86ad986-498f-4caf-901e-198076f335d6') # make a UUID using a SHA-1 hash of a namespace UUID and a name In [7]: uuid.uuid5(uuid.NAMESPACE_DNS, 'python.org') Out[7]: UUID('886313e1-3b8a-5372-9b90-0c9aee199e5d') # make a UUID from a string of hex digits (braces and hyphens ignored) In [8]: x = uuid.UUID('{00010203-0405-0607-0809-0a0b0c0d0e0f}') # convert a UUID to a string of hex digits in standard form In [9]: str(x) Out[9]: '00010203-0405-0607-0809-0a0b0c0d0e0f' # get the raw 16 bytes of the UUID In [10]: x.bytes Out[10]: b'\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\t\\n\\x0b\\x0c\\r\\x0e\\x0f' # make a UUID from a 16-byte string In [11]: uuid.UUID(bytes=x.bytes) Out[11]: UUID('00010203-0405-0607-0809-0a0b0c0d0e0f')","title":"2.4 uuid.uuid5(namespace, name)"},{"location":"python/lib/wordcloud/1.wordcloud/","text":"1. \u5b89\u88c5 \u00b6 \u82e5\u4e0b\u8f7d\u6162\uff0c\u53ef\u66f4\u6362\u5b89\u88c5\u6e90\u4e3a\u8c46\u74e3 sudo pip install --trusted-host pypi.douban.com -i http://pypi.douban.com/simple/ wordcloud 2. word cloud \u5e93\u4ecb\u7ecd \u00b6 wordcloud\u5e93\uff0c\u53ef\u4ee5\u8bf4\u662fpython\u975e\u5e38\u4f18\u79c0\u7684\u8bcd\u4e91\u5c55\u793a\u7b2c\u4e09\u65b9\u5e93\u3002\u8bcd\u4e91\u4ee5\u8bcd\u8bed\u4e3a\u57fa\u672c\u5355\u4f4d\u66f4\u52a0\u76f4\u89c2\u548c\u827a\u672f\u7684\u5c55\u793a\u6587\u672c\uff0c\u4e0b\u9762\u7ed9\u5927\u5bb6\u770b\u4e00\u4e2a\u793a\u4f8b\uff1a 2.1 \u4ecb\u7ecd \u00b6 \u63a5\u4e0b\u6765\uff0c\u4ecb\u7ecd\u4e0bwordcloud\u7684\u57fa\u672c\u4f7f\u7528\u3002wordcloud\u628a\u8bcd\u4e91\u5f53\u4f5c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5b83\u53ef\u4ee5\u5c06\u6587\u672c\u4e2d\u8bcd\u8bed\u51fa\u73b0\u7684\u9891\u7387\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u7ed8\u5236\u8bcd\u4e91\uff0c\u800c\u8bcd\u4e91\u7684\u5927\u5c0f\u3001\u989c\u8272\u3001\u5f62\u72b6\u7b49\u90fd\u662f\u53ef\u4ee5\u8bbe\u5b9a\u7684\u3002 In [5]: from wordcloud import WordCloud In [6]: W = WordCloud() 2.2 \u53c2\u6570 \u00b6 \u5728wordcloud\u4f5c\u4e3a\u5bf9\u8c61\u65f6\uff0c\u5927\u5bb6\u8981\u6ce8\u610f\u5b57\u6bcd\u7684\u5927\u5c0f\u5199\u3002 \u603b\u7684\u6765\u8bf4\uff0c\u751f\u6210\u4e00\u4e2a\u6f02\u4eae\u7684\u8bcd\u4e91\u6587\u4ef6\u4e09\u6b65\u5c31\u53ef\u4ee5\u5b8c\u6210. 1\u3001\u914d\u7f6e\u5bf9\u8c61\u53c2\u6570 2\u3001\u52a0\u8f7d\u8bcd\u4e91\u6587\u672c 3\u3001\u8f93\u51fa\u8bcd\u4e91\u6587\u4ef6 \uff08\u5982\u679c\u4e0d\u52a0\u8bf4\u660e\u9ed8\u8ba4\u7684\u56fe\u7247\u5927\u5c0f\u4e3a400 * 200\uff09 wordcloud\u7684\u5e38\u89c4\u65b9\u6cd5\u5982\u4e0b\uff1a \u65b9\u6cd5 \u63cf\u8ff0 w.generate(txt) \u5411 WordCloud\u5bf9\u8c61W\u4e2d\u52a0\u8f7d\u6587\u4ef6txt\uff0c\u4f8b\u5982 w.generate(\"Python && wordcloud\") w.to_file(filename) \u5c06\u8bcd\u4e91\u8f93\u51fa\u7684\u56fe\u50cf\u539f\u4ef6.png\u6216\u8005.jpg\u683c\u5f0f\u4fdd\u5b58 w.to_file(\"pic.png\") 2.3 \u4ee3\u7801 \u00b6 #!/usr/bin/python # _*_ coding: utf-8 _*_ from wordcloud import WordCloud w = WordCloud() # \u8bbe\u7f6e\u5bf9\u8c61 w.generate(\"I love china\") # \u52a0\u8f7d\u6587\u672c w.to_file(\"love.png\") # \u4fdd\u5b58 \u8fd0\u884c\u7ed3\u679c images/love.png<\u6587\u4ef6\u5185> 2.4 \u6ce8\u610f \u00b6 wordcloud\u505a\u8bcd\u9891\u7edf\u8ba1\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a 1\u3001\u5206\u9694\uff1a\u4ee5\u7a7a\u683c\u5206\u9694\u5355\u8bcd 2\u3001\u7edf\u8ba1 \uff1a\u5355\u8bcd\u51fa\u73b0\u7684\u6b21\u6570\u5e76\u8fc7\u6ee4 3\u3001\u5b57\u4f53\uff1a\u6839\u636e\u7edf\u8ba1\u642d\u914d\u76f8\u5e94\u7684\u5b57\u53f7 4\u3001\u5e03\u5c40 \u5e38\u7528\u7684\u53c2\u6570\u5217\u8868\u5982\u4e0b\uff1a \u65b9\u6cd5 \u63cf\u8ff0 width \u6307\u5b9a\u8bcd\u4e91\u56fe\u7247\u7684\u5bbd \u4f8b\u5982w=WordCloud(width=200) height \u6307\u5b9a\u8bcd\u4e91\u56fe\u7247\u7684\u9ad8 \u7528\u6cd5\u7528\u4e0a min_font_size \u6700\u5c0f\u5b57\u53f7 \u9ed8\u8ba4\u4e3a\u56db\u53f7 \u4f8b\u5982 w=WordCloud(min_font_size=5) max_font-size \u6700\u5927\u5b57\u53f7 \u7528\u6cd5\u7528\u4e0a font_step \u6307\u5b9a\u8bcd\u4e91\u4e2d\u8bcd\u8bed\u6b65\u8fdb\u95f4\u9694\uff0c\u9ed8\u8ba4\u4e3a1 font_path \u6307\u5b9a\u5b57\u4f53\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a\u7a7a max_words \u6307\u5b9a\u8bcd\u4e91\u663e\u793a\u7684\u6700\u5927\u5355\u8bcd\u6570\u91cf\uff0c\u9ed8\u8ba4\u662f200 stop_words \u6307\u5b9a\u8bcd\u4e91\u4e2d\u6392\u9664\u8bcd\u5217\u8868\uff0c\u5373\u4e0d\u663e\u793a\u7684\u5355\u8bcd\u5217\u8868 mask \u6307\u5b9a\u8bcd\u4e91\u7684\u5f62\u72b6\uff0c\u9ed8\u8ba4\u4e3a\u957f\u65b9\u5f62\uff0c\u9700\u8981\u5f15\u7528imread()\u51fd\u6570 background_color \u6307\u5b9a\u56fe\u7247\u989c\u8272 Note mask \u7528\u6cd5 From scipy.misc import imread M = imread('pic.png') W = WordCloud(mask=M)","title":"1. wordcloud"},{"location":"python/lib/wordcloud/1.wordcloud/#1","text":"\u82e5\u4e0b\u8f7d\u6162\uff0c\u53ef\u66f4\u6362\u5b89\u88c5\u6e90\u4e3a\u8c46\u74e3 sudo pip install --trusted-host pypi.douban.com -i http://pypi.douban.com/simple/ wordcloud","title":"1. \u5b89\u88c5"},{"location":"python/lib/wordcloud/1.wordcloud/#2-word-cloud","text":"wordcloud\u5e93\uff0c\u53ef\u4ee5\u8bf4\u662fpython\u975e\u5e38\u4f18\u79c0\u7684\u8bcd\u4e91\u5c55\u793a\u7b2c\u4e09\u65b9\u5e93\u3002\u8bcd\u4e91\u4ee5\u8bcd\u8bed\u4e3a\u57fa\u672c\u5355\u4f4d\u66f4\u52a0\u76f4\u89c2\u548c\u827a\u672f\u7684\u5c55\u793a\u6587\u672c\uff0c\u4e0b\u9762\u7ed9\u5927\u5bb6\u770b\u4e00\u4e2a\u793a\u4f8b\uff1a","title":"2. word cloud \u5e93\u4ecb\u7ecd"},{"location":"python/lib/wordcloud/1.wordcloud/#21","text":"\u63a5\u4e0b\u6765\uff0c\u4ecb\u7ecd\u4e0bwordcloud\u7684\u57fa\u672c\u4f7f\u7528\u3002wordcloud\u628a\u8bcd\u4e91\u5f53\u4f5c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5b83\u53ef\u4ee5\u5c06\u6587\u672c\u4e2d\u8bcd\u8bed\u51fa\u73b0\u7684\u9891\u7387\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u7ed8\u5236\u8bcd\u4e91\uff0c\u800c\u8bcd\u4e91\u7684\u5927\u5c0f\u3001\u989c\u8272\u3001\u5f62\u72b6\u7b49\u90fd\u662f\u53ef\u4ee5\u8bbe\u5b9a\u7684\u3002 In [5]: from wordcloud import WordCloud In [6]: W = WordCloud()","title":"2.1 \u4ecb\u7ecd"},{"location":"python/lib/wordcloud/1.wordcloud/#22","text":"\u5728wordcloud\u4f5c\u4e3a\u5bf9\u8c61\u65f6\uff0c\u5927\u5bb6\u8981\u6ce8\u610f\u5b57\u6bcd\u7684\u5927\u5c0f\u5199\u3002 \u603b\u7684\u6765\u8bf4\uff0c\u751f\u6210\u4e00\u4e2a\u6f02\u4eae\u7684\u8bcd\u4e91\u6587\u4ef6\u4e09\u6b65\u5c31\u53ef\u4ee5\u5b8c\u6210. 1\u3001\u914d\u7f6e\u5bf9\u8c61\u53c2\u6570 2\u3001\u52a0\u8f7d\u8bcd\u4e91\u6587\u672c 3\u3001\u8f93\u51fa\u8bcd\u4e91\u6587\u4ef6 \uff08\u5982\u679c\u4e0d\u52a0\u8bf4\u660e\u9ed8\u8ba4\u7684\u56fe\u7247\u5927\u5c0f\u4e3a400 * 200\uff09 wordcloud\u7684\u5e38\u89c4\u65b9\u6cd5\u5982\u4e0b\uff1a \u65b9\u6cd5 \u63cf\u8ff0 w.generate(txt) \u5411 WordCloud\u5bf9\u8c61W\u4e2d\u52a0\u8f7d\u6587\u4ef6txt\uff0c\u4f8b\u5982 w.generate(\"Python && wordcloud\") w.to_file(filename) \u5c06\u8bcd\u4e91\u8f93\u51fa\u7684\u56fe\u50cf\u539f\u4ef6.png\u6216\u8005.jpg\u683c\u5f0f\u4fdd\u5b58 w.to_file(\"pic.png\")","title":"2.2 \u53c2\u6570"},{"location":"python/lib/wordcloud/1.wordcloud/#23","text":"#!/usr/bin/python # _*_ coding: utf-8 _*_ from wordcloud import WordCloud w = WordCloud() # \u8bbe\u7f6e\u5bf9\u8c61 w.generate(\"I love china\") # \u52a0\u8f7d\u6587\u672c w.to_file(\"love.png\") # \u4fdd\u5b58 \u8fd0\u884c\u7ed3\u679c images/love.png<\u6587\u4ef6\u5185>","title":"2.3 \u4ee3\u7801"},{"location":"python/lib/wordcloud/1.wordcloud/#24","text":"wordcloud\u505a\u8bcd\u9891\u7edf\u8ba1\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a 1\u3001\u5206\u9694\uff1a\u4ee5\u7a7a\u683c\u5206\u9694\u5355\u8bcd 2\u3001\u7edf\u8ba1 \uff1a\u5355\u8bcd\u51fa\u73b0\u7684\u6b21\u6570\u5e76\u8fc7\u6ee4 3\u3001\u5b57\u4f53\uff1a\u6839\u636e\u7edf\u8ba1\u642d\u914d\u76f8\u5e94\u7684\u5b57\u53f7 4\u3001\u5e03\u5c40 \u5e38\u7528\u7684\u53c2\u6570\u5217\u8868\u5982\u4e0b\uff1a \u65b9\u6cd5 \u63cf\u8ff0 width \u6307\u5b9a\u8bcd\u4e91\u56fe\u7247\u7684\u5bbd \u4f8b\u5982w=WordCloud(width=200) height \u6307\u5b9a\u8bcd\u4e91\u56fe\u7247\u7684\u9ad8 \u7528\u6cd5\u7528\u4e0a min_font_size \u6700\u5c0f\u5b57\u53f7 \u9ed8\u8ba4\u4e3a\u56db\u53f7 \u4f8b\u5982 w=WordCloud(min_font_size=5) max_font-size \u6700\u5927\u5b57\u53f7 \u7528\u6cd5\u7528\u4e0a font_step \u6307\u5b9a\u8bcd\u4e91\u4e2d\u8bcd\u8bed\u6b65\u8fdb\u95f4\u9694\uff0c\u9ed8\u8ba4\u4e3a1 font_path \u6307\u5b9a\u5b57\u4f53\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a\u7a7a max_words \u6307\u5b9a\u8bcd\u4e91\u663e\u793a\u7684\u6700\u5927\u5355\u8bcd\u6570\u91cf\uff0c\u9ed8\u8ba4\u662f200 stop_words \u6307\u5b9a\u8bcd\u4e91\u4e2d\u6392\u9664\u8bcd\u5217\u8868\uff0c\u5373\u4e0d\u663e\u793a\u7684\u5355\u8bcd\u5217\u8868 mask \u6307\u5b9a\u8bcd\u4e91\u7684\u5f62\u72b6\uff0c\u9ed8\u8ba4\u4e3a\u957f\u65b9\u5f62\uff0c\u9700\u8981\u5f15\u7528imread()\u51fd\u6570 background_color \u6307\u5b9a\u56fe\u7247\u989c\u8272 Note mask \u7528\u6cd5 From scipy.misc import imread M = imread('pic.png') W = WordCloud(mask=M)","title":"2.4 \u6ce8\u610f"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/","text":"\u4e00\u3001\u5b66\u4e60 url \u00b6 yaml\u8bed\u6cd5 \u5b66\u4e60\u7f51\u7ad9 \u4e8c\u3001yaml\u8bed\u6cd5 \u00b6 1\u3001\u57fa\u672c\u89c4\u5219 \u00b6 \u5927\u5c0f\u5199\u654f\u611f \u4f7f\u7528\u7f29\u8fdb\u8868\u793a\u5c42\u7ea7\u5173\u7cfb \u7f29\u8fdb\u65f6\u4e0d\u5141\u8bb8\u4f7f\u7528Tab \uff0c\u53ea\u5141\u8bb8\u4f7f\u7528\u7a7a\u683c \u7f29\u8fdb\u7684\u7a7a\u683c\u6570\u76ee\u4e0d\u91cd\u8981\uff0c\u53ea\u8981==\u76f8\u540c\u5c42\u7ea7\u7684\u5143\u7d20\u5de6\u5bf9\u9f50\u5373\u53ef== # \u8868\u793a\u6ce8\u91ca \uff0c\u4ece\u5b83\u5f00\u59cb\u5230\u884c\u5c3e\u90fd\u88ab\u5ffd\u7565 YAML \u8fd8\u6709\u4e00\u4e2a\u5c0f\u7684\u602a\u7656. \u6240\u6709\u7684 YAML \u6587\u4ef6\u5f00\u59cb\u884c\u90fd\u5e94\u8be5\u662f ---. \u8fd9\u662f YAML \u683c\u5f0f\u7684\u4e00\u90e8\u5206, \u8868\u660e\u4e00\u4e2a\u6587\u4ef6\u7684\u5f00\u59cb. \u5217\u8868\u4e2d\u7684\u6240\u6709\u6210\u5458\u90fd\u5f00\u59cb\u4e8e\u76f8\u540c\u7684\u7f29\u8fdb\u7ea7\u522b, \u5e76\u4e14\u4f7f\u7528\u4e00\u4e2a \"- \" \u4f5c\u4e3a\u5f00\u5934(\u4e00\u4e2a\u6a2a\u6760\u548c\u4e00\u4e2a\u7a7a\u683c) 2\u3001yaml\u8f6c\u5b57\u5178 \u00b6 yaml\u4e2d\u652f\u6301\u6620\u5c04\u6216\u5b57\u5178\u7684\u8868\u793a\uff0c\u5982\u4e0b\uff1a # \u4e0b\u9762\u683c\u5f0f\u8bfb\u5230Python\u91cc\u4f1a\u662f\u4e2adict name: \u7070\u84dd age: 0 job: Tester \u8f38\u51fa {'name': '\u7070\u84dd', 'age': 0, 'job': 'Tester'} 3\u3001yaml\u8f6c\u5217\u8868 \u00b6 yaml\u4e2d\u652f\u6301\u5217\u8868\u6216\u6570\u7ec4\u7684\u8868\u793a\uff0c\u5982\u4e0b\uff1a # \u4e0b\u9762\u683c\u5f0f\u8bfb\u5230Python\u91cc\u4f1a\u662f\u4e2alist - \u7070\u84dd - 0 - Tester \u8f38\u51fa ['\u7070\u84dd', 0, 'Tester'] 4\u3001\u590d\u5408\u7ed3\u6784 \u00b6 \u5b57\u5178\u548c\u5217\u8868\u53ef\u4ee5\u590d\u5408\u8d77\u6765\u4f7f\u7528\uff0c\u5982\u4e0b\uff1a # \u4e0b\u9762\u683c\u5f0f\u8bfb\u5230Python\u91cc\u662f\u4e2alist\u91cc\u5305\u542bdict - name: \u7070\u84dd age: 0 job: Tester - name: James age: 30 \u8f93\u51fa\uff1a [{'name': '\u7070\u84dd', 'age': 0, 'job': 'Tester'}, {'name': 'James', 'age': 30}] 5\u3001\u57fa\u672c\u7c7b\u578b \u00b6 yaml\u4e2d\u6709\u4ee5\u4e0b\u57fa\u672c\u7c7b\u578b\uff1a 1 \u5b57\u7b26\u4e32 2 \u6574\u578b 3 \u6d6e\u70b9\u578b 4 \u5e03\u5c14\u578b 5 null 6 \u65f6\u95f4 7 \u65e5\u671f \u6211\u4eec\u5199\u4e2a\u4f8b\u5b50\u6765\u770b\u4e0b\uff1a # \u8fd9\u4e2a\u4f8b\u5b50\u8f93\u51fa\u4e00\u4e2a\u5b57\u5178\uff0c\u5176\u4e2dvalue\u5305\u62ec\u6240\u6709\u57fa\u672c\u7c7b\u578b str: \"Hello World!\" int: 110 float: 3.141 boolean: true # or false None: null # \u4e5f\u53ef\u4ee5\u7528 ~ \u53f7\u6765\u8868\u793a null time: 2016-09-22t11:43:30.20+08:00 # ISO8601\uff0c\u5199\u6cd5\u767e\u5ea6 date: 2016-09-22 # \u540c\u6837ISO8601 \u8f38\u51fa {'str': 'Hello World!', 'int': 110, 'float': 3.141, 'boolean': True, 'None': None, 'time': datetime.datetime(2016, 9, 22, 3, 43, 30, 200000), 'date': datetime.date(2016, 9, 22)} json\u683c\u5f0f\u5316\u540e { 'str': 'Hello World!', 'int': 110, 'float': 3.141, 'boolean': True, 'None': None, 'time': datetime.datetime(2016, 9, 22, 3, 43, 30, 200000), 'date': datetime.date(2016, 9, 22) } \u5982\u679c\u5b57\u7b26\u4e32\u6ca1\u6709\u7a7a\u683c\u6216\u7279\u6b8a\u5b57\u7b26\uff0c\u4e0d\u9700\u8981\u52a0\u5f15\u53f7\uff0c\u4f46\u5982\u679c\u5176\u4e2d\u6709\u7a7a\u683c\u6216\u7279\u6b8a\u5b57\u7b26\uff0c\u5219\u9700\u8981\u52a0\u5f15\u53f7\u4e86 str: \u7070\u84dd str1: \"Hello World\" str2: \"Hello\\nWorld\" \u8f38\u51fa {'str': '\u7070\u84dd', 'str1': 'Hello World', 'str2': 'Hello\\nWorld'} \u8fd9\u91cc\u8981\u6ce8\u610f\u5355\u5f15\u53f7\u548c\u53cc\u5f15\u53f7\u7684\u533a\u522b\uff0c\u5355\u5f15\u53f7\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u8f6c\u5230Python\u4f1a\u88ab\u8f6c\u4e49\uff0c\u4e5f\u5c31\u662f\u5230\u6700\u540e\u662f\u539f\u6837\u8f93\u51fa\u4e86\uff0c\u53cc\u5f15\u53f7\u4e0d\u4f1a\u88abPython\u8f6c\u4e49\uff0c\u5230\u6700\u540e\u662f\u8f93\u51fa\u4e86\u7279\u6b8a\u5b57\u7b26\uff1b\u5982\uff1a str1: 'Hello\\nWorld' str2: \"Hello\\nWorld\" \u8f38\u51fa {'str1': 'Hello\\\\nWorld', 'str2': 'Hello\\nWorld'} \u53ef\u4ee5\u770b\u5230\uff0c\u5355\u5f15\u53f7\u4e2d\u7684\u2019\\n\u2019\u6700\u540e\u662f\u8f93\u51fa\u4e86\uff0c\u53cc\u5f15\u53f7\u4e2d\u7684\u2019\\n\u2019\u6700\u540e\u662f\u8f6c\u4e49\u6210\u4e86\u56de\u8f66 6\u3001\u5f15\u7528 \u00b6 & \u548c * \u7528\u4e8e\u5f15\u7528 name: &name \u7070\u84dd tester: *name \u8fd9\u4e2a\u76f8\u5f53\u4e8e\u4e00\u4e0b\u811a\u672c\uff1a name: \u7070\u84dd tester: \u7070\u84dd \u8f93\u51fa\uff1a {'name': '\u7070\u84dd', 'tester': '\u7070\u84dd'} 7\u3001\u5f3a\u5236\u8f6c\u6362 \u00b6 yaml\u662f\u53ef\u4ee5\u8fdb\u884c\u5f3a\u5236\u8f6c\u6362\u7684\uff0c\u7528 !! \u5b9e\u73b0\uff0c\u5982\u4e0b\uff1a str: !!str 3.14 int: !!int \"123\" \u8f93\u51fa\uff1a {'int': 123, 'str': '3.14'} \u660e\u663e\u80fd\u591f\u770b\u51fa123\u88ab\u5f3a\u8f6c\u6210\u4e86int\u7c7b\u578b\uff0c\u800cfloat\u578b\u76843.14\u5219\u88ab\u5f3a\u8f6c\u6210\u4e86str\u578b\u3002 8\u3001\u5206\u6bb5 \u00b6 \u5728\u540c\u4e00\u4e2ayaml\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u7528 \u2014 \u6765\u5206\u6bb5\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u591a\u4e2a\u6587\u6863\u5199\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d --- name: James age: 20 --- name: Lily age: 19 \u4e09\u3001\u6784\u9020\u5668(constructors)\u3001\u8868\u793a\u5668(representers)\u3001\u89e3\u6790\u5668(resolvers ) \u00b6 1\u3001yaml.YAMLObject \u00b6 yaml.YAMLObject\u7528\u5143\u7c7b\u6765\u6ce8\u518c\u4e00\u4e2a\u6784\u9020\u5668\uff08\u4e5f\u5c31\u662f\u4ee3\u7801\u91cc\u7684 init() \u65b9\u6cd5\uff09\uff0c\u8ba9\u4f60\u628ayaml\u8282\u70b9\u8f6c\u4e3aPython\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u7528\u8868\u793a\u5668\uff08\u4e5f\u5c31\u662f\u4ee3\u7801\u91cc\u7684 repr() \u51fd\u6570\uff09\u6765\u8ba9\u4f60\u628aPython\u5bf9\u8c61\u8f6c\u4e3ayaml\u8282\u70b9\uff0c\u770b\u4ee3\u7801\uff1a import yaml class Person(yaml.YAMLObject): yaml_tag = '!person' def __init__(self, name, age): self.name = name self.age = age def __repr__(self): return '%s(name=%s, age=%d)' % (self.__class__.__name__, self.name, self.age) james = Person('James', 20) print (yaml.dump(james)) # Python\u5bf9\u8c61\u5b9e\u4f8b\u8f6c\u4e3ayaml lily = yaml.load('!person {name: Lily, age: 19}') print (lily) # yaml\u8f6c\u4e3aPython\u5bf9\u8c61\u5b9e\u4f8b \u8f93\u51fa !person {age: 20, name: James} Person(name=Lily, age=19) 2\u3001yaml.add_constructor \u548c yaml.add_representer \u00b6 \u4f60\u53ef\u80fd\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u5e76\u4e0d\u60f3\u901a\u8fc7\u4e0a\u9762\u8fd9\u79cd\u5143\u7c7b\u7684\u65b9\u5f0f\uff0c\u800c\u662f\u60f3\u5b9a\u4e49\u6b63\u5e38\u7684\u7c7b\uff0c\u90a3\u4e48\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e24\u79cd\u65b9\u6cd5 import yaml class Person(object): def __init__(self, name, age): self.name = name self.age = age def __repr__(self): return 'Person(%s, %s)' % (self.name, self.age) james = Person('James', 20) print (yaml.dump(james)) # \u6ca1\u52a0\u8868\u793a\u5668\u4e4b\u524d def person_repr(dumper, data): return dumper.represent_mapping(u'!person', {\"name\": data.name, \"age\": data.age}) # mapping\u8868\u793a\u5668\uff0c\u7528\u4e8edict yaml.add_representer(Person, person_repr) # \u7528add_representer\u65b9\u6cd5\u4e3a\u5bf9\u8c61\u6dfb\u52a0\u8868\u793a\u5668 print (yaml.dump(james)) # \u52a0\u4e86\u8868\u793a\u5668\u4e4b\u540e \u8f93\u51fa Note \u7b2c\u4e00\u884c\u662f\u6ca1\u52a0\u8868\u793a\u5668\u4e4b\u524d\uff0c\u591a\u4e11\uff01\u4e2d\u95f4\u90a3\u884c\u662f\u52a0\u4e86\u8868\u793a\u5668\u4e4b\u540e\uff0c\u53d8\u6210\u4e86\u89c4\u8303\u7684\u683c\u5f0f\uff0c\u4e0b\u9762\u6dfb\u52a0\u4e86\u6784\u9020\u5668\uff0c\u80fd\u591f\u628a !person \u6807\u7b7e\u8f6c\u5316\u4e3aPerson\u5bf9\u8c61\u3002 \u56db\u3001\u793a\u4f8b \u00b6 yaml\u662f\u4e00\u79cd\u5f88\u6e05\u6670\u3001\u7b80\u6d01\u7684\u683c\u5f0f\uff0c\u800c\u4e14\u8ddfPython\u975e\u5e38\u5408\u62cd\uff0c\u975e\u5e38\u5bb9\u6613\u64cd\u4f5c\uff0c\u6211\u4eec\u5728\u642d\u5efa\u81ea\u52a8\u5316\u6d4b\u8bd5\u6846\u67b6\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u91c7\u7528yaml\u4f5c\u4e3a\u914d\u7f6e\u6587\u4ef6\uff0c\u6216\u8005\u7528\u4f8b\u6587\u4ef6\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u7528\u4f8b\u7684\u793a\u4f8b # Test using included Django test app # First install python-django # Then launch the app in another terminal by doing # cd testapp # python manage.py testserver test_data.json # Once launched, tests can be executed via: # python resttest.py http://localhost:8000 miniapp-test.yaml --- - config: - testset: \"Tests using test app\" - test: # create entity - name: \"Basic get\" - url: \"/api/person/\" - test: # create entity - name: \"Get single person\" - url: \"/api/person/1/\" - test: # create entity - name: \"Get single person\" - url: \"/api/person/1/\" - method: 'DELETE' - test: # create entity by PUT - name: \"Create/update person\" - url: \"/api/person/1/\" - method: \"PUT\" - body: '{\"first_name\": \"Gaius\",\"id\": 1,\"last_name\": \"Baltar\",\"login\": \"gbaltar\"}' - headers: {'Content-Type': 'application/json'} - test: # create entity by POST - name: \"Create person\" - url: \"/api/person/\" - method: \"POST\" - body: '{\"first_name\": \"Willim\",\"last_name\": \"Adama\",\"login\": \"theadmiral\"}' - headers: {Content-Type: application/json}","title":"1. yaml\u8bed\u6cd5"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#url","text":"yaml\u8bed\u6cd5 \u5b66\u4e60\u7f51\u7ad9","title":"\u4e00\u3001\u5b66\u4e60 url"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#yaml","text":"","title":"\u4e8c\u3001yaml\u8bed\u6cd5"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#1","text":"\u5927\u5c0f\u5199\u654f\u611f \u4f7f\u7528\u7f29\u8fdb\u8868\u793a\u5c42\u7ea7\u5173\u7cfb \u7f29\u8fdb\u65f6\u4e0d\u5141\u8bb8\u4f7f\u7528Tab \uff0c\u53ea\u5141\u8bb8\u4f7f\u7528\u7a7a\u683c \u7f29\u8fdb\u7684\u7a7a\u683c\u6570\u76ee\u4e0d\u91cd\u8981\uff0c\u53ea\u8981==\u76f8\u540c\u5c42\u7ea7\u7684\u5143\u7d20\u5de6\u5bf9\u9f50\u5373\u53ef== # \u8868\u793a\u6ce8\u91ca \uff0c\u4ece\u5b83\u5f00\u59cb\u5230\u884c\u5c3e\u90fd\u88ab\u5ffd\u7565 YAML \u8fd8\u6709\u4e00\u4e2a\u5c0f\u7684\u602a\u7656. \u6240\u6709\u7684 YAML \u6587\u4ef6\u5f00\u59cb\u884c\u90fd\u5e94\u8be5\u662f ---. \u8fd9\u662f YAML \u683c\u5f0f\u7684\u4e00\u90e8\u5206, \u8868\u660e\u4e00\u4e2a\u6587\u4ef6\u7684\u5f00\u59cb. \u5217\u8868\u4e2d\u7684\u6240\u6709\u6210\u5458\u90fd\u5f00\u59cb\u4e8e\u76f8\u540c\u7684\u7f29\u8fdb\u7ea7\u522b, \u5e76\u4e14\u4f7f\u7528\u4e00\u4e2a \"- \" \u4f5c\u4e3a\u5f00\u5934(\u4e00\u4e2a\u6a2a\u6760\u548c\u4e00\u4e2a\u7a7a\u683c)","title":"1\u3001\u57fa\u672c\u89c4\u5219"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#2yaml","text":"yaml\u4e2d\u652f\u6301\u6620\u5c04\u6216\u5b57\u5178\u7684\u8868\u793a\uff0c\u5982\u4e0b\uff1a # \u4e0b\u9762\u683c\u5f0f\u8bfb\u5230Python\u91cc\u4f1a\u662f\u4e2adict name: \u7070\u84dd age: 0 job: Tester \u8f38\u51fa {'name': '\u7070\u84dd', 'age': 0, 'job': 'Tester'}","title":"2\u3001yaml\u8f6c\u5b57\u5178"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#3yaml","text":"yaml\u4e2d\u652f\u6301\u5217\u8868\u6216\u6570\u7ec4\u7684\u8868\u793a\uff0c\u5982\u4e0b\uff1a # \u4e0b\u9762\u683c\u5f0f\u8bfb\u5230Python\u91cc\u4f1a\u662f\u4e2alist - \u7070\u84dd - 0 - Tester \u8f38\u51fa ['\u7070\u84dd', 0, 'Tester']","title":"3\u3001yaml\u8f6c\u5217\u8868"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#4","text":"\u5b57\u5178\u548c\u5217\u8868\u53ef\u4ee5\u590d\u5408\u8d77\u6765\u4f7f\u7528\uff0c\u5982\u4e0b\uff1a # \u4e0b\u9762\u683c\u5f0f\u8bfb\u5230Python\u91cc\u662f\u4e2alist\u91cc\u5305\u542bdict - name: \u7070\u84dd age: 0 job: Tester - name: James age: 30 \u8f93\u51fa\uff1a [{'name': '\u7070\u84dd', 'age': 0, 'job': 'Tester'}, {'name': 'James', 'age': 30}]","title":"4\u3001\u590d\u5408\u7ed3\u6784"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#5","text":"yaml\u4e2d\u6709\u4ee5\u4e0b\u57fa\u672c\u7c7b\u578b\uff1a 1 \u5b57\u7b26\u4e32 2 \u6574\u578b 3 \u6d6e\u70b9\u578b 4 \u5e03\u5c14\u578b 5 null 6 \u65f6\u95f4 7 \u65e5\u671f \u6211\u4eec\u5199\u4e2a\u4f8b\u5b50\u6765\u770b\u4e0b\uff1a # \u8fd9\u4e2a\u4f8b\u5b50\u8f93\u51fa\u4e00\u4e2a\u5b57\u5178\uff0c\u5176\u4e2dvalue\u5305\u62ec\u6240\u6709\u57fa\u672c\u7c7b\u578b str: \"Hello World!\" int: 110 float: 3.141 boolean: true # or false None: null # \u4e5f\u53ef\u4ee5\u7528 ~ \u53f7\u6765\u8868\u793a null time: 2016-09-22t11:43:30.20+08:00 # ISO8601\uff0c\u5199\u6cd5\u767e\u5ea6 date: 2016-09-22 # \u540c\u6837ISO8601 \u8f38\u51fa {'str': 'Hello World!', 'int': 110, 'float': 3.141, 'boolean': True, 'None': None, 'time': datetime.datetime(2016, 9, 22, 3, 43, 30, 200000), 'date': datetime.date(2016, 9, 22)} json\u683c\u5f0f\u5316\u540e { 'str': 'Hello World!', 'int': 110, 'float': 3.141, 'boolean': True, 'None': None, 'time': datetime.datetime(2016, 9, 22, 3, 43, 30, 200000), 'date': datetime.date(2016, 9, 22) } \u5982\u679c\u5b57\u7b26\u4e32\u6ca1\u6709\u7a7a\u683c\u6216\u7279\u6b8a\u5b57\u7b26\uff0c\u4e0d\u9700\u8981\u52a0\u5f15\u53f7\uff0c\u4f46\u5982\u679c\u5176\u4e2d\u6709\u7a7a\u683c\u6216\u7279\u6b8a\u5b57\u7b26\uff0c\u5219\u9700\u8981\u52a0\u5f15\u53f7\u4e86 str: \u7070\u84dd str1: \"Hello World\" str2: \"Hello\\nWorld\" \u8f38\u51fa {'str': '\u7070\u84dd', 'str1': 'Hello World', 'str2': 'Hello\\nWorld'} \u8fd9\u91cc\u8981\u6ce8\u610f\u5355\u5f15\u53f7\u548c\u53cc\u5f15\u53f7\u7684\u533a\u522b\uff0c\u5355\u5f15\u53f7\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u8f6c\u5230Python\u4f1a\u88ab\u8f6c\u4e49\uff0c\u4e5f\u5c31\u662f\u5230\u6700\u540e\u662f\u539f\u6837\u8f93\u51fa\u4e86\uff0c\u53cc\u5f15\u53f7\u4e0d\u4f1a\u88abPython\u8f6c\u4e49\uff0c\u5230\u6700\u540e\u662f\u8f93\u51fa\u4e86\u7279\u6b8a\u5b57\u7b26\uff1b\u5982\uff1a str1: 'Hello\\nWorld' str2: \"Hello\\nWorld\" \u8f38\u51fa {'str1': 'Hello\\\\nWorld', 'str2': 'Hello\\nWorld'} \u53ef\u4ee5\u770b\u5230\uff0c\u5355\u5f15\u53f7\u4e2d\u7684\u2019\\n\u2019\u6700\u540e\u662f\u8f93\u51fa\u4e86\uff0c\u53cc\u5f15\u53f7\u4e2d\u7684\u2019\\n\u2019\u6700\u540e\u662f\u8f6c\u4e49\u6210\u4e86\u56de\u8f66","title":"5\u3001\u57fa\u672c\u7c7b\u578b"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#6","text":"& \u548c * \u7528\u4e8e\u5f15\u7528 name: &name \u7070\u84dd tester: *name \u8fd9\u4e2a\u76f8\u5f53\u4e8e\u4e00\u4e0b\u811a\u672c\uff1a name: \u7070\u84dd tester: \u7070\u84dd \u8f93\u51fa\uff1a {'name': '\u7070\u84dd', 'tester': '\u7070\u84dd'}","title":"6\u3001\u5f15\u7528"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#7","text":"yaml\u662f\u53ef\u4ee5\u8fdb\u884c\u5f3a\u5236\u8f6c\u6362\u7684\uff0c\u7528 !! \u5b9e\u73b0\uff0c\u5982\u4e0b\uff1a str: !!str 3.14 int: !!int \"123\" \u8f93\u51fa\uff1a {'int': 123, 'str': '3.14'} \u660e\u663e\u80fd\u591f\u770b\u51fa123\u88ab\u5f3a\u8f6c\u6210\u4e86int\u7c7b\u578b\uff0c\u800cfloat\u578b\u76843.14\u5219\u88ab\u5f3a\u8f6c\u6210\u4e86str\u578b\u3002","title":"7\u3001\u5f3a\u5236\u8f6c\u6362"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#8","text":"\u5728\u540c\u4e00\u4e2ayaml\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u7528 \u2014 \u6765\u5206\u6bb5\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u591a\u4e2a\u6587\u6863\u5199\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d --- name: James age: 20 --- name: Lily age: 19","title":"8\u3001\u5206\u6bb5"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#constructorsrepresentersresolvers","text":"","title":"\u4e09\u3001\u6784\u9020\u5668(constructors)\u3001\u8868\u793a\u5668(representers)\u3001\u89e3\u6790\u5668(resolvers )"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#1yamlyamlobject","text":"yaml.YAMLObject\u7528\u5143\u7c7b\u6765\u6ce8\u518c\u4e00\u4e2a\u6784\u9020\u5668\uff08\u4e5f\u5c31\u662f\u4ee3\u7801\u91cc\u7684 init() \u65b9\u6cd5\uff09\uff0c\u8ba9\u4f60\u628ayaml\u8282\u70b9\u8f6c\u4e3aPython\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u7528\u8868\u793a\u5668\uff08\u4e5f\u5c31\u662f\u4ee3\u7801\u91cc\u7684 repr() \u51fd\u6570\uff09\u6765\u8ba9\u4f60\u628aPython\u5bf9\u8c61\u8f6c\u4e3ayaml\u8282\u70b9\uff0c\u770b\u4ee3\u7801\uff1a import yaml class Person(yaml.YAMLObject): yaml_tag = '!person' def __init__(self, name, age): self.name = name self.age = age def __repr__(self): return '%s(name=%s, age=%d)' % (self.__class__.__name__, self.name, self.age) james = Person('James', 20) print (yaml.dump(james)) # Python\u5bf9\u8c61\u5b9e\u4f8b\u8f6c\u4e3ayaml lily = yaml.load('!person {name: Lily, age: 19}') print (lily) # yaml\u8f6c\u4e3aPython\u5bf9\u8c61\u5b9e\u4f8b \u8f93\u51fa !person {age: 20, name: James} Person(name=Lily, age=19)","title":"1\u3001yaml.YAMLObject"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#2yamladd_constructor-yamladd_representer","text":"\u4f60\u53ef\u80fd\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u5e76\u4e0d\u60f3\u901a\u8fc7\u4e0a\u9762\u8fd9\u79cd\u5143\u7c7b\u7684\u65b9\u5f0f\uff0c\u800c\u662f\u60f3\u5b9a\u4e49\u6b63\u5e38\u7684\u7c7b\uff0c\u90a3\u4e48\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e24\u79cd\u65b9\u6cd5 import yaml class Person(object): def __init__(self, name, age): self.name = name self.age = age def __repr__(self): return 'Person(%s, %s)' % (self.name, self.age) james = Person('James', 20) print (yaml.dump(james)) # \u6ca1\u52a0\u8868\u793a\u5668\u4e4b\u524d def person_repr(dumper, data): return dumper.represent_mapping(u'!person', {\"name\": data.name, \"age\": data.age}) # mapping\u8868\u793a\u5668\uff0c\u7528\u4e8edict yaml.add_representer(Person, person_repr) # \u7528add_representer\u65b9\u6cd5\u4e3a\u5bf9\u8c61\u6dfb\u52a0\u8868\u793a\u5668 print (yaml.dump(james)) # \u52a0\u4e86\u8868\u793a\u5668\u4e4b\u540e \u8f93\u51fa Note \u7b2c\u4e00\u884c\u662f\u6ca1\u52a0\u8868\u793a\u5668\u4e4b\u524d\uff0c\u591a\u4e11\uff01\u4e2d\u95f4\u90a3\u884c\u662f\u52a0\u4e86\u8868\u793a\u5668\u4e4b\u540e\uff0c\u53d8\u6210\u4e86\u89c4\u8303\u7684\u683c\u5f0f\uff0c\u4e0b\u9762\u6dfb\u52a0\u4e86\u6784\u9020\u5668\uff0c\u80fd\u591f\u628a !person \u6807\u7b7e\u8f6c\u5316\u4e3aPerson\u5bf9\u8c61\u3002","title":"2\u3001yaml.add_constructor \u548c yaml.add_representer"},{"location":"python/lib/yaml/1.yaml\u8bed\u6cd5/#_1","text":"yaml\u662f\u4e00\u79cd\u5f88\u6e05\u6670\u3001\u7b80\u6d01\u7684\u683c\u5f0f\uff0c\u800c\u4e14\u8ddfPython\u975e\u5e38\u5408\u62cd\uff0c\u975e\u5e38\u5bb9\u6613\u64cd\u4f5c\uff0c\u6211\u4eec\u5728\u642d\u5efa\u81ea\u52a8\u5316\u6d4b\u8bd5\u6846\u67b6\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u91c7\u7528yaml\u4f5c\u4e3a\u914d\u7f6e\u6587\u4ef6\uff0c\u6216\u8005\u7528\u4f8b\u6587\u4ef6\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u7528\u4f8b\u7684\u793a\u4f8b # Test using included Django test app # First install python-django # Then launch the app in another terminal by doing # cd testapp # python manage.py testserver test_data.json # Once launched, tests can be executed via: # python resttest.py http://localhost:8000 miniapp-test.yaml --- - config: - testset: \"Tests using test app\" - test: # create entity - name: \"Basic get\" - url: \"/api/person/\" - test: # create entity - name: \"Get single person\" - url: \"/api/person/1/\" - test: # create entity - name: \"Get single person\" - url: \"/api/person/1/\" - method: 'DELETE' - test: # create entity by PUT - name: \"Create/update person\" - url: \"/api/person/1/\" - method: \"PUT\" - body: '{\"first_name\": \"Gaius\",\"id\": 1,\"last_name\": \"Baltar\",\"login\": \"gbaltar\"}' - headers: {'Content-Type': 'application/json'} - test: # create entity by POST - name: \"Create person\" - url: \"/api/person/\" - method: \"POST\" - body: '{\"first_name\": \"Willim\",\"last_name\": \"Adama\",\"login\": \"theadmiral\"}' - headers: {Content-Type: application/json}","title":"\u56db\u3001\u793a\u4f8b"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/","text":"\u5b89\u88c5 \u00b6 pip install PyYAML YAML\u662f\u4e00\u79cd\u76f4\u89c2\u7684\u80fd\u591f\u88ab\u7535\u8111\u8bc6\u522b\u7684\u7684\u6570\u636e\u5e8f\u5217\u5316\u683c\u5f0f\uff0c\u5bb9\u6613\u88ab\u4eba\u7c7b\u9605\u8bfb\uff0c\u5e76\u4e14\u5bb9\u6613\u548c\u811a\u672c\u8bed\u8a00\u4ea4\u4e92\u3002YAML\u7c7b\u4f3c\u4e8eXML\uff0c\u4f46\u662f\u8bed\u6cd5\u6bd4XML\u7b80\u5355\u5f97\u591a\uff0c\u5bf9\u4e8e\u8f6c\u5316\u6210\u6570\u7ec4\u6216\u53ef\u4ee5hash\u7684\u6570\u636e\u65f6\u662f\u5f88\u7b80\u5355\u6709\u6548\u7684\u3002 1\u3001PyYaml \u00b6 1.1\u3001load() :\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61 \u00b6 \u6211\u4eec\u5148\u521b\u5efa\u4e00\u4e2ayml\u6587\u4ef6\uff0cconfig.yml: name: Tom Smith age: 37 spouse: name: Jane Smith age: 25 children: - name: Jimmy Smith age: 15 - name1: Jenny Smith age1: 12 1.2\u3001\u8bfb\u53d6yml\u6587\u4ef6\uff1a \u00b6 import yaml f = open('config.yml') y = yaml.load(f) print(y) \u8f93\u51fa {'name': 'Tom Smith', 'age': 37, 'spouse': {'name': 'Jane Smith', 'age': 25}, 'children': [{'name': 'Jimmy Smith', 'age': 15}, {'name1': 'Jenny Smith', 'age1': 12}]} json\u683c\u5f0f\u5316\u540e { 'name': 'Tom Smith', 'age': 37, 'spouse': { 'name': 'Jane Smith', 'age': 25 }, 'children': [{ 'name': 'Jimmy Smith', 'age': 15 }, { 'name1': 'Jenny Smith', 'age1': 12 }] } 2\u3001load_all()\u751f\u6210\u4e00\u4e2a\u8fed\u4ee3\u5668 \u00b6 \u5982\u679cstring\u6216\u6587\u4ef6\u5305\u542b\u51e0\u5757yaml\u6587\u6863\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528yaml.load_all\u6765\u89e3\u6790\u5168\u90e8\u7684\u6587\u6863\u3002 import yaml f = ''' --- name: James age: 20 --- name: Lily age: 19 ''' y = yaml.load_all(f) for data in y: print(data) \u8fd0\u884c\u7ed3\u679c {'name': 'James', 'age': 20} {'name': 'Lily', 'age': 19} 3\u3001yaml.dump \u5c06\u4e00\u4e2apython\u5bf9\u8c61\u751f\u6210\u4e3ayaml\u6587\u6863 \u00b6 import yaml aproject = {'name': 'Silenthand Olleander', 'race': 'Human', 'traits': ['ONE_HAND', 'ONE_EYE'] } print(yaml.dump(aproject)) \u8fd0\u884c\u7ed3\u679c name: Silenthand Olleander race: Human traits: [ONE_HAND, ONE_EYE] yaml.dump\u63a5\u6536\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e00\u5b9a\u8981\u662f\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u672c\u6587\u4ef6\u6216\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0cyaml.dump\u4f1a\u628a\u751f\u6210\u7684yaml\u6587\u6863\u5199\u5230\u6587\u4ef6\u91cc import yaml aproject = {'name': 'Silenthand Olleander', 'race': 'Human', 'traits': ['ONE_HAND', 'ONE_EYE'] } f = open(r'config1.yml', 'w') print(yaml.dump(aproject, f)) \u8fd0\u884c\u540e\u6094\u4ea7\u751f\u4e00\u4e2a\u6587\u4ef6config1.yml \u5185\u5bb9 name: Silenthand Olleander race: Human traits: [ONE_HAND, ONE_EYE] 4\u3001yaml.dump_all()\u5c06\u591a\u4e2a\u6bb5\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d \u00b6 import yaml obj1 = {\"name\": \"James\", \"age\": 20} obj2 = [\"Lily\", 19] with open('config2.yml', 'w') as f: yaml.dump_all([obj1, obj2], f) \u6267\u884c\u540e\uff0c\u4ea7\u751fconfig2.yml\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a {age: 20, name: James} --- [Lily, 19]","title":"2. yaml\u4f7f\u7528"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#_1","text":"pip install PyYAML YAML\u662f\u4e00\u79cd\u76f4\u89c2\u7684\u80fd\u591f\u88ab\u7535\u8111\u8bc6\u522b\u7684\u7684\u6570\u636e\u5e8f\u5217\u5316\u683c\u5f0f\uff0c\u5bb9\u6613\u88ab\u4eba\u7c7b\u9605\u8bfb\uff0c\u5e76\u4e14\u5bb9\u6613\u548c\u811a\u672c\u8bed\u8a00\u4ea4\u4e92\u3002YAML\u7c7b\u4f3c\u4e8eXML\uff0c\u4f46\u662f\u8bed\u6cd5\u6bd4XML\u7b80\u5355\u5f97\u591a\uff0c\u5bf9\u4e8e\u8f6c\u5316\u6210\u6570\u7ec4\u6216\u53ef\u4ee5hash\u7684\u6570\u636e\u65f6\u662f\u5f88\u7b80\u5355\u6709\u6548\u7684\u3002","title":"\u5b89\u88c5"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#1pyyaml","text":"","title":"1\u3001PyYaml"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#11load","text":"\u6211\u4eec\u5148\u521b\u5efa\u4e00\u4e2ayml\u6587\u4ef6\uff0cconfig.yml: name: Tom Smith age: 37 spouse: name: Jane Smith age: 25 children: - name: Jimmy Smith age: 15 - name1: Jenny Smith age1: 12","title":"1.1\u3001load() :\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#12yml","text":"import yaml f = open('config.yml') y = yaml.load(f) print(y) \u8f93\u51fa {'name': 'Tom Smith', 'age': 37, 'spouse': {'name': 'Jane Smith', 'age': 25}, 'children': [{'name': 'Jimmy Smith', 'age': 15}, {'name1': 'Jenny Smith', 'age1': 12}]} json\u683c\u5f0f\u5316\u540e { 'name': 'Tom Smith', 'age': 37, 'spouse': { 'name': 'Jane Smith', 'age': 25 }, 'children': [{ 'name': 'Jimmy Smith', 'age': 15 }, { 'name1': 'Jenny Smith', 'age1': 12 }] }","title":"1.2\u3001\u8bfb\u53d6yml\u6587\u4ef6\uff1a"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#2load_all","text":"\u5982\u679cstring\u6216\u6587\u4ef6\u5305\u542b\u51e0\u5757yaml\u6587\u6863\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528yaml.load_all\u6765\u89e3\u6790\u5168\u90e8\u7684\u6587\u6863\u3002 import yaml f = ''' --- name: James age: 20 --- name: Lily age: 19 ''' y = yaml.load_all(f) for data in y: print(data) \u8fd0\u884c\u7ed3\u679c {'name': 'James', 'age': 20} {'name': 'Lily', 'age': 19}","title":"2\u3001load_all()\u751f\u6210\u4e00\u4e2a\u8fed\u4ee3\u5668"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#3yamldump-pythonyaml","text":"import yaml aproject = {'name': 'Silenthand Olleander', 'race': 'Human', 'traits': ['ONE_HAND', 'ONE_EYE'] } print(yaml.dump(aproject)) \u8fd0\u884c\u7ed3\u679c name: Silenthand Olleander race: Human traits: [ONE_HAND, ONE_EYE] yaml.dump\u63a5\u6536\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e00\u5b9a\u8981\u662f\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u672c\u6587\u4ef6\u6216\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0cyaml.dump\u4f1a\u628a\u751f\u6210\u7684yaml\u6587\u6863\u5199\u5230\u6587\u4ef6\u91cc import yaml aproject = {'name': 'Silenthand Olleander', 'race': 'Human', 'traits': ['ONE_HAND', 'ONE_EYE'] } f = open(r'config1.yml', 'w') print(yaml.dump(aproject, f)) \u8fd0\u884c\u540e\u6094\u4ea7\u751f\u4e00\u4e2a\u6587\u4ef6config1.yml \u5185\u5bb9 name: Silenthand Olleander race: Human traits: [ONE_HAND, ONE_EYE]","title":"3\u3001yaml.dump \u5c06\u4e00\u4e2apython\u5bf9\u8c61\u751f\u6210\u4e3ayaml\u6587\u6863"},{"location":"python/lib/yaml/2.yaml\u4f7f\u7528/#4yamldump_all","text":"import yaml obj1 = {\"name\": \"James\", \"age\": 20} obj2 = [\"Lily\", 19] with open('config2.yml', 'w') as f: yaml.dump_all([obj1, obj2], f) \u6267\u884c\u540e\uff0c\u4ea7\u751fconfig2.yml\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a {age: 20, name: James} --- [Lily, 19]","title":"4\u3001yaml.dump_all()\u5c06\u591a\u4e2a\u6bb5\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d"},{"location":"python/lib/yield/1.yield/","text":"yield\u89e3\u6790\uff1a \u00b6 yield \u7684\u4f5c\u7528\u5c31\u662f\u628a\u4e00\u4e2a\u51fd\u6570\u53d8\u6210\u4e00\u4e2a\u751f\u6210\u5668(generator)\uff0c\u5e26\u6709yield\u7684\u51fd\u6570\u4e0d\u518d\u662f\u4e00\u4e2a\u666e\u901a\u51fd\u6570\uff0c Python\u89e3\u91ca\u5668\u4f1a\u5c06\u5176\u89c6\u4e3a\u4e00\u4e2agenerator\uff0c\u5355\u72ec\u8c03\u7528\uff08\u5982fab(5)\uff09\u4e0d\u4f1a\u6267\u884cfab\u51fd\u6570\uff0c \u800c\u662f\u8fd4\u56de\u4e00\u4e2a iterable \u5bf9\u8c61\uff01\u5728for\u5faa\u73af\u6267\u884c\u65f6\uff0c\u6bcf\u6b21\u5faa\u73af\u90fd\u4f1a\u6267\u884cfab\u51fd\u6570\u5185\u90e8\u7684\u4ee3\u7801\uff0c \u6267\u884c\u5230yield b\u65f6\uff0cfab\u51fd\u6570\u5c31\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u503c\uff0c\u4e0b\u6b21\u8fed\u4ee3\u65f6\uff0c\u4ee3\u7801\u4ece yield b \u7684\u4e0b\u4e00\u6761\u8bed\u53e5\u7ee7\u7eed\u6267\u884c\uff0c \u800c\u51fd\u6570\u7684\u672c\u5730\u53d8\u91cf\u770b\u8d77\u6765\u548c\u4e0a\u6b21\u4e2d\u65ad\u6267\u884c\u524d\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u4e8e\u662f\u51fd\u6570\u7ee7\u7eed\u6267\u884c\uff0c\u76f4\u5230\u518d\u6b21\u9047\u5230 yield\u3002 \u53c2\u8003\u5b9e\u4f8b\u5982\u4e0b\uff1a 1.1 \u4f8b\u5b501 \u00b6 def fab(max): n, a, b = 0, 0, 1 while n < max: # print b yield b # print b a, b = b, a + b n = n + 1 print(fab(5)) \u7ed3\u679c <generator object fab at 0x00000170C16C8930> 1.2. \u4f8b\u5b502 \u00b6 for n in fab(5): print(n) \u7ed3\u679c 1 1 2 3 5 \u5bf9\u4e8e\u542b\u6709yield\u7684\u51fd\u6570\uff0c\u5916\u90e8\u8981\u4ee5\u8fed\u4ee3\u7684\u65b9\u5f0f\u8c03\u7528\uff0c\u5f53\u51fd\u6570\u6267\u884c\u7ed3\u675f\u65f6\uff0cgenerator \u81ea\u52a8\u629b\u51fa StopIteration \u5f02\u5e38\uff0c\u8868\u793a\u8fed\u4ee3\u5b8c\u6210\u3002 \u5728 for \u5faa\u73af\u91cc\uff0c\u65e0\u9700\u5904\u7406 StopIteration \u5f02\u5e38\uff0c\u5faa\u73af\u4f1a\u6b63\u5e38\u7ed3\u675f\u3002 def ff(max): a,b = 0,1 yield max # yield\u4e0d\u5728\u5faa\u73af\u4e2d\uff0c\u8fd9\u91cc\u5df2\u7ecf\u5230\u51fd\u6570\u6700\u540e\u6240\u4ee5\u76f4\u63a5\u8fd4\u56de\uff0c\u76f8\u5f53\u4e8ereturn for n in ff(5): print n \u7ed3\u679c 5 \u7ed3\u8bba\uff1a\u7efc\u4e0a\u53ef\u77e5\uff0cyield\u8981\u4f7f\u7528\u5728\u5faa\u73af\u4e2d\uff0c\u8fd9\u6837\u751f\u6210\u5668\u624d\u6709\u4f7f\u7528\u7684\u610f\u4e49\u3002","title":"1. yield"},{"location":"python/lib/yield/1.yield/#yield","text":"yield \u7684\u4f5c\u7528\u5c31\u662f\u628a\u4e00\u4e2a\u51fd\u6570\u53d8\u6210\u4e00\u4e2a\u751f\u6210\u5668(generator)\uff0c\u5e26\u6709yield\u7684\u51fd\u6570\u4e0d\u518d\u662f\u4e00\u4e2a\u666e\u901a\u51fd\u6570\uff0c Python\u89e3\u91ca\u5668\u4f1a\u5c06\u5176\u89c6\u4e3a\u4e00\u4e2agenerator\uff0c\u5355\u72ec\u8c03\u7528\uff08\u5982fab(5)\uff09\u4e0d\u4f1a\u6267\u884cfab\u51fd\u6570\uff0c \u800c\u662f\u8fd4\u56de\u4e00\u4e2a iterable \u5bf9\u8c61\uff01\u5728for\u5faa\u73af\u6267\u884c\u65f6\uff0c\u6bcf\u6b21\u5faa\u73af\u90fd\u4f1a\u6267\u884cfab\u51fd\u6570\u5185\u90e8\u7684\u4ee3\u7801\uff0c \u6267\u884c\u5230yield b\u65f6\uff0cfab\u51fd\u6570\u5c31\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u503c\uff0c\u4e0b\u6b21\u8fed\u4ee3\u65f6\uff0c\u4ee3\u7801\u4ece yield b \u7684\u4e0b\u4e00\u6761\u8bed\u53e5\u7ee7\u7eed\u6267\u884c\uff0c \u800c\u51fd\u6570\u7684\u672c\u5730\u53d8\u91cf\u770b\u8d77\u6765\u548c\u4e0a\u6b21\u4e2d\u65ad\u6267\u884c\u524d\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u4e8e\u662f\u51fd\u6570\u7ee7\u7eed\u6267\u884c\uff0c\u76f4\u5230\u518d\u6b21\u9047\u5230 yield\u3002 \u53c2\u8003\u5b9e\u4f8b\u5982\u4e0b\uff1a","title":"yield\u89e3\u6790\uff1a"},{"location":"python/lib/yield/1.yield/#11-1","text":"def fab(max): n, a, b = 0, 0, 1 while n < max: # print b yield b # print b a, b = b, a + b n = n + 1 print(fab(5)) \u7ed3\u679c <generator object fab at 0x00000170C16C8930>","title":"1.1 \u4f8b\u5b501"},{"location":"python/lib/yield/1.yield/#12-2","text":"for n in fab(5): print(n) \u7ed3\u679c 1 1 2 3 5 \u5bf9\u4e8e\u542b\u6709yield\u7684\u51fd\u6570\uff0c\u5916\u90e8\u8981\u4ee5\u8fed\u4ee3\u7684\u65b9\u5f0f\u8c03\u7528\uff0c\u5f53\u51fd\u6570\u6267\u884c\u7ed3\u675f\u65f6\uff0cgenerator \u81ea\u52a8\u629b\u51fa StopIteration \u5f02\u5e38\uff0c\u8868\u793a\u8fed\u4ee3\u5b8c\u6210\u3002 \u5728 for \u5faa\u73af\u91cc\uff0c\u65e0\u9700\u5904\u7406 StopIteration \u5f02\u5e38\uff0c\u5faa\u73af\u4f1a\u6b63\u5e38\u7ed3\u675f\u3002 def ff(max): a,b = 0,1 yield max # yield\u4e0d\u5728\u5faa\u73af\u4e2d\uff0c\u8fd9\u91cc\u5df2\u7ecf\u5230\u51fd\u6570\u6700\u540e\u6240\u4ee5\u76f4\u63a5\u8fd4\u56de\uff0c\u76f8\u5f53\u4e8ereturn for n in ff(5): print n \u7ed3\u679c 5 \u7ed3\u8bba\uff1a\u7efc\u4e0a\u53ef\u77e5\uff0cyield\u8981\u4f7f\u7528\u5728\u5faa\u73af\u4e2d\uff0c\u8fd9\u6837\u751f\u6210\u5668\u624d\u6709\u4f7f\u7528\u7684\u610f\u4e49\u3002","title":"1.2. \u4f8b\u5b502"},{"location":"syntax/code_block/","text":"4\u4e2a\u7a7a\u683c \u00b6 \u5728\u6bcf\u884c\u524d\u9762\u52a0\u4e0a4\u4e2a\u7a7a\u683c text = \"Hello, world!\" print text \u6548\u679c text = \"Hello, world!\" print text 3\u4e2a ` \u00b6 ```text text = \"Hello, world!\" print text ``` \u6548\u679c text = \"Hello, world!\" print text \u6ce81: \u652f\u6301\u4ee3\u7801\u9ad8\u4eae \uff0c\u8be6\u89c1\" \u533a\u5757\u4ee3\u7801\u9ad8\u4eae \" \u6ce82: \u5982\u679c\u4ee3\u7801\u533a\u5757\u4e0a\u65b9\u662f\u5217\u8868\uff0c\u5982 \u65e0\u5e8f\u5217\u8868 \u6216 \u6709\u5e8f\u5217\u8868 \uff0c\u90a3\u4e484\u4e2a\u7a7a\u683c\u4e0d\u4f1a\u88ab\u89e3\u6790\u4e3a\u4ee3\u7801\u533a\u5757\uff0c\u800c\u662f\u88ab\u89e3\u6790\u4e3a\u4e00\u4e2a\u666e\u901a\u7f29\u8fdb","title":"6.2. \u533a\u5757"},{"location":"syntax/code_block/#4","text":"\u5728\u6bcf\u884c\u524d\u9762\u52a0\u4e0a4\u4e2a\u7a7a\u683c text = \"Hello, world!\" print text \u6548\u679c text = \"Hello, world!\" print text","title":"4\u4e2a\u7a7a\u683c"},{"location":"syntax/code_block/#3","text":"```text text = \"Hello, world!\" print text ``` \u6548\u679c text = \"Hello, world!\" print text \u6ce81: \u652f\u6301\u4ee3\u7801\u9ad8\u4eae \uff0c\u8be6\u89c1\" \u533a\u5757\u4ee3\u7801\u9ad8\u4eae \" \u6ce82: \u5982\u679c\u4ee3\u7801\u533a\u5757\u4e0a\u65b9\u662f\u5217\u8868\uff0c\u5982 \u65e0\u5e8f\u5217\u8868 \u6216 \u6709\u5e8f\u5217\u8868 \uff0c\u90a3\u4e484\u4e2a\u7a7a\u683c\u4e0d\u4f1a\u88ab\u89e3\u6790\u4e3a\u4ee3\u7801\u533a\u5757\uff0c\u800c\u662f\u88ab\u89e3\u6790\u4e3a\u4e00\u4e2a\u666e\u901a\u7f29\u8fdb","title":"3\u4e2a `"},{"location":"syntax/code_highlight/","text":"\u9ad8\u4eae\u90e8\u5206\u8be6\u89c1 \u4ee3\u7801\u9ad8\u4eae \u7ae0\u8282","title":"6.3. \u9ad8\u4eae"},{"location":"syntax/code_inline/","text":"\u5728\u4e00\u884c\u5185\u8981\u6807\u8bb0\u7684\u6587\u672c\u524d\u540e\u5404\u52a0\u4e00\u4e2a ` AAA`BBB`CCC \u6548\u679c\uff1a AAA BBB CCC \u6ce8: \u652f\u6301\u4ee3\u7801\u9ad8\u4eae \uff0c\u8be6\u89c1\" \u884c\u5185\u4ee3\u7801\u9ad8\u4eae \"","title":"6.1. \u884c\u5185"},{"location":"syntax/cutline/","text":"\u5206\u5272\u7ebf\u4f7f\u7528\u4e09\u4e2a\u6216\u4ee5\u4e0a * \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 - \u548c _ \uff0c\u4e0b\u9762\u4ec5\u4ee5 - \u4f5c\u4e3a\u793a\u4f8b --- \u6548\u679c","title":"9. \u5206\u5272\u7ebf"},{"location":"syntax/emoji_main/","text":"\u4ec0\u4e48\u662femoji \u00b6 emoji\u662f\u65e5\u672c\u5728\u65e0\u7ebf\u901a\u4fe1\u4e2d\u6240\u4f7f\u7528\u7684\u89c6\u89c9\u60c5\u611f\u7b26\u53f7\uff0c\u5df2\u88abunicode\u91c7\u7eb3\uff0c\u5f53\u524dunicode\u5305\u542b\u4e86\u975e\u5e38\u591a\u7684emoji\u56fe\u6807\uff0c\u6bcf\u4e00\u6b21unicode\u66f4\u65b0\u90fd\u4f1a\u53d1\u5e03\u65b0\u7684emoji\u56fe\u6807\u3002\u53ea\u8981\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301unicode\uff0c\u5c31\u80fd\u5728\u4efb\u610f\u4f7f\u7528unicode\u7f16\u7801\u7684\u5730\u65b9\u770b\u5230\u6f02\u4eae\u7684\u5f69\u8272\u56fe\u6807\uff0c\u6bd4\u5982\u6587\u672c\u3001mysql\u8868\u91cc\u3001\u7f51\u9875\u3002 emoji\u73b0\u72b6 \u00b6 \u867d\u7136unicode\u5b98\u7f51\u53ef\u4ee5\u67e5\u5230\u6240\u6709emoji\u56fe\u6807\uff0c\u4f46\u5e76\u672a\u63d0\u4f9b\u4e00\u4e2a\u4fbf\u5229\u7684\u56fe\u6807\u5206\u7c7b\u67e5\u8be2\u548c\u4f7f\u7528\u65b9\u6cd5\u3002\u56e0\u6b64\u5c31\u6709\u4e00\u4e9b\u7b2c\u4e09\u65b9emoji\u5382\u5546\u5c06\u90e8\u5206emoji\u56fe\u6807\uff0c\u5236\u4f5c\u6210\u4e0d\u540c\u683c\u5f0f\u3001\u4e0d\u540c\u5c3a\u5bf8(\u4f8b\u598264x64 PNG\u3001128x128 PNG\u6216SVG\u7b49\u683c\u5f0f)\u7684\u56fe\u7247\u653e\u5165\u81ea\u5df1\u7684CDN\u5e93\u3002\u7136\u540e\u5c06\u8fd9\u4e9bCDN\u56fe\u7247\u4ee5\u514d\u8d39\u6216\u4ed8\u8d39\u65b9\u5f0f\u5bf9\u5916\u63d0\u4f9b\u3002 \u5982\u4f55\u83b7\u5f97emoji \u00b6 \u6839\u636e\u4f7f\u7528\u9700\u6c42\u5206\u4e3a2\u79cd: \u4e0d\u6ee1\u8db3\u4e8eunicode\u7684emoji\u56fe\u6807\uff0c\u5e0c\u671b\u66f4\u597d\u770b\uff0c\u5e76\u4e14\u5c3a\u5bf8\u53ef\u9009\uff0c\u90a3\u4e48\u5c31\u4f7f\u7528\u7b2c\u4e09\u65b9emoji\u5382\u5546\u5e93\uff0c\u63a8\u8350\u4f7f\u7528EmojiOne\u7684png\u56fe\u5e93\uff0c\u5206\u4e3a\u514d\u8d39\u548c\u4ed8\u8d39\uff0c\u5176\u4e2d\u514d\u8d39\u7684\u56fe\u5e93\u5df2\u8db3\u591f\u6ee1\u8db3\u4e00\u822c\u6027\u4f7f\u7528\u9700\u6c42\uff0c\u5982\u679c\u60f3\u4f7f\u7528svg\uff0c\u514d\u8d39\u7684\u53ea\u6709EmojiOne-2.2.7\u4ee5\u5185\u7248\u672c\uff0c\u6700\u65b0\u7684svg\u90fd\u662f\u8981\u4ed8\u8d39\u7684\u3002\u4f7f\u7528\u65b9\u6cd5\u662f\u5728\u6587\u6863\u91cc\u7528 :\u77ed\u540d \u6765\u8ba9mkdocs\u81ea\u52a8\u5339\u914d\u5e76\u6e32\u67d3\u4e3a \u6807\u7b7e \u4e3e\u4f8b\u8bf4\u660e2.2.7\u4e0e\u9ad8\u7248\u672c\u533a\u522b \u5982\u679c\u7528\u7684 :\u77ed\u540d: \u662f2.2.7\u5305\u542b\u7684\uff0c\u90a3\u4e48\u56fe\u6807\u80fd\u6b63\u5e38\u663e\u793a\uff0c\u5426\u5219\u663e\u793a\u4e0d\u51fa\u6765 \u6bd4\u5982\uff1a https://cdn.jsdelivr.net/emojione/assets/svg/1f600.svg \u8fd9\u4e2a\u662f2.2.7\u5c31\u6709\u7684\uff0c\u8bbf\u95ee\u8fd9\u4e2aurl\u53ef\u4ee5\u770b\u5230\u56fe\u6807 https://cdn.jsdelivr.net/emojione/assets/svg/1f92e.svg \u8fd9\u4e2a\u662f2.2.7\u4e4b\u540e\u624d\u6709\u7684\uff0c\u9700\u8981\u4ed8\u8d39\u624d\u80fd\u83b7\u5f97\u56fe\u6807\uff0c\u672a\u4ed8\u8d39\u76f4\u63a5\u8bbf\u95ee\u4f1a\u5f97\u5230\u62a5\u9519\uff1a https://cdn.jsdelivr.net/emojione/assets/3.1/png/64/1f92e.png \u8fd9\u4e2a\u662fpng\uff0c\u4e0d\u5c5e\u4e8e\u4ed8\u8d39\u90e8\u5206\uff0c\u8bbf\u95ee\u8fd9\u4e2aurl\u53ef\u4ee5\u770b\u5230\u56fe\u6807 \u56e0\u6b64\u63a8\u8350\u7684\u6700\u4f73\u5165\u95e8\u5b9e\u8df5\u5e94\u5f53\u662f\u9996\u9009png\u3002 \u80fd\u591f\u63a5\u53d7unicode\u7684emoji\u56fe\u6807\uff0c\u5c31\u7b80\u5355\u4e86\uff0c\u76f4\u63a5\u5c06\u56fe\u6807\u590d\u5236\u7c98\u8d34\u5230\u6587\u672c\u91cc\u5373\u53ef \u8fd92\u79cd\u65b9\u6cd5\u5e76\u4e0d\u51b2\u7a81\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2amarkdown\u6587\u672c\u91cc\u6df7\u5408\u4f7f\u7528","title":"18.1. \u4ecb\u7ecd"},{"location":"syntax/emoji_main/#emoji","text":"emoji\u662f\u65e5\u672c\u5728\u65e0\u7ebf\u901a\u4fe1\u4e2d\u6240\u4f7f\u7528\u7684\u89c6\u89c9\u60c5\u611f\u7b26\u53f7\uff0c\u5df2\u88abunicode\u91c7\u7eb3\uff0c\u5f53\u524dunicode\u5305\u542b\u4e86\u975e\u5e38\u591a\u7684emoji\u56fe\u6807\uff0c\u6bcf\u4e00\u6b21unicode\u66f4\u65b0\u90fd\u4f1a\u53d1\u5e03\u65b0\u7684emoji\u56fe\u6807\u3002\u53ea\u8981\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301unicode\uff0c\u5c31\u80fd\u5728\u4efb\u610f\u4f7f\u7528unicode\u7f16\u7801\u7684\u5730\u65b9\u770b\u5230\u6f02\u4eae\u7684\u5f69\u8272\u56fe\u6807\uff0c\u6bd4\u5982\u6587\u672c\u3001mysql\u8868\u91cc\u3001\u7f51\u9875\u3002","title":"\u4ec0\u4e48\u662femoji"},{"location":"syntax/emoji_main/#emoji_1","text":"\u867d\u7136unicode\u5b98\u7f51\u53ef\u4ee5\u67e5\u5230\u6240\u6709emoji\u56fe\u6807\uff0c\u4f46\u5e76\u672a\u63d0\u4f9b\u4e00\u4e2a\u4fbf\u5229\u7684\u56fe\u6807\u5206\u7c7b\u67e5\u8be2\u548c\u4f7f\u7528\u65b9\u6cd5\u3002\u56e0\u6b64\u5c31\u6709\u4e00\u4e9b\u7b2c\u4e09\u65b9emoji\u5382\u5546\u5c06\u90e8\u5206emoji\u56fe\u6807\uff0c\u5236\u4f5c\u6210\u4e0d\u540c\u683c\u5f0f\u3001\u4e0d\u540c\u5c3a\u5bf8(\u4f8b\u598264x64 PNG\u3001128x128 PNG\u6216SVG\u7b49\u683c\u5f0f)\u7684\u56fe\u7247\u653e\u5165\u81ea\u5df1\u7684CDN\u5e93\u3002\u7136\u540e\u5c06\u8fd9\u4e9bCDN\u56fe\u7247\u4ee5\u514d\u8d39\u6216\u4ed8\u8d39\u65b9\u5f0f\u5bf9\u5916\u63d0\u4f9b\u3002","title":"emoji\u73b0\u72b6"},{"location":"syntax/emoji_main/#emoji_2","text":"\u6839\u636e\u4f7f\u7528\u9700\u6c42\u5206\u4e3a2\u79cd: \u4e0d\u6ee1\u8db3\u4e8eunicode\u7684emoji\u56fe\u6807\uff0c\u5e0c\u671b\u66f4\u597d\u770b\uff0c\u5e76\u4e14\u5c3a\u5bf8\u53ef\u9009\uff0c\u90a3\u4e48\u5c31\u4f7f\u7528\u7b2c\u4e09\u65b9emoji\u5382\u5546\u5e93\uff0c\u63a8\u8350\u4f7f\u7528EmojiOne\u7684png\u56fe\u5e93\uff0c\u5206\u4e3a\u514d\u8d39\u548c\u4ed8\u8d39\uff0c\u5176\u4e2d\u514d\u8d39\u7684\u56fe\u5e93\u5df2\u8db3\u591f\u6ee1\u8db3\u4e00\u822c\u6027\u4f7f\u7528\u9700\u6c42\uff0c\u5982\u679c\u60f3\u4f7f\u7528svg\uff0c\u514d\u8d39\u7684\u53ea\u6709EmojiOne-2.2.7\u4ee5\u5185\u7248\u672c\uff0c\u6700\u65b0\u7684svg\u90fd\u662f\u8981\u4ed8\u8d39\u7684\u3002\u4f7f\u7528\u65b9\u6cd5\u662f\u5728\u6587\u6863\u91cc\u7528 :\u77ed\u540d \u6765\u8ba9mkdocs\u81ea\u52a8\u5339\u914d\u5e76\u6e32\u67d3\u4e3a \u6807\u7b7e \u4e3e\u4f8b\u8bf4\u660e2.2.7\u4e0e\u9ad8\u7248\u672c\u533a\u522b \u5982\u679c\u7528\u7684 :\u77ed\u540d: \u662f2.2.7\u5305\u542b\u7684\uff0c\u90a3\u4e48\u56fe\u6807\u80fd\u6b63\u5e38\u663e\u793a\uff0c\u5426\u5219\u663e\u793a\u4e0d\u51fa\u6765 \u6bd4\u5982\uff1a https://cdn.jsdelivr.net/emojione/assets/svg/1f600.svg \u8fd9\u4e2a\u662f2.2.7\u5c31\u6709\u7684\uff0c\u8bbf\u95ee\u8fd9\u4e2aurl\u53ef\u4ee5\u770b\u5230\u56fe\u6807 https://cdn.jsdelivr.net/emojione/assets/svg/1f92e.svg \u8fd9\u4e2a\u662f2.2.7\u4e4b\u540e\u624d\u6709\u7684\uff0c\u9700\u8981\u4ed8\u8d39\u624d\u80fd\u83b7\u5f97\u56fe\u6807\uff0c\u672a\u4ed8\u8d39\u76f4\u63a5\u8bbf\u95ee\u4f1a\u5f97\u5230\u62a5\u9519\uff1a https://cdn.jsdelivr.net/emojione/assets/3.1/png/64/1f92e.png \u8fd9\u4e2a\u662fpng\uff0c\u4e0d\u5c5e\u4e8e\u4ed8\u8d39\u90e8\u5206\uff0c\u8bbf\u95ee\u8fd9\u4e2aurl\u53ef\u4ee5\u770b\u5230\u56fe\u6807 \u56e0\u6b64\u63a8\u8350\u7684\u6700\u4f73\u5165\u95e8\u5b9e\u8df5\u5e94\u5f53\u662f\u9996\u9009png\u3002 \u80fd\u591f\u63a5\u53d7unicode\u7684emoji\u56fe\u6807\uff0c\u5c31\u7b80\u5355\u4e86\uff0c\u76f4\u63a5\u5c06\u56fe\u6807\u590d\u5236\u7c98\u8d34\u5230\u6587\u672c\u91cc\u5373\u53ef \u8fd92\u79cd\u65b9\u6cd5\u5e76\u4e0d\u51b2\u7a81\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2amarkdown\u6587\u672c\u91cc\u6df7\u5408\u4f7f\u7528","title":"\u5982\u4f55\u83b7\u5f97emoji"},{"location":"syntax/emoji_principle/","text":"\u672c\u6587\u4e2d\u4e3b\u8981\u4ecb\u7ecdmkdocs\u4f9d\u8d56pymdownx.emoji\u8fdb\u884c\u5339\u914d\u3001\u6e32\u67d3\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u8bf4\u660e\u5747\u662f\u5173\u4e8epymdownx.emoji\u3002 pymdownx\u652f\u63013\u4e2a\u4e3b\u6d41\u7684emoji\u5382\u5546\uff1aGemoji\uff08github.com\u505a\u7684\uff09\u3001EmojiOne\uff08\u7b2c\u4e09\u65b9\u7684\uff0c\u5206\u4e3a\u514d\u8d39\u7248\u3001\u4ed8\u8d39\u7248\u3001\u6218\u7565\u5408\u4f5c\u7248\uff09\u3001Twemoji\uff08twitter\u505a\u7684\uff09\uff0cpymdownx\u5b98\u65b9\u63a8\u8350\u7528EmojiOne\uff0c\u9ed8\u8ba4\u4e5f\u662fEmojiOne \u67092\u4e2a\u5173\u952e\u53c2\u6570 \u00b6 emoji_index\uff0c\u9009\u62e9emoji\u5382\u5546\uff0c\u9ed8\u8ba4\u4e3aEmojiOne emoji_generator\uff0c\u9009\u62e9\u5382\u5546\u5bf9\u5e94\u7684\u56fe\u7247\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3ato_png generator\u67093\u7c7b \u00b6 to_png/to_svg : markdown\u5728\u6e32\u67d3\u65f6\u5019\uff0c\u5176\u4e2d\u7684 :\u77ed\u540d: \u6839\u636eemoji_index(\u5373Gemoji/EmojiOne/Twemoji)\u88ab\u6620\u5c04\u4e3a\u76f8\u5e94\u7684unicode\u7801 unicode\u7801\u88ab\u8f6c\u4e3aemoji_index\u5bf9\u5e94\u7684\u56fe\u7247CDN\u5730\u5740(Gemoji/EmojiOne/Twemoji\u90fd\u6709\u5404\u81ea\u7684CDN) \u6e32\u67d3\u6210html\u65f6\u5019\u56fe\u7247\u5730\u5740\u88ab\u5199\u5165 \u6807\u7b7e to_png_sprite/to_svg_sprite : \u6682\u4e0d\u4e86\u89e3 to_alt : markdown\u5728\u6e32\u67d3\u65f6\u5019\uff0c\u5176\u4e2d\u7684 :\u77ed\u540d: \u6839\u636eemoji_index(\u5373Gemoji/EmojiOne/Twemoji)\u88ab\u6620\u5c04\u4e3a\u76f8\u5e94\u7684unicode\u7801 \u6e32\u67d3\u6210html\u65f6\u5019unicode\u7801\u88ab\u76f4\u63a5\u5199\u5165 \u6807\u7b7e to_alt\u6548\u679c\u7b49\u540c\u4e8e\u76f4\u63a5\u5c06emoji\u56fe\u6807\u590d\u5236\u5230markdown\u6587\u6863\u4e2d","title":"18.2. \u5de5\u4f5c\u539f\u7406"},{"location":"syntax/emoji_principle/#2","text":"emoji_index\uff0c\u9009\u62e9emoji\u5382\u5546\uff0c\u9ed8\u8ba4\u4e3aEmojiOne emoji_generator\uff0c\u9009\u62e9\u5382\u5546\u5bf9\u5e94\u7684\u56fe\u7247\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3ato_png","title":"\u67092\u4e2a\u5173\u952e\u53c2\u6570"},{"location":"syntax/emoji_principle/#generator3","text":"to_png/to_svg : markdown\u5728\u6e32\u67d3\u65f6\u5019\uff0c\u5176\u4e2d\u7684 :\u77ed\u540d: \u6839\u636eemoji_index(\u5373Gemoji/EmojiOne/Twemoji)\u88ab\u6620\u5c04\u4e3a\u76f8\u5e94\u7684unicode\u7801 unicode\u7801\u88ab\u8f6c\u4e3aemoji_index\u5bf9\u5e94\u7684\u56fe\u7247CDN\u5730\u5740(Gemoji/EmojiOne/Twemoji\u90fd\u6709\u5404\u81ea\u7684CDN) \u6e32\u67d3\u6210html\u65f6\u5019\u56fe\u7247\u5730\u5740\u88ab\u5199\u5165 \u6807\u7b7e to_png_sprite/to_svg_sprite : \u6682\u4e0d\u4e86\u89e3 to_alt : markdown\u5728\u6e32\u67d3\u65f6\u5019\uff0c\u5176\u4e2d\u7684 :\u77ed\u540d: \u6839\u636eemoji_index(\u5373Gemoji/EmojiOne/Twemoji)\u88ab\u6620\u5c04\u4e3a\u76f8\u5e94\u7684unicode\u7801 \u6e32\u67d3\u6210html\u65f6\u5019unicode\u7801\u88ab\u76f4\u63a5\u5199\u5165 \u6807\u7b7e to_alt\u6548\u679c\u7b49\u540c\u4e8e\u76f4\u63a5\u5c06emoji\u56fe\u6807\u590d\u5236\u5230markdown\u6587\u6863\u4e2d","title":"generator\u67093\u7c7b"},{"location":"syntax/emoji_usage/","text":"\u901a\u8fc7\u5728markdown\u91cc\u4f7f\u7528 :\u77ed\u540d: \uff0c\u53ef\u4ee5\u5728\u6e32\u67d3\u51fa\u7684html\u91cc\u5c55\u73b0emoji\u56fe\u7247 \u4f9d\u8d56\u6a21\u5757: pymdownx.emoji \u4f7f\u7528\u6b65\u9aa4: mkdocs.yml\u91cc\u914d\u7f6e: - pymdownx.emoji : emoji_generator : !!python/name:pymdownx.emoji.to_png \u5efa\u8bae\u4f7f\u7528to_png\uff0c\u5982\u679c\u4f7f\u7528to_svg\u4f1a\u6709\u90e8\u5206\u56fe\u7247\u56e0\u4e3a\u672a\u4ed8\u8d39\u5bfc\u81f4\u65e0\u6cd5\u663e\u793a \u6d4f\u89c8\u5668\u6253\u5f00 https://www.emojicopy.com/ (emojione\u5b98\u65b9\u63a8\u51fa\u7684emoji\u67e5\u8be2\u7f51\u7ad9\uff0c\u867d\u7136\u5e76\u975e\u5168\u90e8emoji\uff0c\u4f46\u4e5f\u662f\u76ee\u524d\u627e\u5230\u7684\u76f8\u5bf9\u6700\u5168\uff0c\u5e76\u4e14\u5206\u7c7b\u6e05\u695a\uff0c\u4f7f\u7528\u65b9\u4fbf\u7684emoji\u67e5\u8be2\u7f51\u7ad9)\uff0c\u5c06\u9f20\u6807\u60ac\u505c\u5728\u56fe\u6807\u4e0a\u65b9\u4e00\u4f1a\uff0c\u4f1a\u51fa\u73b0\u5bf9\u5e94\u7684\u5168\u540d\uff0c\u6bd4\u5982 \u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u5168\u540d\uff0c\u6bd4\u5982\u8fd9\u91cc\u53eb\u505agrinning face \u70b9\u51fb\u8fdb\u5165\u9644\u5f55\u91cc\u7684 emojione\u5168\u540d\u77ed\u540d\u6620\u5c04\u8868 \uff0c\u5728\u91cc\u9762\u67e5\u627e\u5bf9\u5e94\u7684\u77ed\u540d \u5728markdown\u91cc\u4f7f\u7528\u8be5\u77ed\u540d \u6700\u7701\u4e8b\u505a\u6cd5: \u76f4\u63a5\u590d\u5236emoji\u56fe\u6807 \u65e0\u9700mkdocs.yml\u505a\u4efb\u4f55\u914d\u7f6e\uff0c\u53ea\u8981\u662femoji\u56fe\u6807(\u662f\u56fe\u6807\u4e0d\u662f\u56fe\u7247)\uff0c\u65e0\u8bba\u662f\u8f93\u5165\u6cd5\u81ea\u5e26\u7684emoji\u56fe\u6807\uff0c\u8fd8\u662f https://www.emojicopy.com/ \u4e0a\u7684emoji\u56fe\u6807\uff0c\u90fd\u53ef\u4ee5\u76f4\u63a5\u590d\u5236\u7c98\u8d34\u5230markdown\u6587\u6863\u91cc\u5373\u53ef\u3002\u6bd4\u5982\u8fd9\u4e2a\u7b11\u8138\ud83d\ude04\u5c31\u6765\u81ea\u6211\u7684\u8f93\u5165\u6cd5\uff0c\u53ef\u4ee5\u81ea\u884c\u590d\u5236\u5230markdown\u6587\u6863\u91cc\u6d4b\u8bd5\u3002 \u800c\u4e14\u8fd9\u79cd\u65b9\u5f0f\u9002\u7528\u4e8e\u6240\u6709markdown\u7f16\u8f91\u5668\u3002","title":"18.3. \u6700\u4f73\u5b9e\u8df5"},{"location":"syntax/escape/","text":"\u63a8\u8350\u4f9d\u7167\u5982\u4e0b\u987a\u5e8f\u8fdb\u884c\u8f6c\u4e49\u5c1d\u8bd5 1\u20e3\ufe0f \u4f7f\u7528\u8f6c\u4e49\u7b26\u53f7 \\ 2\u20e3\ufe0f \u4f7f\u7528 \u884c\u5185\u4ee3\u7801 \u6216 \u533a\u5757\u4ee3\u7801 \u65b9\u5f0f 3\u20e3\ufe0f \u5728\u884c\u5185\u4ee3\u7801\u6216\u533a\u5757\u4ee3\u7801\u91cc\u518d\u4f7f\u7528\u8f6c\u4e49\u7b26\u53f7 \\ 4\u20e3\ufe0f html\u6807\u7b7e: &lt;code&gt;\u9700\u8981\u8f6c\u4e49\u7684\u5185\u5bb9&lt;/code&gt; \u5982\u679c\u4e0a\u9762\u90fd\u884c\u4e0d\u901a\uff0c\u53ea\u6709\u6700\u540e\u4e00\u62db\uff0c\u622a\u56fe\u5e76 \u63d2\u5165\u56fe\u7247 \u63a8\u8350\u7684\u622a\u56fe\u65b9\u5f0f \u628a\u8981\u8f6c\u4e49\u7684\u6587\u672c\u590d\u5236\u5230\u5fae\u4fe1\u804a\u5929\u5bf9\u8bdd\u8f93\u5165\u6846\u91cc\uff0c\u7136\u540e\u7528\u4efb\u610f\u622a\u56fe\u5de5\u5177\u5bf9\u7740\u8f93\u5165\u6846\u622a\u56fe\uff0c\u8fd9\u6837\u622a\u56fe\u51fa\u6765\u7684\u5e26\u6709\u7070\u8272\u80cc\u666f\uff0c\u5373\u4ee3\u7801\u5757\u90a3\u79cd\u7070\u8272\u80cc\u666f\uff08\u4f1a\u8ba9\u4eba\u89c9\u5f97\u662f\u4f7f\u7528\u4ee3\u7801\u5757\u65b9\u5f0f\u5728\u8868\u8ff0\uff09\u3002 \u6ce8\u610f\u4e0a\u4e0b\u6587 \u76f8\u540c\u7684\u7b26\u53f7\uff0c\u4f1a\u56e0\u4e3a\u4e0a\u4e0b\u6587\u73af\u5883\u88abmkdocs\u8ba4\u4e3a\u662f\u4e0d\u540c\u7684\u610f\u601d\uff0c\u56e0\u6b64\u6709\u65f6\u4f1a\u9047\u5230\u4e00\u4e9b\u7b26\u53f7\u5728\u6709\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u91cc\u53ef\u4ee5\u4f7f\u7528\u6216\u8f6c\u4e49\uff0c\u6709\u7684\u5c31\u4e0d\u884c\uff0c\u6bd4\u5982\u8ddf\u5728\u5217\u8868\u4e4b\u540e\u548c\u8ddf\u7740\u6807\u9898\u4e4b\u540e\u662f\u4e0d\u540c\u4e0a\u4e0b\u6587\u73af\u5883\u3002 \u6211\u7684\u6848\u4f8b \u53ef\u4ee5\u4e0agithub\u67e5\u770b\u672c\u6587\u6863\u4e2d\u8f6c\u4e49\u7ae0\u8282\u7684markdown\u6e90\u6587\u4ef6\uff0c\u5176\u4e2d\u5927\u91cf\u4f7f\u7528\u4e86\u8f6c\u4e49","title":"12. \u8f6c\u4e49"},{"location":"syntax/font_line/","text":"\u4e0d\u5e26\u9ad8\u4eae \u00b6 \u4f9d\u8d56\u6a21\u5757: pymdownx.critic This is ~~is~~ a test. \u6548\u679c This is is a test. \u80cc\u666f\u9ad8\u4eae \u00b6 \u8be6\u89c1 \u9ad8\u4eae\u7ae0\u8282\u6a2a\u7ebf\u90e8\u5206","title":"7.4. \u6a2a\u7ebf"},{"location":"syntax/font_line/#_1","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.critic This is ~~is~~ a test. \u6548\u679c This is is a test.","title":"\u4e0d\u5e26\u9ad8\u4eae"},{"location":"syntax/font_line/#_2","text":"\u8be6\u89c1 \u9ad8\u4eae\u7ae0\u8282\u6a2a\u7ebf\u90e8\u5206","title":"\u80cc\u666f\u9ad8\u4eae"},{"location":"syntax/font_stress/","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.betterem(smart_enable=all) *text* \u6216 _text_ \u659c\u4f53 **text** \u6216 __text__ \u7c97\u4f53 ***text*** \u6216 ___text___ \u7c97\u659c\u4f53 \u6548\u679c text \u659c\u4f53 text \u7c97\u4f53 text \u7c97\u659c\u4f53 \u907f\u514d\u51b2\u7a81 \u8fd9\u4e2a\u6269\u5c55\u548cmarkdown.extensions.smartstrong\u6269\u5c55\u51b2\u7a81\uff0c\u4e0d\u80fd\u540c\u65f6\u8f7d\u5165\uff0c\u524d\u8005\u66ff\u4ee3\u4e86\u540e\u8005\uff0c\u5b9e\u73b0\u66f4\u597d\u7684\u6548\u679c\u3002","title":"7.1. \u659c\u4f53,\u7c97\u4f53,\u7c97\u659c\u4f53"},{"location":"syntax/font_underline/","text":"\u4e0d\u5e26\u9ad8\u4eae \u00b6 \u4f9d\u8d56\u6a21\u5757: pymdownx.caret ^^underline me^^ \u6548\u679c underline me \u80cc\u666f\u9ad8\u4eae \u00b6 \u8be6\u89c1 \u9ad8\u4eae\u7ae0\u8282\u4e0b\u5212\u7ebf\u90e8\u5206","title":"7.3. \u4e0b\u5212\u7ebf"},{"location":"syntax/font_underline/#_1","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.caret ^^underline me^^ \u6548\u679c underline me","title":"\u4e0d\u5e26\u9ad8\u4eae"},{"location":"syntax/font_underline/#_2","text":"\u8be6\u89c1 \u9ad8\u4eae\u7ae0\u8282\u4e0b\u5212\u7ebf\u90e8\u5206","title":"\u80cc\u666f\u9ad8\u4eae"},{"location":"syntax/font_underline_line/","text":"\u53ea\u6709\u9ad8\u4eae\u5f62\u5f0f,\u8be6\u89c1 \u9ad8\u4eae\u7ae0\u8282\u4e0b\u5212\u7ebf+\u6a2a\u7ebf\u90e8\u5206","title":"7.5. \u4e0b\u5212\u7ebf+\u6a2a\u7ebf"},{"location":"syntax/font_updown/","text":"\u4e0a\u6807 \u00b6 \u4f9d\u8d56\u6a21\u5757: pymdownx.caret 10^2^ \u6548\u679c 10 2 \u9488\u5bf9\u82f1\u6587\u63cf\u8ff0\u7b2c\u51e0\u7684\u4e0a\u6807\uff0c\u53ef\u4ee5 1st \u8fd9\u79cd\u65b9\u5f0f(\u4f9d\u8d56\u6a21\u5757: pymdownx.smartsymbols) \u7528\u6cd5 \u6548\u679c 1st 2nd 3rd 1 st 2 nd 3 rd 1^st^ 2^nd^ 3^rd^ 1 st 2 nd 3 rd \u4e0b\u6807 \u00b6 \u4f9d\u8d56\u6a21\u5757: pymdownx.tilde H~2~O \u6548\u679c H 2 O","title":"7.2. \u4e0a\u6807,\u4e0b\u6807"},{"location":"syntax/font_updown/#_1","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.caret 10^2^ \u6548\u679c 10 2 \u9488\u5bf9\u82f1\u6587\u63cf\u8ff0\u7b2c\u51e0\u7684\u4e0a\u6807\uff0c\u53ef\u4ee5 1st \u8fd9\u79cd\u65b9\u5f0f(\u4f9d\u8d56\u6a21\u5757: pymdownx.smartsymbols) \u7528\u6cd5 \u6548\u679c 1st 2nd 3rd 1 st 2 nd 3 rd 1^st^ 2^nd^ 3^rd^ 1 st 2 nd 3 rd","title":"\u4e0a\u6807"},{"location":"syntax/font_updown/#_2","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.tilde H~2~O \u6548\u679c H 2 O","title":"\u4e0b\u6807"},{"location":"syntax/footnote/","text":"\u4f9d\u8d56\u6a21\u5757: footnotes \u7b2c\u4e00\u6b65. \u63d2\u5165\u5f15\u7528 Lorem ipsum[^1] dolor sit amet, consectetur adipiscing elit.[^2] \u7b2c\u4e8c\u6b65. \u63d2\u5165\u5185\u5bb9 [^1]: Lorem ipsum dolor sit amet, consectetur adipiscing elit. [^2]: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. \u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u811a\u6ce81\u5185\u5bb9\u662f\u5355\u884c\u65b9\u5f0f\uff0c\u811a\u6ce82\u5185\u5bb9\u662f\u591a\u884c\u65b9\u5f0f \u6548\u679c Lorem ipsum 1 dolor sit amet, consectetur adipiscing elit. 2 \u6ce8\u610f \u4e0d\u4e00\u5b9a\u8981\u7528[^1]\uff0c\u4e5f\u53ef\u4ee5\u7528\u81ea\u5b9a\u4e49\u5173\u952e\u5b57\uff0c\u6bd4\u5982[^mykey]\uff0c\u4f46\u8fd9\u6837\u4e0b\u9762\u4e5f\u8981\u6539\u4e3a[^mykey]\uff0c\u4e5f\u53ef\u4ee5\u652f\u6301\u7a7a\u683c\uff0c\u6bd4\u5982[^my key]\uff08\u5f53\u7136\u540e\u9762\u4e5f\u8981[^my key]: \u65e0\u8bba\u811a\u6ce8\u6807\u7b7e\u5199\u7684\u662f\u4ec0\u4e48\uff08\u5373[^1]\u6216\u8005[^mykey]\uff0c\u5728\u5c55\u793a\u811a\u6ce8\u6807\u7b7e\u548c\u5c55\u793a\u811a\u6ce8\u5185\u5bb9\u65f6\u5019\u90fd\u662f\u81ea\u52a8\u7528\u6570\u5b57\u4ece1\u5f00\u59cb\u7d2f\u52a0\u6807\u8bb0\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u5199\u7684\u5185\u5bb9\uff09 [^1]: \u811a\u6ce8\u5185\u5bb9\u65e0\u8bba\u5199\u5728.md\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\uff0c\u5728\u5c55\u793a\u65f6\u5019\u90fd\u662f\u81ea\u52a8\u4f4d\u4e8e\u6587\u6863\u7684\u6700\u4e0b\u65b9\uff0c\u5e76\u4e14\u4f1a\u81ea\u52a8\u6dfb\u52a0---\u8fd9\u6837\u4e00\u4e2a\u6a2a\u7ebf Lorem ipsum dolor sit amet, consectetur adipiscing elit. \u21a9 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. \u21a9","title":"15. \u811a\u6ce8"},{"location":"syntax/headline/","text":"\u4f7f\u7528 # \uff0c\u8868\u793a1-6\u7ea7\u6807\u9898\u3002 # \u4e00\u7ea7\u6807\u9898 ## \u4e8c\u7ea7\u6807\u9898 ### \u4e09\u7ea7\u6807\u9898 #### \u56db\u7ea7\u6807\u9898 ##### \u4e94\u7ea7\u6807\u9898 ###### \u516d\u7ea7\u6807\u9898 \u6ce8\u610f: \u4e00\u4e2a.md\u91cc\u53ea\u80fd\u6709\u4e00\u4e2a # \uff0c\u8ddf\u7740\u591a\u4e2a ## \u3002\u5982\u679c\u6709\u591a\u4e2a # \uff0c\u5219\u4e0d\u4f1a\u81ea\u52a8\u751f\u4ea7\u672c\u9875\u76ee\u5f55\u3002 \u5982\u679c\u6709 # \uff0c\u5219\u4f7f\u7528\u8be5\u6807\u9898\u4f5c\u4e3a\u672c\u9875\u6b63\u6587\u90e8\u5206\u7b2c\u4e00\u884c\uff0c\u5982\u679c\u6ca1\u6709#\uff0c\u5219\u4e3amkdocs.yml\u91cc\u6307\u5b9a\u7684pages\u540d\u3002 \u4e2a\u4eba\u5efa\u8bae.md\u4ece ## \u5f00\u59cb\uff0c\u4e0d\u8981\u7528 # \u3002","title":"2. \u6807\u9898"},{"location":"syntax/highlight_background/","text":"\u9ec4\u8272 \u00b6 2\u4e2a\u6a21\u5757\u5747\u63d0\u4f9b\u4e86\u76f8\u4f3c\u7684\u6548\u679c \u6a21\u57571: pymdownx.mark ==hello world== \u6548\u679c hello world \u6a21\u57572: pymdownx.critic \u6548\u679c hello world \u4f46\u8fd92\u4e2a\u6a21\u5757\u4e5f\u6709\u533a\u522b : \u533a\u522b1: pymdownx.mark\u6e32\u67d3\u51fa\u7684html\u662f <p><mark>hello world</mark></p> pymdownx.critic\u6e32\u67d3\u51fa\u7684html\u662f <p><mark class=\"critic\">hello world</mark></p> \u533a\u522b2: pymdownx.mark\u4e0d\u652f\u6301\u5757\u80cc\u666f\u9ad8\u4eae pymdownx.critic\u652f\u6301\u5757\u80cc\u666f\u9ad8\u4eae \u7528\u6cd5: \u6548\u679c: AAA BBB CCC \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u9ec4\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b \u7eff\u8272(\u4e0b\u5212\u7ebf) \u00b6 \u8868\u793a\u63d2\u5165\u6587\u5b57 \u4f9d\u8d56\u6a21\u5757: pymdownx.critic \u6548\u679c Hello, my world! \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u7eff\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b \u7ea2\u8272(\u6a2a\u7ebf) \u00b6 \u8868\u793a\u5220\u9664\u6587\u5b57 \u4f9d\u8d56\u6a21\u5757: pymdownx.tidle \u6548\u679c delete me \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u7ea2\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b \u7eff\u8272+\u7ea2\u8272(\u4e0b\u5212\u7ebf+\u6a2a\u7ebf) \u00b6 \u8868\u793a\u66ff\u6362\u6587\u5b57 2\u79cd\u5b9e\u73b0\u65b9\u5f0f: \u5148\u4f7f\u7528\u7ea2\u8272(\u6a2a\u7ebf)\uff0c\u518d\u4f7f\u7528\u7eff\u8272(\u4e0b\u5212\u7ebf) \u4f7f\u7528\u4e13\u95e8\u7684\u8bed\u6cd5\uff0c\u4f9d\u8d56\u6a21\u5757pymdownx.tidle \u8fd92\u79cd\u65b9\u5f0f\u6548\u679c\u5b8c\u5168\u4e00\u81f4\uff0c\u5305\u62ec\u5b9e\u9645\u770b\u5230\u7684\u6837\u5f0f\u548chtml\u90fd\u662f\u76f8\u540c\u7684 Hello, my our world! \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u7eff\u8272+\u7ea2\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b \u7070\u8272 \u00b6 \u8868\u793a\u6ce8\u89e3 \u4f9d\u8d56\u6a21\u5757: pymdownx.critic \u6548\u679c This is a test What is it a test of? . \u6ce8\u610f: \u53ea\u652f\u6301\u5355\u884c\u7528\u6cd5\uff0c\u4e0d\u652f\u6301\u533a\u5757\u7528\u6cd5 \u65e0\u6cd5\u4e0e\u4ee3\u7801\u9ad8\u4eae\u7ed3\u5408\uff0c\u5305\u62ec\u884c\u5185\u4ee3\u7801\u9ad8\u4eae\u548c\u533a\u5757\u4ee3\u7801\u9ad8\u4eae","title":"13.2. \u80cc\u666f\u9ad8\u4eae"},{"location":"syntax/highlight_background/#_1","text":"2\u4e2a\u6a21\u5757\u5747\u63d0\u4f9b\u4e86\u76f8\u4f3c\u7684\u6548\u679c \u6a21\u57571: pymdownx.mark ==hello world== \u6548\u679c hello world \u6a21\u57572: pymdownx.critic \u6548\u679c hello world \u4f46\u8fd92\u4e2a\u6a21\u5757\u4e5f\u6709\u533a\u522b : \u533a\u522b1: pymdownx.mark\u6e32\u67d3\u51fa\u7684html\u662f <p><mark>hello world</mark></p> pymdownx.critic\u6e32\u67d3\u51fa\u7684html\u662f <p><mark class=\"critic\">hello world</mark></p> \u533a\u522b2: pymdownx.mark\u4e0d\u652f\u6301\u5757\u80cc\u666f\u9ad8\u4eae pymdownx.critic\u652f\u6301\u5757\u80cc\u666f\u9ad8\u4eae \u7528\u6cd5: \u6548\u679c: AAA BBB CCC \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u9ec4\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b","title":"\u9ec4\u8272"},{"location":"syntax/highlight_background/#_2","text":"\u8868\u793a\u63d2\u5165\u6587\u5b57 \u4f9d\u8d56\u6a21\u5757: pymdownx.critic \u6548\u679c Hello, my world! \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u7eff\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b","title":"\u7eff\u8272(\u4e0b\u5212\u7ebf)"},{"location":"syntax/highlight_background/#_3","text":"\u8868\u793a\u5220\u9664\u6587\u5b57 \u4f9d\u8d56\u6a21\u5757: pymdownx.tidle \u6548\u679c delete me \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u7ea2\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b","title":"\u7ea2\u8272(\u6a2a\u7ebf)"},{"location":"syntax/highlight_background/#_4","text":"\u8868\u793a\u66ff\u6362\u6587\u5b57 2\u79cd\u5b9e\u73b0\u65b9\u5f0f: \u5148\u4f7f\u7528\u7ea2\u8272(\u6a2a\u7ebf)\uff0c\u518d\u4f7f\u7528\u7eff\u8272(\u4e0b\u5212\u7ebf) \u4f7f\u7528\u4e13\u95e8\u7684\u8bed\u6cd5\uff0c\u4f9d\u8d56\u6a21\u5757pymdownx.tidle \u8fd92\u79cd\u65b9\u5f0f\u6548\u679c\u5b8c\u5168\u4e00\u81f4\uff0c\u5305\u62ec\u5b9e\u9645\u770b\u5230\u7684\u6837\u5f0f\u548chtml\u90fd\u662f\u76f8\u540c\u7684 Hello, my our world! \u652f\u6301\u5d4c\u5957\uff0c\u8be6\u89c1 \u7eff\u8272+\u7ea2\u8272\u533a\u5757\u5d4c\u5957\u9ad8\u4eae\u4ee3\u7801\u793a\u4f8b","title":"\u7eff\u8272+\u7ea2\u8272(\u4e0b\u5212\u7ebf+\u6a2a\u7ebf)"},{"location":"syntax/highlight_background/#_5","text":"\u8868\u793a\u6ce8\u89e3 \u4f9d\u8d56\u6a21\u5757: pymdownx.critic \u6548\u679c This is a test What is it a test of? . \u6ce8\u610f: \u53ea\u652f\u6301\u5355\u884c\u7528\u6cd5\uff0c\u4e0d\u652f\u6301\u533a\u5757\u7528\u6cd5 \u65e0\u6cd5\u4e0e\u4ee3\u7801\u9ad8\u4eae\u7ed3\u5408\uff0c\u5305\u62ec\u884c\u5185\u4ee3\u7801\u9ad8\u4eae\u548c\u533a\u5757\u4ee3\u7801\u9ad8\u4eae","title":"\u7070\u8272"},{"location":"syntax/highlight_code/","text":"\u884c\u5185\u4ee3\u7801\u9ad8\u4eae \u00b6 \u4f9d\u8d56\u6a21\u5757: pymdownx.inlinehilite \u4f7f\u7528shebang\u53ef\u4ee5\u5728\u4e00\u884c\u6587\u672c\u91cc\u5b9e\u73b0\u4ee3\u7801\u9ad8\u4eae `#!python print \"Hello, world!\"`\u6216`:::python print \"Hello, world!\"` \u6548\u679c print \"Hello, world!\" \u6216 print \"Hello, world!\" \u5f00\u5934\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5982\u679c\u6709\u7a7a\u683c\u7684\u8bdd\uff0c\u5c31\u4f1a\u88ab\u8ba4\u4e3a\u662f\u6b63\u6587 ` #!python print \"Hello, world!\"` \u6548\u679c #!python print \"Hello, world!\" ` :::python print \"Hello, world!\"` \u6548\u679c :::python print \"Hello, world!\" \u533a\u5757\u4ee3\u7801\u9ad8\u4eae \u00b6 \u7528\u6cd5 \u00b6 \u4f9d\u8d56\u6a21\u5757: codehilite \u5199\u6cd51: 3\u4e2a` ```python text = \"Hello, world!\" print text ``` \u6548\u679c text = \"Hello, world!\" print text \u5199\u6cd52: 4\u4e2a\u7a7a\u683c+shebang #!/usr/bin/python text = \"Hello, world!\" print text \u6548\u679c #!/usr/bin/python text = \"Hello, world!\" print text \u652f\u6301434\u79cd\u683c\u5f0f codehilite\u662f\u57fa\u4e8epygments\u5b9e\u73b0\u9ad8\u4eae\u7684\uff0c\u652f\u6301434\u79cd\u683c\u5f0f\uff0c\u8be6\u89c1 \u652f\u6301\u4ee3\u7801\u9ad8\u4eae\u7684\u8bed\u8a00 \u82e5\u6307\u5b9a\u4e86\u4e0d\u5b58\u5728\u7684\u683c\u5f0f\uff0c\u5219\u7b49\u540c\u4e8etext\uff0c\u4e0d\u505a\u4efb\u4f55\u9ad8\u4eae\u6e32\u67d3 \u82e5\u4e0d\u60f3\u4f7f\u7528\u9ad8\u4eae\uff0c\u7528text\uff0c\u5982\uff1a ```text text = \"Hello, world!\" print text ``` \u6548\u679c text = \"Hello, world!\" print text \u53c2\u65701. \u81ea\u52a8\u731c\u6d4b\u8bed\u8a00 \u00b6 \u5728mkdocs.yml\u91ccmarkdown_extensions\u90e8\u5206\u8bbe\u7f6e\u5982\u4e0b - codehilite(guess_lang=false) \u5173\u95ed\u731c\u6d4b\uff0c\u82e5\u4e0d\u6307\u5b9a\u8bed\u8a00\uff0c\u5219\u5173\u95ed\u9ad8\u4eae - codehilite(guess_lang=true) \u5f00\u542f\u731c\u6d4b\uff0c\u82e5\u4e0d\u6307\u5b9a\u8bed\u8a00\uff0c\u5219\u81ea\u52a8\u731c\u6d4b \u53c2\u65702. \u663e\u793a\u884c\u53f7 \u00b6 \u5728mkdocs.yml\u91ccmarkdown_extensions\u90e8\u5206\u8bbe\u7f6e - codehilite(linenums=true) \u663e\u793a\u884c\u53f7 - codehilite(linenums=false) \u4e0d\u663e\u793a\u884c\u53f7 \u82e5codehilite(linenums=true)\uff0c4\u4e2a\u7a7a\u683c\u7684\u4ee3\u7801\u5757\u65b9\u5f0f\u4e5f\u4f1a\u88ab\u81ea\u52a8\u52a0\u4e0a\u884c\u53f7 \u6307\u5b9a\u4ee3\u7801\u5757\u663e\u793a\u884c\u53f7 \u56e0\u6b64\uff0c\u5982\u679c\u60f3\u5168\u5c40\u9ed8\u8ba4\u4e0d\u663e\u793a\u884c\u53f7\uff0c\u800c\u6307\u5b9a\u4ee3\u7801\u5757\u663e\u793a\u884c\u53f7\uff0c\u53ef\u4ee5\u5728mkdocs.yml\u91cc\u6307\u5b9alinenums=false\uff0c\u7136\u540e\u60f3\u663e\u793a\u884c\u53f7\u7684\u4ee3\u7801\u5757\u7528linenums=\"1\" \u53c2\u65703. \u6307\u5b9a\u7b2c\u51e0\u884c\u80cc\u666f\u9ad8\u4eae \u00b6 \u5728mkdocs.yml\u91cc\u4e0d\u7528\u989d\u5916\u8bbe\u7f6e ```python hl_lines=\"2 4\" text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 \u53c2\u65704. \u6307\u5b9a\u884c\u53f7\u4ece\u591a\u5c11\u5f00\u59cb\u7f16\u53f7 \u00b6 ```python linenums=\"2\" text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c 2 3 4 text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 \u5f3a\u5236\u663e\u5f0f\u884c\u53f7 \u5f53\u4ee3\u7801\u5757\u6307\u5b9a\u4e86linenums\u540e\uff0c\u5373\u4f7fmkdocs.yml\u91cclinenums=false\uff0c\u4e5f\u4f1a\u81ea\u52a8\u663e\u793a\u884c\u53f7 \u56e0\u6b64\uff0c\u5982\u679c\u60f3\u5168\u5c40\u9ed8\u8ba4\u4e0d\u663e\u793a\u884c\u53f7\uff0c\u800c\u6307\u5b9a\u4ee3\u7801\u5757\u663e\u793a\u884c\u53f7\uff0c\u53ef\u4ee5\u5728mkdocs.yml\u91cc\u6307\u5b9alinenums=false\uff0c\u7136\u540e\u60f3\u663e\u793a\u884c\u53f7\u7684\u4ee3\u7801\u5757\u7528linenums=\"1\" \u6ce8\u610f\uff1a\u4ee3\u7801\u5757linenums\u53c2\u6570\u4e0d\u4f1a\u5f71\u54cdhl_lines\uff0c\u5373\u65e0\u8bbalinenums\u6307\u5b9a\u4ece\u591a\u5c11\u884c\u5f00\u59cb\u7f16\u53f7\uff0chl_lines\u5b9e\u9645\u90fd\u4ee5\u884c\u53f7\u4ece1\u5f00\u59cb\u7f16\u53f7\u6765\u627e\u5230\u5bf9\u5e94\u884c\u8fdb\u884c\u80cc\u666f\u9ad8\u4eae\u6e32\u67d3\uff0c\u5982\uff1a ```python linenums=\"2\" hl_lines=\"3\" text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c 2 3 4 text1 = \"Hello, \" text2 = \"world!\" print text1 + text2","title":"13.1. \u4ee3\u7801\u9ad8\u4eae"},{"location":"syntax/highlight_code/#_1","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.inlinehilite \u4f7f\u7528shebang\u53ef\u4ee5\u5728\u4e00\u884c\u6587\u672c\u91cc\u5b9e\u73b0\u4ee3\u7801\u9ad8\u4eae `#!python print \"Hello, world!\"`\u6216`:::python print \"Hello, world!\"` \u6548\u679c print \"Hello, world!\" \u6216 print \"Hello, world!\" \u5f00\u5934\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5982\u679c\u6709\u7a7a\u683c\u7684\u8bdd\uff0c\u5c31\u4f1a\u88ab\u8ba4\u4e3a\u662f\u6b63\u6587 ` #!python print \"Hello, world!\"` \u6548\u679c #!python print \"Hello, world!\" ` :::python print \"Hello, world!\"` \u6548\u679c :::python print \"Hello, world!\"","title":"\u884c\u5185\u4ee3\u7801\u9ad8\u4eae"},{"location":"syntax/highlight_code/#_2","text":"","title":"\u533a\u5757\u4ee3\u7801\u9ad8\u4eae"},{"location":"syntax/highlight_code/#_3","text":"\u4f9d\u8d56\u6a21\u5757: codehilite \u5199\u6cd51: 3\u4e2a` ```python text = \"Hello, world!\" print text ``` \u6548\u679c text = \"Hello, world!\" print text \u5199\u6cd52: 4\u4e2a\u7a7a\u683c+shebang #!/usr/bin/python text = \"Hello, world!\" print text \u6548\u679c #!/usr/bin/python text = \"Hello, world!\" print text \u652f\u6301434\u79cd\u683c\u5f0f codehilite\u662f\u57fa\u4e8epygments\u5b9e\u73b0\u9ad8\u4eae\u7684\uff0c\u652f\u6301434\u79cd\u683c\u5f0f\uff0c\u8be6\u89c1 \u652f\u6301\u4ee3\u7801\u9ad8\u4eae\u7684\u8bed\u8a00 \u82e5\u6307\u5b9a\u4e86\u4e0d\u5b58\u5728\u7684\u683c\u5f0f\uff0c\u5219\u7b49\u540c\u4e8etext\uff0c\u4e0d\u505a\u4efb\u4f55\u9ad8\u4eae\u6e32\u67d3 \u82e5\u4e0d\u60f3\u4f7f\u7528\u9ad8\u4eae\uff0c\u7528text\uff0c\u5982\uff1a ```text text = \"Hello, world!\" print text ``` \u6548\u679c text = \"Hello, world!\" print text","title":"\u7528\u6cd5"},{"location":"syntax/highlight_code/#1","text":"\u5728mkdocs.yml\u91ccmarkdown_extensions\u90e8\u5206\u8bbe\u7f6e\u5982\u4e0b - codehilite(guess_lang=false) \u5173\u95ed\u731c\u6d4b\uff0c\u82e5\u4e0d\u6307\u5b9a\u8bed\u8a00\uff0c\u5219\u5173\u95ed\u9ad8\u4eae - codehilite(guess_lang=true) \u5f00\u542f\u731c\u6d4b\uff0c\u82e5\u4e0d\u6307\u5b9a\u8bed\u8a00\uff0c\u5219\u81ea\u52a8\u731c\u6d4b","title":"\u53c2\u65701. \u81ea\u52a8\u731c\u6d4b\u8bed\u8a00"},{"location":"syntax/highlight_code/#2","text":"\u5728mkdocs.yml\u91ccmarkdown_extensions\u90e8\u5206\u8bbe\u7f6e - codehilite(linenums=true) \u663e\u793a\u884c\u53f7 - codehilite(linenums=false) \u4e0d\u663e\u793a\u884c\u53f7 \u82e5codehilite(linenums=true)\uff0c4\u4e2a\u7a7a\u683c\u7684\u4ee3\u7801\u5757\u65b9\u5f0f\u4e5f\u4f1a\u88ab\u81ea\u52a8\u52a0\u4e0a\u884c\u53f7 \u6307\u5b9a\u4ee3\u7801\u5757\u663e\u793a\u884c\u53f7 \u56e0\u6b64\uff0c\u5982\u679c\u60f3\u5168\u5c40\u9ed8\u8ba4\u4e0d\u663e\u793a\u884c\u53f7\uff0c\u800c\u6307\u5b9a\u4ee3\u7801\u5757\u663e\u793a\u884c\u53f7\uff0c\u53ef\u4ee5\u5728mkdocs.yml\u91cc\u6307\u5b9alinenums=false\uff0c\u7136\u540e\u60f3\u663e\u793a\u884c\u53f7\u7684\u4ee3\u7801\u5757\u7528linenums=\"1\"","title":"\u53c2\u65702. \u663e\u793a\u884c\u53f7"},{"location":"syntax/highlight_code/#3","text":"\u5728mkdocs.yml\u91cc\u4e0d\u7528\u989d\u5916\u8bbe\u7f6e ```python hl_lines=\"2 4\" text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c text1 = \"Hello, \" text2 = \"world!\" print text1 + text2","title":"\u53c2\u65703. \u6307\u5b9a\u7b2c\u51e0\u884c\u80cc\u666f\u9ad8\u4eae"},{"location":"syntax/highlight_code/#4","text":"```python linenums=\"2\" text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c 2 3 4 text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 \u5f3a\u5236\u663e\u5f0f\u884c\u53f7 \u5f53\u4ee3\u7801\u5757\u6307\u5b9a\u4e86linenums\u540e\uff0c\u5373\u4f7fmkdocs.yml\u91cclinenums=false\uff0c\u4e5f\u4f1a\u81ea\u52a8\u663e\u793a\u884c\u53f7 \u56e0\u6b64\uff0c\u5982\u679c\u60f3\u5168\u5c40\u9ed8\u8ba4\u4e0d\u663e\u793a\u884c\u53f7\uff0c\u800c\u6307\u5b9a\u4ee3\u7801\u5757\u663e\u793a\u884c\u53f7\uff0c\u53ef\u4ee5\u5728mkdocs.yml\u91cc\u6307\u5b9alinenums=false\uff0c\u7136\u540e\u60f3\u663e\u793a\u884c\u53f7\u7684\u4ee3\u7801\u5757\u7528linenums=\"1\" \u6ce8\u610f\uff1a\u4ee3\u7801\u5757linenums\u53c2\u6570\u4e0d\u4f1a\u5f71\u54cdhl_lines\uff0c\u5373\u65e0\u8bbalinenums\u6307\u5b9a\u4ece\u591a\u5c11\u884c\u5f00\u59cb\u7f16\u53f7\uff0chl_lines\u5b9e\u9645\u90fd\u4ee5\u884c\u53f7\u4ece1\u5f00\u59cb\u7f16\u53f7\u6765\u627e\u5230\u5bf9\u5e94\u884c\u8fdb\u884c\u80cc\u666f\u9ad8\u4eae\u6e32\u67d3\uff0c\u5982\uff1a ```python linenums=\"2\" hl_lines=\"3\" text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c 2 3 4 text1 = \"Hello, \" text2 = \"world!\" print text1 + text2","title":"\u53c2\u65704. \u6307\u5b9a\u884c\u53f7\u4ece\u591a\u5c11\u5f00\u59cb\u7f16\u53f7"},{"location":"syntax/image_index/","text":"\u5f53\u4e00\u4e2a\u9875\u9762\u91cc\u591a\u6b21\u8c03\u7528\u76f8\u540c\u56fe\u7247\u65f6\uff0c\u8fd9\u79cd\u65b9\u6cd5\u66f4\u9002\u7528: ![alt][\u7d22\u5f15] [\u7d22\u5f15]: \u56fe\u7247\u5730\u5740 \"title\" \u6ce8\u610f: [\u7d22\u5f15]: \u56fe\u7247\u5730\u5740 \"title\" \u53ef\u4ee5\u5199\u5728\u4efb\u610f\u5730\u65b9\uff0c\u901a\u5e38\u4e60\u60ef\u4e8e\u653e\u5728markdown\u672c\u9875\u6587\u6863\u6700\u4e0b\u65b9 \u5982 ![alt][test icon] ... [test icon]: /img/test_icon.png \"title\" \u6548\u679c \u9f20\u6807\u60ac\u505c\u5728\u56fe\u6807\u4e0a\u53ef\u4ee5\u770b\u5230\"title\"\u5b57\u6837","title":"11.2. \u53c2\u8003\u5f0f"},{"location":"syntax/image_inline/","text":"\u6dfb\u52a0\u56fe\u7247\u7684\u5f62\u5f0f\u548c\u94fe\u63a5\u76f8\u4f3c\uff0c\u53ea\u9700\u5728\u94fe\u63a5\u7684\u57fa\u7840\u4e0a\u524d\u65b9\u52a0\u4e00\u4e2a ! ![alt](\u56fe\u7247\u5730\u5740 \"title\") \u5982 ![hello](./../img/test_icon.png \"title\") \u6548\u679c \u9f20\u6807\u60ac\u505c\u5728\u56fe\u6807\u4e0a\u53ef\u4ee5\u770b\u5230\"title\"\u5b57\u6837","title":"11.1. \u884c\u5185\u5f0f"},{"location":"syntax/link_anchor/","text":"\u82f1\u6587\u53ebPermalinks\uff0c\u662ftoc\u6269\u5c55\u6a21\u5757\u7684\u4e00\u4e2a\u529f\u80fd \u4f9d\u8d56\u6a21\u5757: toc \u9ed8\u8ba4\u503c: toc(permalink=false) \u7b14\u8005\u63a8\u8350\u503c: toc(permalink=true) \u53c2\u6570\u8bbe\u7f6e: toc(permalink=true) \u70b9\u51fb\u951a\u70b9\u6216\u8005\u8df3\u8f6c\u81f3\u951a\u70b9\u540e\u4f1a\u81ea\u52a8\u5728\u951a\u70b9\u5904\u663e\u793a\u56fe\u6807\u6216\u6587\u672c\uff0c\u5e76\u81ea\u52a8\u56fa\u5b9a\u5728\u8be5\u4f4d\u7f6e\uff0c\u5237\u65b0\u9875\u9762\u540e\u4e5f\u4f1a\u81ea\u52a8\u56de\u5230\u8be5\u4f4d\u7f6e\uff0c\u6548\u679c\u5982\u4e0b\uff1a toc(permalink=false) \u770b\u4e0d\u5230\u951a\u70b9\u5904\u7684\u56fe\u6807\u6216\u6587\u672c\uff0c\u4f46\u8df3\u8f6c\u81f3\u951a\u70b9\u5904\u540e\u81ea\u52a8\u56fa\u5b9a\u5728\u8be5\u4f4d\u7f6e\uff0c\u5237\u65b0\u9875\u9762\u540e\u4e5f\u4f1a\u81ea\u52a8\u56de\u5230\u8be5\u4f4d\u7f6e toc(permalink=false)\u7b49\u540c\u4e8e\u6ce8\u91ca\u6389\u8fd9\u4e2a\u6269\u5c55\uff0c\u6548\u679c\u5747\u5982\u4e0b\uff1a toc(permalink=\u81ea\u5b9a\u4e49\u540d) \u53ef\u4ee5\u652f\u6301\u81ea\u5b9a\u4e49\u540d\uff0c\u6bd4\u5982toc(permalinks=hello)\uff0c\u6548\u679c\u5982\u4e0b\uff1a","title":"10.3. \u951a\u70b9\u63d0\u793a"},{"location":"syntax/link_auto/","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.magiclink \u5f53\u8bc6\u522b\u5230HTML\u3001FTP\u3001Email\u5730\u5740\u65f6\u5019\u4f1a\u81ea\u52a8\u8f6c\u4e3a\u8d85\u94fe\u63a5\uff0c\u5982 http://www.example.cpm/ \u6548\u679c http://www.example.com/ \u7ecf\u6d4b\u8bd5\uff0c\u81f3\u5c11\u652f\u6301\u4ee5\u4e0b\u51e0\u79cd\u81ea\u52a8\u94fe\u63a5 http://www.example.com/ https://www.example.com/ ftp://www.example.com/ www.example.com user@example.com","title":"10.2. \u81ea\u52a8\u94fe\u63a5"},{"location":"syntax/link_normal/","text":"\u884c\u5185\u5f0f \u00b6 [example](http://www.example.com/ \"title\") \u6548\u679c example \u9f20\u6807\u60ac\u505c\u5728\u94fe\u63a5\u4e0a\u53ef\u4ee5\u770b\u5230\"title\"\u5b57\u6837 \u53c2\u8003\u5f0f \u00b6 \u5f53\u4e00\u4e2a\u9875\u9762\u91cc\u591a\u6b21\u8c03\u7528\u76f8\u540c\u94fe\u63a5\u65f6\uff0c\u8fd9\u79cd\u65b9\u6cd5\u66f4\u9002\u7528: [example][\u7d22\u5f15] ... [\u7d22\u5f15]: http://www.example.com/ \"title\" \u6ce8\u610f: [\u7d22\u5f15]: http://www.example.com/ \"title\" \u53ef\u4ee5\u5199\u5728\u4efb\u610f\u5730\u65b9\uff0c\u901a\u5e38\u4e60\u60ef\u4e8e\u653e\u5728markdown\u672c\u9875\u6587\u6863\u6700\u4e0b\u65b9 \u6548\u679c example \u9f20\u6807\u60ac\u505c\u5728\u94fe\u63a5\u4e0a\u53ef\u4ee5\u770b\u5230\"title\"\u5b57\u6837","title":"10.1. \u666e\u901a\u94fe\u63a5"},{"location":"syntax/link_normal/#_1","text":"[example](http://www.example.com/ \"title\") \u6548\u679c example \u9f20\u6807\u60ac\u505c\u5728\u94fe\u63a5\u4e0a\u53ef\u4ee5\u770b\u5230\"title\"\u5b57\u6837","title":"\u884c\u5185\u5f0f"},{"location":"syntax/link_normal/#_2","text":"\u5f53\u4e00\u4e2a\u9875\u9762\u91cc\u591a\u6b21\u8c03\u7528\u76f8\u540c\u94fe\u63a5\u65f6\uff0c\u8fd9\u79cd\u65b9\u6cd5\u66f4\u9002\u7528: [example][\u7d22\u5f15] ... [\u7d22\u5f15]: http://www.example.com/ \"title\" \u6ce8\u610f: [\u7d22\u5f15]: http://www.example.com/ \"title\" \u53ef\u4ee5\u5199\u5728\u4efb\u610f\u5730\u65b9\uff0c\u901a\u5e38\u4e60\u60ef\u4e8e\u653e\u5728markdown\u672c\u9875\u6587\u6863\u6700\u4e0b\u65b9 \u6548\u679c example \u9f20\u6807\u60ac\u505c\u5728\u94fe\u63a5\u4e0a\u53ef\u4ee5\u770b\u5230\"title\"\u5b57\u6837","title":"\u53c2\u8003\u5f0f"},{"location":"syntax/list_noseq/","text":"\u4f7f\u7528 * \u3001 + \u3001\u6216 - \u6807\u8bb0\u65e0\u5e8f\u5217\u8868\uff0c\u4e0b\u9762\u4ec5\u4ee5 - \u4f5c\u4e3a\u793a\u4f8b\uff0c - \u7b2c\u4e00\u9879 - \u7b2c\u4e8c\u9879 - \u7b2c\u4e09\u9879 \u6ce8: \u6807\u8bb0\u540e\u9762\u6700\u5c11\u6709\u4e00\u4e2a \u7a7a\u683c \u6216 \u5236\u8868\u7b26 \u3002\u82e5\u4e0d\u5728\u5f15\u7528\u533a\u5757\u4e2d\uff0c\u5fc5\u987b\u548c\u524d\u65b9\u6bb5\u843d\u4e4b\u95f4\u5b58\u5728\u7a7a\u884c\u3002 \u6548\u679c \u7b2c\u4e00\u9879 \u7b2c\u4e8c\u9879 \u7b2c\u4e09\u9879","title":"8.1. \u65e0\u5e8f\u5217\u8868"},{"location":"syntax/list_seq/","text":"\u6709\u5e8f\u5217\u8868\u7684\u6807\u8bb0\u65b9\u5f0f\u662f\u5c06\u4e0a\u8ff0\u7684\u7b26\u53f7\u6362\u6210\u6570\u5b57,\u5e76\u8f85\u4ee5 . 1. \u7b2c\u4e00\u9879 2. \u7b2c\u4e8c\u9879 3. \u7b2c\u4e09\u9879 \u6548\u679c \u7b2c\u4e00\u9879 \u7b2c\u4e8c\u9879 \u7b2c\u4e09\u9879","title":"8.2. \u6709\u5e8f\u5217\u8868"},{"location":"syntax/list_task/","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.tasklist \u7528\u6cd5: - [ ] \u6216 - [x] \uff0c\u5176\u4e2d [ ] \u8868\u793a\u4e0d\u6253\u52fe\uff0c [x] \u8868\u793a\u6253\u52fe\uff0c - \u53ef\u4ee5\u7528 + \u6216 * \u66ff\u4ee3 - [x] Lorem ipsum dolor sit amet, consectetur adipiscing elit - [x] Nulla lobortis egestas semper - [x] Curabitur elit nibh, euismod et ullamcorper at, iaculis feugiat est - [ ] Vestibulum convallis sit amet nisi a tincidunt - [x] In hac habitasse platea dictumst - [x] In scelerisque nibh non dolor mollis congue sed et metus - [x] Sed egestas felis quis elit dapibus, ac aliquet turpis mattis - [ ] Praesent sed risus massa - [x] Aenean pretium efficitur erat, donec pharetra, ligula non scelerisque - [ ] Nulla vel eros venenatis, imperdiet enim id, faucibus nisi \u6548\u679c Lorem ipsum dolor sit amet, consectetur adipiscing elit Nulla lobortis egestas semper Curabitur elit nibh, euismod et ullamcorper at, iaculis feugiat est Vestibulum convallis sit amet nisi a tincidunt In hac habitasse platea dictumst In scelerisque nibh non dolor mollis congue sed et metus Sed egestas felis quis elit dapibus, ac aliquet turpis mattis Praesent sed risus massa Aenean pretium efficitur erat, donec pharetra, ligula non scelerisque Nulla vel eros venenatis, imperdiet enim id, faucibus nisi","title":"8.3. \u4efb\u52a1\u5217\u8868"},{"location":"syntax/main/","text":"\u7531\u4e8e\u8bed\u6cd5\u4f17\u591a\uff0c\u56e0\u6b64\u5c06 \u5927\u90e8\u5206\u8bed\u6cd5 \u6c47\u603b\u5728\u4e0b\u9762\u8868\u683c\u91cc\uff0c\u4fbf\u4e8e\u4e00\u89c8\u3002 \u4f46\u8be5\u8868\u5e76\u672a\u6db5\u76d6\u5168\u90e8\u8bed\u6cd5(\u5982\u67d0\u4e9b\u7279\u6b8a\u7b26\u53f7) \uff0c\u56e0\u6b64\u8be6\u60c5\u8bf7\u7ffb\u770b\u8bed\u6cd5\u7684\u5177\u4f53\u7ae0\u8282\u3002 \u7b26\u53f7 \u7528\u9014 # \u6807\u9898 \u7a7a\u884c \u6bb5\u843d > \u5f15\u7528 [^sth] \u811a\u6ce8 !!! \u6ce8\u89e3 ??? \u6298\u53e0\u6ce8\u89e3 \\ \u8f6c\u4e49 * \u5217\u8868 + \u5217\u8868 - \u5217\u8868 *[x] \u4efb\u52a1\u5217\u8868 +[x] \u4efb\u52a1\u5217\u8868 -[x] \u4efb\u52a1\u5217\u8868 --- \u5206\u5272\u7ebf :shortname: emoji ` \u884c\u5185\u4ee3\u7801 ```\u8bed\u8a00 \u4ee3\u7801\u5757,\u5e26\u9ad8\u4eae TAB \u4ee3\u7801\u5757 #! \u4ee3\u7801\u9ad8\u4eae ::: \u4ee3\u7801\u9ad8\u4eae *sth* \u659c\u4f53 _sth_ \u659c\u4f53 **sth** \u7c97\u4f53 __sth__ \u7c97\u4f53 ***sth*** \u7c97\u659c\u4f53 ___sth___ \u7c97\u659c\u4f53 ^sth^ \u4e0a\u6807 ~sth~ \u4e0b\u6807 ^^sth^^ \u6587\u5b57\u4e0b\u5212\u7ebf ~~sth~~ \u6587\u5b57\u4e2d\u6a2a\u7ebf {++sth++} \u6587\u5b57\u4e0b\u5212\u7ebf,\u7eff\u8272\u80cc\u666f\u9ad8\u4eae {--sth--} \u6587\u5b57\u4e2d\u6a2a\u7ebf,\u7ea2\u8272\u80cc\u666f\u9ad8\u4eae {~~false~>true~~} \u6587\u5b57\u4e0b\u5212\u7ebf\u63a5\u6587\u5b57\u6a2a\u7ebf,\u7eff\u63a5\u7ea2\u80cc\u666f\u9ad8\u4eae {>>sth<<} \u8868\u793a\u6ce8\u89e3,\u7070\u8272\u80cc\u666f\u9ad8\u4eae ==sth== \u9ec4\u8272\u80cc\u666f\u9ad8\u4eae {==sth==} \u9ec4\u8272\u80cc\u666f\u9ad8\u4eae $sth$ \u884c\u5185\u5f0f\u6570\u5b66\u516c\u5f0f \\(sth)\\ \u884c\u5185\u5f0f\u6570\u5b66\u516c\u5f0f $$...$$ \u533a\u5757\u5f0f\u6570\u5b66\u516c\u5f0f \\begin{}...\\end{} \u533a\u5757\u5f0f\u6570\u5b66\u516c\u5f0f [text](url \"title\") \u884c\u5185\u5f0f\u94fe\u63a5 [text][index],\u6587\u6863\u6700\u540e[index]: url \"title\" \u53c2\u8003\u5f0f\u94fe\u63a5 \u7b26\u5408\u8981\u6c42\u7684URL \u81ea\u52a8\u94fe\u63a5 ![alt](url \"title\") \u884c\u5185\u5f0f\u56fe\u7247 ![alt][index],\u6587\u6863\u6700\u540e[index]: url \"title\" \u53c2\u8003\u5f0f\u56fe\u7247","title":"1. \u8bed\u6cd5\u603b\u89c8"},{"location":"syntax/math_js/","text":"\u5148\u5728docs\u91cc\u521b\u5efajs\u76ee\u5f55\uff0c\u5e76\u5728js\u76ee\u5f55\u4e2d\u653e\u7f6eextra.js\uff1a window . MathJax = { tex2jax : { inlineMath : [ [ \"\\\\(\" , \"\\\\)\" ] ], displayMath : [ [ \"\\\\[\" , \"\\\\]\" ] ] }, TeX : { TagSide : \"right\" , TagIndent : \".8em\" , MultLineWidth : \"85%\" , equationNumbers : { autoNumber : \"AMS\" , }, unicode : { fonts : \"STIXGeneral,'Arial Unicode MS'\" } }, displayAlign : \"left\" , showProcessingMessages : false , messageStyle : \"none\" }; \u7136\u540e\u5728mkdocs.yml\u91cc\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff0c\u7528\u4e8e\u5bfc\u5165js extra_javascript : - 'js/extra.js' - 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'","title":"17.2. \u5bfc\u5165js"},{"location":"syntax/math_main/","text":"\u7528\u4e8eTeX\u6570\u5b66\u516c\u5f0f\u7684\u5c55\u793a\uff0c\u4f7f\u7528\u4e4b\u524d\u8981\u5148\u5728docs/\u91cc\u521b\u5efajavascripts\u76ee\u5f55\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u653e\u7f6eextra.js \u4f9d\u8d56\u6a21\u5757: pymdownx.arithmatex","title":"17.1. \u4ecb\u7ecd"},{"location":"syntax/math_usage/","text":"\u884c\u5185\u5199\u6cd5\u67092\u79cd: $...$ \u548c \\(...\\) \u533a\u5757\u5199\u6cd5\u67093\u79cd: $$...$$ , \\[...\\] , \u548c \\begin{}...\\end{} \u5177\u4f53\u7528\u6cd5\u8be6\u89c1: https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference http://www.andy-roberts.net/writing/latex/mathematics_1 http://www.andy-roberts.net/writing/latex/mathematics_2 \u6b64\u5904\u4ec5\u4e3e\u4e2a\u4f8b\u5b50(\u56e0\u4e3abegin end\u65b9\u5f0f\u6211\u8fd8\u4e0d\u591f\u4e86\u89e3)\uff1a $$ p(x|y) = \\frac{p(y|x)p(x)}{p(y)} $$ \u6548\u679c p(x|y) = \\frac{p(y|x)p(x)}{p(y)} p(x|y) = \\frac{p(y|x)p(x)}{p(y)} $p(x|y) = \\frac{p(y|x)p(x)}{p(y)}$ \u6548\u679c p(x|y) = \\frac{p(y|x)p(x)}{p(y)} p(x|y) = \\frac{p(y|x)p(x)}{p(y)}","title":"17.3. \u7528\u6cd5"},{"location":"syntax/meta/","text":"\u4f9d\u8d56\u6a21\u5757\uff1ameta mkdocs\u652f\u6301(\u5b9e\u9645\u662fpython markdown\u652f\u6301)\u7684\u5143\u4fe1\u606f\u5185\u5bb9\uff0c\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5bf9\u5e94\u7684html\uff0c\u76ee\u524d\u652f\u6301\u4ee5\u4e0b4\u79cdmeta title: Lorem ipsum dolor sit amet description: Nullam urna elit, malesuada eget finibus ut, ac tortor. path: path/to/file source: file.js \u6ce8\u610f: \u8981\u5199\u5728markdown\u6587\u6863\u7684\u6700\u4e0a\u65b9 \u5199\u5b8c\u540e\u8981\u52a0\u4e00\u4e2a\u7a7a\u884c \u4f1a\u88ab\u81ea\u52a8\u7ffb\u8bd1\u6210 &lt;head&gt; &lt;meta name=\"description\" content=\"Nullam urna elit, malesuada eget finibus ut, ac tortor.\"&gt; &lt;title&gt;Lorem ipsum dolor sit amet&lt;/title&gt; &lt;/head&gt; \u4ee5\u53ca&lt;body&gt;\u4e2d\u67d0\u4e2a\u4f4d\u7f6e\u4f1a\u770b\u5230&lt;a href=\"/path/to/file/file.js\" title=\"file.js\" class=\"md-source-file\"&gt; \u5176\u4e2dpath\u548csource\u7684\u6548\u679c:","title":"16. \u5143\u4fe1\u606f"},{"location":"syntax/nest_green_code/","text":"\u6548\u679c print \"Hello, world!\" print \"Hello, world!\" print \"Hello, world!\"","title":"20.9. \u7eff\u8272\u533a\u5757-\u4ee3\u7801"},{"location":"syntax/nest_greenred_code/","text":"\u6548\u679c print \"Hello, world!\" print \"Hello, our world!\" print \"Hello, my world!\" print \"Hello, our world!\"","title":"20.11. \u7eff\u63a5\u7ea2\u533a\u5757-\u4ee3\u7801"},{"location":"syntax/nest_list_code/","text":"\u4ee5\u4e0b3\u79cd\u6548\u679c\u76f8\u540c: \u4e00. \u4e0d\u7f29\u8fdb\uff0c\u65e0\u7a7a\u884c - list1 ```python text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u4e8c. \u7f29\u8fdb\uff0c\u65e0\u7a7a\u884c - list1 ```python text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u4e09. \u7f29\u8fdb\uff0c\u6709\u7a7a\u884c - list1 ```python text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c\u5747\u5982\u4e0b list1 text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 \u6ce8\u610f: \u4e0d\u80fd\u65e0\u7f29\u8fdb\u5374\u6709\u7a7a\u884c\uff0c\u5982\u4e0b\u9762\u8fd9\u6837\u662f\u6709\u95ee\u9898\u7684\uff0c\u53ef\u4ee5\u81ea\u884c\u6d4b\u8bd5: - list1 ```python text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ```","title":"20.6. \u5217\u8868-\u4ee3\u7801\u5757"},{"location":"syntax/nest_list_list/","text":"- aaa - bbb \u6548\u679c aaa bbb","title":"20.3. \u5217\u8868-\u5217\u8868"},{"location":"syntax/nest_list_list_quote/","text":"- aaa - bbb > ccc \u6548\u679c aaa bbb ccc","title":"20.13. \u5217\u8868-\u5217\u8868-\u5f15\u7528"},{"location":"syntax/nest_main/","text":"\u51e0\u4e4e\u6bcf\u79cd\u5177\u6709\u884c\u5185\u3001\u533a\u5757\u7684\u529f\u80fd\u6a21\u5757\u90fd\u80fd\u81ea\u8eab\u53ca\u76f8\u4e92\u4e4b\u95f4\u591a\u5c42\u5d4c\u5957\uff0c\u672c\u6587\u65e0\u6cd5\u4e00\u4e00\u9610\u8ff0\uff0c\u56e0\u6b64\u4ec5\u4e3e\u51e0\u4e2a\u4f8b\u5b50\u8bf4\u660e","title":"20.1. \u4ecb\u7ecd"},{"location":"syntax/nest_note_code/","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.superfences !!! note Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. ```python text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c Note Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. text1 = \"Hello, \" text2 = \"world!\" print text1 + text2","title":"20.5. \u6ce8\u89e3-\u4ee3\u7801\u5757"},{"location":"syntax/nest_note_list_quote/","text":"!!! note \"test\" - aaa &gt; bbb \u6548\u679c test aaa bbb","title":"20.12. \u6ce8\u89e3-\u5217\u8868-\u5f15\u7528"},{"location":"syntax/nest_note_note/","text":"!!! note Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! warning Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. \u6548\u679c Note Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. Warning Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.","title":"20.2. \u6ce8\u89e3-\u6ce8\u89e3"},{"location":"syntax/nest_quote_code/","text":"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod > nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor > massa, nec semper lorem quam in massa. > ```go import \"fmt\" func main() { fmt.Println(\"Hello, world\") } ``` \u6548\u679c Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. import \"fmt\" func main () { fmt . Println ( \"Hello, world\" ) } \u53ef\u4ee5\u770b\u51fa\uff0c\u7528>\u65f6\u5019\uff0c\u8981\u6bcf\u884c\u7684>\u5185\u5bb9\u7f29\u8fdb\u5bf9\u9f50\uff0c\u4e0d\u8fc7\uff0c\u5982\u679c\u662f\u4e00\u4e2a\u4ee3\u7801\u5757\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u7b2c\u4e00\u4e2a>\u5373\u53ef \u4f46\u8981\u6ce8\u610f, \u4e0a\u9762\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u80fd\u6709\u7a7a\u884c\uff0c\u5982\u679c\u6709\u7a7a\u884c\u5c31\u4f1a\u88ab\u8ba4\u4e3a\u7ec8\u6b62\uff0c\u6bd4\u5982\uff1a > ```go import \"fmt\" func main() { fmt.Println(\"Hello, world\") fmt.Println(\"last\") } ``` \u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c31\u8981\u5728\u7a7a\u884c\u4e4b\u540e\u7684\u65b0\u884c\u518d\u7528>\u8868\u793a\u672a\u4e2d\u65ad\uff0c\u6bd4\u5982\uff1a > ```go import \"fmt\" func main() { fmt.Println(\"Hello, world\") > fmt.Println(\"last\") } ``` import \"fmt\" func main () { fmt . Println ( \"Hello, world\" ) fmt . Println ( \"last\" ) }","title":"20.7. \u5f15\u7528-\u4ee3\u7801\u5757"},{"location":"syntax/nest_quote_quote/","text":"> \u533a\u5757\u5f15\u7528 >> \u5d4c\u5957\u5f15\u7528 \u6548\u679c \u533a\u5757\u5f15\u7528 \u5d4c\u5957\u5f15\u7528","title":"20.4. \u5f15\u7528-\u5f15\u7528"},{"location":"syntax/nest_quote_quote_code/","text":"&gt; aaa &gt;&gt; bbb &gt;&gt;&gt; ```python text1 = \"Hello, \" text2 = \"world!\" print text1 + text2 ``` \u6548\u679c aaa bbb text1 = \"Hello, \" text2 = \"world!\" print text1 + text2","title":"20.14. \u5f15\u7528-\u5f15\u7528-\u4ee3\u7801"},{"location":"syntax/nest_red_code/","text":"\u6548\u679c print \"Hello, world!\" print \"Hello, world!\" print \"Hello, world!\"","title":"20.10. \u7ea2\u8272\u533a\u5757-\u4ee3\u7801"},{"location":"syntax/nest_yellow_code/","text":"\u6548\u679c print \"Hello, world!\" print \"Hello, world!\" print \"Hello, world!\"","title":"20.8. \u9ec4\u8272\u533a\u5757-\u4ee3\u7801"},{"location":"syntax/note_details/","text":"\u628a!!!\u6539\u6210???\uff0c\u6ce8\u610f\u6b64\u65f6\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u5426\u5219\u6837\u5f0f\u6709\u95ee\u9898 \u9002\u7528\u573a\u666f: \u6298\u53e0\u7279\u522b\u9002\u7528\u4e8eFAQ\uff0c\u5373\u6807\u9898\u91cc\u5199\u95ee\u9898\uff0c\u5185\u5bb9\u91cc\u5199\u7b54\u6848 \u4f9d\u8d56\u6a21\u5757: pymdownx.details ??? note \"\u6807\u9898\" \u5185\u5bb9 \u6548\u679c \u6807\u9898 \u5185\u5bb9 \u6ce8\u610f: \u6298\u53e0\u4e2d\u7684\u5185\u5bb9\u5728\u6298\u53e0\u672a\u6253\u5f00\u65f6\u5019\u901a\u8fc7ctrl-f\u662f\u641c\u7d22\u4e0d\u51fa\u6765\u7684\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7\u9875\u9762\u4e0a\u65b9\u7684Search\u680f\u91cc\u641c\u5230","title":"14.6. \u6298\u53e0"},{"location":"syntax/note_empty-title/","text":"!!! note \"\" \u5185\u5bb9 \u6548\u679c \u5185\u5bb9","title":"14.3. \u7a7a\u6807\u9898"},{"location":"syntax/note_full/","text":"!!! note \"\u6807\u9898\" \u5185\u5bb9 \u6548\u679c \u6807\u9898 \u5185\u5bb9","title":"14.2. \u5b8c\u6574\u683c\u5f0f"},{"location":"syntax/note_main/","text":"\u5199\u6ce8\u89e3\u4f7f\u7528\uff0c\u4f9d\u8d56\u6a21\u5757: admonition \u652f\u6301\u591a\u79cd\u6837\u5f0f\uff0c\u5982\u5e26\u6709\u6807\u9898\u3001\u65e0\u6807\u9898\u3001\u7a7a\u6807\u9898\uff0c\u8fd8\u652f\u6301\u6298\u53e0\u5f0f(\u5e38\u7528\u4e8eFAQ) \u652f\u6301\u591a\u79cd\u989c\u8272\u98ce\u683c\uff0c\u5305\u62ec\u8b66\u544a\u63d0\u793a\u3001\u9519\u8bef\u63d0\u793a\u3001\u6210\u529f\u63d0\u793a\u7b4911\u79cd\u98ce\u683c","title":"14.1. \u4ecb\u7ecd"},{"location":"syntax/note_nest/","text":"\u6ce8\u89e3\u6807\u9898\u548c\u5185\u5bb9\u652f\u6301\u591a\u79cd\u6837\u5f0f \u00b6 \u4f8b1. \u6807\u9898\u91cc\u4f7f\u7528\u659c\u4f53 !!! note \"*\u6807\u9898e*\" \u5185\u5bb9 \u6807\u9898 \u5185\u5bb9 \u4f8b2. \u5185\u5bb9\u91cc\u4f7f\u7528h1-h6 !!! note \"\u6807\u9898\" # h1 ## h2 ### h3 \u6ce8\u89e3\u5d4c\u5957\u4ee3\u7801\u5757 \u00b6 \u8be6\u89c1 \u6ce8\u89e3\u5d4c\u5957\u4ee3\u7801\u5757 \u7ae0\u8282 \u6ce8\u89e3\u5d4c\u5957\u6ce8\u89e3 \u00b6 \u8be6\u89c1 \u6ce8\u89e3\u5d4c\u5957\u6ce8\u89e3 \u7ae0\u8282","title":"14.8. \u5d4c\u5957"},{"location":"syntax/note_nest/#_1","text":"\u4f8b1. \u6807\u9898\u91cc\u4f7f\u7528\u659c\u4f53 !!! note \"*\u6807\u9898e*\" \u5185\u5bb9 \u6807\u9898 \u5185\u5bb9 \u4f8b2. \u5185\u5bb9\u91cc\u4f7f\u7528h1-h6 !!! note \"\u6807\u9898\" # h1 ## h2 ### h3","title":"\u6ce8\u89e3\u6807\u9898\u548c\u5185\u5bb9\u652f\u6301\u591a\u79cd\u6837\u5f0f"},{"location":"syntax/note_nest/#_2","text":"\u8be6\u89c1 \u6ce8\u89e3\u5d4c\u5957\u4ee3\u7801\u5757 \u7ae0\u8282","title":"\u6ce8\u89e3\u5d4c\u5957\u4ee3\u7801\u5757"},{"location":"syntax/note_nest/#_3","text":"\u8be6\u89c1 \u6ce8\u89e3\u5d4c\u5957\u6ce8\u89e3 \u7ae0\u8282","title":"\u6ce8\u89e3\u5d4c\u5957\u6ce8\u89e3"},{"location":"syntax/note_none-title/","text":"!!! note \u5185\u5bb9 \u6548\u679c Note \u5185\u5bb9 \u6ce8\u610f: \u65e0\u6807\u9898\u65f6\u7c7b\u578b\u9996\u5b57\u6bcd\u4f1a\u88ab\u5927\u5199\uff0c\u5982\u4e0a\u9762note\u88ab\u5927\u5199\u6210Note","title":"14.4. \u65e0\u6807\u9898"},{"location":"syntax/note_none-type/","text":"\u65e0\u7c7b\u578b\uff0c\u5219\u9ed8\u8ba4\u4e3anote \u6ce8\u610f\u8fd9\u4e2a\u65f6\u5019\u6807\u9898\u5fc5\u987b\u5199\u82f1\u6587\uff0c\u5e76\u4e14\u9996\u5b57\u6bcd\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6210\u5927\u5199: !!! title \u5185\u5bb9 \u76f8\u5f53\u4e8e !!! note \"Title\" \u5185\u5bb9 \u6548\u679c Title \u5185\u5bb9","title":"14.5. \u65e0\u7c7b\u578b"},{"location":"syntax/note_style/","text":"\u670911\u79cd\u6837\u5f0f\uff0c\u6bcf\u4e00\u79cd\u6837\u5f0f\u90fd\u652f\u6301\u591a\u79cd\u5173\u952e\u5b57\uff0c\u6bd4\u5982note\u53ef\u4ee5\u7528seealso\u66ff\u4ee3\uff0csummary\u53ef\u4ee5\u7528tldr\u66ff\u4ee3 !!! note \"note, seealso\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! summary \"summary, tldr\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! info \"info, todo\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! tip \"tip, hint, important\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! success \"success, check, done\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! question \"question, help, faq\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! warning \"warning, caution, attention\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! failure \"failure, fail, missing\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! danger \"danger, error\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! bug \"bug\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. !!! quote \"quote, cite\" Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. \u6548\u679c note, seealso Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. summary, tldr Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. info, todo Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. tip, hint, important Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. success, check, done Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor question, help, faq Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. warning, caution, attention Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. failure, fail, missing Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. danger, error Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. bug Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. quote, cite Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.","title":"14.7. 11\u79cd\u989c\u8272\u6837\u5f0f"},{"location":"syntax/paragraph/","text":"\u4e00\u4e2a\u6bb5\u843d\u8868\u793a\u4e00\u4e2a\u8bed\u6cd5\u5757\uff0c\u6bcf\u4e2a\u8bed\u6cd5\u5757\u4e4b\u95f4\u8981\u6709\u7a7a\u884c\uff0c\u82e5\u60f3\u5728\u6bb5\u5185\u5f3a\u5236\u6362\u884c\u7684\u65b9\u5f0f\u662f\u4f7f\u7528 \u4e24\u4e2a\u4ee5\u4e0a \u7a7a\u683c\u52a0\u4e0a\u56de\u8f66\u3002 \u5efa\u8bae: \u5982\u679c\u5199\u4e00\u4e2a\u8bed\u6cd5\uff0c\u6548\u679c\u548c\u60f3\u8c61\u7684\u4e0d\u4e00\u6837\uff0c\u6bd4\u5982\u6324\u5728\u4e00\u884c\u5185\uff0c\u6216\u8005\u6ca1\u6709\u7f29\u8fdb\uff0c\u5219\u591a1\u30012\u4e2a\u6362\u884c\u8bd5\u8bd5","title":"3. \u6bb5\u843d"},{"location":"syntax/quote/","text":"\u5728\u6bb5\u843d\u7684\u6bcf\u884c\u6216\u8005\u53ea\u5728\u7b2c\u4e00\u884c\u4f7f\u7528\u7b26\u53f7 > \u8fd8\u53ef\u4f7f\u7528\u591a\u4e2a \u5d4c\u5957\u5f15\u7528 \uff0c\u5982\uff1a > \u533a\u5757\u5f15\u7528 \u6548\u679c\uff1a \u533a\u5757\u5f15\u7528","title":"4. \u5f15\u7528"},{"location":"syntax/symbol/","text":"\u4f9d\u8d56\u6a21\u5757: pymdownx.smartsymbols \u7528\u6cd5 \u6548\u679c (tm) \u2122 (c) \u00a9 (r) \u00ae c/o \u2105 +/- \u00b1 --> \u2192 <-- \u2190 <--> \u2194 =/= \u2260 1/4 3/5 \u00bc \u2157 1st 2nd 3rd 1 st 2 nd 3 rd","title":"19. \u7279\u6b8a\u7b26\u53f7"},{"location":"syntax/table/","text":"\u793a\u4f8b \u00b6 | \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 | | :-- | :--: | --: | | A1 | B1 | C1 | | A2 | B2 | C2 | \u6548\u679c \u5b57\u6bb51 \u5b57\u6bb52 \u5b57\u6bb53 A1 B1 C1 A2 B2 C2 \u8be6\u89e3 \u00b6 \u81f3\u5c11\u75313\u884c\u7ec4\u6210 \u7b2c1\u884c\uff1a\u5b57\u6bb5\u540d | \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 | \u7b2c2\u884c\uff1a\b\u8bbe\u7f6e\u5bf9\u9f50 | :-- | :--: | --: | \u5206\u522b\u8868\u793a\u4e3a\u5de6\u5bf9\u9f50\uff0c\u5c45\u4e2d\u5bf9\u9f50\uff0c\u53c8\u5bf9\u9f50\u3002\u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u8bbe\u7f6e\u5bf9\u9f50\uff0c\u5373\u4e0d\u5199\u5192\u53f7\uff0c\u4f46\u8fd9\u6837\u4e0d\u597d\u7ef4\u62a4\uff0c\u56e0\u6b64\u5efa\u8bae\u90fd\u8bbe\u7f6e\u5bf9\u9f50 \u7b2c3\u884c\u5f00\u59cb\uff1a\u6b63\u6587 | \u5185\u5bb91 | \u5185\u5bb92 | \u5185\u5bb93 | \u7a7a\u683c\u4e0d\u53ef\u5ffd\u7565 |\u5b57\u6bb51|\u5b57\u6bb52|\u5b57\u6bb53| \u8fd9\u6837\u662f\u6709\u95ee\u9898\u7684\uff0c\u7a7a\u683c1\u4e2a\uff0c\u4e5f\u53ef\u4ee5\u591a\u4e2a\uff0c\u4f46\u4e0d\u80fd\u4e0d\u5199 \u6700\u5de6\u8fb9\u548c\u6700\u53f3\u8fb9\u7684|\u53ef\u7701\u7565 | \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 | \u4e5f\u53ef\u4ee5\u5199\u6210\u8fd9\u6837 \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 \u4e0d\u4ec5\u662f\u7b2c1\u884c\uff0c\u6bcf\u4e00\u884c\u90fd\u53ef\u4ee5\u8fd9\u4e48\u7701\u7565","title":"5. \u8868\u683c"},{"location":"syntax/table/#_1","text":"| \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 | | :-- | :--: | --: | | A1 | B1 | C1 | | A2 | B2 | C2 | \u6548\u679c \u5b57\u6bb51 \u5b57\u6bb52 \u5b57\u6bb53 A1 B1 C1 A2 B2 C2","title":"\u793a\u4f8b"},{"location":"syntax/table/#_2","text":"\u81f3\u5c11\u75313\u884c\u7ec4\u6210 \u7b2c1\u884c\uff1a\u5b57\u6bb5\u540d | \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 | \u7b2c2\u884c\uff1a\b\u8bbe\u7f6e\u5bf9\u9f50 | :-- | :--: | --: | \u5206\u522b\u8868\u793a\u4e3a\u5de6\u5bf9\u9f50\uff0c\u5c45\u4e2d\u5bf9\u9f50\uff0c\u53c8\u5bf9\u9f50\u3002\u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u8bbe\u7f6e\u5bf9\u9f50\uff0c\u5373\u4e0d\u5199\u5192\u53f7\uff0c\u4f46\u8fd9\u6837\u4e0d\u597d\u7ef4\u62a4\uff0c\u56e0\u6b64\u5efa\u8bae\u90fd\u8bbe\u7f6e\u5bf9\u9f50 \u7b2c3\u884c\u5f00\u59cb\uff1a\u6b63\u6587 | \u5185\u5bb91 | \u5185\u5bb92 | \u5185\u5bb93 | \u7a7a\u683c\u4e0d\u53ef\u5ffd\u7565 |\u5b57\u6bb51|\u5b57\u6bb52|\u5b57\u6bb53| \u8fd9\u6837\u662f\u6709\u95ee\u9898\u7684\uff0c\u7a7a\u683c1\u4e2a\uff0c\u4e5f\u53ef\u4ee5\u591a\u4e2a\uff0c\u4f46\u4e0d\u80fd\u4e0d\u5199 \u6700\u5de6\u8fb9\u548c\u6700\u53f3\u8fb9\u7684|\u53ef\u7701\u7565 | \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 | \u4e5f\u53ef\u4ee5\u5199\u6210\u8fd9\u6837 \u5b57\u6bb51 | \u5b57\u6bb52 | \u5b57\u6bb53 \u4e0d\u4ec5\u662f\u7b2c1\u884c\uff0c\u6bcf\u4e00\u884c\u90fd\u53ef\u4ee5\u8fd9\u4e48\u7701\u7565","title":"\u8be6\u89e3"},{"location":"tools/elinks/1.index/","text":"1. \u4ecb\u7ecd \u00b6 \u5229\u7528Linux\u670d\u52a1\u5668\u5b9e\u73b0\u5bf9\u76ee\u6807\u9875\u9762\u7684\u5b9a\u65f6\u8bbf\u95ee\u53ef\u80fd\u67d0\u4e9b\u540c\u5b66\u4f1a\u4f7f\u7528\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u7cfb\u7edf\uff0c\u80af\u5b9a\u6709\u65b9\u6cd5\u5b9e\u73b0\u5bf9\u7f51\u7ad9\u7684\u8bbf\u95ee\uff0c\u7ecf\u8fc7\u7814\u7a76\u5f97\u77e5\u5728linux\u7cfb\u7edf\u4e2d\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u6d4f\u89c8\u5668\u5b9e\u73b0\u5bf9\u7f51\u7ad9\u7684\u8bbf\u95ee\uff0c\u7279\u6b64\u6574\u7406\u4e86\u547d\u4ee4\u884c\u6d4f\u89c8\u5668\u7684\u5b89\u88c5\u65b9\u6cd5\u3002 2. \u5b89\u88c5 \u00b6 \u5728\u670d\u52a1\u5668centos\u7cfb\u7edf\u4e2d\u5b89\u88c5links\u547d\u4ee4\u884c\u6d4f\u89c8\u5668\uff0c\u6267\u884c\u547d\u4ee4 centos yum install elinks ubuntu apt-get install elinks root@leco:/home/leco/jike/pojie# elinks http://192.168.5.110:7000 --dump \u6781\u9a8c\u9a8c\u8bc1SDKDemo -------------------------------------------------------------------------- \u5f39\u51fa\u5f0fDemo\uff0c\u4f7f\u7528ajax\u5f62\u5f0f\u63d0\u4ea4\u4e8c\u6b21\u9a8c\u8bc1\u7801\u6240\u9700\u7684\u9a8c\u8bc1\u7ed3\u679c\u503c \u7528\u6237\u540d\uff1a [1]_____________________ \u5bc6 \u7801\uff1a [2]_____________________ [3][ \u63d0\u4ea4 ] -------------------------------------------------------------------------- \u5d4c\u5165\u5f0fDemo\uff0c\u4f7f\u7528\u8868\u5355\u5f62\u5f0f\u63d0\u4ea4\u4e8c\u6b21\u9a8c\u8bc1\u6240\u9700\u7684\u9a8c\u8bc1\u7ed3\u679c\u503c \u7528\u6237\u540d\uff1a [4]_____________________ \u5bc6 \u7801\uff1a [5]_____________________ \u6b63\u5728\u52a0\u8f7d\u9a8c\u8bc1\u7801...... \u8bf7\u5148\u62d6\u52a8\u9a8c\u8bc1\u7801\u5230\u76f8\u5e94\u4f4d\u7f6e [6][ \u63d0\u4ea4 ] References Visible links","title":"2. elinks"},{"location":"tools/elinks/1.index/#1","text":"\u5229\u7528Linux\u670d\u52a1\u5668\u5b9e\u73b0\u5bf9\u76ee\u6807\u9875\u9762\u7684\u5b9a\u65f6\u8bbf\u95ee\u53ef\u80fd\u67d0\u4e9b\u540c\u5b66\u4f1a\u4f7f\u7528\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u7cfb\u7edf\uff0c\u80af\u5b9a\u6709\u65b9\u6cd5\u5b9e\u73b0\u5bf9\u7f51\u7ad9\u7684\u8bbf\u95ee\uff0c\u7ecf\u8fc7\u7814\u7a76\u5f97\u77e5\u5728linux\u7cfb\u7edf\u4e2d\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u6d4f\u89c8\u5668\u5b9e\u73b0\u5bf9\u7f51\u7ad9\u7684\u8bbf\u95ee\uff0c\u7279\u6b64\u6574\u7406\u4e86\u547d\u4ee4\u884c\u6d4f\u89c8\u5668\u7684\u5b89\u88c5\u65b9\u6cd5\u3002","title":"1. \u4ecb\u7ecd"},{"location":"tools/elinks/1.index/#2","text":"\u5728\u670d\u52a1\u5668centos\u7cfb\u7edf\u4e2d\u5b89\u88c5links\u547d\u4ee4\u884c\u6d4f\u89c8\u5668\uff0c\u6267\u884c\u547d\u4ee4 centos yum install elinks ubuntu apt-get install elinks root@leco:/home/leco/jike/pojie# elinks http://192.168.5.110:7000 --dump \u6781\u9a8c\u9a8c\u8bc1SDKDemo -------------------------------------------------------------------------- \u5f39\u51fa\u5f0fDemo\uff0c\u4f7f\u7528ajax\u5f62\u5f0f\u63d0\u4ea4\u4e8c\u6b21\u9a8c\u8bc1\u7801\u6240\u9700\u7684\u9a8c\u8bc1\u7ed3\u679c\u503c \u7528\u6237\u540d\uff1a [1]_____________________ \u5bc6 \u7801\uff1a [2]_____________________ [3][ \u63d0\u4ea4 ] -------------------------------------------------------------------------- \u5d4c\u5165\u5f0fDemo\uff0c\u4f7f\u7528\u8868\u5355\u5f62\u5f0f\u63d0\u4ea4\u4e8c\u6b21\u9a8c\u8bc1\u6240\u9700\u7684\u9a8c\u8bc1\u7ed3\u679c\u503c \u7528\u6237\u540d\uff1a [4]_____________________ \u5bc6 \u7801\uff1a [5]_____________________ \u6b63\u5728\u52a0\u8f7d\u9a8c\u8bc1\u7801...... \u8bf7\u5148\u62d6\u52a8\u9a8c\u8bc1\u7801\u5230\u76f8\u5e94\u4f4d\u7f6e [6][ \u63d0\u4ea4 ] References Visible links","title":"2. \u5b89\u88c5"},{"location":"tools/git/1.git/","text":"\u5728\u7ebf\u5b89\u88c5 \u00b6 ubuntu \u5728\u7ebf\u5b89\u88c5 apt-get install git -y centos \u5728\u7ebf\u5b89\u88c5 yum install -y git ubuntu root@k8s4:/home/leco# apt-get install git Reading package lists... Done Building dependency tree Reading state information... Done git is already the newest version (1:2.7.4-0ubuntu1.4). 0 upgraded, 0 newly installed, 0 to remove and 4 not upgraded. centos [root@leco ~]# yum install git Loaded plugins: fastestmirror Setting up Install Process Loading mirror speeds from cached hostfile base | 3.7 kB 00:00 epel | 4.7 kB 00:00 epel/primary_db | 6.0 MB 00:00 extras | 3.4 kB 00:00 mysql-connectors-community | 2.5 kB 00:00 mysql-tools-community | 2.5 kB 00:00 mysql56-community | 2.5 kB 00:00 saltstack | 2.9 kB 00:00 updates | 3.4 kB 00:00 Package git-1.7.1-9.el6_9.x86_64 already installed and latest version Nothing to do \u521d\u59cb\u5316\u672c\u5730 \u00b6 root@k8s4:~/git_test# git init Initialized empty Git repository in /root/git_test/.git/ root@k8s4:~/git_test# ll -a total 12 drwxr-xr-x 3 root root 4096 Jan 15 11:25 ./ drwx------ 9 root root 4096 Jan 15 11:25 ../ drwxr-xr-x 7 root root 4096 Jan 15 11:25 .git/ 2.\u57fa\u672c\u914d\u7f6e \u00b6 root@k8s4:/home/leco# git config usage: git config [<options>] Config file location --global use global config file --system use system config file --local use repository config file -f, --file <file> use given config file --blob <blob-id> read config from given blob object Action --get get value: name [value-regex] --get-all get all values: key [value-regex] --get-regexp get values for regexp: name-regex [value-regex] --get-urlmatch get value specific for the URL: section[.var] URL --replace-all replace all matching variables: name value [value_regex] --add add a new variable: name value --unset remove a variable: name [value-regex] --unset-all remove all matches: name [value-regex] --rename-section rename section: old-name new-name --remove-section remove a section: name -l, --list list all -e, --edit open an editor --get-color find the color configured: slot [default] --get-colorbool find the color setting: slot [stdout-is-tty] Type --bool value is \"true\" or \"false\" --int value is decimal number --bool-or-int value is --bool or --int --path value is a path (file or directory name) Other -z, --null terminate values with NUL byte --name-only show variable names only --includes respect include directives on lookup 3.\u4eba\u5458\u4fe1\u606f\u914d\u7f6e \u00b6 root@k8s4:/home/leco# git config --global user.name leco root@k8s4:/home/leco# git config --global user.email leco@leco.com root@k8s4:/home/leco# cd root@k8s4:~# ll .gitconfig -rw-r--r-- 1 root root 43 Jan 15 11:22 .gitconfig root@k8s4:~# cat .gitconfig [user] name = leco email = leco@leco.com root@k8s4:~# git config --list user.name=leco user.email=leco@leco.com root@k8s4:~# mkdir git_test root@k8s4:~# cd git_test/ root@k8s4:~/git_test# git init Initialized empty Git repository in /root/git_test/.git/ root@k8s4:~/git_test# ll -a total 12 drwxr-xr-x 3 root root 4096 Jan 15 11:25 ./ drwx------ 9 root root 4096 Jan 15 11:25 ../ drwxr-xr-x 7 root root 4096 Jan 15 11:25 .git/ # git \u4ed3\u5e93 \u6d41\u7a0b\u56fe \u00b6 graph TD A[\u8fdc\u7a0b\u4ed3\u5e93]-->B[\u672c\u5730\u4ed3\u5e93] B -->A B-->C[\u6682\u5b58\u533a\u57df] C-->B C-->D[\u5de5\u4f5c\u76ee\u5f55] D-->C Workspace\uff1a \u5de5\u4f5c\u533a Index/Stage/Cached : \u7f13\u5b58\u533a Respository\uff1a \u672c\u5730\u4ed3\u5e93 Remote: \u8fdc\u7a0b\u4ed3\u5e93 Git \u547d\u4ee4\u5c31\u662f\u7528\u4e8e\u5c06\u6587\u4ef6\u6539\u52a8\u5207\u6362\u5230\u4e0d\u540c\u7a7a\u95f4\u6765\u8bb0\u5f55 \u72b6\u6001 \u00b6 root@k8s4:~/git_test# git status On branch master # \u5728master\u5206\u652f\u4e0a Initial commit nothing to commit (create/copy files and use \"git add\" to track) # \u4ed3\u5e93\u6ca1\u6709\u4efb\u52a1 \u65b0\u5efa\u540e\u67e5\u770b \u00b6 root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git status On branch master Initial commit Untracked files: (use \"git add <file>...\" to include in what will be committed) a b c nothing added to commit but untracked files present (use \"git add\" to track) root@k8s4:~/git_test# \u63d0\u4ea4\u6587\u4ef6\u540e \u00b6 root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a new file: b new file: c \u89e3\u91ca - untracked files\u5c31\u662f\u7f13\u5b58\u533a - git add filename \u6216\u8005git add .(\u63d0\u4ea4\u6240\u6709) \u5230\u7f13\u5b58\u533a - git rm --cached \u662f\u5c06\u4e4b\u524d\u63d0\u4ea4\u7684\u6587\u4ef6\uff08\u4e5f\u5c31\u662f\u63d0\u4ea4\u5230\u7f13\u5b58\u7684\u6587\u4ef6\uff09\u5220\u9664\uff0c\u8fd4\u56de\u5230\u672c\u5730 \u5220\u9664\u7f13\u5b58c\u7684\u6587\u4ef6 \u00b6 root@k8s4:~/git_test# git rm --cached c rm 'c' root@k8s4:~/git_test# ls a b c root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a new file: b \u89e3\u91ca\uff0c\u53ef\u4ee5\u770b\u5230\u7f13\u5b58\u6587\u4ef6\u53ea\u6709a\uff0cb\u4e24\u4e2a\u6587\u4ef6\u4e86\uff0cc\u6587\u4ef6\u88ab\u4ece\u7f13\u5b58\u533a\u4e2d\u5220\u9664\u4e86\uff0c - \u8981\u662f\u5b8c\u5168\u5220\u9664c\u7684\u8bdd\uff0c\u5c31\u76f4\u63a5\u518d\u672c\u5730\u7ee7\u7eed\u628ac\u6587\u4ef6\u5220\u9664\u5373\u53ef root@k8s4:~/git_test# rm c \u76f4\u63a5\u5220\u9664\u7684\u8bdd\uff08\u540c\u65f6\u5220\u9664\u7f13\u5b58\u533a\u6587\u4ef6\u548c\u672c\u5730\u6587\u4ef6\uff09 root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a new file: b root@k8s4:~/git_test# git rm -f b rm 'b' root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a \u63d0\u4ea4 \u00b6 root@k8s4:~/git_test# git commit -m 'commit a' [master (root-commit) e73cff4] commit a 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean \u6ce8\u91ca - git commit -m \"\u540e\u9762\u662f\u6ce8\u91ca\"\uff0c\u8fd9\u6837\u5c31\u5c06\u5de5\u4f5c\u533a\u6587\u4ef6\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93 - commit\u4e4b\u524d\u4e00\u5b9a\u8981add\u4e5f\u5c31\u662f\u5148\u5c06\u672c\u5730\u6587\u4ef6add\u5230\u7f13\u5b58\u533a\uff0c\u7136\u540ecommit\u540e\u4f1a\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93 \u6539\u540d \u00b6 \u65b9\u6cd51 \u73b0\u5c06\u672c\u5730\u6587\u4ef6a \u6539\u4e3aa.txt \u5220\u9664\u7f13\u5b58\u533aa\u6587\u4ef6 \u63d0\u4ea4a.txt\u6587\u4ef6 \u65b9\u6cd52 git mv oldfile newfile git commit -m 'newfile' # \u65b9\u6cd51 root@k8s4:~/git_test# ls a root@k8s4:~/git_test# mv a a.txt root@k8s4:~/git_test# ls a.txt root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add/rm <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) deleted: a Untracked files: (use \"git add <file>...\" to include in what will be committed) a.txt no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git rm --cached a rm 'a' root@k8s4:~/git_test# git status On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) deleted: a Untracked files: (use \"git add <file>...\" to include in what will be committed) a.txt root@k8s4:~/git_test# git add a.txt root@k8s4:~/git_test# git status On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) renamed: a -> a.txt root@k8s4:~/git_test# git commit -m 'commit a.txt' [master da4a5dd] commit a.txt 1 file changed, 0 insertions(+), 0 deletions(-) rename a => a.txt (100%) root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean # \u65b9\u6cd52 root@k8s4:~/git_test# git mv a.txt a root@k8s4:~/git_test# git commit -m 'rename a.txt to a' [master 26e567b] rename a.txt to a 1 file changed, 0 insertions(+), 0 deletions(-) rename a.txt => a (100%) root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean \u5bf9\u6bd4\u67e5\u770b\uff0c\u4fee\u6539\u4e86\u4ec0\u4e48 \u00b6 git diff file \u5bf9\u6bd4\u6587\u4ef6\u5728\u672c\u5730\u548c\u7f13\u5b58\u533a\u7684\u5dee\u5f02 git diff --cached file \u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 git diff file \u5c31\u662f\u67e5\u770b\u672c\u5730\u548c\u7f13\u5b58\u533a\u6587\u4ef6\u7684\u5bf9\u6bd4 root@k8s4:~/git_test# echo '1'>>a root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git diff a diff --git a/a b/a index e69de29..d00491f 100644 --- a/a +++ b/a @@ -0,0 +1 @@ +1 # \u65b0\u52a0\u5185\u5bb9 \u4fee\u6539\u540e\u518d\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\uff08git add\uff09\uff0c\u5728\u6bd4\u5bf9 \u8fd9\u6837\u7f13\u5b58\u533a\u6587\u4ef6\u548c\u672c\u5730\u6587\u4ef6\u5c31\u4e00\u6837\u4e86\uff0c\u6240\u4ee5\u5bf9\u6bd4\u540e\u5565\u90fd\u6ca1\u6709 root@k8s4:~/git_test# git add a root@k8s4:~/git_test# git status On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git diff a - \u518d\u6b21\u5bf9\u6b64\uff0c\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 - git diff --cached file \u5c31\u662f\u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 root@k8s4:~/git_test# git diff --cached a diff --git a/a b/a index e69de29..d00491f 100644 --- a/a +++ b/a @@ -0,0 +1 @@ +1 - \u7ee7\u7eed\u5c06\u7f13\u5b58\u533a\u7684\u6587\u4ef6\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u518d\u5bf9\u6bd4 root@k8s4:~/git_test# git commit -m 'modify a' [master ccf4d94] modify a 1 file changed, 1 insertion(+) root@k8s4:~/git_test# git diff --cached a # \u56e0\u4e3a\u6587\u4ef6\u90fd\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u4e86\uff0c\u6240\u4ee5\u5bf9\u6bd4\u540e\u90fd\u4e00\u6837\u4e86\uff0c \u67e5\u770b\u63d0\u4ea4\u7684\u65e5\u5fd7 \u00b6 root@k8s4:~/git_test# git log commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a - \u7b80\u5199 root@k8s4:~/git_test# git log --oneline 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git log --oneline --decorate 1afadfd (HEAD -> master) modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a - \u8be6\u7ec6\u65e5\u5fd7 root@k8s4:~/git_test# git log -p commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second diff --git a/a b/a index d00491f..68fac01 100644 --- a/a +++ b/a @@ -1 +1,2 @@ 1 +bbb commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a diff --git a/a b/a index e69de29..d00491f 100644 --- a/a +++ b/a @@ -0,0 +1 @@ +1 commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a diff --git a/a b/a new file mode 100644 index 0000000..e69de29 diff --git a/a.txt b/a.txt deleted file mode 100644 index e69de29..0000000 commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt diff --git a/a b/a deleted file mode 100644 index e69de29..0000000 diff --git a/a.txt b/a.txt new file mode 100644 index 0000000..e69de29 commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a diff --git a/a b/a new file mode 100644 index 0000000..e69de29 - \u67e5\u770b\u5386\u53f2\u51e0\u6761\u8bb0\u5f55 - git log -n n\u8868\u793a\u663e\u793a\u6700\u540e\u4fee\u6539\u7684\u51e0\u6761\u8bb0\u5f55 root@k8s4:~/git_test# git log -2 commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a","title":"1. git"},{"location":"tools/git/1.git/#_1","text":"ubuntu \u5728\u7ebf\u5b89\u88c5 apt-get install git -y centos \u5728\u7ebf\u5b89\u88c5 yum install -y git ubuntu root@k8s4:/home/leco# apt-get install git Reading package lists... Done Building dependency tree Reading state information... Done git is already the newest version (1:2.7.4-0ubuntu1.4). 0 upgraded, 0 newly installed, 0 to remove and 4 not upgraded. centos [root@leco ~]# yum install git Loaded plugins: fastestmirror Setting up Install Process Loading mirror speeds from cached hostfile base | 3.7 kB 00:00 epel | 4.7 kB 00:00 epel/primary_db | 6.0 MB 00:00 extras | 3.4 kB 00:00 mysql-connectors-community | 2.5 kB 00:00 mysql-tools-community | 2.5 kB 00:00 mysql56-community | 2.5 kB 00:00 saltstack | 2.9 kB 00:00 updates | 3.4 kB 00:00 Package git-1.7.1-9.el6_9.x86_64 already installed and latest version Nothing to do","title":"\u5728\u7ebf\u5b89\u88c5"},{"location":"tools/git/1.git/#_2","text":"root@k8s4:~/git_test# git init Initialized empty Git repository in /root/git_test/.git/ root@k8s4:~/git_test# ll -a total 12 drwxr-xr-x 3 root root 4096 Jan 15 11:25 ./ drwx------ 9 root root 4096 Jan 15 11:25 ../ drwxr-xr-x 7 root root 4096 Jan 15 11:25 .git/","title":"\u521d\u59cb\u5316\u672c\u5730"},{"location":"tools/git/1.git/#2","text":"root@k8s4:/home/leco# git config usage: git config [<options>] Config file location --global use global config file --system use system config file --local use repository config file -f, --file <file> use given config file --blob <blob-id> read config from given blob object Action --get get value: name [value-regex] --get-all get all values: key [value-regex] --get-regexp get values for regexp: name-regex [value-regex] --get-urlmatch get value specific for the URL: section[.var] URL --replace-all replace all matching variables: name value [value_regex] --add add a new variable: name value --unset remove a variable: name [value-regex] --unset-all remove all matches: name [value-regex] --rename-section rename section: old-name new-name --remove-section remove a section: name -l, --list list all -e, --edit open an editor --get-color find the color configured: slot [default] --get-colorbool find the color setting: slot [stdout-is-tty] Type --bool value is \"true\" or \"false\" --int value is decimal number --bool-or-int value is --bool or --int --path value is a path (file or directory name) Other -z, --null terminate values with NUL byte --name-only show variable names only --includes respect include directives on lookup","title":"2.\u57fa\u672c\u914d\u7f6e"},{"location":"tools/git/1.git/#3","text":"root@k8s4:/home/leco# git config --global user.name leco root@k8s4:/home/leco# git config --global user.email leco@leco.com root@k8s4:/home/leco# cd root@k8s4:~# ll .gitconfig -rw-r--r-- 1 root root 43 Jan 15 11:22 .gitconfig root@k8s4:~# cat .gitconfig [user] name = leco email = leco@leco.com root@k8s4:~# git config --list user.name=leco user.email=leco@leco.com root@k8s4:~# mkdir git_test root@k8s4:~# cd git_test/ root@k8s4:~/git_test# git init Initialized empty Git repository in /root/git_test/.git/ root@k8s4:~/git_test# ll -a total 12 drwxr-xr-x 3 root root 4096 Jan 15 11:25 ./ drwx------ 9 root root 4096 Jan 15 11:25 ../ drwxr-xr-x 7 root root 4096 Jan 15 11:25 .git/ # git \u4ed3\u5e93","title":"3.\u4eba\u5458\u4fe1\u606f\u914d\u7f6e"},{"location":"tools/git/1.git/#_3","text":"graph TD A[\u8fdc\u7a0b\u4ed3\u5e93]-->B[\u672c\u5730\u4ed3\u5e93] B -->A B-->C[\u6682\u5b58\u533a\u57df] C-->B C-->D[\u5de5\u4f5c\u76ee\u5f55] D-->C Workspace\uff1a \u5de5\u4f5c\u533a Index/Stage/Cached : \u7f13\u5b58\u533a Respository\uff1a \u672c\u5730\u4ed3\u5e93 Remote: \u8fdc\u7a0b\u4ed3\u5e93 Git \u547d\u4ee4\u5c31\u662f\u7528\u4e8e\u5c06\u6587\u4ef6\u6539\u52a8\u5207\u6362\u5230\u4e0d\u540c\u7a7a\u95f4\u6765\u8bb0\u5f55","title":"\u6d41\u7a0b\u56fe"},{"location":"tools/git/1.git/#_4","text":"root@k8s4:~/git_test# git status On branch master # \u5728master\u5206\u652f\u4e0a Initial commit nothing to commit (create/copy files and use \"git add\" to track) # \u4ed3\u5e93\u6ca1\u6709\u4efb\u52a1","title":"\u72b6\u6001"},{"location":"tools/git/1.git/#_5","text":"root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git status On branch master Initial commit Untracked files: (use \"git add <file>...\" to include in what will be committed) a b c nothing added to commit but untracked files present (use \"git add\" to track) root@k8s4:~/git_test#","title":"\u65b0\u5efa\u540e\u67e5\u770b"},{"location":"tools/git/1.git/#_6","text":"root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a new file: b new file: c \u89e3\u91ca - untracked files\u5c31\u662f\u7f13\u5b58\u533a - git add filename \u6216\u8005git add .(\u63d0\u4ea4\u6240\u6709) \u5230\u7f13\u5b58\u533a - git rm --cached \u662f\u5c06\u4e4b\u524d\u63d0\u4ea4\u7684\u6587\u4ef6\uff08\u4e5f\u5c31\u662f\u63d0\u4ea4\u5230\u7f13\u5b58\u7684\u6587\u4ef6\uff09\u5220\u9664\uff0c\u8fd4\u56de\u5230\u672c\u5730","title":"\u63d0\u4ea4\u6587\u4ef6\u540e"},{"location":"tools/git/1.git/#c","text":"root@k8s4:~/git_test# git rm --cached c rm 'c' root@k8s4:~/git_test# ls a b c root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a new file: b \u89e3\u91ca\uff0c\u53ef\u4ee5\u770b\u5230\u7f13\u5b58\u6587\u4ef6\u53ea\u6709a\uff0cb\u4e24\u4e2a\u6587\u4ef6\u4e86\uff0cc\u6587\u4ef6\u88ab\u4ece\u7f13\u5b58\u533a\u4e2d\u5220\u9664\u4e86\uff0c - \u8981\u662f\u5b8c\u5168\u5220\u9664c\u7684\u8bdd\uff0c\u5c31\u76f4\u63a5\u518d\u672c\u5730\u7ee7\u7eed\u628ac\u6587\u4ef6\u5220\u9664\u5373\u53ef root@k8s4:~/git_test# rm c \u76f4\u63a5\u5220\u9664\u7684\u8bdd\uff08\u540c\u65f6\u5220\u9664\u7f13\u5b58\u533a\u6587\u4ef6\u548c\u672c\u5730\u6587\u4ef6\uff09 root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a new file: b root@k8s4:~/git_test# git rm -f b rm 'b' root@k8s4:~/git_test# git status On branch master Initial commit Changes to be committed: (use \"git rm --cached <file>...\" to unstage) new file: a","title":"\u5220\u9664\u7f13\u5b58c\u7684\u6587\u4ef6"},{"location":"tools/git/1.git/#_7","text":"root@k8s4:~/git_test# git commit -m 'commit a' [master (root-commit) e73cff4] commit a 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean \u6ce8\u91ca - git commit -m \"\u540e\u9762\u662f\u6ce8\u91ca\"\uff0c\u8fd9\u6837\u5c31\u5c06\u5de5\u4f5c\u533a\u6587\u4ef6\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93 - commit\u4e4b\u524d\u4e00\u5b9a\u8981add\u4e5f\u5c31\u662f\u5148\u5c06\u672c\u5730\u6587\u4ef6add\u5230\u7f13\u5b58\u533a\uff0c\u7136\u540ecommit\u540e\u4f1a\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93","title":"\u63d0\u4ea4"},{"location":"tools/git/1.git/#_8","text":"\u65b9\u6cd51 \u73b0\u5c06\u672c\u5730\u6587\u4ef6a \u6539\u4e3aa.txt \u5220\u9664\u7f13\u5b58\u533aa\u6587\u4ef6 \u63d0\u4ea4a.txt\u6587\u4ef6 \u65b9\u6cd52 git mv oldfile newfile git commit -m 'newfile' # \u65b9\u6cd51 root@k8s4:~/git_test# ls a root@k8s4:~/git_test# mv a a.txt root@k8s4:~/git_test# ls a.txt root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add/rm <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) deleted: a Untracked files: (use \"git add <file>...\" to include in what will be committed) a.txt no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git rm --cached a rm 'a' root@k8s4:~/git_test# git status On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) deleted: a Untracked files: (use \"git add <file>...\" to include in what will be committed) a.txt root@k8s4:~/git_test# git add a.txt root@k8s4:~/git_test# git status On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) renamed: a -> a.txt root@k8s4:~/git_test# git commit -m 'commit a.txt' [master da4a5dd] commit a.txt 1 file changed, 0 insertions(+), 0 deletions(-) rename a => a.txt (100%) root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean # \u65b9\u6cd52 root@k8s4:~/git_test# git mv a.txt a root@k8s4:~/git_test# git commit -m 'rename a.txt to a' [master 26e567b] rename a.txt to a 1 file changed, 0 insertions(+), 0 deletions(-) rename a.txt => a (100%) root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean","title":"\u6539\u540d"},{"location":"tools/git/1.git/#_9","text":"git diff file \u5bf9\u6bd4\u6587\u4ef6\u5728\u672c\u5730\u548c\u7f13\u5b58\u533a\u7684\u5dee\u5f02 git diff --cached file \u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 git diff file \u5c31\u662f\u67e5\u770b\u672c\u5730\u548c\u7f13\u5b58\u533a\u6587\u4ef6\u7684\u5bf9\u6bd4 root@k8s4:~/git_test# echo '1'>>a root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git diff a diff --git a/a b/a index e69de29..d00491f 100644 --- a/a +++ b/a @@ -0,0 +1 @@ +1 # \u65b0\u52a0\u5185\u5bb9 \u4fee\u6539\u540e\u518d\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\uff08git add\uff09\uff0c\u5728\u6bd4\u5bf9 \u8fd9\u6837\u7f13\u5b58\u533a\u6587\u4ef6\u548c\u672c\u5730\u6587\u4ef6\u5c31\u4e00\u6837\u4e86\uff0c\u6240\u4ee5\u5bf9\u6bd4\u540e\u5565\u90fd\u6ca1\u6709 root@k8s4:~/git_test# git add a root@k8s4:~/git_test# git status On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git diff a - \u518d\u6b21\u5bf9\u6b64\uff0c\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 - git diff --cached file \u5c31\u662f\u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 root@k8s4:~/git_test# git diff --cached a diff --git a/a b/a index e69de29..d00491f 100644 --- a/a +++ b/a @@ -0,0 +1 @@ +1 - \u7ee7\u7eed\u5c06\u7f13\u5b58\u533a\u7684\u6587\u4ef6\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u518d\u5bf9\u6bd4 root@k8s4:~/git_test# git commit -m 'modify a' [master ccf4d94] modify a 1 file changed, 1 insertion(+) root@k8s4:~/git_test# git diff --cached a # \u56e0\u4e3a\u6587\u4ef6\u90fd\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u4e86\uff0c\u6240\u4ee5\u5bf9\u6bd4\u540e\u90fd\u4e00\u6837\u4e86\uff0c","title":"\u5bf9\u6bd4\u67e5\u770b\uff0c\u4fee\u6539\u4e86\u4ec0\u4e48"},{"location":"tools/git/1.git/#_10","text":"root@k8s4:~/git_test# git log commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a - \u7b80\u5199 root@k8s4:~/git_test# git log --oneline 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git log --oneline --decorate 1afadfd (HEAD -> master) modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a - \u8be6\u7ec6\u65e5\u5fd7 root@k8s4:~/git_test# git log -p commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second diff --git a/a b/a index d00491f..68fac01 100644 --- a/a +++ b/a @@ -1 +1,2 @@ 1 +bbb commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a diff --git a/a b/a index e69de29..d00491f 100644 --- a/a +++ b/a @@ -0,0 +1 @@ +1 commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a diff --git a/a b/a new file mode 100644 index 0000000..e69de29 diff --git a/a.txt b/a.txt deleted file mode 100644 index e69de29..0000000 commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt diff --git a/a b/a deleted file mode 100644 index e69de29..0000000 diff --git a/a.txt b/a.txt new file mode 100644 index 0000000..e69de29 commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a diff --git a/a b/a new file mode 100644 index 0000000..e69de29 - \u67e5\u770b\u5386\u53f2\u51e0\u6761\u8bb0\u5f55 - git log -n n\u8868\u793a\u663e\u793a\u6700\u540e\u4fee\u6539\u7684\u51e0\u6761\u8bb0\u5f55 root@k8s4:~/git_test# git log -2 commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a","title":"\u67e5\u770b\u63d0\u4ea4\u7684\u65e5\u5fd7"},{"location":"tools/git/2.git_rollback/","text":"\u7248\u672c\u6062\u590d \u00b6 1.\u672c\u5730\u4fee\u6539\u540e\u9519\u8bef\u6062\u590d \u7528\u672c\u5730\u7f13\u5b58\u533a\u8986\u76d6\u672c\u5730\u6587\u4ef6 git checkout -- file 2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d \u7528\u4ed3\u5e93\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 git reset HEAD file git checkout -- file \u7528\u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d git log \u67e5\u5386\u53f2\u7248\u672c\u53f7 git reflog \u67e5\u770b\u6240\u6709\u5386\u53f2\u7248\u672c\u53f7 git reset --hard \u7248\u672c\u53f7 1. \u672c\u5730\u4fee\u6539\u540e\u9519\u8bef\u6062\u590d \u00b6 root@k8s4:~/git_test# echo 'ccc'>>a root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git diff a diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a 1 bbb 2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d \u00b6 root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u672c 1 bbb ccc root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u6587\u4ef6\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git diff --cached # \u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git reset HEAD a # \u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 Unstaged changes after reset: M a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff08\u6ca1\u53d8\u3002\u56e0\u4e3a\u53ea\u7528\u672c\u5730\u4ed3\u5e93\u8986\u76d6\u4e86\u7f13\u5b58\u533a\u6587\u4ef6\uff09 1 bbb ccc root@k8s4:~/git_test# git diff a # \u5bf9\u6bd4\u7f13\u5b58\u533a\u548c\u672c\u5730\u6587\u4ef6\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git diff --cached a # \u5bf9\u6bd4\u4ed3\u5e93\u548c\u7f13\u5b58\u533a\u6587\u4ef6\u5dee\u5f02 root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a # \u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a # \u67e5\u770b\u6587\u4ef6 1 bbb 3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d \u00b6 root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u6587\u4ef6 1 bbb root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git log # \u67e5\u770b\u5386\u53f2\u65e5\u5fd7 commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reset --hard ccf4d94ce # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c\u4e5f\u5c31\u662f\u4e0a\u9762commit\u540e\u9762\u7684\u503c\uff08\u53ef\u4ee5\u53d6\u90e8\u5206\uff09 HEAD is now at ccf4d94 modify a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff0c\u5df2\u7ecf\u56de\u9000\u5230\u67d0\u4e00\u4e2a\u7248\u672c\u6587\u4ef6\u4e86 1 root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master nothing to commit, working directory clean # \u6062\u590d\u67d0\u4e2a\u7248\u672c\u540e\uff0c\u5728\u8fd9\u4e2a\u7248\u672c\u4e4b\u540e\u7684log\u4e5f\u770b\u4e0d\u5230\uff0c\u4f7f\u7528 git reflog\u662f\u67e5\u770b\u6240\u6709\u5386\u53f2\u8bb0\u5f55 root@k8s4:~/git_test# git log commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reflog ccf4d94 HEAD@{0}: reset: moving to ccf4d94ce 1afadfd HEAD@{1}: commit: modify a second ccf4d94 HEAD@{2}: commit: modify a 26e567b HEAD@{3}: commit: rename a.txt to a da4a5dd HEAD@{4}: commit: commit a.txt e73cff4 HEAD@{5}: commit (initial): commit a root@k8s4:~/git_test# git reset --hard 1afadfd # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c HEAD is now at 1afadfd modify a second root@k8s4:~/git_test# cat a 1 bbb t checkout -- file - 2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d - \u7528\u4ed3\u5e93\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 - git reset HEAD file - git checkout -- file - \u7528\u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 - 3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d - git log \u67e5\u5386\u53f2\u7248\u672c\u53f7 - git reflog \u67e5\u770b\u6240\u6709\u5386\u53f2\u7248\u672c\u53f7 - git reset --hard \u7248\u672c\u53f7 1. \u672c\u5730\u4fee\u6539\u540e\u9519\u8bef\u6062\u590d \u00b6 root@k8s4:~/git_test# echo 'ccc'>>a root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git diff a diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a 1 bbb 2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d \u00b6 root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u672c 1 bbb ccc root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u6587\u4ef6\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git diff --cached # \u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git reset HEAD a # \u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 Unstaged changes after reset: M a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff08\u6ca1\u53d8\u3002\u56e0\u4e3a\u53ea\u7528\u672c\u5730\u4ed3\u5e93\u8986\u76d6\u4e86\u7f13\u5b58\u533a\u6587\u4ef6\uff09 1 bbb ccc root@k8s4:~/git_test# git diff a # \u5bf9\u6bd4\u7f13\u5b58\u533a\u548c\u672c\u5730\u6587\u4ef6\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git diff --cached a # \u5bf9\u6bd4\u4ed3\u5e93\u548c\u7f13\u5b58\u533a\u6587\u4ef6\u5dee\u5f02 root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a # \u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a # \u67e5\u770b\u6587\u4ef6 1 bbb 3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d \u00b6 root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u6587\u4ef6 1 bbb root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git log # \u67e5\u770b\u5386\u53f2\u65e5\u5fd7 commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reset --hard ccf4d94ce # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c\u4e5f\u5c31\u662f\u4e0a\u9762commit\u540e\u9762\u7684\u503c\uff08\u53ef\u4ee5\u53d6\u90e8\u5206\uff09 HEAD is now at ccf4d94 modify a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff0c\u5df2\u7ecf\u56de\u9000\u5230\u67d0\u4e00\u4e2a\u7248\u672c\u6587\u4ef6\u4e86 1 root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master nothing to commit, working directory clean # \u6062\u590d\u67d0\u4e2a\u7248\u672c\u540e\uff0c\u5728\u8fd9\u4e2a\u7248\u672c\u4e4b\u540e\u7684log\u4e5f\u770b\u4e0d\u5230\uff0c\u4f7f\u7528 git reflog\u662f\u67e5\u770b\u6240\u6709\u5386\u53f2\u8bb0\u5f55 root@k8s4:~/git_test# git log commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reflog ccf4d94 HEAD@{0}: reset: moving to ccf4d94ce 1afadfd HEAD@{1}: commit: modify a second ccf4d94 HEAD@{2}: commit: modify a 26e567b HEAD@{3}: commit: rename a.txt to a da4a5dd HEAD@{4}: commit: commit a.txt e73cff4 HEAD@{5}: commit (initial): commit a root@k8s4:~/git_test# git reset --hard 1afadfd # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c HEAD is now at 1afadfd modify a second root@k8s4:~/git_test# cat a 1 bbb","title":"2. git\u56de\u6eda"},{"location":"tools/git/2.git_rollback/#_1","text":"1.\u672c\u5730\u4fee\u6539\u540e\u9519\u8bef\u6062\u590d \u7528\u672c\u5730\u7f13\u5b58\u533a\u8986\u76d6\u672c\u5730\u6587\u4ef6 git checkout -- file 2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d \u7528\u4ed3\u5e93\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 git reset HEAD file git checkout -- file \u7528\u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d git log \u67e5\u5386\u53f2\u7248\u672c\u53f7 git reflog \u67e5\u770b\u6240\u6709\u5386\u53f2\u7248\u672c\u53f7 git reset --hard \u7248\u672c\u53f7","title":"\u7248\u672c\u6062\u590d"},{"location":"tools/git/2.git_rollback/#1","text":"root@k8s4:~/git_test# echo 'ccc'>>a root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git diff a diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a 1 bbb","title":"1. \u672c\u5730\u4fee\u6539\u540e\u9519\u8bef\u6062\u590d"},{"location":"tools/git/2.git_rollback/#2","text":"root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u672c 1 bbb ccc root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u6587\u4ef6\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git diff --cached # \u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git reset HEAD a # \u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 Unstaged changes after reset: M a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff08\u6ca1\u53d8\u3002\u56e0\u4e3a\u53ea\u7528\u672c\u5730\u4ed3\u5e93\u8986\u76d6\u4e86\u7f13\u5b58\u533a\u6587\u4ef6\uff09 1 bbb ccc root@k8s4:~/git_test# git diff a # \u5bf9\u6bd4\u7f13\u5b58\u533a\u548c\u672c\u5730\u6587\u4ef6\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git diff --cached a # \u5bf9\u6bd4\u4ed3\u5e93\u548c\u7f13\u5b58\u533a\u6587\u4ef6\u5dee\u5f02 root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a # \u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a # \u67e5\u770b\u6587\u4ef6 1 bbb","title":"2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d"},{"location":"tools/git/2.git_rollback/#3","text":"root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u6587\u4ef6 1 bbb root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git log # \u67e5\u770b\u5386\u53f2\u65e5\u5fd7 commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reset --hard ccf4d94ce # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c\u4e5f\u5c31\u662f\u4e0a\u9762commit\u540e\u9762\u7684\u503c\uff08\u53ef\u4ee5\u53d6\u90e8\u5206\uff09 HEAD is now at ccf4d94 modify a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff0c\u5df2\u7ecf\u56de\u9000\u5230\u67d0\u4e00\u4e2a\u7248\u672c\u6587\u4ef6\u4e86 1 root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master nothing to commit, working directory clean # \u6062\u590d\u67d0\u4e2a\u7248\u672c\u540e\uff0c\u5728\u8fd9\u4e2a\u7248\u672c\u4e4b\u540e\u7684log\u4e5f\u770b\u4e0d\u5230\uff0c\u4f7f\u7528 git reflog\u662f\u67e5\u770b\u6240\u6709\u5386\u53f2\u8bb0\u5f55 root@k8s4:~/git_test# git log commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reflog ccf4d94 HEAD@{0}: reset: moving to ccf4d94ce 1afadfd HEAD@{1}: commit: modify a second ccf4d94 HEAD@{2}: commit: modify a 26e567b HEAD@{3}: commit: rename a.txt to a da4a5dd HEAD@{4}: commit: commit a.txt e73cff4 HEAD@{5}: commit (initial): commit a root@k8s4:~/git_test# git reset --hard 1afadfd # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c HEAD is now at 1afadfd modify a second root@k8s4:~/git_test# cat a 1 bbb t checkout -- file - 2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d - \u7528\u4ed3\u5e93\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 - git reset HEAD file - git checkout -- file - \u7528\u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 - 3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d - git log \u67e5\u5386\u53f2\u7248\u672c\u53f7 - git reflog \u67e5\u770b\u6240\u6709\u5386\u53f2\u7248\u672c\u53f7 - git reset --hard \u7248\u672c\u53f7","title":"3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d"},{"location":"tools/git/2.git_rollback/#1_1","text":"root@k8s4:~/git_test# echo 'ccc'>>a root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git diff a diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a 1 bbb","title":"1. \u672c\u5730\u4fee\u6539\u540e\u9519\u8bef\u6062\u590d"},{"location":"tools/git/2.git_rollback/#2_1","text":"root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u672c 1 bbb ccc root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u6587\u4ef6\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u7f13\u5b58\u533a\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git diff --cached # \u5bf9\u6bd4\u6587\u4ef6\u5728\u7f13\u5b58\u533a\u548c\u672c\u5730\u4ed3\u5e93\u7684\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git reset HEAD a # \u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u8986\u76d6\u7f13\u5b58\u533a\u6587\u4ef6 Unstaged changes after reset: M a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff08\u6ca1\u53d8\u3002\u56e0\u4e3a\u53ea\u7528\u672c\u5730\u4ed3\u5e93\u8986\u76d6\u4e86\u7f13\u5b58\u533a\u6587\u4ef6\uff09 1 bbb ccc root@k8s4:~/git_test# git diff a # \u5bf9\u6bd4\u7f13\u5b58\u533a\u548c\u672c\u5730\u6587\u4ef6\u5dee\u5f02 diff --git a/a b/a index 68fac01..cc63771 100644 --- a/a +++ b/a @@ -1,2 +1,3 @@ 1 bbb +ccc root@k8s4:~/git_test# git diff --cached a # \u5bf9\u6bd4\u4ed3\u5e93\u548c\u7f13\u5b58\u533a\u6587\u4ef6\u5dee\u5f02 root@k8s4:~/git_test# git status On branch master Changes not staged for commit: (use \"git add <file>...\" to update what will be committed) (use \"git checkout -- <file>...\" to discard changes in working directory) modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git checkout -- a # \u7f13\u5b58\u533a\u6587\u4ef6\u8986\u76d6\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# cat a # \u67e5\u770b\u6587\u4ef6 1 bbb","title":"2.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u6062\u590d"},{"location":"tools/git/2.git_rollback/#3_1","text":"root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u6587\u4ef6 1 bbb root@k8s4:~/git_test# echo 'ccc'>>a # \u4fee\u6539\u672c\u5730\u6587\u4ef6 root@k8s4:~/git_test# cat a 1 bbb ccc root@k8s4:~/git_test# git add . # \u63d0\u4ea4\u5230\u7f13\u5b58\u533a root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master Changes to be committed: (use \"git reset HEAD <file>...\" to unstage) modified: a root@k8s4:~/git_test# git log # \u67e5\u770b\u5386\u53f2\u65e5\u5fd7 commit 1afadfd79ce4a2676650401e9334b60b36550372 Author: leco <leco@leco.com> Date: Tue Jan 15 12:53:33 2019 +0800 modify a second commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reset --hard ccf4d94ce # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c\u4e5f\u5c31\u662f\u4e0a\u9762commit\u540e\u9762\u7684\u503c\uff08\u53ef\u4ee5\u53d6\u90e8\u5206\uff09 HEAD is now at ccf4d94 modify a root@k8s4:~/git_test# cat a # \u67e5\u770b\u672c\u5730\u6587\u4ef6\uff0c\u5df2\u7ecf\u56de\u9000\u5230\u67d0\u4e00\u4e2a\u7248\u672c\u6587\u4ef6\u4e86 1 root@k8s4:~/git_test# git status # \u67e5\u770b\u72b6\u6001 On branch master nothing to commit, working directory clean # \u6062\u590d\u67d0\u4e2a\u7248\u672c\u540e\uff0c\u5728\u8fd9\u4e2a\u7248\u672c\u4e4b\u540e\u7684log\u4e5f\u770b\u4e0d\u5230\uff0c\u4f7f\u7528 git reflog\u662f\u67e5\u770b\u6240\u6709\u5386\u53f2\u8bb0\u5f55 root@k8s4:~/git_test# git log commit ccf4d94ce795364ec9157fbdee829cbf2c0108b1 Author: leco <leco@leco.com> Date: Tue Jan 15 12:43:28 2019 +0800 modify a commit 26e567b47ad85ba7ea48e030e8d259bddf3d9b69 Author: leco <leco@leco.com> Date: Tue Jan 15 12:35:04 2019 +0800 rename a.txt to a commit da4a5ddc2a9795ba231e0e8a86dc501b93a63dc9 Author: leco <leco@leco.com> Date: Tue Jan 15 12:31:36 2019 +0800 commit a.txt commit e73cff4891f06c86c59f0fe316902cf829ae17e4 Author: leco <leco@leco.com> Date: Tue Jan 15 12:24:57 2019 +0800 commit a root@k8s4:~/git_test# git reflog ccf4d94 HEAD@{0}: reset: moving to ccf4d94ce 1afadfd HEAD@{1}: commit: modify a second ccf4d94 HEAD@{2}: commit: modify a 26e567b HEAD@{3}: commit: rename a.txt to a da4a5dd HEAD@{4}: commit: commit a.txt e73cff4 HEAD@{5}: commit (initial): commit a root@k8s4:~/git_test# git reset --hard 1afadfd # \u56de\u9000\u5230\u67d0\u4e2a\u7248\u672c HEAD is now at 1afadfd modify a second root@k8s4:~/git_test# cat a 1 bbb","title":"3.\u672c\u5730\u4fee\u6539\u540e\u63d0\u4ea4\u5230\u7f13\u5b58\u533a\u540e\u7136\u540e\u518d\u63d0\u4ea4\u5230\u672c\u5730\u4ed3\u5e93\u540e\u6062\u590d"},{"location":"tools/git/3.git_branch/","text":"\u4ecb\u7ecd \u00b6 git\u5206\u652f\uff0c\u4ece\u672c\u8d28\u4e0a\u6765\u8bb2\u4ec5\u4ec5\u662f\u6307\u5411\u63d0\u4ea4\u5bf9\u8c61\u7684\u53ef\u53d8\u6307\u9488\uff0c\u5728\u8fd9\u4e00\u70b9\u4e0a\u4e0eSVN\u662f\u6709\u672c\u8d28\u533a\u522b\uff0cSVN\u7684\u5206\u652f\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u76ee\u5f55\u3002 git\u7684\u9ed8\u8ba4\u5206\u652f\u540d\u5b57\u662fmaster\u3002\u5728\u591a\u6b21\u63d0\u4ea4\u64cd\u4f5c\u4e4b\u540e\uff0c\u4f60\u5176\u5b9e\u5df2\u7ecf\u6709\u4e00\u4e2a\u6307\u5411\u6700\u540e\u90a3\u4e2a\u63d0\u4ea4\u5bf9\u8c61\u7684master\u5206\u652f\uff0c\u5b83\u4f1a\u5728\u6bcf\u6b21\u7684\u63d0\u4ea4\u64cd\u4f5c\u4e2d\u81ea\u52a8\u5411\u524d\u79fb\u52a8\u3002 \u67e5\u770b\u5206\u652f git branch \u521b\u5efa\u5206\u652f git branch testing \u5207\u6362\u5206\u652f git checkout testing \u5408\u5e76\u5206\u652f \u5728\u8c01\u4e0a\u5408\u5e76\u8c01\u7684\u5206\u652f\u8981\u6ce8\u610f\uff0c\u6bd4\u5982\u5728master\u7684\u5206\u652f\u4e0a\u5408\u5e76testing\u5206\u652f\uff0c\u5c31\u5148\u5207\u6362\u5230master\u5206\u652f\u4e0a \u5207\u6362\u5230master\u5206\u652f\u4e0a\u5728\u6267\u884c git merge testing \u5220\u9664\u5206\u652f git branch -d testing root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# git log --oneline --decorate 1afadfd (HEAD -> master) modify a second # \u6700\u540e\u6307\u5411 ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u89e3\u91ca - HEAD \u6307\u5411\u8c01\uff0c\u5f53\u524d\u5c31\u662f\u54ea\u4e2a\u5206\u652f - \u64cd\u4f5c\u4e4b\u540e\uff0c\u6700\u540e\u6307\u5411\u90a3\u4e2a\u63d0\u4ea4\u7684\u5206\u652f graph LR A[HEAD]-->B[master] B-->C[f30ab] E[V1.0]-->C C-->D[Snapshot C] F[34ac2]-->C F-->G[Snapshot B] H[98ca9]-->F H-->I[Snapshot A] \u5728\u5b9e\u9645\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u5c3d\u91cf\u4fdd\u8bc1master\u5206\u652f\u7a33\u5b9a\uff0c\u4ec5\u7528\u4e8e\u53d1\u5e03\u65b0\u9881\u5e03\uff0c\u5e73\u65f6\u4e0d\u8981\u968f\u4fbf\u76f4\u63a5\u4fee\u6539\u91cc\u9762\u7684\u6570\u636e\u6587\u4ef6 \u5e72\u6d3b\u90fd\u5728dev\u5206\u652f\u4e0a\uff0c\u6bcf\u4eba\u4ecedev\u5206\u652f\u521b\u5efa\u81ea\u5df1\u7684\u4e2a\u4eba\u5206\u652f\uff0c\u5f00\u53d1\u5b8c\u5408\u5e76\u5230dev\u5206\u652f\uff0c\u6700\u540edev\u5206\u652f\u5408\u5e76\u5230master\u5206\u652f\u4e0a \u521b\u5efa\u5206\u652f root@k8s4:~/git_test# git branch testing \u67e5\u770b\u5206\u652f root@k8s4:~/git_test# git branch * master # \u5f53\u524d\u5728master\u5206\u652f\uff08\u770b*\u53f7\u4f4d\u7f6e\uff09 testing \u6b64\u65f6master\u5206\u652f\u548ctesting\u5206\u652f\u90fd\u6307\u5411\u6700\u540e\u63d0\u4ea4\u7684\u90a3\u4e2acommit 1afadfd (HEAD -> master, testing) modify a second # \u770b\u5730\u65b9\u5c31\u6307\u5411\u4e86\u54ea\u4e2acommit ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a - \u5207\u6362\u5206\u652f root@k8s4:~/git_test# git checkout testing Switched to branch 'testing' root@k8s4:~/git_test# git branch master * testing root@k8s4:~/git_test# cat a 1 bbb \u5728testing\u5206\u652f\u4e0b\u64cd\u4f5c root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# git checkout testing Switched to branch 'testing' root@k8s4:~/git_test# git branch master * testing root@k8s4:~/git_test# cat a 1 bbb root@k8s4:~/git_test# git log --oneline --decorate 1afadfd (HEAD -> testing, master) modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# touch test root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'commit test on branch testing ' [testing 81cec5e] commit test on branch testing 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 test root@k8s4:~/git_test# git status On branch testing nothing to commit, working directory clean root@k8s4:~/git_test# ls a test root@k8s4:~/git_test# git log --oneline --decorate 81cec5e (HEAD -> testing) commit test on branch testing 1afadfd (master) modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git branch master * testing root@k8s4:~/git_test# git checkout master Switched to branch 'master' root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# ls a \u6b64\u65f6\u770b\u5230\u5728testing\u5206\u652f\u4e0a\u7684\u64cd\u4f5c\uff0c\u5728master\u4e0a\u6ca1\u6709(\u9700\u8981\u5408\u5e76)\uff0c\u56e0\u4e3amaster\u548chead\u7684HEAD\u6307\u5411\u4e0d\u540c\u7684commit\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u591a\u4eba\u534f\u4f5c\u3002 \u5728master\u5206\u652f\u4e0b\u64cd\u4f5c root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# touch master root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'commit master in branch master' [master 21af5cc] commit master in branch master 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 master root@k8s4:~/git_test# git log --oneline --decorate 21af5cc (HEAD -> master) commit master in branch master 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u5408\u5e76\u5206\u652f testing\u5206\u652f\u5408\u5e76\u5230master\u5206\u652f\u4e0a \u9996\u5148\u5728master\u5206\u652f\u4e0a\u6267\u884c root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# git merge testing \u6b64\u65f6\u4f1a\u5f39\u51fa\u4e00\u4e2a\u754c\u9762\uff0c\u8bb0\u5f55\u6b64\u6b21\u64cd\u4f5c GNU nano 2.5.3 File: /root/git_test/.git/MERGE_MSG Modified Merge branch 'testing' # Please enter a commit message to explain why this merge is necessary, # especially if it merges an updated upstream into a topic branch. # # Lines starting with '#' will be ignored, and an empty message aborts # the commit. merge testing to master # \u65b0\u589e\u5185\u5bb9 \u8bb0\u5f55\u5408\u5e76\u4e86\u4ec0\u4e48\u4fe1\u606f merge test to master \u6b64\u65f6\u6309\u4e0bctrl + X \u540e\u518d\u6309\u4e0bY \u4fdd\u5b58\u9000\u51fa Merge made by the 'recursive' strategy. test | 0 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 test # \u6b64\u65f6\u53ef\u4ee5\u770b\u5230testing\u5206\u652f\u4e0b\u7684\u6570\u636e\u5df2\u7ecf\u5408\u5e76\u8fc7\u6765\u4e86 root@k8s4:~/git_test# ls a master test root@k8s4:~/git_test# git branch * master \u6b64\u65f6\u53ef\u4ee5\u770b\u5230testing\u5206\u652f\u5408\u5e76\u8fc7\u6765\u7684\u6570\u636e root@k8s4:~/git_test# git log --oneline --decorat a369899 (HEAD -> master) Merge branch 'testing' 21af5cc commit master in branch master 81cec5e (testing, mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a # \u5207\u6362\u5230testing\u5206\u652f\u67e5\u770b\u4fe1\u606f root@k8s4:~/git_test# git checkout testing Switched to branch 'testing' root@k8s4:~/git_test# ls a test root@k8s4:~/git_test# git log --oneline --decorat 81cec5e (HEAD -> testing, mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u4e0d\u540c\u5206\u652f\u4fee\u6539\u540c\u4e00\u4e2a\u6587\u4ef6\u540e\u5408\u5e76 root@k8s4:~/git_test# git branch # \u67e5\u770b\u5f53\u524d\u5206\u652f * master testing root@k8s4:~/git_test# ls a master test root@k8s4:~/git_test# cat a 1 bbb root@k8s4:~/git_test# echo 'master'>>a # \u5728master\u5206\u652f\u4e0a\u4fee\u6539\u63d0\u4ea4\u6570\u636e root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'modify a on master' [master 41d0dd3] modify a on master 1 file changed, 1 insertion(+) root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# git log --oneline --decorat # \u67e5\u770bmaster\u5206\u652f\u4e0a\u65e5\u5fd7 41d0dd3 (HEAD -> master) modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e (testing, mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git checkout testing # \u5207\u6362\u5230testing\u5206\u652f\u4e0a\u64cd\u4f5c\u6570\u636e Switched to branch 'testing' root@k8s4:~/git_test# ls a test root@k8s4:~/git_test# cat a 1 bbb root@k8s4:~/git_test# echo 'testing'>>a # testing\u5206\u652f\u4e0a\u4fee\u6539\u63d0\u4ea4\u6570\u636e root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'modify a on testing branch' [testing 65b3dce] modify a on testing branch 1 file changed, 1 insertion(+) root@k8s4:~/git_test# git checkout master # \u5207\u6362\u5230master\u5206\u652f\u4e0a \u5408\u5e76testing\u5206\u652f Switched to branch 'master' root@k8s4:~/git_test# git merge testing Auto-merging a CONFLICT (content): Merge conflict in a Automatic merge failed; fix conflicts and then commit the result. root@k8s4:~/git_test# git status On branch master You have unmerged paths. (fix conflicts and run \"git commit\") Unmerged paths: (use \"git add <file>...\" to mark resolution) both modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") # \u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u5c31\u662fmaster\u5206\u652f\u548ctesting\u5206\u652f\u90fd\u540c\u65f6\u4fee\u6539\u4e86\u540c\u4e00\u4e2a\u6587\u4ef6a,\u8fd9\u6837\u7684\u60c5\u51b5\u5fc5\u987b\u624b\u52a8\u4fee\u6539 root@k8s4:~/git_test# cat a # \u67e5\u770b\u540c\u4e00\u4e2a\u6587\u4ef6\u5728\u4e24\u4e2a\u5206\u652f\u4e0b\u7684\u5dee\u5f02 1 bbb <<<<<<< HEAD master # \u5728master\u4e0b\u7684\u4fee\u6539 ======= testing # \u5728testing\u4e0b\u4fee\u6539 >>>>>>> testing - \u5982\u4f55\u89e3\u51b3\u51b2\u7a81 - \u5c31\u662f\u5728master\u5206\u652f\u4e0a\u4fee\u6539\u6210\u4f60\u8ba4\u4e3a\u5bf9 root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# vim a root@k8s4:~/git_test# cat a # \u8ba4\u4e3a\u6b63\u786e\u7684 1 bbb master testing root@k8s4:~/git_test# git status On branch master You have unmerged paths. (fix conflicts and run \"git commit\") Unmerged paths: (use \"git add <file>...\" to mark resolution) both modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git add . # \u91cd\u65b0\u63d0\u4ea4 root@k8s4:~/git_test# git commit -m 'meger testing to master both modify a' [master 495c011] meger testing to master both modify a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# git log --oneline --decorat # \u67e5\u770b\u65e5\u5fd7 495c011 (HEAD -> master) meger testing to master both modify a 65b3dce (testing) modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e (mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u5220\u9664\u5206\u652f root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# git branch -d testing Deleted branch testing (was 65b3dce). root@k8s4:~/git_test# git branch * master","title":"3. git\u5206\u652f"},{"location":"tools/git/3.git_branch/#_1","text":"git\u5206\u652f\uff0c\u4ece\u672c\u8d28\u4e0a\u6765\u8bb2\u4ec5\u4ec5\u662f\u6307\u5411\u63d0\u4ea4\u5bf9\u8c61\u7684\u53ef\u53d8\u6307\u9488\uff0c\u5728\u8fd9\u4e00\u70b9\u4e0a\u4e0eSVN\u662f\u6709\u672c\u8d28\u533a\u522b\uff0cSVN\u7684\u5206\u652f\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u76ee\u5f55\u3002 git\u7684\u9ed8\u8ba4\u5206\u652f\u540d\u5b57\u662fmaster\u3002\u5728\u591a\u6b21\u63d0\u4ea4\u64cd\u4f5c\u4e4b\u540e\uff0c\u4f60\u5176\u5b9e\u5df2\u7ecf\u6709\u4e00\u4e2a\u6307\u5411\u6700\u540e\u90a3\u4e2a\u63d0\u4ea4\u5bf9\u8c61\u7684master\u5206\u652f\uff0c\u5b83\u4f1a\u5728\u6bcf\u6b21\u7684\u63d0\u4ea4\u64cd\u4f5c\u4e2d\u81ea\u52a8\u5411\u524d\u79fb\u52a8\u3002 \u67e5\u770b\u5206\u652f git branch \u521b\u5efa\u5206\u652f git branch testing \u5207\u6362\u5206\u652f git checkout testing \u5408\u5e76\u5206\u652f \u5728\u8c01\u4e0a\u5408\u5e76\u8c01\u7684\u5206\u652f\u8981\u6ce8\u610f\uff0c\u6bd4\u5982\u5728master\u7684\u5206\u652f\u4e0a\u5408\u5e76testing\u5206\u652f\uff0c\u5c31\u5148\u5207\u6362\u5230master\u5206\u652f\u4e0a \u5207\u6362\u5230master\u5206\u652f\u4e0a\u5728\u6267\u884c git merge testing \u5220\u9664\u5206\u652f git branch -d testing root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# git log --oneline --decorate 1afadfd (HEAD -> master) modify a second # \u6700\u540e\u6307\u5411 ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u89e3\u91ca - HEAD \u6307\u5411\u8c01\uff0c\u5f53\u524d\u5c31\u662f\u54ea\u4e2a\u5206\u652f - \u64cd\u4f5c\u4e4b\u540e\uff0c\u6700\u540e\u6307\u5411\u90a3\u4e2a\u63d0\u4ea4\u7684\u5206\u652f graph LR A[HEAD]-->B[master] B-->C[f30ab] E[V1.0]-->C C-->D[Snapshot C] F[34ac2]-->C F-->G[Snapshot B] H[98ca9]-->F H-->I[Snapshot A] \u5728\u5b9e\u9645\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u5c3d\u91cf\u4fdd\u8bc1master\u5206\u652f\u7a33\u5b9a\uff0c\u4ec5\u7528\u4e8e\u53d1\u5e03\u65b0\u9881\u5e03\uff0c\u5e73\u65f6\u4e0d\u8981\u968f\u4fbf\u76f4\u63a5\u4fee\u6539\u91cc\u9762\u7684\u6570\u636e\u6587\u4ef6 \u5e72\u6d3b\u90fd\u5728dev\u5206\u652f\u4e0a\uff0c\u6bcf\u4eba\u4ecedev\u5206\u652f\u521b\u5efa\u81ea\u5df1\u7684\u4e2a\u4eba\u5206\u652f\uff0c\u5f00\u53d1\u5b8c\u5408\u5e76\u5230dev\u5206\u652f\uff0c\u6700\u540edev\u5206\u652f\u5408\u5e76\u5230master\u5206\u652f\u4e0a \u521b\u5efa\u5206\u652f root@k8s4:~/git_test# git branch testing \u67e5\u770b\u5206\u652f root@k8s4:~/git_test# git branch * master # \u5f53\u524d\u5728master\u5206\u652f\uff08\u770b*\u53f7\u4f4d\u7f6e\uff09 testing \u6b64\u65f6master\u5206\u652f\u548ctesting\u5206\u652f\u90fd\u6307\u5411\u6700\u540e\u63d0\u4ea4\u7684\u90a3\u4e2acommit 1afadfd (HEAD -> master, testing) modify a second # \u770b\u5730\u65b9\u5c31\u6307\u5411\u4e86\u54ea\u4e2acommit ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a - \u5207\u6362\u5206\u652f root@k8s4:~/git_test# git checkout testing Switched to branch 'testing' root@k8s4:~/git_test# git branch master * testing root@k8s4:~/git_test# cat a 1 bbb \u5728testing\u5206\u652f\u4e0b\u64cd\u4f5c root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# git checkout testing Switched to branch 'testing' root@k8s4:~/git_test# git branch master * testing root@k8s4:~/git_test# cat a 1 bbb root@k8s4:~/git_test# git log --oneline --decorate 1afadfd (HEAD -> testing, master) modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# touch test root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'commit test on branch testing ' [testing 81cec5e] commit test on branch testing 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 test root@k8s4:~/git_test# git status On branch testing nothing to commit, working directory clean root@k8s4:~/git_test# ls a test root@k8s4:~/git_test# git log --oneline --decorate 81cec5e (HEAD -> testing) commit test on branch testing 1afadfd (master) modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git branch master * testing root@k8s4:~/git_test# git checkout master Switched to branch 'master' root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# ls a \u6b64\u65f6\u770b\u5230\u5728testing\u5206\u652f\u4e0a\u7684\u64cd\u4f5c\uff0c\u5728master\u4e0a\u6ca1\u6709(\u9700\u8981\u5408\u5e76)\uff0c\u56e0\u4e3amaster\u548chead\u7684HEAD\u6307\u5411\u4e0d\u540c\u7684commit\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u591a\u4eba\u534f\u4f5c\u3002 \u5728master\u5206\u652f\u4e0b\u64cd\u4f5c root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# touch master root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'commit master in branch master' [master 21af5cc] commit master in branch master 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 master root@k8s4:~/git_test# git log --oneline --decorate 21af5cc (HEAD -> master) commit master in branch master 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u5408\u5e76\u5206\u652f testing\u5206\u652f\u5408\u5e76\u5230master\u5206\u652f\u4e0a \u9996\u5148\u5728master\u5206\u652f\u4e0a\u6267\u884c root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# git merge testing \u6b64\u65f6\u4f1a\u5f39\u51fa\u4e00\u4e2a\u754c\u9762\uff0c\u8bb0\u5f55\u6b64\u6b21\u64cd\u4f5c GNU nano 2.5.3 File: /root/git_test/.git/MERGE_MSG Modified Merge branch 'testing' # Please enter a commit message to explain why this merge is necessary, # especially if it merges an updated upstream into a topic branch. # # Lines starting with '#' will be ignored, and an empty message aborts # the commit. merge testing to master # \u65b0\u589e\u5185\u5bb9 \u8bb0\u5f55\u5408\u5e76\u4e86\u4ec0\u4e48\u4fe1\u606f merge test to master \u6b64\u65f6\u6309\u4e0bctrl + X \u540e\u518d\u6309\u4e0bY \u4fdd\u5b58\u9000\u51fa Merge made by the 'recursive' strategy. test | 0 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 test # \u6b64\u65f6\u53ef\u4ee5\u770b\u5230testing\u5206\u652f\u4e0b\u7684\u6570\u636e\u5df2\u7ecf\u5408\u5e76\u8fc7\u6765\u4e86 root@k8s4:~/git_test# ls a master test root@k8s4:~/git_test# git branch * master \u6b64\u65f6\u53ef\u4ee5\u770b\u5230testing\u5206\u652f\u5408\u5e76\u8fc7\u6765\u7684\u6570\u636e root@k8s4:~/git_test# git log --oneline --decorat a369899 (HEAD -> master) Merge branch 'testing' 21af5cc commit master in branch master 81cec5e (testing, mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a # \u5207\u6362\u5230testing\u5206\u652f\u67e5\u770b\u4fe1\u606f root@k8s4:~/git_test# git checkout testing Switched to branch 'testing' root@k8s4:~/git_test# ls a test root@k8s4:~/git_test# git log --oneline --decorat 81cec5e (HEAD -> testing, mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u4e0d\u540c\u5206\u652f\u4fee\u6539\u540c\u4e00\u4e2a\u6587\u4ef6\u540e\u5408\u5e76 root@k8s4:~/git_test# git branch # \u67e5\u770b\u5f53\u524d\u5206\u652f * master testing root@k8s4:~/git_test# ls a master test root@k8s4:~/git_test# cat a 1 bbb root@k8s4:~/git_test# echo 'master'>>a # \u5728master\u5206\u652f\u4e0a\u4fee\u6539\u63d0\u4ea4\u6570\u636e root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'modify a on master' [master 41d0dd3] modify a on master 1 file changed, 1 insertion(+) root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# git log --oneline --decorat # \u67e5\u770bmaster\u5206\u652f\u4e0a\u65e5\u5fd7 41d0dd3 (HEAD -> master) modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e (testing, mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git checkout testing # \u5207\u6362\u5230testing\u5206\u652f\u4e0a\u64cd\u4f5c\u6570\u636e Switched to branch 'testing' root@k8s4:~/git_test# ls a test root@k8s4:~/git_test# cat a 1 bbb root@k8s4:~/git_test# echo 'testing'>>a # testing\u5206\u652f\u4e0a\u4fee\u6539\u63d0\u4ea4\u6570\u636e root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'modify a on testing branch' [testing 65b3dce] modify a on testing branch 1 file changed, 1 insertion(+) root@k8s4:~/git_test# git checkout master # \u5207\u6362\u5230master\u5206\u652f\u4e0a \u5408\u5e76testing\u5206\u652f Switched to branch 'master' root@k8s4:~/git_test# git merge testing Auto-merging a CONFLICT (content): Merge conflict in a Automatic merge failed; fix conflicts and then commit the result. root@k8s4:~/git_test# git status On branch master You have unmerged paths. (fix conflicts and run \"git commit\") Unmerged paths: (use \"git add <file>...\" to mark resolution) both modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") # \u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u5c31\u662fmaster\u5206\u652f\u548ctesting\u5206\u652f\u90fd\u540c\u65f6\u4fee\u6539\u4e86\u540c\u4e00\u4e2a\u6587\u4ef6a,\u8fd9\u6837\u7684\u60c5\u51b5\u5fc5\u987b\u624b\u52a8\u4fee\u6539 root@k8s4:~/git_test# cat a # \u67e5\u770b\u540c\u4e00\u4e2a\u6587\u4ef6\u5728\u4e24\u4e2a\u5206\u652f\u4e0b\u7684\u5dee\u5f02 1 bbb <<<<<<< HEAD master # \u5728master\u4e0b\u7684\u4fee\u6539 ======= testing # \u5728testing\u4e0b\u4fee\u6539 >>>>>>> testing - \u5982\u4f55\u89e3\u51b3\u51b2\u7a81 - \u5c31\u662f\u5728master\u5206\u652f\u4e0a\u4fee\u6539\u6210\u4f60\u8ba4\u4e3a\u5bf9 root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# vim a root@k8s4:~/git_test# cat a # \u8ba4\u4e3a\u6b63\u786e\u7684 1 bbb master testing root@k8s4:~/git_test# git status On branch master You have unmerged paths. (fix conflicts and run \"git commit\") Unmerged paths: (use \"git add <file>...\" to mark resolution) both modified: a no changes added to commit (use \"git add\" and/or \"git commit -a\") root@k8s4:~/git_test# git add . # \u91cd\u65b0\u63d0\u4ea4 root@k8s4:~/git_test# git commit -m 'meger testing to master both modify a' [master 495c011] meger testing to master both modify a root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# git log --oneline --decorat # \u67e5\u770b\u65e5\u5fd7 495c011 (HEAD -> master) meger testing to master both modify a 65b3dce (testing) modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e (mster) commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a \u5220\u9664\u5206\u652f root@k8s4:~/git_test# git branch * master testing root@k8s4:~/git_test# git branch -d testing Deleted branch testing (was 65b3dce). root@k8s4:~/git_test# git branch * master","title":"\u4ecb\u7ecd"},{"location":"tools/git/4.git_lab/","text":"1. \u6807\u7b7e\u7684\u4f7f\u7528 \u00b6 \u524d\u9762\u56de\u6eda\u7684\u662f\u4e00\u4e32\u5b57\u7b26\uff0c\u53c8\u957f\u53c8\u96be\u8bb0\u3002 2. \u7b80\u5355\u5b9e\u7528 \u00b6 root@k8s4:~/git_test# git log --oneline --decorat 495c011 (HEAD -> master) meger testing to master both modify a 65b3dce modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a 3. \u57fa\u672c\u547d\u4ee4 \u00b6 git tag v1.0 # \u5f53\u524d\u63d0\u4ea4\u5185\u5bb9\u6253\u4e00\u4e2a\u6807\u7b7e\uff0c\u65b9\u4fbf\u56de\u6eda\uff0c\u6bcf\u6b21\u63d0\u4ea4\u90fd\u4f1a\u6253\u4e2atag git tag # \u67e5\u770b\u5f53\u524d\u6240\u6709\u6807\u7b7e git show v1.0 # \u67e5\u770b\u5f53\u524d1.0\u7248\u672c\u7684\u8be6\u7ec6\u4fe1\u606f git tag v1.2 -m 'version 1.2 release is test' # \u521b\u5efa\u5e26\u6709\u8bf4\u660e\u7684\u6807\u7b7e\uff0c -a \u662f\u6307\u5b9a\u6807\u7b7e\u540d -m \u662f\u6307\u5b9a\u8bf4\u660e\u6587\u5b57 git tag -d v1.0 # \u6211\u4eec\u4e3a\u540c\u4e00\u4e2a\u63d0\u4ea4\u7248\u672c\u8bbe\u7f6e\u4e86\u4e24\u6b21\u6807\u7b7e\uff0c\u5220\u9664\u4e4b\u524d\u7684v.10 4. \u6253\u6807\u7b7e \u00b6 4.1 \u6ca1\u6307\u5b9a\u7279\u5b9a\u7684\u7248\u672c \u00b6 root@k8s4:~/git_test# git log --oneline --decorat 495c011 (HEAD -> master) meger testing to master both modify a 65b3dce modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git tag -a v1.0 \u7136\u540e\u65b0\u5f00\u7684\u7a97\u53e3\u8bb0\u5f55tag\u7684\u4fe1\u606f\uff0c\u6211\u8bb0\u5f55\u4e3a This is my v1.0 version 4.1.1 \u67e5\u770b\u6253\u7684\u6807\u7b7e \u00b6 root@k8s4:~/git_test# git tag v1.0 4.2 \u6307\u5b9a\u7279\u5b9a\u7684\u7248\u672c \u00b6 root@k8s4:~/git_test# git log --oneline --decorat 495c011 (HEAD -> master, tag: v1.0) meger testing to master both modify a 65b3dce modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e commit test on branch testing 1afadfd modify a second # \u6307\u5b9a\u8fd9\u4e2a\u7248\u672c\u6253\u6807\u7b7e ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git tag v1.0 root@k8s4:~/git_test# git tag -a v2.0 1afadfd root@k8s4:~/git_test# git tag v1.0 v2.0 4.2.1 \u67e5\u770b\u6253\u7684\u6807\u7b7e \u00b6 root@k8s4:~/git_test# git show v1.0 tag v1.0 Tagger: leco <leco@leco.com> Date: Tue Jan 15 14:56:45 2019 +0800 This is my v1.0 version commit 495c011cd59214a3d8de425203162e6af50f41be Merge: 41d0dd3 65b3dce Author: leco <leco@leco.com> Date: Tue Jan 15 14:38:27 2019 +0800 meger testing to master both modify a diff --cc a index 3bf17cd,a2b2d32..db90531 --- a/a +++ b/a @@@ -1,3 -1,3 +1,4 @@@ 1 bbb +master + testing 5. tag\u64cd\u4f5c \u00b6 5.1 \u901a\u8fc7tag \u6062\u590d\u7248\u672c \u00b6 \u4ee5\u4e0b\u662f\u6062\u590d\u52302.0\u7248\u672c root@k8s4:~/git_test# touch b root@k8s4:~/git_test# ls a b master test root@k8s4:~/git_test# git reset --hard v2.0 HEAD is now at 1afadfd modify a second root@k8s4:~/git_test# ls a b 5.2 \u5220\u9664tag \u00b6 root@k8s4:~/git_test# git tag v1.0 v2.0 root@k8s4:~/git_test# git tag -d v2.0 Deleted tag 'v2.0' (was 65b1d62) root@k8s4:~/git_test# git tag v1.0","title":"4. git \u6807\u7b7e"},{"location":"tools/git/4.git_lab/#1","text":"\u524d\u9762\u56de\u6eda\u7684\u662f\u4e00\u4e32\u5b57\u7b26\uff0c\u53c8\u957f\u53c8\u96be\u8bb0\u3002","title":"1. \u6807\u7b7e\u7684\u4f7f\u7528"},{"location":"tools/git/4.git_lab/#2","text":"root@k8s4:~/git_test# git log --oneline --decorat 495c011 (HEAD -> master) meger testing to master both modify a 65b3dce modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a","title":"2. \u7b80\u5355\u5b9e\u7528"},{"location":"tools/git/4.git_lab/#3","text":"git tag v1.0 # \u5f53\u524d\u63d0\u4ea4\u5185\u5bb9\u6253\u4e00\u4e2a\u6807\u7b7e\uff0c\u65b9\u4fbf\u56de\u6eda\uff0c\u6bcf\u6b21\u63d0\u4ea4\u90fd\u4f1a\u6253\u4e2atag git tag # \u67e5\u770b\u5f53\u524d\u6240\u6709\u6807\u7b7e git show v1.0 # \u67e5\u770b\u5f53\u524d1.0\u7248\u672c\u7684\u8be6\u7ec6\u4fe1\u606f git tag v1.2 -m 'version 1.2 release is test' # \u521b\u5efa\u5e26\u6709\u8bf4\u660e\u7684\u6807\u7b7e\uff0c -a \u662f\u6307\u5b9a\u6807\u7b7e\u540d -m \u662f\u6307\u5b9a\u8bf4\u660e\u6587\u5b57 git tag -d v1.0 # \u6211\u4eec\u4e3a\u540c\u4e00\u4e2a\u63d0\u4ea4\u7248\u672c\u8bbe\u7f6e\u4e86\u4e24\u6b21\u6807\u7b7e\uff0c\u5220\u9664\u4e4b\u524d\u7684v.10","title":"3. \u57fa\u672c\u547d\u4ee4"},{"location":"tools/git/4.git_lab/#4","text":"","title":"4. \u6253\u6807\u7b7e"},{"location":"tools/git/4.git_lab/#41","text":"root@k8s4:~/git_test# git log --oneline --decorat 495c011 (HEAD -> master) meger testing to master both modify a 65b3dce modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e commit test on branch testing 1afadfd modify a second ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git tag -a v1.0 \u7136\u540e\u65b0\u5f00\u7684\u7a97\u53e3\u8bb0\u5f55tag\u7684\u4fe1\u606f\uff0c\u6211\u8bb0\u5f55\u4e3a This is my v1.0 version","title":"4.1 \u6ca1\u6307\u5b9a\u7279\u5b9a\u7684\u7248\u672c"},{"location":"tools/git/4.git_lab/#411","text":"root@k8s4:~/git_test# git tag v1.0","title":"4.1.1 \u67e5\u770b\u6253\u7684\u6807\u7b7e"},{"location":"tools/git/4.git_lab/#42","text":"root@k8s4:~/git_test# git log --oneline --decorat 495c011 (HEAD -> master, tag: v1.0) meger testing to master both modify a 65b3dce modify a on testing branch 41d0dd3 modify a on master a369899 Merge branch 'testing' 21af5cc commit master in branch master 81cec5e commit test on branch testing 1afadfd modify a second # \u6307\u5b9a\u8fd9\u4e2a\u7248\u672c\u6253\u6807\u7b7e ccf4d94 modify a 26e567b rename a.txt to a da4a5dd commit a.txt e73cff4 commit a root@k8s4:~/git_test# git tag v1.0 root@k8s4:~/git_test# git tag -a v2.0 1afadfd root@k8s4:~/git_test# git tag v1.0 v2.0","title":"4.2 \u6307\u5b9a\u7279\u5b9a\u7684\u7248\u672c"},{"location":"tools/git/4.git_lab/#421","text":"root@k8s4:~/git_test# git show v1.0 tag v1.0 Tagger: leco <leco@leco.com> Date: Tue Jan 15 14:56:45 2019 +0800 This is my v1.0 version commit 495c011cd59214a3d8de425203162e6af50f41be Merge: 41d0dd3 65b3dce Author: leco <leco@leco.com> Date: Tue Jan 15 14:38:27 2019 +0800 meger testing to master both modify a diff --cc a index 3bf17cd,a2b2d32..db90531 --- a/a +++ b/a @@@ -1,3 -1,3 +1,4 @@@ 1 bbb +master + testing","title":"4.2.1 \u67e5\u770b\u6253\u7684\u6807\u7b7e"},{"location":"tools/git/4.git_lab/#5-tag","text":"","title":"5. tag\u64cd\u4f5c"},{"location":"tools/git/4.git_lab/#51-tag","text":"\u4ee5\u4e0b\u662f\u6062\u590d\u52302.0\u7248\u672c root@k8s4:~/git_test# touch b root@k8s4:~/git_test# ls a b master test root@k8s4:~/git_test# git reset --hard v2.0 HEAD is now at 1afadfd modify a second root@k8s4:~/git_test# ls a b","title":"5.1 \u901a\u8fc7tag \u6062\u590d\u7248\u672c"},{"location":"tools/git/4.git_lab/#52-tag","text":"root@k8s4:~/git_test# git tag v1.0 v2.0 root@k8s4:~/git_test# git tag -d v2.0 Deleted tag 'v2.0' (was 65b1d62) root@k8s4:~/git_test# git tag v1.0","title":"5.2 \u5220\u9664tag"},{"location":"tools/github/1.github/","text":"Hub\u662f\u4e00\u4e2a\u9762\u5411\u5f00\u6e90\u53ca\u79c1\u6709\u8f6f\u4ef6\u9879\u76ee\u7684\u6258\u7ba1\u5e73\u53f0\uff0c\u56e0\u4e3a\u53ea\u652f\u6301git \u4f5c\u4e3a\u552f\u4e00\u7684\u7248\u672c\u5e93\u683c\u5f0f\u8fdb\u884c\u6258\u7ba1\uff0c\u6545\u540dgitHub\u3002 gitHub\u4e8e2008\u5e744\u670810\u65e5\u6b63\u5f0f\u4e0a\u7ebf\uff0c\u9664\u4e86git\u4ee3\u7801\u4ed3\u5e93\u6258\u7ba1\u53ca\u57fa\u672c\u7684 Web\u7ba1\u7406\u754c\u9762\u4ee5\u5916\uff0c\u8fd8\u63d0\u4f9b\u4e86\u8ba2\u9605\u3001\u8ba8\u8bba\u7ec4\u3001\u6587\u672c\u6e32\u67d3\u3001\u5728\u7ebf\u6587\u4ef6\u7f16\u8f91\u5668\u3001\u534f\u4f5c\u56fe\u8c31\uff08\u62a5\u8868\uff09\u3001\u4ee3\u7801\u7247\u6bb5\u5206\u4eab\uff08Gist\uff09\u7b49\u529f\u80fd\u3002\u76ee\u524d\uff0c\u5176\u6ce8\u518c\u7528\u6237\u5df2\u7ecf\u8d85\u8fc7350\u4e07\uff0c\u6258\u7ba1\u7248\u672c\u6570\u91cf\u4e5f\u662f\u975e\u5e38\u4e4b\u591a\uff0c\u5176\u4e2d\u4e0d\u4e4f\u77e5\u540d\u5f00\u6e90\u9879\u76ee Ruby on Rails\u3001jQuery\u3001python \u7b49\u3002 2018\u5e746\u67084\u65e5\uff0c\u5fae\u8f6f\u5ba3\u5e03\uff0c\u901a\u8fc775\u4ebf\u7f8e\u5143\u7684\u80a1\u7968\u4ea4\u6613\u6536\u8d2d\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0GitHub\u3002 git\u4f7f\u7528 github\u4f7f\u7528 Github\u5b98\u7f51 - \u6ce8\u518c\u7528\u6237 - \u914d\u7f6essh-key - \u521b\u5efa\u9879\u76ee - \u514b\u9686\u9879\u76ee\u5230\u672c\u5730 - \u63a8\u9001\u4fee\u6539\u5230\u8fdc\u7a0b \u672c\u5730\u4ed3\u5e93\u5173\u8054\u8fdc\u7a0b\uff08github\uff09\u4ed3\u5e93\uff0c\u5e76\u628a\u672c\u5730\u4ed3\u5e93\u5185\u5bb9\u63a8\u9001\u5230\u8fdc\u7a0b\u4ed3\u5e93\u4e0a \u8be6\u7ec6\u65b9\u6cd5 \u672c\u5730\u65b0\u521b\u5efa\u4ed3\u5e93 \u672c\u5730\u5df2\u7ecf\u5b58\u5728\u4ed3\u5e93 \u2026or create a new repository on the command line echo \"# git\" >> README.md git init git add README.md git commit -m \"first commit\" git remote add origin git@github.com:caimengzhi/git.git git push -u origin master \u2026or push an existing repository from the command line git remote add origin git@github.com:caimengzhi/git.git git push -u origin master \u53ea\u6f14\u793a\u672c\u5730\u5b58\u5728\u7684\u4ed3\u5e93\u63a8\u5230\u5230github root@k8s4:~/git_test# git status On branch master nothing to commit, working directory clean root@k8s4:~/git_test# ls a b master test \u5173\u8054\u672c\u5730\u4ed3\u5e93\u548c\u8fdc\u7a0b\u4ed3\u5e93 root@k8s4:~/git_test# git remote add origin git@github.com:caimengzhi/git.git | |______________________________ \u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740(github) |__________________________________________ \u8fdc\u7a0b\u4ed3\u5e93\u540d\u5b57 root@k8s4:~/git_test# git remote origin \u628a\u81ea\u5df1\u7684\u516c\u7ea6\u7ed1\u5b9a\u5230github root@k8s4:~/git_test# ssh-keygen -t rsa Generating public/private rsa key pair. Enter file in which to save the key (/root/.ssh/id_rsa): /root/.ssh/id_rsa already exists. Overwrite (y/n)? y Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /root/.ssh/id_rsa. Your public key has been saved in /root/.ssh/id_rsa.pub. The key fingerprint is: SHA256:Q/ctxUTf8bzz8VhNNpdIFV8vS1R2yAZ+9z1iUvLXczw root@k8s4 The key's randomart image is: +---[RSA 2048]----+ | .==**| | ..+=+X| | . ...+*o%| | . . .+= BO| | S .o+oEO| | . o.ooX| | . o| | | | | +----[SHA256]-----+ root@k8s4:~/git_test# ls /root/.ssh/id_rsa /root/.ssh/id_rsa root@k8s4:~/git_test# cat /root/.ssh//id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDdW9wXBlVkMGVjoBPK+TKC8+k8XDmzaZA1lHEGTv2T2NgmETIGLXsj2JzFcT600k8isLcwuPBTE1Sntm0829sbMtBaPjseFO7LAN64vWyXxEVyoRx1l4wM3zHMvBLlgb2Og5YzEhBd3rRPEAZlTq6vKeiJghkngDAHKA/0fk4oOiIHBB9p39EsBioi4EhIhvinie6LI0iGOZPQbrbGMnKOCIDzkN8WXtkIWS9VCwN88BGdgROYrJxcZFO7S5her6sjgBNvILw3uBhfGDwVtARtaFRwXG4TmK1n1OIoTE1LCEjNZwTq6bVkJvxDLQco2WcM9R4qcVrCrmokqVXaeYGn root@k8s4 \u63a8\u9001 root@k8s4:~/git_test# git push -u origin master Counting objects: 29, done. Delta compression using up to 4 threads. Compressing objects: 100% (19/19), done. Writing objects: 100% (29/29), 2.38 KiB | 0 bytes/s, done. Total 29 (delta 3), reused 0 (delta 0) remote: Resolving deltas: 100% (3/3), done. To git@github.com:caimengzhi/git.git * [new branch] master -> master Branch master set up to track remote branch master from origin. \u4ea7\u770bgithub\u4ed3\u5e93\u4e0a\u662f\u5426\u6709\u6570\u636e \u514b\u9686\u8fdc\u7a0b\u4ed3\u5e93\u6570\u636e root@k8s4:~/git_test# cd /opt/ root@k8s4:/opt# ls root@k8s4:/opt# git clone https://github.com/caimengzhi/git.git Cloning into 'git'... # \u56e0\u4e3a\u662f\u79c1\u6709\u4ed3\u5e93\u6240\u4ee5\u8981\u8f93\u5165github\u7684\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u624d\u80fdclone\u4e0b\u6765\uff0c Username for 'https://github.com': xxx # \u8fd9\u4e2a\u5730\u65b9\u8f93\u5165github\u8d26\u53f7 Password for 'https://caimengzhi@github.com': # github\u5bc6\u7801 remote: Enumerating objects: 29, done. remote: Counting objects: 100% (29/29), done. remote: Compressing objects: 100% (16/16), done. remote: Total 29 (delta 3), reused 29 (delta 3), pack-reused 0 Unpacking objects: 100% (29/29), done. Checking connectivity... done. root@k8s4:/opt# ls git root@k8s4:/opt# cd git/ root@k8s4:/opt/git# ls a b master test \u522b\u7684\u5176\u4ed6clone - \u8981\u52a0\u8d26\u53f7 [root@leco git]# git clone https://caimengzhi@github.com/caimengzhi/git.git Initialized empty Git repository in /opt/git/git/.git/ Password: # \u6b64\u5730\u65b9\u8981\u8f93\u5165\u5bc6\u7801 remote: Enumerating objects: 29, done. remote: Counting objects: 100% (29/29), done. remote: Compressing objects: 100% (16/16), done. remote: Total 29 (delta 3), reused 29 (delta 3), pack-reused 0 Unpacking objects: 100% (29/29), done. [root@leco git]# pwd /opt/git [root@leco git]# ls git [root@leco git]# tree . \u2514\u2500\u2500 git \u251c\u2500\u2500 a \u251c\u2500\u2500 b \u251c\u2500\u2500 master \u2514\u2500\u2500 test 1 directory, 4 files [root@leco git]# git remote origin \u672c\u5730\u4fee\u6539\u540e\u63a8\u9001 root@k8s4:/opt/git# touch c root@k8s4:/opt/git# git add . root@k8s4:/opt/git# git commit -m 'commit c' [master d381f99] commit c 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 c root@k8s4:/opt/git# git push origin master Username for 'https://github.com': # \u8f93\u5165github\u8d26\u53f7 Password for 'https://caimengzhi@github.com': # \u8f93\u5165github\u5bc6\u7801 Counting objects: 2, done. Delta compression using up to 4 threads. Compressing objects: 100% (2/2), done. Writing objects: 100% (2/2), 207 bytes | 0 bytes/s, done. Total 2 (delta 1), reused 0 (delta 0) remote: Resolving deltas: 100% (1/1), completed with 1 local object. To https://github.com/caimengzhi/git.git d504270..d381f99 master -> master \u6b64\u65f6\u5728\u4f1a\u5230\u4e4b\u524d\u7684\u9879\u76ee\u4e0b\u521b\u5efa\u6587\u4ef6\u540e\u63d0\u4ea4 root@k8s4:/opt/git# cd root@k8s4:~# cd git_test/ root@k8s4:~/git_test# touch d root@k8s4:~/git_test# git add . root@k8s4:~/git_test# git commit -m 'commit -d' [master 28d37c5] commit -d 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 d root@k8s4:~/git_test# git push origin master To git@github.com:caimengzhi/git.git ! [rejected] master -> master (fetch first) error: failed to push some refs to 'git@github.com:caimengzhi/git.git' hint: Updates were rejected because the remote contains work that you do hint: not have locally. This is usually caused by another repository pushing hint: to the same ref. You may want to first integrate the remote changes hint: (e.g., 'git pull ...') before pushing again. hint: See the 'Note about fast-forwards' in 'git push --help' for details. \u7adf\u7136\u62a5\u9519\u4e86\uff0c\u56e0\u4e3a\u522b\u7684\u5730\u65b9\u5df2\u7ecf\u63d0\u4ea4\u4e86\u6570\u636e\uff0c\u6b64\u65f6\u672c\u5730\u4ed3\u5e93\u548c\u8fdc\u7a0bgithub\u4ed3\u5e93\u4e0d\u4e00\u81f4\u3002\u89e3\u51b3\u529e\u6cd5\u5c31\u662f - \u628a\u8fdc\u7a0bgithub\u4ed3\u5e93\u62c9\u4e0b\u6765\uff0c\u5408\u5e76\u540e\u518d\u9000 # 1. \u5148\u4ecegithub\u4e0a\u62c9\u4e0b\u6765 root@k8s4:~/git_test# git fetch Warning: Permanently added the RSA host key for IP address '13.250.177.223' to the list of known hosts. remote: Enumerating objects: 3, done. remote: Counting objects: 100% (3/3), done. remote: Compressing objects: 100% (1/1), done. remote: Total 2 (delta 1), reused 2 (delta 1), pack-reused 0 Unpacking objects: 100% (2/2), done. From github.com:caimengzhi/git d504270..d381f99 master -> origin/master root@k8s4:~/git_test# ls a b d master test # 2. \u7136\u540e\u672c\u5730\u4ed3\u5e93\u548c\u4e4b\u524d\u62c9\u4e0b\u6765\u7684\u5408\u5e76 root@k8s4:~/git_test# git merge origin/master Merge made by the 'recursive' strategy. c | 0 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 c \u8bb0\u5f55\u5408\u5e76\u7684\u5185\u5bb9 root@k8s4:~/git_test# ll total 16 drwxr-xr-x 3 root root 4096 Jan 15 15:53 ./ drwx------ 9 root root 4096 Jan 15 14:37 ../ drwxr-xr-x 8 root root 4096 Jan 15 15:53 .git/ -rw-r--r-- 1 root root 21 Jan 15 15:24 a -rw-r--r-- 1 root root 0 Jan 15 15:02 b -rw-r--r-- 1 root root 0 Jan 15 15:53 c -rw-r--r-- 1 root root 0 Jan 15 15:50 d -rw-r--r-- 1 root root 0 Jan 15 15:24 master -rw-r--r-- 1 root root 0 Jan 15 15:24 test # 3. \u7136\u540e\u518d\u63a8\u9001\u5230\u8fdc\u7a0b root@k8s4:~/git_test# git push -u origin master Counting objects: 4, done. Delta compression using up to 4 threads. Compressing objects: 100% (4/4), done. Writing objects: 100% (4/4), 426 bytes | 0 bytes/s, done. Total 4 (delta 2), reused 0 (delta 0) remote: Resolving deltas: 100% (2/2), completed with 1 local object. To git@github.com:caimengzhi/git.git d381f99..752ef29 master -> master Branch master set up to track remote branch master from origin. root@k8s4:~/git_test# \u6ce8\u610f - \u6bcf\u6b21\u63a8\u9001\u7684\u65f6\u5019\uff0c\u90fd\u8981\u62c9\u4e00\u4e0b\u8fdc\u7a0b\u4ed3\u5e93\u7684\u6570\u636e\u7136\u540e\u5408\u5e76\uff0c\u4fdd\u8bc1\u672c\u5730\u4ed3\u5e93\u548c\u8fdc\u7a0b\u4ed3\u5e93\u7684\u6570\u636e\u4e00\u81f4 - \u7136\u540e\u518d\u4fee\u6539\u672c\u5730\u6570\u636e\u540e\uff0c\u518d\u6b21\u63a8\u9001\u5230\u8fdc\u7a0b","title":"2. github"},{"location":"tools/gitlab/1.gitlab/","text":"1. \u4ecb\u7ecd \u00b6 1.1 \u53c2\u8003\u6307\u5357 \u00b6 \u5b98\u7f51 \u5b89\u88c5\u6307\u5357 \u79bb\u7ebf\u5b89\u88c5 \u6e05\u534e\u6e90 1.2 \u533a\u522b \u00b6 gitlab-ce \u793e\u533a\u7248\u672c(\u514d\u8d39) gitlab-ee \u4f01\u4e1a\u7248\u672c(\u6536\u8d39) 1.3 \u5728\u7ebf\u5b89\u88c5 \u00b6 sudo apt-get update sudo apt-get install -y curl openssh-server ca-certificates sudo apt-get install -y postfix 1.4 \u5728\u7ebf\u5b89\u88c5(\u6307\u5b9a\u7248\u672c) \u00b6 curl -s https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash sudo apt-get install gitlab-ce=10.2.2-ce.0 1.5 \u79bb\u7ebf\u5b89\u88c5\uff08\u6307\u5b9a\u7248\u672c\uff09 \u00b6 root@k8s4:~/git_test# lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 16.04.5 LTS Release: 16.04 Codename: xenial root@k8s4:~/git_test# wget --content-disposition https://packages.gitlab.com/gitlab/gitlab-ce/packages/ubuntu/xenial/gitlab-ce_10.2.2-ce.0_amd64.deb/download.deb --2019-01-15 16:15:50-- https://packages.gitlab.com/gitlab/gitlab-ce/packages/ubuntu/xenial/gitlab-ce_10.2.2-ce.0_amd64.deb/download.deb \u3002\u3002\u3002\u3002\u3002\u7701\u7565\u3002\u3002\u3002\u3002\u3002 \u5f00\u59cb\u5b89\u88c5 root@k8s4:~/git_test# dpkg -i gitlab-ce_10.2.2-ce.0_amd64.deb Selecting previously unselected package gitlab-ce. (Reading database ... 120662 files and directories currently installed.) Preparing to unpack gitlab-ce_10.2.2-ce.0_amd64.deb ... Unpacking gitlab-ce (10.2.2-ce.0) ... Setting up gitlab-ce (10.2.2-ce.0) ... It looks like GitLab has not been configured yet; skipping the upgrade script. *. *. *** *** ***** ***** .****** ******* ******** ******** ,,,,,,,,,***********,,,,,,,,, ,,,,,,,,,,,*********,,,,,,,,,,, .,,,,,,,,,,,*******,,,,,,,,,,,, ,,,,,,,,,*****,,,,,,,,,. ,,,,,,,****,,,,,, .,,,***,,,, ,*,. _______ __ __ __ / ____(_) /_/ / ____ _/ /_ / / __/ / __/ / / __ \\`/ __ \\ / /_/ / / /_/ /___/ /_/ / /_/ / \\____/_/\\__/_____/\\__,_/_.___/ Thank you for installing GitLab! GitLab was unable to detect a valid hostname for your instance. Please configure a URL for your GitLab instance by setting `external_url` configuration in /etc/gitlab/gitlab.rb file. Then, you can start your GitLab instance by running the following command: sudo gitlab-ctl reconfigure For a comprehensive list of configuration options please see the Omnibus GitLab readme https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/README.md \u4e0b\u8f7d\u548c\u5b89\u88c5\u7684\u65f6\u5019\u90fd\u6bd4\u8f83\u6162\uff0c\u8bf7\u7a0d\u7b49\u7247\u523b 2. \u914d\u7f6e \u00b6 2.1 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u00b6 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 external_url \u4e3a\u672c\u673aIP\u5730\u5740 root@k8s4:/etc/gitlab# cp gitlab.rb gitlab.rb.ori root@k8s4:/etc/gitlab# vim /etc/gitlab/gitlab.rb root@k8s4:/etc/gitlab# diff gitlab.rb gitlab.rb.ori 13c13 < external_url 'http://192.168.5.106' --- > external_url 'http://gitlab.example.com # \u53ea\u6709\u4fee\u6539/etc/gitlab/gitlab.rb\u5c31\u8981\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c(\u5176\u4ed6\u5f88\u591a\u6587\u4ef6\u90fd\u4f9d\u8d56\u8fd9\u4e2a\u6587\u4ef6) root@k8s4:/etc/gitlab# gitlab-ctl reconfigure root@k8s4:/etc/gitlab# gitlab-ctl status run: gitaly: (pid 39985) 31s; run: log: (pid 39567) 70s run: gitlab-monitor: (pid 40000) 30s; run: log: (pid 39685) 62s run: gitlab-workhorse: (pid 39972) 31s; run: log: (pid 39470) 80s run: logrotate: (pid 39513) 72s; run: log: (pid 39512) 72s run: nginx: (pid 39490) 78s; run: log: (pid 39489) 78s run: node-exporter: (pid 39664) 64s; run: log: (pid 39663) 64s run: postgres-exporter: (pid 40034) 29s; run: log: (pid 39878) 48s run: postgresql: (pid 39075) 128s; run: log: (pid 39074) 128s run: prometheus: (pid 40010) 30s; run: log: (pid 39787) 54s run: redis: (pid 38976) 134s; run: log: (pid 38975) 134s run: redis-exporter: (pid 39768) 56s; run: log: (pid 39767) 56s run: sidekiq: (pid 39454) 81s; run: log: (pid 39453) 81s run: unicorn: (pid 39383) 87s; run: log: (pid 39382) 87s 2.2 \u67e5\u770b\u65e5\u5fd7 \u00b6 root@k8s4:/etc/gitlab# gitlab-ctl tail 2.3 \u65e5\u5fd7\u8def\u5f84 \u00b6 root@k8s4:/etc/gitlab# cd /var/log/gitlab/ 2.4 gitlab\u6570\u636e \u00b6 root@k8s4:/var/log/gitlab# ls /var/opt/gitlab/ 2.5 github\u5907\u4efd\u6570\u636e \u00b6 root@k8s4:/var/opt/gitlab/backups# pwd /var/opt/gitlab/backups 2.6 \u5b89\u88c5\u540e\u7a0b\u5e8f\u4f4d\u7f6e \u00b6 root@k8s4:/opt/gitlab# pwd /opt/gitlab root@k8s4:/opt/gitlab# ll total 1656 drwxr-xr-x 10 root root 4096 Jan 15 16:27 ./ drwxr-xr-x 4 root root 4096 Jan 15 16:21 ../ -rw-r--r-- 1 root root 1460869 Nov 24 2017 LICENSE drwxr-xr-x 2 root root 4096 Jan 15 16:22 LICENSES/ drwxr-xr-x 2 root root 4096 Jan 15 16:22 bin/ -rw-r--r-- 1 root root 157364 Nov 24 2017 dependency_licenses.json drwxr-xr-x 18 root root 4096 Jan 15 16:26 embedded/ drwxr-xr-x 6 root root 4096 Jan 15 16:28 etc/ drwxr-xr-x 2 root root 4096 Jan 15 16:28 init/ drwxr-xr-x 2 root root 4096 Jan 15 16:28 service/ drwxr-xr-x 15 root root 4096 Jan 15 16:28 sv/ drwxr-xr-x 3 root root 4096 Jan 15 16:27 var/ -rw-r--r-- 1 root root 19881 Nov 24 2017 version-manifest.json -rw-r--r-- 1 root root 8696 Nov 24 2017 version-manifest.txt","title":"1. gitlab"},{"location":"tools/gitlab/1.gitlab/#1","text":"","title":"1. \u4ecb\u7ecd"},{"location":"tools/gitlab/1.gitlab/#11","text":"\u5b98\u7f51 \u5b89\u88c5\u6307\u5357 \u79bb\u7ebf\u5b89\u88c5 \u6e05\u534e\u6e90","title":"1.1 \u53c2\u8003\u6307\u5357"},{"location":"tools/gitlab/1.gitlab/#12","text":"gitlab-ce \u793e\u533a\u7248\u672c(\u514d\u8d39) gitlab-ee \u4f01\u4e1a\u7248\u672c(\u6536\u8d39)","title":"1.2 \u533a\u522b"},{"location":"tools/gitlab/1.gitlab/#13","text":"sudo apt-get update sudo apt-get install -y curl openssh-server ca-certificates sudo apt-get install -y postfix","title":"1.3 \u5728\u7ebf\u5b89\u88c5"},{"location":"tools/gitlab/1.gitlab/#14","text":"curl -s https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash sudo apt-get install gitlab-ce=10.2.2-ce.0","title":"1.4 \u5728\u7ebf\u5b89\u88c5(\u6307\u5b9a\u7248\u672c)"},{"location":"tools/gitlab/1.gitlab/#15","text":"root@k8s4:~/git_test# lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 16.04.5 LTS Release: 16.04 Codename: xenial root@k8s4:~/git_test# wget --content-disposition https://packages.gitlab.com/gitlab/gitlab-ce/packages/ubuntu/xenial/gitlab-ce_10.2.2-ce.0_amd64.deb/download.deb --2019-01-15 16:15:50-- https://packages.gitlab.com/gitlab/gitlab-ce/packages/ubuntu/xenial/gitlab-ce_10.2.2-ce.0_amd64.deb/download.deb \u3002\u3002\u3002\u3002\u3002\u7701\u7565\u3002\u3002\u3002\u3002\u3002 \u5f00\u59cb\u5b89\u88c5 root@k8s4:~/git_test# dpkg -i gitlab-ce_10.2.2-ce.0_amd64.deb Selecting previously unselected package gitlab-ce. (Reading database ... 120662 files and directories currently installed.) Preparing to unpack gitlab-ce_10.2.2-ce.0_amd64.deb ... Unpacking gitlab-ce (10.2.2-ce.0) ... Setting up gitlab-ce (10.2.2-ce.0) ... It looks like GitLab has not been configured yet; skipping the upgrade script. *. *. *** *** ***** ***** .****** ******* ******** ******** ,,,,,,,,,***********,,,,,,,,, ,,,,,,,,,,,*********,,,,,,,,,,, .,,,,,,,,,,,*******,,,,,,,,,,,, ,,,,,,,,,*****,,,,,,,,,. ,,,,,,,****,,,,,, .,,,***,,,, ,*,. _______ __ __ __ / ____(_) /_/ / ____ _/ /_ / / __/ / __/ / / __ \\`/ __ \\ / /_/ / / /_/ /___/ /_/ / /_/ / \\____/_/\\__/_____/\\__,_/_.___/ Thank you for installing GitLab! GitLab was unable to detect a valid hostname for your instance. Please configure a URL for your GitLab instance by setting `external_url` configuration in /etc/gitlab/gitlab.rb file. Then, you can start your GitLab instance by running the following command: sudo gitlab-ctl reconfigure For a comprehensive list of configuration options please see the Omnibus GitLab readme https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/README.md \u4e0b\u8f7d\u548c\u5b89\u88c5\u7684\u65f6\u5019\u90fd\u6bd4\u8f83\u6162\uff0c\u8bf7\u7a0d\u7b49\u7247\u523b","title":"1.5 \u79bb\u7ebf\u5b89\u88c5\uff08\u6307\u5b9a\u7248\u672c\uff09"},{"location":"tools/gitlab/1.gitlab/#2","text":"","title":"2. \u914d\u7f6e"},{"location":"tools/gitlab/1.gitlab/#21","text":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 external_url \u4e3a\u672c\u673aIP\u5730\u5740 root@k8s4:/etc/gitlab# cp gitlab.rb gitlab.rb.ori root@k8s4:/etc/gitlab# vim /etc/gitlab/gitlab.rb root@k8s4:/etc/gitlab# diff gitlab.rb gitlab.rb.ori 13c13 < external_url 'http://192.168.5.106' --- > external_url 'http://gitlab.example.com # \u53ea\u6709\u4fee\u6539/etc/gitlab/gitlab.rb\u5c31\u8981\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c(\u5176\u4ed6\u5f88\u591a\u6587\u4ef6\u90fd\u4f9d\u8d56\u8fd9\u4e2a\u6587\u4ef6) root@k8s4:/etc/gitlab# gitlab-ctl reconfigure root@k8s4:/etc/gitlab# gitlab-ctl status run: gitaly: (pid 39985) 31s; run: log: (pid 39567) 70s run: gitlab-monitor: (pid 40000) 30s; run: log: (pid 39685) 62s run: gitlab-workhorse: (pid 39972) 31s; run: log: (pid 39470) 80s run: logrotate: (pid 39513) 72s; run: log: (pid 39512) 72s run: nginx: (pid 39490) 78s; run: log: (pid 39489) 78s run: node-exporter: (pid 39664) 64s; run: log: (pid 39663) 64s run: postgres-exporter: (pid 40034) 29s; run: log: (pid 39878) 48s run: postgresql: (pid 39075) 128s; run: log: (pid 39074) 128s run: prometheus: (pid 40010) 30s; run: log: (pid 39787) 54s run: redis: (pid 38976) 134s; run: log: (pid 38975) 134s run: redis-exporter: (pid 39768) 56s; run: log: (pid 39767) 56s run: sidekiq: (pid 39454) 81s; run: log: (pid 39453) 81s run: unicorn: (pid 39383) 87s; run: log: (pid 39382) 87s","title":"2.1 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6"},{"location":"tools/gitlab/1.gitlab/#22","text":"root@k8s4:/etc/gitlab# gitlab-ctl tail","title":"2.2 \u67e5\u770b\u65e5\u5fd7"},{"location":"tools/gitlab/1.gitlab/#23","text":"root@k8s4:/etc/gitlab# cd /var/log/gitlab/","title":"2.3 \u65e5\u5fd7\u8def\u5f84"},{"location":"tools/gitlab/1.gitlab/#24-gitlab","text":"root@k8s4:/var/log/gitlab# ls /var/opt/gitlab/","title":"2.4 gitlab\u6570\u636e"},{"location":"tools/gitlab/1.gitlab/#25-github","text":"root@k8s4:/var/opt/gitlab/backups# pwd /var/opt/gitlab/backups","title":"2.5 github\u5907\u4efd\u6570\u636e"},{"location":"tools/gitlab/1.gitlab/#26","text":"root@k8s4:/opt/gitlab# pwd /opt/gitlab root@k8s4:/opt/gitlab# ll total 1656 drwxr-xr-x 10 root root 4096 Jan 15 16:27 ./ drwxr-xr-x 4 root root 4096 Jan 15 16:21 ../ -rw-r--r-- 1 root root 1460869 Nov 24 2017 LICENSE drwxr-xr-x 2 root root 4096 Jan 15 16:22 LICENSES/ drwxr-xr-x 2 root root 4096 Jan 15 16:22 bin/ -rw-r--r-- 1 root root 157364 Nov 24 2017 dependency_licenses.json drwxr-xr-x 18 root root 4096 Jan 15 16:26 embedded/ drwxr-xr-x 6 root root 4096 Jan 15 16:28 etc/ drwxr-xr-x 2 root root 4096 Jan 15 16:28 init/ drwxr-xr-x 2 root root 4096 Jan 15 16:28 service/ drwxr-xr-x 15 root root 4096 Jan 15 16:28 sv/ drwxr-xr-x 3 root root 4096 Jan 15 16:27 var/ -rw-r--r-- 1 root root 19881 Nov 24 2017 version-manifest.json -rw-r--r-- 1 root root 8696 Nov 24 2017 version-manifest.txt","title":"2.6 \u5b89\u88c5\u540e\u7a0b\u5e8f\u4f4d\u7f6e"},{"location":"tools/gitlab/2.gitlab_close_register/","text":"\u7528\u6237root\u767b\u5f55\u540e \u70b9\u51fb\u6700\u4e0b\u9762\u7684save\uff0c\u7136\u540e\u9000\u51fa\u91cd\u65b0\u767b\u5f55","title":"2. \u5173\u95ed\u6ce8\u518c"},{"location":"tools/gitlab/3.set_root_pwd/","text":"\u65f6\u95f4\u957f\u7a81\u7136\u5fd8\u8bb0\u4e86root\u8d26\u53f7\u7684\u5bc6\u7801\uff0c\u4ee5\u4e0b\u662f\u627e\u56de\u5bc6\u7801\u8fc7\u7a0b \u627e\u56de\u6b65\u9aa4 \u00b6 [root@leco gitlab]# su - git -sh-4.1$ gitlab-rails console production ------------------------------------------------------------------------------------- GitLab: 11.7.5 (c5b5b18) GitLab Shell: 8.4.4 postgresql: 9.6.11 ------------------------------------------------------------------------------------- Loading production environment (Rails 5.0.7.1) irb(main):001:0> user = User.where(id: 1).first # \u786e\u5b9a\u662f\u5426\u662froot\u7528\u6237 => #<User id:1 @root> irb(main):002:0> user.password = 'caimengzhi!\\#@809' # \u8bbe\u7f6e\u767b\u5f55\u8d26\u53f7root\u7684\u5bc6\u7801 => \"caimengzhi!\\#@809\" irb(main):003:0> user.save! Enqueued ActionMailer::DeliveryJob (Job ID: 26a68d46-d3f4-46a1-92c8-79057ec4a13f) to Sidekiq(mailers) with arguments: \"DeviseMailer\", \"password_change\", \"deliver_now\", #<GlobalID:0x00007f225e449bc0 @uri=#<URI::GID gid://gitlab/User/1>> => true irb(main):004:0> exit \u518d\u6b21\u767b\u5f55 \u4f7f\u7528 \u8d26\u53f7: root \u5bc6\u7801: caimengzhi!#@809","title":"3. \u627e\u56deroot\u5bc6\u7801"},{"location":"tools/gitlab/3.set_root_pwd/#_1","text":"[root@leco gitlab]# su - git -sh-4.1$ gitlab-rails console production ------------------------------------------------------------------------------------- GitLab: 11.7.5 (c5b5b18) GitLab Shell: 8.4.4 postgresql: 9.6.11 ------------------------------------------------------------------------------------- Loading production environment (Rails 5.0.7.1) irb(main):001:0> user = User.where(id: 1).first # \u786e\u5b9a\u662f\u5426\u662froot\u7528\u6237 => #<User id:1 @root> irb(main):002:0> user.password = 'caimengzhi!\\#@809' # \u8bbe\u7f6e\u767b\u5f55\u8d26\u53f7root\u7684\u5bc6\u7801 => \"caimengzhi!\\#@809\" irb(main):003:0> user.save! Enqueued ActionMailer::DeliveryJob (Job ID: 26a68d46-d3f4-46a1-92c8-79057ec4a13f) to Sidekiq(mailers) with arguments: \"DeviseMailer\", \"password_change\", \"deliver_now\", #<GlobalID:0x00007f225e449bc0 @uri=#<URI::GID gid://gitlab/User/1>> => true irb(main):004:0> exit \u518d\u6b21\u767b\u5f55 \u4f7f\u7528 \u8d26\u53f7: root \u5bc6\u7801: caimengzhi!#@809","title":"\u627e\u56de\u6b65\u9aa4"},{"location":"tools/script_scriptreplay/1.index/","text":"cript\u547d\u4ee4\u7b80\u4ecb \u5f53\u4f60\u5728\u7ec8\u7aef\u6216\u63a7\u5236\u53f0\u4e0a\u5de5\u4f5c\u65f6\uff0c\u4f60\u53ef\u80fd\u60f3\u8bb0\u5f55\u4e0b\u81ea\u5df1\u505a\u4e86\u4e9b\u4ec0\u4e48\u3002\u8fd9\u79cd\u8bb0\u5f55\u53ef\u4ee5\u770b\u6210\u662f\u4fdd\u5b58\u4e86\u7ec8\u7aef\u75d5\u8ff9\u7684\u6587\u6863\u3002\u5047\u8bbe\u4f60\u8ddf\u4e00\u4e9bLinux\u7ba1\u7406\u5458\u540c\u65f6\u5728\u7cfb\u7edf\u4e0a\u5e72\u6d3b\u3002\u6216\u8005\u8bf4\u4f60\u8ba9\u522b\u4eba\u8fdc\u7a0b\u5230\u4f60\u7684\u670d\u52a1\u5668\u3002\u4f60\u5c31\u4f1a\u60f3\u8bb0\u5f55\u4e0b\u7ec8\u7aef\u53d1\u751f\u8fc7\u4ec0\u4e48\u3002\u8981\u5b9e\u73b0\u5b83\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528script\u547d\u4ee4\u3002 2.1 \u4ec0\u4e48script\u547d\u4ee4 \u00b6 script \u662f\u4e00\u4e2a\u795e\u5947\u547d\u4ee4\uff0c\u53ef\u4ee5\u4f7f\u7528script\u5de5\u5177\u8bb0\u5f55\u7528\u6237\u5728\u5f53\u524d\u7ec8\u7aef\u7684\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u5df2\u7ecf\u8f93\u51fa\u5230\u5c4f\u5e55\u7684\u5185\u5bb9\u3002\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4fdd\u5b58\u5230\u6307\u5b9a\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0cscript\u547d\u4ee4\u5728\u4f60\u9700\u8981\u8bb0\u5f55\u6216\u8005\u5b58\u6863\u7ec8\u7aef\u6d3b\u52a8\u65f6\u53ef\u80fd\u5f88\u6709\u7528\uff0c\u8bb0\u5f55\u6587\u4ef6\u4f1a\u5b58\u50a8\u4e3a\u6587\u672c\u6587\u4ef6\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u3002 \u5728\u4f7f\u7528script\u547d\u4ee4\u5c06\u7ec8\u7aef\u7684\u4f1a\u8bdd\u8fc7\u7a0b\u5f55\u5236\u4e0b\u6765\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 scriptreplay\u5c06\u5176\u5f55\u5236\u7684\u7ed3\u679c\u64ad\u653e\u7ed9\u4ed6\u4eba\u89c2\u770b\u3002 script \u7684\u597d\u5904\u5c31\u5728\u4e8e\u4f60\u5728\u7ec8\u7aef\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u3001\u6572\u8fc7\u7684\u547d\u4ee4\u548c\u6253\u5370\u51fa\u7684\u7ed3\u679c\u5b83\u90fd\u53ef\u4ee5\u539f\u539f\u672c\u672c\u5730\u8fdb\u884c\u5f55\u5236\u3002\u53ef\u4ee5\u5e94\u7528\u4e8e\u6559\u5b66\u3001\u6f14\u793a\u3001\u5ba1\u8ba1\u3002 2.2 script\u547d\u4ee4\u64cd\u4f5c \u00b6 \u4f7f\u7528 script --help \u547d\u4ee4\u6765\u67e5\u770b script\u547d\u4ee4\u7684\u7528\u6cd5 leco@leco:~$ script --help Usage: script [options] [file] Make a typescript of a terminal session. \u9009\u9879\uff1a -a, --append append the output -c, --command <command> run command rather than interactive shell -e, --return return exit code of the child process -f, --flush run flush after each write --force use output file even when it is a link -q, --quiet be quiet -t, --timing[=<file>] output timing data to stderr (or to FILE) -V, --version output version information and exit -h, --help display this help and exit For more details see script(1). \u89e3\u91ca -a\u9009\u9879 \u5728\u73b0\u6709\u8f93\u51fa\u5f55\u5236\u7684\u6587\u4ef6\u7684\u5185\u5bb9\u4e0a\u8ffd\u52a0\u65b0\u7684\u5185\u5bb9 -c\u9009\u9879 \u540e\u9762\u53ef\u4ee5\u52a0\u4e0a\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u662f\u4ea4\u4e92\u5f0fshell\u4e0a\u6267\u884c\u7684\u547d\u4ee4 -r\u9009\u9879 \u5b50\u8fdb\u7a0b\u4e2d\u8fd4\u56de\u9000\u51fa\u4ee3\u7801 -f\u9009\u9879 \u5982\u679c\u9700\u8981\u5728\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\u7684\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 -f \u53c2\u6570\u3002PS:\u53ef\u4ee5\u7528\u4e8e\u6559\u5b66,\u4e24\u4e2a\u547d\u4ee4\u884c\u63a5-f\u53ef\u4ee5\u5b9e\u65f6\u6f14\u793a -q\u9009\u9879 \u53ef\u4ee5\u4f7fscript\u547d\u4ee4\u4ee5\u9759\u9ed8\u6a21\u5f0f\u8fd0\u884c -t\u9009\u9879 \u6307\u660e\u8f93\u51fa\u5f55\u5236\u7684\u65f6\u95f4\u6570\u636e -V\u9009\u9879 \u8f93\u51fascript\u7684\u7248\u672c\u4fe1\u606f\uff0c\u7136\u540e\u9000\u51fa -h\u9009\u9879 \u8f93\u51fascript\u7684help\u4fe1\u606f\uff0c\u7136\u540e\u9000\u51fa [file] \u9009\u9879 1\u3001\u5f53file\u4e3a\u7a7a\u65f6\uff0c\u64cd\u4f5c\u5185\u5bb9\u5c06\u8bb0\u5f55\u5230\u5f53\u524d\u76ee\u5f55\u4e2d\u540d\u79f0\u4e3atypescript\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u3002 root@leco:~/summer# ls # \u4e4b\u524d\u662f\u6ca1\u6709\u6587\u4ef6\u7684 root@leco:~/summer# script # \u542f\u52a8\uff0c\u9ed8\u8ba4\u4fdd\u5b58\u662ftypescript\u6587\u4ef6 \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# exit #\u9000\u51fa exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# ls typescript \u67e5\u770b\u5185\u5bb9 root@leco:~/summer# cat typescript \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f656\u520656\u79d2 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f657\u520603\u79d2 2\u3001\u5982\u679c\u6307\u5b9afile\uff0c\u90a3\u4e48\u5c06\u628a\u7ec8\u7aef\u7684\u64cd\u4f5c\u5185\u5bb9\u8bb0\u5f55\u5230file\u6587\u4ef6\u4e2d\u3002 root@leco:~/summer# rm typescript # \u5220\u9664\u4e4b\u524d\u505a\u5b9e\u9a8c\u7684\u9ed8\u8ba4\u8f93\u51fa\u6587\u4ef6 root@leco:~/summer# ls root@leco:~/summer# script summerout.log # \u6307\u5b9a\u8f93\u51fa\u6587\u4ef6 \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a summerout.log root@leco:~/summer# ls # \u5f00\u59cb\u64cd\u4f5c summerout.log root@leco:~/summer# echo 'my love from summer' my love from summer root@leco:~/summer# exit # \u9000\u51fa exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a summerout.log root@leco:~/summer# ls # \u663e\u793a\u8bb0\u5f55\u7684\u6307\u5b9a\u6587\u4ef6\u5185\u5bb9 summerout.log root@leco:~/summer# cat summerout.log # \u67e5\u770b\u8bb0\u5f55\u7684\u5185\u5bb9\uff0c\u4ee5\u4e0b\u662f\u8bb0\u4fdd\u5b58\u4e86 \u64cd\u4f5c\u5386\u53f2 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f659\u520602\u79d2 root@leco:~/summer# ls summerout.log root@leco:~/summer# echo 'my love from summer' my love from summer root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f659\u520625\u79d2 \u67e5\u770b\u7248\u672c root@leco:~/summer# script -V script\uff0c\u6765\u81ea util-linux 2.27.1 script -q \u9009\u9879 \u9759\u9ed8\u8f93\u51fa #1. \u4e0d\u5e26-q\u7684\u64cd\u4f5c root@leco:~/summer# ls root@leco:~/summer# script \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript # \u6b64\u65f6\u4f1a\u63d0\u793a\u8fd9\u4e2a\u3002\u5e26-q\u5c31\u4e0d\u8f93\u51fa root@leco:~/summer# ls typescript root@leco:~/summer# echo 'hello' hello root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript #2. \u5e26-q\u7684\u64cd\u4f5c root@leco:~/summer# ls typescript root@leco:~/summer# rm typescript root@leco:~/summer# ls root@leco:~/summer# script -q root@leco:~/summer# echo 'hello' hello root@leco:~/summer# exit exit root@leco:~/summer# ls typescript script -a \u9009\u9879 -a\u9009\u9879 \u5728\u73b0\u6709\u8f93\u51fa\u5f55\u5236\u7684\u6587\u4ef6\u7684\u5185\u5bb9\u4e0a\u8ffd\u52a0\u65b0\u7684\u5185\u5bb9 root@leco:~/summer# ls typescript root@leco:~/summer# rm typescript # \u5220\u9664\u4e4b\u524d\u64cd\u4f5c\u5386\u53f2 root@leco:~/summer# ls root@leco:~/summer# script # \u5f00\u59cb\u8bb0\u5f55 \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '345' 345 root@leco:~/summer# exit # \u9000\u51fa exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# ls typescript root@leco:~/summer# cat typescript # \u67e5\u770b\u64cd\u4f5c\u5386\u53f2 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f607\u520656\u79d2 root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '345' 345 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520608\u79d2 # \u4ee5\u4e0a\u90fd\u662f\u7b2c\u4e00\u6b21\u64cd\u4f5c\u7684\u5386\u53f2\u2018 root@leco:~/summer# script -a # \u5f00\u59cb\u7b2c\u4e8c\u6b21\uff0c\u4e5f\u5c31\u662f-a \u5c31\u662f\u8ffd\u52a0\u5185\u5bb9\u5230\u7b2c\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e2d \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c123' \u7b2c\u4e8c\u6b21\u64cd\u4f5c123 root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c456' \u7b2c\u4e8c\u6b21\u64cd\u4f5c456 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# ls typescript root@leco:~/summer# cat typescript \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f607\u520656\u79d2 root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '345' 345 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520608\u79d2 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520620\u79d2 root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c123' \u7b2c\u4e8c\u6b21\u64cd\u4f5c123 root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c456' \u7b2c\u4e8c\u6b21\u64cd\u4f5c456 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520635\u79d2 script -t \u9009\u9879 -t\u9009\u9879 \u6307\u660e\u8f93\u51fa\u5f55\u5236\u7684\u65f6\u95f4\u6570\u636e root@leco:~/summer# ls root@leco:~/summer# script -t 2>datas.time -aq commands.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '456' 456 root@leco:~/summer# exit exit root@leco:~/summer# ls commands.his datas.time root@leco:~/summer# cat commands.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f616\u520638\u79d2 root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '456' 456 root@leco:~/summer# exit exit root@leco:~/summer# cat datas.time 0.016874 44 1.117511 4 0.213036 12 0.189993 8 0.639560 2 0.000082 5 0.000225 44 0.316049 10 0.155868 16 0.388290 12 0.719740 2 0.000032 5 0.000301 44 1.598040 1 0.222087 1 0.368449 1 0.256182 1 0.269758 2 0.000071 6 root@leco:~/summer# \u89e3\u91ca \u9009\u9879-t\u7528\u4e8e\u5b58\u50a8\u65f6\u5e8f\u6587\u4ef6\uff0c\u8fd9\u91cc\u5bfc\u5165\u5230stderr\uff0c\u518d\u91cd\u5b9a\u5411\u5230datas.time\uff0c \u9009\u9879-a\u7528\u4e8e\u5c06\u547d\u4ee4\u8f93\u51fa\u4fe1\u606f\uff0c\u8ffd\u52a0\u5230commands.his\u6587\u4ef6\u3002 \u8fd9\u6837\u5f55\u5236\u89c6\u5c4f\u5c31\u5f88\u65b9\u4fbf\u5566\uff0c\u800c\u4e14\u8fd9\u4e24\u4e2a\u6587\u4ef6\u5f88\u5c0f\uff0c\u53ef\u4ee5\u62f7\u8d1d\u5230\u9700\u8981\u64ad\u653e\u7684\u673a\u5668\u4e0a\u8fdb\u884c\u64ad\u653e\u3002 \u4ee5\u4e0a\u662f\u5f55\u5236\uff0c\u4e0b\u9762\u5f00\u59cb\u56de\u653e\u4e4b\u524d\u64cd\u4f5c # \u56de\u653e\u547d\u4ee4\uff0c\u63a5\u4e0b\u6765\u540e\u9762\u5c31\u50cf\u653e\u7535\u5f71\u4e00\u6837\uff0c\u91cd\u590d\u4f60\u4e4b\u524d\u64cd\u4f5c\uff0c\u81ea\u5df1\u64cd\u4f5c\u4e00\u6ce2\uff0c\u4f53\u4f1a\u6548\u679c root@leco:~/summer# scriptreplay datas.time commands.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '456' 456 root@leco:~/summer# exit exit \u6ce8\u610f: scriptreplay \u540e\u9762\u6570\u636e\u6587\u4ef6\uff0c\u540e\u547d\u4ee4\u6587\u4ef6 script -f \u9009\u9879 -f\u9009\u9879 \u5982\u679c\u9700\u8981\u5728\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\u7684\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 -f \u53c2\u6570\u3002PS:\u53ef\u4ee5\u7528\u4e8e\u6559\u5b66,\u4e24\u4e2a\u547d\u4ee4\u884c\u63a5-f\u53ef\u4ee5\u5b9e\u65f6\u6f14\u793a root@leco:~/summer# ls root@leco:~/summer# script -t 2>datas.time -a commands.his \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a commands.his root@leco:~/summer# echo '\u5f00\u59cb\u6559\u5b66\u4e86' \u5f00\u59cb\u6559\u5b66\u4e86 root@leco:~/summer# script -f \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# echo '\u4f60\u5728\u8ba4\u771f\u770b\u5417' \u4f60\u5728\u8ba4\u771f\u770b\u5417 \u4f7f\u7528script -f \u5b9e\u65f6\u5237\u65b0\u6570\u636e\uff0c\u8bb0\u5f55\u6587\u4ef6\u5206\u522b\u4e3acommands.his\u548cdatas.time script -c \u9009\u9879 -c\u9009\u9879 \u540e\u9762\u53ef\u4ee5\u52a0\u4e0a\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u662f\u4ea4\u4e92\u5f0fshell\u4e0a\u6267\u884c\u7684\u547d\u4ee4 root@leco:~/summer# script -a \"commands.his\" -c \"ifconfig|grep 192.168.5.110\" \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a commands.his inet \u5730\u5740:192.168.5.110 \u5e7f\u64ad:192.168.5.255 \u63a9\u7801:255.255.255.0 \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a commands.his root@leco:~/summer# exit exit root@leco:~/summer# ls commands.his root@leco:~/summer# cat commands.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f634\u520658\u79d2 inet \u5730\u5740:192.168.5.110 \u5e7f\u64ad:192.168.5.255 \u63a9\u7801:255.255.255.0 \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f634\u520658\u79d2 2.3 \u9000\u51fascript \u00b6 \u8981\u9000\u51fa\u8bb0\u5f55\u6d3b\u52a8\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e2d\u6309\u4e0bCtrl+D\uff0c\u6216\u8005\u8f93\u5165exit\u3002\u5728\u9000\u51fascript\u524d\uff0c\u4f60\u4f1a\u53d1\u73b0\u8bb0\u5f55\u6587\u4ef6\u7684\u5927\u5c0f\u4e3a0 Kb\uff0c\u800c\u5728\u9000\u51fa\u4e4b\u540e\uff0c\u6587\u4ef6\u5927\u5c0f\u4f1a\u53d1\u751f\u6539\u53d8\u3002 \u8bb0\u5f55\u5386\u53f2\u7684\u6587\u4ef6\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u90fd\u662f0\u5b57\u8282\uff0c\u9000\u51fa\u7684\u65f6\u5019\u624d\u5199\u5165\u8be5\u6587\u4ef6\u3002 root@leco:~/summer# script exit.his \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a exit.his root@leco:~/summer# ls exit.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# echo '12312' 12312 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a exit.his root@leco:~/summer# du -sh exit.his 4.0K exit.his root@leco:~/summer# cat exit.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f637\u520644\u79d2 root@leco:~/summer# ls exit.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# echo '12312' 12312 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f638\u520605\u79d2 \u4e09\u3001Script\u547d\u4ee4\u7ed3\u5408\u5b9e\u9645\u4f7f\u7528\u573a\u666f \u00b6 3.1 \u6848\u4f8b1 \u5b9a\u65f6\u5907\u4efd \u00b6 \u5148\u5728\u7ec8\u7aef\u6267\u884cscript\u547d\u4ee4\u8bb0\u5f55scp\u547d\u4ee4\u8fc7\u7a0b\uff0c\u5148\u5728\u7ec8\u7aef\u6572\u4e2a\u547d\u4ee4 script datas.his -c 'sh for.sh' \u6211\u662f\u8bb0\u5f55\u6211\u811a\u672c\u7684\u6267\u884c\u8fc7\u7a0b\u7684\u8bb0\u5f55\u3002 root@leco:~/summer# ls for.sh root@leco:~/summer# cat for.sh for((i=0;i<10;i++)) do echo $i done root@leco:~/summer# script datas.his -c 'sh for.sh' \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a datas.his 0 1 2 3 4 5 6 7 8 9 \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a datas.his root@leco:~/summer# ls datas.his for.sh root@leco:~/summer# cat datas.his # \u67e5\u770b\u5386\u53f2\u8bb0\u5f55 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f641\u520652\u79d2 0 1 2 3 4 5 6 7 8 9 \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f641\u520652\u79d2 script\u8bb0\u5f55\u6574\u4e2a\u8fc7\u7a0b\u7ed3\u675f\u3002 \u4ece\u7ed3\u679c\u6765\u770b\uff0c\u6574\u4e2a\u8fc7\u7a0b\u4f7f\u7528script\u547d\u4ee4\u8bb0\u5f55\u662f\u6ca1\u6709\u95ee\u9898\u7684 \u770b\u4e0b\u4ee5\u4e0b\u5b9e\u4f8b auto_backup_to_remote.sh #!/bin/bash # gitlab \u673a\u623f\u5907\u4efd\u8def\u5f84 LocalBackDir=/data/gitlabData/backups # \u8fdc\u7a0b\u5907\u4efd\u670d\u52a1\u5668(FTP\u670d\u52a1\u5668) gitlab\u5907\u4efd\u6587\u4ef6\u5b58\u653e\u8def\u5f84 RemoteBackDir=/data/gitlabDataBackup # \u8fdc\u7a0b\u5907\u4efd\u670d\u52a1\u5668 \u767b\u5f55\u8d26\u6237 RemoteUser=root # \u8fdc\u7a0b\u673a\u623f\u4ee3\u7801\u5907\u4efd\u670d\u52a1\u5668IP\u5730\u5740 RemoteIP1=\u8fdc\u7a0b\u670d\u52a1\u5668IP\u5730\u5740 #\u5f53\u524d\u7cfb\u7edf\u65e5\u671f DATE=`date +\"%Y-%m-%d\"` #Log\u5b58\u653e\u8def\u5f84 LogFile=$LocalBackDir/log/$DATE.log #\u90ae\u4ef6\u5199\u5165\u7684\u6587\u4ef6 mailcontent=$LocalBackDir/mail/mailcontent_$DATE mailToUser=ouyangpeng\u7684\u90ae\u7bb1 mailToUser1=\u9886\u5bfc1\u7684\u90ae\u7bb1 mailToUser2=\u9886\u5bfc2\u7684\u90ae\u7bb1 #\u65b0\u5efa\u65e5\u5fd7\u6587\u4ef6 touch $LogFile #\u8ffd\u52a0\u65e5\u5fd7\u5230\u65e5\u5fd7\u6587\u4ef6 echo \"Gitlab auto backup to remote server, start at $(date +\"%Y-%m-%d %H:%M:%S\")\" > $LogFile echo \"---------------------------------------------------------------------------\" >> $LogFile # \u67e5\u627e \u672c\u5730\u5907\u4efd\u76ee\u5f55\u4e0b \u65f6\u95f4\u4e3a180\u5206\u949f\u4e4b\u5185\u7684\uff0c\u5e76\u4e14\u540e\u7f00\u4e3a.tar\u7684gitlab\u5907\u4efd\u6587\u4ef6 BACKUPFILE_SEND_TO_REMOTE=$(find /data/gitlabData/backups -type f -mmin -180 -name '*.tar*') # \u8f93\u51fa\u65e5\u5fd7\uff0c\u6253\u5370\u51fa\u6bcf\u6b21scp\u7684\u6587\u4ef6\u540d echo \"---------------------The file to scp to remote server is: $BACKUPFILE_SEND_TO_REMOTE-------------------------------\" >> $LogFile #\u5907\u4efd\u5230 \u8fdc\u7a0b\u673a\u623f\u4ee3\u7801\u5907\u4efd\u670d\u52a1\u5668 scp -v $BACKUPFILE_SEND_TO_REMOTE $RemoteUser@$RemoteIP1:$RemoteBackDir # $?\u7b26\u53f7\u663e\u793a\u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u8fd4\u56de\u503c\uff0c\u5982\u679c\u4e3a0\u5219\u4ee3\u8868\u6267\u884c\u6210\u529f\uff0c\u5176\u4ed6\u8868\u793a\u5931\u8d25 if [ $? -eq 0 ];then #\u8ffd\u52a0\u65e5\u5fd7\u5230\u65e5\u5fd7\u6587\u4ef6 echo \"-----------------------------------Success!----------------------------------------\" >> $LogFile echo \"Gitlab auto backup to remote server, end at $(date +\"%Y-%m-%d %H:%M:%S\")\" >> $LogFile #\u5199Email\u7684\u6b63\u6587\u5185\u5bb9 > \"$mailcontent\" echo \"GitLab Backup Daily Report, backup to remote server Success ! Please Check your Email and read the following log file\" >> $mailcontent #\u8bfb\u53d6mailcontent\u5185\u5bb9\u5f53\u505a\u90ae\u4ef6\u6b63\u6587 \uff0c\u9644\u4ef6\u4e3aLog\u6587\u4ef6 #cat $mailcontent | mail -s \"Congratulation! GitLab backup to remote server Success Report.\" -t $mailToUser $mailToUser1 $mailToUser2 -A $LogFile #\u6210\u529f\u7684\u8bdd\uff0c\u53ea\u53d1\u9001\u7ed9\u6211\u4e00\u4e2a\u4eba\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u53d1\u9001\u7ed9\u5176\u4ed6\u4eba cat $mailcontent | mail -s \"Congratulation! GitLab backup to remote server Success Report.\" $mailToUser -A $LogFile else #\u8ffd\u52a0\u65e5\u5fd7\u5230\u65e5\u5fd7\u6587\u4ef6 echo \"-----------------------------------Failed!---------------------------------------\" >> $LogFile echo \"Gitlab auto backup to remote server failed at $(date +\"%Y-%m-%d %H:%M:%S\")\" >> $LogFile #\u5199Email\u7684\u6b63\u6587\u5185\u5bb9 > \"$mailcontent\" echo \"GitLab Backup Daily Report,Backup to remote server Failed ! Please Check your Email and read the following log file !\" >> $mailcontent #\u8bfb\u53d6mailcontent\u5185\u5bb9\u5f53\u505a\u90ae\u4ef6\u6b63\u6587 \uff0c\u9644\u4ef6\u4e3aLog\u6587\u4ef6 cat $mailcontent | mail -s \"Warning! GitLab Backup to remote server Failed Report.\" -t $mailToUser $mailToUser1 $mailToUser2 -A $LogFile fi auto_backup_to_remote_script.sh*\u6587\u4ef6\u6e90\u4ee3\u7801\u662f #!/bin/bash # gitlab \u673a\u623f\u5907\u4efd\u8def\u5f84 LocalBackDir=/data/gitlabData/backups #\u5f53\u524d\u7cfb\u7edf\u65e5\u671f DATE=`date +\"%Y-%m-%d\"` #Log\u5b58\u653e\u8def\u5f84 LogFile=$LocalBackDir/log/$DATE.log #Script\u547d\u4ee4\u8bb0\u5f55\u7684\u5b58\u653e\u8def\u5f84\u548c\u6587\u4ef6\u540d ScriptLogFile=$LocalBackDir/script_log/$DATE.log ScriptTimeFile=$LocalBackDir/script_log/$DATE.date #\u65b0\u5efa\u65e5\u5fd7\u6587\u4ef6 touch $ScriptLogFile touch $ScriptTimeFile #\u5f00\u59cb\u542f\u52a8script\u8bb0\u5f55\u6574\u4e2a\u8fc7\u7a0b\uff0c\u6267\u884c /data/gitlabData/backups/auto_backup_to_remote.sh \u811a\u672c script -a $ScriptLogFile -c\"/data/gitlabData/backups/auto_backup_to_remote.sh\" \u8fd9\u6837\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u5c06\u539f\u6765\u7684\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u7684\u811a\u672c\u6587\u4ef6\u4fee\u6539\u4e0b\u5373\u53ef\u3002 crontab -e # edited by summer 2019-01-23 \u6dfb\u52a0\u5b9a\u65f6\u4efb\u52a1\uff0c\u6bcf\u5929\u51cc\u66681\u70b9\uff0c\u6267\u884cgitlab\u5907\u4efd\u5230\u8fdc\u7a0b\u670d\u52a1\u5668 0 1 * * * /bin/bash /scripts/gitlab/auto_backup_to_remote_script.sh 3.2 \u6848\u4f8b2 \u670d\u52a1\u5668\u5b89\u5168\u5ba1\u8ba1 \u00b6 \u76f4\u63a5\u64cd\u4f5c\u7ebf\u4e0a\u7684\u670d\u52a1\u5668\u6709\u5f88\u5927\u9690\u60a3\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u767b\u5f55\u8df3\u677f\u673a\uff0c\u7136\u540e\u8fde\u63a5\u7ebf\u4e0a\u670d\u52a1\u5668\uff0c\u8df3\u677f\u673a\u53ef\u4ee5\u8bbf\u95ee\u63a7\u5236\u548c\u5b89\u5168\u5ba1\u8ba1\uff0c\u67e5\u770b\u8bb0\u5f55\u6bcf\u4e2a\u4eba\u5bf9\u7ebf\u4e0a\u670d\u52a1\u5668\u7684\u64cd\u4f5c \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b,\u4fee\u6539\u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u5f97\u7528\u6237\u767b\u5f55\u5c31\u4f1a\u89e6\u53d1\u5f55\u50cf root@leco:/datas/commands# tail -1 /etc/profile script -t -f -q 2>/datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.time -a /datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.his root@leco:/datas/commands# chmod 777 /datas/commands/ root@leco:/datas/commands# ls root@leco:/datas/commands# \u6b64\u65f6\u8fd8\u6ca1\u6709\u65e5\u5fd7\uff0c\u63a5\u4e0b\u6765\uff0c\u91cd\u65b0\u767b\u5f55\u7528\u6237 \u6d4b\u8bd5\u767b\u5f55 \u65b0\u5f00\u4e00\u4e2a\u7ec8\u7aef *** \u9700\u8981\u91cd\u542f\u7cfb\u7edf *** Last login: Wed Jan 23 11:03:09 2019 from 192.168.5.1 leco@leco:~$ ip a|grep 192.168.5. inet 192.168.5.110/24 brd 192.168.5.255 scope global enp3s0 leco@leco:~$ echo 'hello' hello \u5728\u770b\u4fdd\u5b58\u7684\u6587\u4ef6 leco@leco:~$ root@leco:/datas/commands# ls leco-1000-20190123110350.his leco-1000-20190123110350.time # 1. \u5355\u72ec\u67e5\u770b \u547d\u4ee4\u5386\u53f2 root@leco:/datas/commands# cat leco-1000-20190123110350.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 11\u65f603\u520650\u79d2 leco@leco:~$ ip a|grep 192.168.5. inet 192.168.5.110/24 brd 192.168.5.255 scope global enp3s0 leco@leco:~$ echo 'hello' hello # \u67e5\u770b\u52a8\u6001\u5386\u53f2 root@leco:/datas/commands# scriptreplay leco-1000-20190123110350.time leco-1000-20190123110350.his leco@leco:~$ ip a|grep 192.168.5. inet 192.168.5.110/24 brd 192.168.5.255 scope global enp3s0 leco@leco:~$ echo 'hello' hello leco@leco:~$ \u81ea\u5df1\u64cd\u4f5c\uff0c\u67e5\u770b\u6548\u679c \u8fd9\u6837\u641e\u5b8c\u540e\uff0c\u53d1\u73b0\u6709\u4e00\u4e2a\u95ee\u9898\u662f\u6bcf\u6b21\u9000\u51fa\uff0c\u6211\u4e60\u60efCtrl+D\uff0c\u7136\u540e\u6309\u7b2c\u4e00\u904d\u505c\u6b62\u5f55\u50cf\uff0c\u7b2c\u4e8c\u904d\u624d\u80fd\u7528\u6237\u9000\u51fa\uff0c\u5982\u4f55\u89e3\u51b3\u5728\u540e\u9762\u6dfb\u52a0 if [ \"$SHLVL\" = 1 ]; then \u3000\u3000\u3000\u3000exit fi \u5b8c\u6574\u7248 root@leco:/datas/commands# tail -4 /etc/profile script -t -f -q 2>/datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.time -a /datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.his if [ \"$SHLVL\" = 1 ]; then exit fi \u8fd9\u6837\u5c31\u53ef\u4ee5\u4e00\u904dCtrl+D\u505c\u6b62\u5f55\u50cf\u548c\u9000\u51fa\u7528\u6237\u3002 \u533a\u522b SHLVL \u8fd9\u4e2a\u53d8\u91cf\u662f\u5e72\u4ec0\u4e48\u7684\uff1f shell\u4e2d\u7684 $SHLVL ,\u8bb0\u5f55\u5f53\u524dshell\u7684\u5d4c\u5957\u5c42\u6b21\uff0c\u521d\u59cb\u4e3a1 \u6bd4\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a\u5f53\u524d\u662f\u5728\u7b2c1\u5c42\uff0c\u6267\u884cbash\u547d\u4ee4\u4e4b\u540e\uff0c $SHLVL \u53d8\u91cf\u53d8\u4e3a2 root@leco:/datas/commands# echo $SHLVL 1 root@leco:/datas/commands# bash root@leco:/datas/commands# echo $SHLVL 2 root@leco:/datas/commands# exit exit root@leco:/datas/commands# echo $SHLVL 1 \u4e0d\u77e5\u9053\u7684\u8bdd\uff0c\u53bb\u767e\u5ea6 SHLVL \u548c BASH_SUBSHELL \u4e24\u4e2a\u53d8\u91cf\u7684\u533a\u522b SHLVL \u548c BASH_SUBSHELL \u4e24\u4e2a\u53d8\u91cf\u7684\u533a\u522b\u53c2\u8003\u94fe\u63a5","title":"3. Linux\u7ec8\u7aef\u5f55\u5c4f\u548c\u56de\u653e"},{"location":"tools/script_scriptreplay/1.index/#21-script","text":"script \u662f\u4e00\u4e2a\u795e\u5947\u547d\u4ee4\uff0c\u53ef\u4ee5\u4f7f\u7528script\u5de5\u5177\u8bb0\u5f55\u7528\u6237\u5728\u5f53\u524d\u7ec8\u7aef\u7684\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u5df2\u7ecf\u8f93\u51fa\u5230\u5c4f\u5e55\u7684\u5185\u5bb9\u3002\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4fdd\u5b58\u5230\u6307\u5b9a\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0cscript\u547d\u4ee4\u5728\u4f60\u9700\u8981\u8bb0\u5f55\u6216\u8005\u5b58\u6863\u7ec8\u7aef\u6d3b\u52a8\u65f6\u53ef\u80fd\u5f88\u6709\u7528\uff0c\u8bb0\u5f55\u6587\u4ef6\u4f1a\u5b58\u50a8\u4e3a\u6587\u672c\u6587\u4ef6\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u3002 \u5728\u4f7f\u7528script\u547d\u4ee4\u5c06\u7ec8\u7aef\u7684\u4f1a\u8bdd\u8fc7\u7a0b\u5f55\u5236\u4e0b\u6765\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 scriptreplay\u5c06\u5176\u5f55\u5236\u7684\u7ed3\u679c\u64ad\u653e\u7ed9\u4ed6\u4eba\u89c2\u770b\u3002 script \u7684\u597d\u5904\u5c31\u5728\u4e8e\u4f60\u5728\u7ec8\u7aef\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u3001\u6572\u8fc7\u7684\u547d\u4ee4\u548c\u6253\u5370\u51fa\u7684\u7ed3\u679c\u5b83\u90fd\u53ef\u4ee5\u539f\u539f\u672c\u672c\u5730\u8fdb\u884c\u5f55\u5236\u3002\u53ef\u4ee5\u5e94\u7528\u4e8e\u6559\u5b66\u3001\u6f14\u793a\u3001\u5ba1\u8ba1\u3002","title":"2.1 \u4ec0\u4e48script\u547d\u4ee4"},{"location":"tools/script_scriptreplay/1.index/#22-script","text":"\u4f7f\u7528 script --help \u547d\u4ee4\u6765\u67e5\u770b script\u547d\u4ee4\u7684\u7528\u6cd5 leco@leco:~$ script --help Usage: script [options] [file] Make a typescript of a terminal session. \u9009\u9879\uff1a -a, --append append the output -c, --command <command> run command rather than interactive shell -e, --return return exit code of the child process -f, --flush run flush after each write --force use output file even when it is a link -q, --quiet be quiet -t, --timing[=<file>] output timing data to stderr (or to FILE) -V, --version output version information and exit -h, --help display this help and exit For more details see script(1). \u89e3\u91ca -a\u9009\u9879 \u5728\u73b0\u6709\u8f93\u51fa\u5f55\u5236\u7684\u6587\u4ef6\u7684\u5185\u5bb9\u4e0a\u8ffd\u52a0\u65b0\u7684\u5185\u5bb9 -c\u9009\u9879 \u540e\u9762\u53ef\u4ee5\u52a0\u4e0a\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u662f\u4ea4\u4e92\u5f0fshell\u4e0a\u6267\u884c\u7684\u547d\u4ee4 -r\u9009\u9879 \u5b50\u8fdb\u7a0b\u4e2d\u8fd4\u56de\u9000\u51fa\u4ee3\u7801 -f\u9009\u9879 \u5982\u679c\u9700\u8981\u5728\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\u7684\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 -f \u53c2\u6570\u3002PS:\u53ef\u4ee5\u7528\u4e8e\u6559\u5b66,\u4e24\u4e2a\u547d\u4ee4\u884c\u63a5-f\u53ef\u4ee5\u5b9e\u65f6\u6f14\u793a -q\u9009\u9879 \u53ef\u4ee5\u4f7fscript\u547d\u4ee4\u4ee5\u9759\u9ed8\u6a21\u5f0f\u8fd0\u884c -t\u9009\u9879 \u6307\u660e\u8f93\u51fa\u5f55\u5236\u7684\u65f6\u95f4\u6570\u636e -V\u9009\u9879 \u8f93\u51fascript\u7684\u7248\u672c\u4fe1\u606f\uff0c\u7136\u540e\u9000\u51fa -h\u9009\u9879 \u8f93\u51fascript\u7684help\u4fe1\u606f\uff0c\u7136\u540e\u9000\u51fa [file] \u9009\u9879 1\u3001\u5f53file\u4e3a\u7a7a\u65f6\uff0c\u64cd\u4f5c\u5185\u5bb9\u5c06\u8bb0\u5f55\u5230\u5f53\u524d\u76ee\u5f55\u4e2d\u540d\u79f0\u4e3atypescript\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u3002 root@leco:~/summer# ls # \u4e4b\u524d\u662f\u6ca1\u6709\u6587\u4ef6\u7684 root@leco:~/summer# script # \u542f\u52a8\uff0c\u9ed8\u8ba4\u4fdd\u5b58\u662ftypescript\u6587\u4ef6 \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# exit #\u9000\u51fa exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# ls typescript \u67e5\u770b\u5185\u5bb9 root@leco:~/summer# cat typescript \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f656\u520656\u79d2 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f657\u520603\u79d2 2\u3001\u5982\u679c\u6307\u5b9afile\uff0c\u90a3\u4e48\u5c06\u628a\u7ec8\u7aef\u7684\u64cd\u4f5c\u5185\u5bb9\u8bb0\u5f55\u5230file\u6587\u4ef6\u4e2d\u3002 root@leco:~/summer# rm typescript # \u5220\u9664\u4e4b\u524d\u505a\u5b9e\u9a8c\u7684\u9ed8\u8ba4\u8f93\u51fa\u6587\u4ef6 root@leco:~/summer# ls root@leco:~/summer# script summerout.log # \u6307\u5b9a\u8f93\u51fa\u6587\u4ef6 \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a summerout.log root@leco:~/summer# ls # \u5f00\u59cb\u64cd\u4f5c summerout.log root@leco:~/summer# echo 'my love from summer' my love from summer root@leco:~/summer# exit # \u9000\u51fa exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a summerout.log root@leco:~/summer# ls # \u663e\u793a\u8bb0\u5f55\u7684\u6307\u5b9a\u6587\u4ef6\u5185\u5bb9 summerout.log root@leco:~/summer# cat summerout.log # \u67e5\u770b\u8bb0\u5f55\u7684\u5185\u5bb9\uff0c\u4ee5\u4e0b\u662f\u8bb0\u4fdd\u5b58\u4e86 \u64cd\u4f5c\u5386\u53f2 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f659\u520602\u79d2 root@leco:~/summer# ls summerout.log root@leco:~/summer# echo 'my love from summer' my love from summer root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 09\u65f659\u520625\u79d2 \u67e5\u770b\u7248\u672c root@leco:~/summer# script -V script\uff0c\u6765\u81ea util-linux 2.27.1 script -q \u9009\u9879 \u9759\u9ed8\u8f93\u51fa #1. \u4e0d\u5e26-q\u7684\u64cd\u4f5c root@leco:~/summer# ls root@leco:~/summer# script \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript # \u6b64\u65f6\u4f1a\u63d0\u793a\u8fd9\u4e2a\u3002\u5e26-q\u5c31\u4e0d\u8f93\u51fa root@leco:~/summer# ls typescript root@leco:~/summer# echo 'hello' hello root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript #2. \u5e26-q\u7684\u64cd\u4f5c root@leco:~/summer# ls typescript root@leco:~/summer# rm typescript root@leco:~/summer# ls root@leco:~/summer# script -q root@leco:~/summer# echo 'hello' hello root@leco:~/summer# exit exit root@leco:~/summer# ls typescript script -a \u9009\u9879 -a\u9009\u9879 \u5728\u73b0\u6709\u8f93\u51fa\u5f55\u5236\u7684\u6587\u4ef6\u7684\u5185\u5bb9\u4e0a\u8ffd\u52a0\u65b0\u7684\u5185\u5bb9 root@leco:~/summer# ls typescript root@leco:~/summer# rm typescript # \u5220\u9664\u4e4b\u524d\u64cd\u4f5c\u5386\u53f2 root@leco:~/summer# ls root@leco:~/summer# script # \u5f00\u59cb\u8bb0\u5f55 \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '345' 345 root@leco:~/summer# exit # \u9000\u51fa exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# ls typescript root@leco:~/summer# cat typescript # \u67e5\u770b\u64cd\u4f5c\u5386\u53f2 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f607\u520656\u79d2 root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '345' 345 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520608\u79d2 # \u4ee5\u4e0a\u90fd\u662f\u7b2c\u4e00\u6b21\u64cd\u4f5c\u7684\u5386\u53f2\u2018 root@leco:~/summer# script -a # \u5f00\u59cb\u7b2c\u4e8c\u6b21\uff0c\u4e5f\u5c31\u662f-a \u5c31\u662f\u8ffd\u52a0\u5185\u5bb9\u5230\u7b2c\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e2d \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c123' \u7b2c\u4e8c\u6b21\u64cd\u4f5c123 root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c456' \u7b2c\u4e8c\u6b21\u64cd\u4f5c456 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# ls typescript root@leco:~/summer# cat typescript \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f607\u520656\u79d2 root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '345' 345 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520608\u79d2 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520620\u79d2 root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c123' \u7b2c\u4e8c\u6b21\u64cd\u4f5c123 root@leco:~/summer# echo '\u7b2c\u4e8c\u6b21\u64cd\u4f5c456' \u7b2c\u4e8c\u6b21\u64cd\u4f5c456 root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f608\u520635\u79d2 script -t \u9009\u9879 -t\u9009\u9879 \u6307\u660e\u8f93\u51fa\u5f55\u5236\u7684\u65f6\u95f4\u6570\u636e root@leco:~/summer# ls root@leco:~/summer# script -t 2>datas.time -aq commands.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '456' 456 root@leco:~/summer# exit exit root@leco:~/summer# ls commands.his datas.time root@leco:~/summer# cat commands.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f616\u520638\u79d2 root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '456' 456 root@leco:~/summer# exit exit root@leco:~/summer# cat datas.time 0.016874 44 1.117511 4 0.213036 12 0.189993 8 0.639560 2 0.000082 5 0.000225 44 0.316049 10 0.155868 16 0.388290 12 0.719740 2 0.000032 5 0.000301 44 1.598040 1 0.222087 1 0.368449 1 0.256182 1 0.269758 2 0.000071 6 root@leco:~/summer# \u89e3\u91ca \u9009\u9879-t\u7528\u4e8e\u5b58\u50a8\u65f6\u5e8f\u6587\u4ef6\uff0c\u8fd9\u91cc\u5bfc\u5165\u5230stderr\uff0c\u518d\u91cd\u5b9a\u5411\u5230datas.time\uff0c \u9009\u9879-a\u7528\u4e8e\u5c06\u547d\u4ee4\u8f93\u51fa\u4fe1\u606f\uff0c\u8ffd\u52a0\u5230commands.his\u6587\u4ef6\u3002 \u8fd9\u6837\u5f55\u5236\u89c6\u5c4f\u5c31\u5f88\u65b9\u4fbf\u5566\uff0c\u800c\u4e14\u8fd9\u4e24\u4e2a\u6587\u4ef6\u5f88\u5c0f\uff0c\u53ef\u4ee5\u62f7\u8d1d\u5230\u9700\u8981\u64ad\u653e\u7684\u673a\u5668\u4e0a\u8fdb\u884c\u64ad\u653e\u3002 \u4ee5\u4e0a\u662f\u5f55\u5236\uff0c\u4e0b\u9762\u5f00\u59cb\u56de\u653e\u4e4b\u524d\u64cd\u4f5c # \u56de\u653e\u547d\u4ee4\uff0c\u63a5\u4e0b\u6765\u540e\u9762\u5c31\u50cf\u653e\u7535\u5f71\u4e00\u6837\uff0c\u91cd\u590d\u4f60\u4e4b\u524d\u64cd\u4f5c\uff0c\u81ea\u5df1\u64cd\u4f5c\u4e00\u6ce2\uff0c\u4f53\u4f1a\u6548\u679c root@leco:~/summer# scriptreplay datas.time commands.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# echo '456' 456 root@leco:~/summer# exit exit \u6ce8\u610f: scriptreplay \u540e\u9762\u6570\u636e\u6587\u4ef6\uff0c\u540e\u547d\u4ee4\u6587\u4ef6 script -f \u9009\u9879 -f\u9009\u9879 \u5982\u679c\u9700\u8981\u5728\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\u7684\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 -f \u53c2\u6570\u3002PS:\u53ef\u4ee5\u7528\u4e8e\u6559\u5b66,\u4e24\u4e2a\u547d\u4ee4\u884c\u63a5-f\u53ef\u4ee5\u5b9e\u65f6\u6f14\u793a root@leco:~/summer# ls root@leco:~/summer# script -t 2>datas.time -a commands.his \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a commands.his root@leco:~/summer# echo '\u5f00\u59cb\u6559\u5b66\u4e86' \u5f00\u59cb\u6559\u5b66\u4e86 root@leco:~/summer# script -f \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a typescript root@leco:~/summer# echo '\u4f60\u5728\u8ba4\u771f\u770b\u5417' \u4f60\u5728\u8ba4\u771f\u770b\u5417 \u4f7f\u7528script -f \u5b9e\u65f6\u5237\u65b0\u6570\u636e\uff0c\u8bb0\u5f55\u6587\u4ef6\u5206\u522b\u4e3acommands.his\u548cdatas.time script -c \u9009\u9879 -c\u9009\u9879 \u540e\u9762\u53ef\u4ee5\u52a0\u4e0a\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u662f\u4ea4\u4e92\u5f0fshell\u4e0a\u6267\u884c\u7684\u547d\u4ee4 root@leco:~/summer# script -a \"commands.his\" -c \"ifconfig|grep 192.168.5.110\" \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a commands.his inet \u5730\u5740:192.168.5.110 \u5e7f\u64ad:192.168.5.255 \u63a9\u7801:255.255.255.0 \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a commands.his root@leco:~/summer# exit exit root@leco:~/summer# ls commands.his root@leco:~/summer# cat commands.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f634\u520658\u79d2 inet \u5730\u5740:192.168.5.110 \u5e7f\u64ad:192.168.5.255 \u63a9\u7801:255.255.255.0 \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f634\u520658\u79d2","title":"2.2 script\u547d\u4ee4\u64cd\u4f5c"},{"location":"tools/script_scriptreplay/1.index/#23-script","text":"\u8981\u9000\u51fa\u8bb0\u5f55\u6d3b\u52a8\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e2d\u6309\u4e0bCtrl+D\uff0c\u6216\u8005\u8f93\u5165exit\u3002\u5728\u9000\u51fascript\u524d\uff0c\u4f60\u4f1a\u53d1\u73b0\u8bb0\u5f55\u6587\u4ef6\u7684\u5927\u5c0f\u4e3a0 Kb\uff0c\u800c\u5728\u9000\u51fa\u4e4b\u540e\uff0c\u6587\u4ef6\u5927\u5c0f\u4f1a\u53d1\u751f\u6539\u53d8\u3002 \u8bb0\u5f55\u5386\u53f2\u7684\u6587\u4ef6\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u90fd\u662f0\u5b57\u8282\uff0c\u9000\u51fa\u7684\u65f6\u5019\u624d\u5199\u5165\u8be5\u6587\u4ef6\u3002 root@leco:~/summer# script exit.his \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a exit.his root@leco:~/summer# ls exit.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# echo '12312' 12312 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a exit.his root@leco:~/summer# du -sh exit.his 4.0K exit.his root@leco:~/summer# cat exit.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f637\u520644\u79d2 root@leco:~/summer# ls exit.his root@leco:~/summer# echo '123' 123 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# echo '12312' 12312 root@leco:~/summer# du -sh exit.his 0 exit.his root@leco:~/summer# exit exit \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f638\u520605\u79d2","title":"2.3 \u9000\u51fascript"},{"location":"tools/script_scriptreplay/1.index/#script","text":"","title":"\u4e09\u3001Script\u547d\u4ee4\u7ed3\u5408\u5b9e\u9645\u4f7f\u7528\u573a\u666f"},{"location":"tools/script_scriptreplay/1.index/#31-1","text":"\u5148\u5728\u7ec8\u7aef\u6267\u884cscript\u547d\u4ee4\u8bb0\u5f55scp\u547d\u4ee4\u8fc7\u7a0b\uff0c\u5148\u5728\u7ec8\u7aef\u6572\u4e2a\u547d\u4ee4 script datas.his -c 'sh for.sh' \u6211\u662f\u8bb0\u5f55\u6211\u811a\u672c\u7684\u6267\u884c\u8fc7\u7a0b\u7684\u8bb0\u5f55\u3002 root@leco:~/summer# ls for.sh root@leco:~/summer# cat for.sh for((i=0;i<10;i++)) do echo $i done root@leco:~/summer# script datas.his -c 'sh for.sh' \u811a\u672c\u5df2\u542f\u52a8\uff0c\u6587\u4ef6\u4e3a datas.his 0 1 2 3 4 5 6 7 8 9 \u811a\u672c\u5b8c\u6210\uff0c\u6587\u4ef6\u4e3a datas.his root@leco:~/summer# ls datas.his for.sh root@leco:~/summer# cat datas.his # \u67e5\u770b\u5386\u53f2\u8bb0\u5f55 \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f641\u520652\u79d2 0 1 2 3 4 5 6 7 8 9 \u811a\u672c\u5b8c\u6210\uff0c\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 10\u65f641\u520652\u79d2 script\u8bb0\u5f55\u6574\u4e2a\u8fc7\u7a0b\u7ed3\u675f\u3002 \u4ece\u7ed3\u679c\u6765\u770b\uff0c\u6574\u4e2a\u8fc7\u7a0b\u4f7f\u7528script\u547d\u4ee4\u8bb0\u5f55\u662f\u6ca1\u6709\u95ee\u9898\u7684 \u770b\u4e0b\u4ee5\u4e0b\u5b9e\u4f8b auto_backup_to_remote.sh #!/bin/bash # gitlab \u673a\u623f\u5907\u4efd\u8def\u5f84 LocalBackDir=/data/gitlabData/backups # \u8fdc\u7a0b\u5907\u4efd\u670d\u52a1\u5668(FTP\u670d\u52a1\u5668) gitlab\u5907\u4efd\u6587\u4ef6\u5b58\u653e\u8def\u5f84 RemoteBackDir=/data/gitlabDataBackup # \u8fdc\u7a0b\u5907\u4efd\u670d\u52a1\u5668 \u767b\u5f55\u8d26\u6237 RemoteUser=root # \u8fdc\u7a0b\u673a\u623f\u4ee3\u7801\u5907\u4efd\u670d\u52a1\u5668IP\u5730\u5740 RemoteIP1=\u8fdc\u7a0b\u670d\u52a1\u5668IP\u5730\u5740 #\u5f53\u524d\u7cfb\u7edf\u65e5\u671f DATE=`date +\"%Y-%m-%d\"` #Log\u5b58\u653e\u8def\u5f84 LogFile=$LocalBackDir/log/$DATE.log #\u90ae\u4ef6\u5199\u5165\u7684\u6587\u4ef6 mailcontent=$LocalBackDir/mail/mailcontent_$DATE mailToUser=ouyangpeng\u7684\u90ae\u7bb1 mailToUser1=\u9886\u5bfc1\u7684\u90ae\u7bb1 mailToUser2=\u9886\u5bfc2\u7684\u90ae\u7bb1 #\u65b0\u5efa\u65e5\u5fd7\u6587\u4ef6 touch $LogFile #\u8ffd\u52a0\u65e5\u5fd7\u5230\u65e5\u5fd7\u6587\u4ef6 echo \"Gitlab auto backup to remote server, start at $(date +\"%Y-%m-%d %H:%M:%S\")\" > $LogFile echo \"---------------------------------------------------------------------------\" >> $LogFile # \u67e5\u627e \u672c\u5730\u5907\u4efd\u76ee\u5f55\u4e0b \u65f6\u95f4\u4e3a180\u5206\u949f\u4e4b\u5185\u7684\uff0c\u5e76\u4e14\u540e\u7f00\u4e3a.tar\u7684gitlab\u5907\u4efd\u6587\u4ef6 BACKUPFILE_SEND_TO_REMOTE=$(find /data/gitlabData/backups -type f -mmin -180 -name '*.tar*') # \u8f93\u51fa\u65e5\u5fd7\uff0c\u6253\u5370\u51fa\u6bcf\u6b21scp\u7684\u6587\u4ef6\u540d echo \"---------------------The file to scp to remote server is: $BACKUPFILE_SEND_TO_REMOTE-------------------------------\" >> $LogFile #\u5907\u4efd\u5230 \u8fdc\u7a0b\u673a\u623f\u4ee3\u7801\u5907\u4efd\u670d\u52a1\u5668 scp -v $BACKUPFILE_SEND_TO_REMOTE $RemoteUser@$RemoteIP1:$RemoteBackDir # $?\u7b26\u53f7\u663e\u793a\u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u8fd4\u56de\u503c\uff0c\u5982\u679c\u4e3a0\u5219\u4ee3\u8868\u6267\u884c\u6210\u529f\uff0c\u5176\u4ed6\u8868\u793a\u5931\u8d25 if [ $? -eq 0 ];then #\u8ffd\u52a0\u65e5\u5fd7\u5230\u65e5\u5fd7\u6587\u4ef6 echo \"-----------------------------------Success!----------------------------------------\" >> $LogFile echo \"Gitlab auto backup to remote server, end at $(date +\"%Y-%m-%d %H:%M:%S\")\" >> $LogFile #\u5199Email\u7684\u6b63\u6587\u5185\u5bb9 > \"$mailcontent\" echo \"GitLab Backup Daily Report, backup to remote server Success ! Please Check your Email and read the following log file\" >> $mailcontent #\u8bfb\u53d6mailcontent\u5185\u5bb9\u5f53\u505a\u90ae\u4ef6\u6b63\u6587 \uff0c\u9644\u4ef6\u4e3aLog\u6587\u4ef6 #cat $mailcontent | mail -s \"Congratulation! GitLab backup to remote server Success Report.\" -t $mailToUser $mailToUser1 $mailToUser2 -A $LogFile #\u6210\u529f\u7684\u8bdd\uff0c\u53ea\u53d1\u9001\u7ed9\u6211\u4e00\u4e2a\u4eba\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u53d1\u9001\u7ed9\u5176\u4ed6\u4eba cat $mailcontent | mail -s \"Congratulation! GitLab backup to remote server Success Report.\" $mailToUser -A $LogFile else #\u8ffd\u52a0\u65e5\u5fd7\u5230\u65e5\u5fd7\u6587\u4ef6 echo \"-----------------------------------Failed!---------------------------------------\" >> $LogFile echo \"Gitlab auto backup to remote server failed at $(date +\"%Y-%m-%d %H:%M:%S\")\" >> $LogFile #\u5199Email\u7684\u6b63\u6587\u5185\u5bb9 > \"$mailcontent\" echo \"GitLab Backup Daily Report,Backup to remote server Failed ! Please Check your Email and read the following log file !\" >> $mailcontent #\u8bfb\u53d6mailcontent\u5185\u5bb9\u5f53\u505a\u90ae\u4ef6\u6b63\u6587 \uff0c\u9644\u4ef6\u4e3aLog\u6587\u4ef6 cat $mailcontent | mail -s \"Warning! GitLab Backup to remote server Failed Report.\" -t $mailToUser $mailToUser1 $mailToUser2 -A $LogFile fi auto_backup_to_remote_script.sh*\u6587\u4ef6\u6e90\u4ee3\u7801\u662f #!/bin/bash # gitlab \u673a\u623f\u5907\u4efd\u8def\u5f84 LocalBackDir=/data/gitlabData/backups #\u5f53\u524d\u7cfb\u7edf\u65e5\u671f DATE=`date +\"%Y-%m-%d\"` #Log\u5b58\u653e\u8def\u5f84 LogFile=$LocalBackDir/log/$DATE.log #Script\u547d\u4ee4\u8bb0\u5f55\u7684\u5b58\u653e\u8def\u5f84\u548c\u6587\u4ef6\u540d ScriptLogFile=$LocalBackDir/script_log/$DATE.log ScriptTimeFile=$LocalBackDir/script_log/$DATE.date #\u65b0\u5efa\u65e5\u5fd7\u6587\u4ef6 touch $ScriptLogFile touch $ScriptTimeFile #\u5f00\u59cb\u542f\u52a8script\u8bb0\u5f55\u6574\u4e2a\u8fc7\u7a0b\uff0c\u6267\u884c /data/gitlabData/backups/auto_backup_to_remote.sh \u811a\u672c script -a $ScriptLogFile -c\"/data/gitlabData/backups/auto_backup_to_remote.sh\" \u8fd9\u6837\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u5c06\u539f\u6765\u7684\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u7684\u811a\u672c\u6587\u4ef6\u4fee\u6539\u4e0b\u5373\u53ef\u3002 crontab -e # edited by summer 2019-01-23 \u6dfb\u52a0\u5b9a\u65f6\u4efb\u52a1\uff0c\u6bcf\u5929\u51cc\u66681\u70b9\uff0c\u6267\u884cgitlab\u5907\u4efd\u5230\u8fdc\u7a0b\u670d\u52a1\u5668 0 1 * * * /bin/bash /scripts/gitlab/auto_backup_to_remote_script.sh","title":"3.1 \u6848\u4f8b1 \u5b9a\u65f6\u5907\u4efd"},{"location":"tools/script_scriptreplay/1.index/#32-2","text":"\u76f4\u63a5\u64cd\u4f5c\u7ebf\u4e0a\u7684\u670d\u52a1\u5668\u6709\u5f88\u5927\u9690\u60a3\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u767b\u5f55\u8df3\u677f\u673a\uff0c\u7136\u540e\u8fde\u63a5\u7ebf\u4e0a\u670d\u52a1\u5668\uff0c\u8df3\u677f\u673a\u53ef\u4ee5\u8bbf\u95ee\u63a7\u5236\u548c\u5b89\u5168\u5ba1\u8ba1\uff0c\u67e5\u770b\u8bb0\u5f55\u6bcf\u4e2a\u4eba\u5bf9\u7ebf\u4e0a\u670d\u52a1\u5668\u7684\u64cd\u4f5c \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b,\u4fee\u6539\u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u5f97\u7528\u6237\u767b\u5f55\u5c31\u4f1a\u89e6\u53d1\u5f55\u50cf root@leco:/datas/commands# tail -1 /etc/profile script -t -f -q 2>/datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.time -a /datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.his root@leco:/datas/commands# chmod 777 /datas/commands/ root@leco:/datas/commands# ls root@leco:/datas/commands# \u6b64\u65f6\u8fd8\u6ca1\u6709\u65e5\u5fd7\uff0c\u63a5\u4e0b\u6765\uff0c\u91cd\u65b0\u767b\u5f55\u7528\u6237 \u6d4b\u8bd5\u767b\u5f55 \u65b0\u5f00\u4e00\u4e2a\u7ec8\u7aef *** \u9700\u8981\u91cd\u542f\u7cfb\u7edf *** Last login: Wed Jan 23 11:03:09 2019 from 192.168.5.1 leco@leco:~$ ip a|grep 192.168.5. inet 192.168.5.110/24 brd 192.168.5.255 scope global enp3s0 leco@leco:~$ echo 'hello' hello \u5728\u770b\u4fdd\u5b58\u7684\u6587\u4ef6 leco@leco:~$ root@leco:/datas/commands# ls leco-1000-20190123110350.his leco-1000-20190123110350.time # 1. \u5355\u72ec\u67e5\u770b \u547d\u4ee4\u5386\u53f2 root@leco:/datas/commands# cat leco-1000-20190123110350.his \u811a\u672c\u542f\u52a8\u4e8e 2019\u5e7401\u670823\u65e5 \u661f\u671f\u4e09 11\u65f603\u520650\u79d2 leco@leco:~$ ip a|grep 192.168.5. inet 192.168.5.110/24 brd 192.168.5.255 scope global enp3s0 leco@leco:~$ echo 'hello' hello # \u67e5\u770b\u52a8\u6001\u5386\u53f2 root@leco:/datas/commands# scriptreplay leco-1000-20190123110350.time leco-1000-20190123110350.his leco@leco:~$ ip a|grep 192.168.5. inet 192.168.5.110/24 brd 192.168.5.255 scope global enp3s0 leco@leco:~$ echo 'hello' hello leco@leco:~$ \u81ea\u5df1\u64cd\u4f5c\uff0c\u67e5\u770b\u6548\u679c \u8fd9\u6837\u641e\u5b8c\u540e\uff0c\u53d1\u73b0\u6709\u4e00\u4e2a\u95ee\u9898\u662f\u6bcf\u6b21\u9000\u51fa\uff0c\u6211\u4e60\u60efCtrl+D\uff0c\u7136\u540e\u6309\u7b2c\u4e00\u904d\u505c\u6b62\u5f55\u50cf\uff0c\u7b2c\u4e8c\u904d\u624d\u80fd\u7528\u6237\u9000\u51fa\uff0c\u5982\u4f55\u89e3\u51b3\u5728\u540e\u9762\u6dfb\u52a0 if [ \"$SHLVL\" = 1 ]; then \u3000\u3000\u3000\u3000exit fi \u5b8c\u6574\u7248 root@leco:/datas/commands# tail -4 /etc/profile script -t -f -q 2>/datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.time -a /datas/commands/$USER-$UID-`date +%Y%m%d%H%M%S`.his if [ \"$SHLVL\" = 1 ]; then exit fi \u8fd9\u6837\u5c31\u53ef\u4ee5\u4e00\u904dCtrl+D\u505c\u6b62\u5f55\u50cf\u548c\u9000\u51fa\u7528\u6237\u3002 \u533a\u522b SHLVL \u8fd9\u4e2a\u53d8\u91cf\u662f\u5e72\u4ec0\u4e48\u7684\uff1f shell\u4e2d\u7684 $SHLVL ,\u8bb0\u5f55\u5f53\u524dshell\u7684\u5d4c\u5957\u5c42\u6b21\uff0c\u521d\u59cb\u4e3a1 \u6bd4\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a\u5f53\u524d\u662f\u5728\u7b2c1\u5c42\uff0c\u6267\u884cbash\u547d\u4ee4\u4e4b\u540e\uff0c $SHLVL \u53d8\u91cf\u53d8\u4e3a2 root@leco:/datas/commands# echo $SHLVL 1 root@leco:/datas/commands# bash root@leco:/datas/commands# echo $SHLVL 2 root@leco:/datas/commands# exit exit root@leco:/datas/commands# echo $SHLVL 1 \u4e0d\u77e5\u9053\u7684\u8bdd\uff0c\u53bb\u767e\u5ea6 SHLVL \u548c BASH_SUBSHELL \u4e24\u4e2a\u53d8\u91cf\u7684\u533a\u522b SHLVL \u548c BASH_SUBSHELL \u4e24\u4e2a\u53d8\u91cf\u7684\u533a\u522b\u53c2\u8003\u94fe\u63a5","title":"3.2 \u6848\u4f8b2 \u670d\u52a1\u5668\u5b89\u5168\u5ba1\u8ba1"}]}